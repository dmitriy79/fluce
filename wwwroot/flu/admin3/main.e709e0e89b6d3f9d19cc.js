!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FlussonicAdmin=t():e.FlussonicAdmin=t()}(this,function(){return(this.webpackJsonpFlussonicAdmin=this.webpackJsonpFlussonicAdmin||[]).push([[0],{1013:function(e,t,n){},1014:function(e,t,n){},1020:function(e,t,n){},1021:function(e,t,n){},1368:function(e,t,n){},1371:function(e,t,n){},1372:function(e,t,n){},1373:function(e,t,n){},1374:function(e,t,n){},1375:function(e,t,n){},1376:function(e,t,n){},1377:function(e,t,n){},1378:function(e,t,n){},1379:function(e,t,n){},1380:function(e,t,n){},1383:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"initialConfigState",function(){return Ze}),n.d(a,"updateConfig",function(){return et}),n.d(a,"updateDelta",function(){return tt}),n.d(a,"waitForSavingDelta",function(){return nt}),n.d(a,"subscribeToConfig",function(){return at}),n.d(a,"unsubscribeFromConfig",function(){return rt}),n.d(a,"approveDelta",function(){return ot}),n.d(a,"store",function(){return mt}),n.d(a,"updateConfigReducer",function(){return st}),n.d(a,"updateDeltaReducer",function(){return lt}),n.d(a,"waitForSavingDeltaReducer",function(){return ct}),n.d(a,"subscribeToConfigReducer",function(){return ut}),n.d(a,"unsubscribeFromConfigReducer",function(){return pt}),n.d(a,"approveDeltaReducer",function(){return dt});n(699),n(536),n(537);var r=n(0),o=n.n(r),i=n(675),s=n(149),l=n(28),c=n.n(l),u=n(234),p=n(377),d=n.n(p);function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){f(e,t,n[t])})}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h={},g={login:null,password:null},v=window.location.hostname,b=window.location.port,y=window.location.protocol,E="".concat(window.location.protocol,"//").concat(window.location.host),w="rtmp://".concat(window.location.hostname,":1935/static/"),S=null,C=null;function O(){return g.login?btoa("".concat(g.login,":").concat(g.password)):null}function x(e,t,n){var a=m({credentials:"same-origin"},t,{headers:m({},h,t.headers)});return fetch("".concat(E).concat(e),a).then(function(e){if(e.ok)return n?e:e.json();throw e})}var N={setAdminToken:function(e){S=e},adminToken:function(){return S},login:function(e){return x("/admin/login",{method:"post",body:Object(u.stringify)(e)})},getHost:function(){return E},setHost:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e){E=e;var n=new URL(t);n.port=1935,n.pathname="".concat(n.pathname,"static/"),n.protocol="rtmp",w=n.toString()}},setLogin:function(e){e?(g.login=e.login,g.password=e.password,h.Authorization="Basic ".concat(O())):(delete h.Authorization,g.login=null,g.password=null)},requestServerInfo:function(){return x("/flussonic/api/server",{method:"get"})},exportConfig:function(){x("/flussonic/api/read_config",{method:"get"}).then(function(e){var t=new Blob([JSON.stringify(e)],{type:"text/plain;charset=utf-8"}),n="".concat(window.location.hostname,"-").concat((new Date).getTime(),".json");return d.a.saveAs(t,n)})},importConfig:function(e){if(e.target.files.length>0){var t=e.target.files[0],n=new FileReader;n.onload=function(e){try{x("/flussonic/api/modify_config",{method:"post",body:JSON.stringify(m({},JSON.parse(e.target.result),{$reset:!0}))})}catch(e){console.error(e)}},n.readAsText(t)}},getServerInfo:function(){return C},setServerInfo:function(e){C=e},restart:function(e){return x("/flussonic/api/stream_restart/".concat(e),{method:"post"})},vodList:function(e,t,n){return x("/flussonic/api/list_files?path=".concat(encodeURIComponent(e),"&prefix=").concat(encodeURIComponent(t),"&subpath=").concat(encodeURIComponent(n)),{method:"get"})},vodRemoveFile:function(e,t,n){return x("/flussonic/api/remove_file?dir=".concat(encodeURIComponent(e),"&prefix=").concat(encodeURIComponent(t),"&subpath=").concat(encodeURIComponent(n)),{method:"post"})},switchSource:function(e,t){return x("/flussonic/api/stream_switch_source/".concat(e,"?url=").concat(encodeURIComponent(t)),{method:"get"})},mediaInfo:function(e){return x("/flussonic/api/media_info/".concat(e),{method:"get"})},killSessions:function(e){return x("/flussonic/api/close_sessions",{method:"post",body:e.join("\n")})}},k=n(82),_=n(651),P=n.n(_),j=n(229),R=n(653),T=n.n(R),I=n(678),D=n(478),A=n(402),q=n(593),M=n(1468),F=n(1469),V=n(1470),B=n(405),L=n(1471),W=n(404),H=n(1472),U=n(306),z={"flex-grow":"-ms-flex-positive","flex-shrink":"-ms-flex-negative","flex-basis":"-ms-flex-preferred-size","align-items":"-ms-flex-align","flex-wrap":"-ms-flex-wrap",order:"-ms-flex-order","justify-content":"-ms-flex-pack","align-self":"-ms-flex-item-align","align-content":"-ms-flex-line-pack"},G={flex:"-ms-flexbox","inline-flex":"-ms-inline-flexbox","flex-start":"start","flex-end":"end","space-between":"justify"};var Q=n(230),K=n(194),J=n(1),Y=n.n(J),$=n(261),X=n(75),Z=n.n(X),ee=n(31),te=n.n(ee),ne=te.a.createActions({pageScroll:{},websocketClose:{},websocketOpen:{}}),ae=te.a.createStore({init:function(){this.outgoing=[],this.subscriptions={}},start:function(){var e,t=this;this.socket=(e=E.replace(/^http/,"ws"),new WebSocket("".concat(e,"/flussonic/api/events").concat(g.login?"?fluadmin=".concat(encodeURIComponent(O())):"")));var n=!0;this.socket.onmessage=function(e){var a=JSON.parse(e.data);"session.open"!==a.event&&"session.close"!==a.event&&n&&t.trigger(a)},this.socket.onopen=function(){ne.websocketOpen(),t.stopReconnect(),t.connected=!0,t.resubscribe(),t.outgoing.forEach(function(e){return t.sendMessage(e)}),t.outgoing=[]},this.socket.onclose=function(){ne.websocketClose(),t.reconnect(!1)},this.socket.onerror=function(){ne.websocketClose(),t.reconnect(!0)}},stop:function(){this.socket.close(),this.socket=null},reconnect:function(e){var t=this;this.disabled=!0,this.socket=null,e&&this.stopReconnect(),this.reconnectTimer||(this.reconnectTimer=setTimeout(function(){t.disabled=!1,t.start()},2e3))},stopReconnect:function(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)},resubscribe:function(){var e=this;this.trigger("resubscribe"),Object.keys(this.subscriptions).forEach(function(t){return e.socket.send("subscribe:".concat(t))})},send:function(e){this.socket&&this.socket.readyState===WebSocket.OPEN?this.sendMessage(e):this.outgoing.push(e)},sendMessage:function(e){var t=e.split(":");"subscribe"===t[0]&&(t.shift(),this.subscriptions[t.join(":")]=!0),"unsubscribe"===t[1]&&(t.shift(),delete this.subscriptions[t.join(":")]),this.socket.send(e)}});function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var oe={prepareStreams:function(e){e.auth=e.auth||{},e.auth.extra=e.auth.extra||{},e.streams=e.streams||{},e.lives=e.lives||{},e.servers=e.servers||{},e.sources=e.sources||{},e.dynamics=e.dynamics||{},e.vods=e.vods||{},e.plugins=e.plugins||{};var t=function(t){t.start_running_at&&(t.lifetime=e.now_ms-t.start_running_at)};for(var n in e.streams)e.streams[n].urls=e.streams[n].urls||[],e.streams[n].auth=e.streams[n].auth||{},e.streams[n].auth.extra=e.streams[n].auth.extra||{},e.streams[n].stats=e.streams[n].stats||{},e.streams[n].stats.name=n,e.streams[n].meta=e.streams[n].meta||{},e.streams[n].cache=e.streams[n].cache||{},e.streams[n].dvr=e.streams[n].dvr||{},e.streams[n].drm=e.streams[n].drm||{},e.streams[n].push=e.streams[n].push||[],t(e.streams[n].stats);for(var a in e.lives)for(var r in e.lives[a].urls=e.lives[a].urls||[],e.lives[a].meta=e.lives[a].meta||{},e.lives[a].dvr=e.lives[a].dvr||{},e.lives[a].cache=e.lives[a].cache||{},e.lives[a].drm=e.lives[a].drm||{},e.lives[a].auth=e.lives[a].auth||{},e.lives[a].auth.extra=e.lives[a].auth.extra||{},e.lives[a].streams=e.lives[a].streams||{},e.lives[a].streams)e.lives[a].streams[r].name=r,t(e.lives[a].streams[r]);for(var o in e.dynamics)for(var i in e.dynamics[o].urls=e.dynamics[o].urls||[],e.dynamics[o].meta=e.dynamics[o].meta||{},e.dynamics[o].streams=e.dynamics[o].streams||{},e.dynamics[o].streams)e.dynamics[o].streams[i].name=i,t(e.dynamics[o].streams[i]);for(var s in e.sources)for(var l in e.sources[s].urls=e.sources[s].urls||[],e.sources[s].meta=e.sources[s].meta||{},e.sources[s].dvr=e.sources[s].dvr||{},e.sources[s].cache=e.sources[s].cache||{},e.sources[s].drm=e.sources[s].drm||{},e.sources[s].auth=e.sources[s].auth||{},e.sources[s].auth.extra=e.sources[s].auth.extra||{},e.sources[s].streams=e.sources[s].streams||{},e.sources[s].streams)e.sources[s].streams[l].name=l,t(e.sources[s].streams[l]);for(var c in e.vods)e.vods[c].urls=e.vods[c].urls||[],e.vods[c].stats=e.vods[c].stats||{},e.vods[c].auth=e.vods[c].auth||{},e.vods[c].auth.extra=e.vods[c].auth.extra||{},e.vods[c].meta=e.vods[c].meta||{},e.vods[c].cache=e.vods[c].cache||{},e.vods[c].drm=e.vods[c].drm||{},e.vods[c].files=e.vods[c].files||{}},changeDelta:function(e,t,n,a,r){if(Array.isArray(n)&&0==n.length)return t;var o=JSON.parse(JSON.stringify(t));"integer"==r&&(a=a.match(/^\d+$/)?parseInt(a,10):null),"string"==r&&""===a&&(a=null);var i=oe.setValueByPath(o,n,a);return oe.delta_cleaner_r(e,i,{}),i},setValueByPath:function(e,t,n){var a=Array.isArray(t)?t:t.split("."),r=e;for(var o in a){var i=a[o];i==""+parseInt(i,10)&&(i=parseInt(i,10)),o==a.length-1?e[i]="$toggle"==n?!e[i]:n:e[i]||(e[i]={}),e=e[i]}return r},delta_cleaner_r:function(e,t,n){if("object"!=re(t)||null===t||Array.isArray(t))n.dirty=(null!==t||void 0!==e)&&JSON.stringify(e)!=JSON.stringify(t);else for(var a in t){var r={};oe.delta_cleaner_r(e?e[a]:{},t[a],r),r.dirty?n.dirty=!0:delete t[a]}},applyDelta:function(e,t,n){var a=JSON.parse(JSON.stringify(t));if(!a)return e;var r=e?JSON.parse(JSON.stringify(e)):{},o={level:1,path:"root"};return oe.applyDelta_r(r,a,n||{},o),o.changed&&n&&n.mark_changes&&(r.changed=!0),r},mutateByDelta:function(e,t){return t?(oe.applyDelta_r(e,t,{},{level:1,path:"root"}),e):e},applyDelta_r:function(e,t,n,a){for(var r in t)if(null===t[r]||void 0===t[r])e.hasOwnProperty(r)&&(a.changed=!0,n.mark_changes&&"outside"==this.markChangedAs(a,r)&&(e[r+"_changed"]=!0)),delete e[r];else if("object"!=re(t[r])||Array.isArray(t[r])){(e.hasOwnProperty(r)?JSON.stringify(e[r]):"")!=(t.hasOwnProperty(r)?JSON.stringify(t[r]):"")&&(a.changed=!0,n.mark_changes&&"outside"==this.markChangedAs(a,r)&&(e[r+"_changed"]=!0)),e[r]=t[r]}else{e[r]||(e[r]={});var o={level:a.level+1,path:a.path+"."+r};if(oe.applyDelta_r(e[r],t[r],n,o),a.changed=a.changed||o.changed,o.changed&&n.mark_changes){var i=this.markChangedAs(a,r);"outside"==i?e[r+"_changed"]=!0:"inside"==i&&(e[r].changed=!0)}}},markChangedAs:function(e,t){switch(e.path){case"root.streams":case"root.vods":case"root.lives":case"root.dynamics":case"root.servers":case"root.sources":case"root.plugins":return"inside";case"root":switch(t){case"streams":case"vods":case"lives":case"dynamics":case"servers":case"sources":case"plugins":return!1}}return"outside"},Instance:function(){this.config={},this.delta={}}};oe.Instance.prototype.setServerConfig=function(e){return this.config=e,this.delta=oe.changeDelta(this.config,this.delta,[],null,""),this.localConfig()},oe.Instance.prototype.resetDelta=function(){this.delta={}},oe.Instance.prototype.setDelta=function(e){return this.delta=e,this.localConfig()},oe.Instance.prototype.changeDelta=function(e,t,n){return this.delta=oe.changeDelta(this.config,this.delta,e,t,n),this.localConfig()},oe.Instance.prototype.applyDelta=function(e){return this._normalize(oe.applyDelta(this.config,this.delta,e||{}))},oe.Instance.prototype.localConfig=function(){return this._normalize(this.applyDelta({mark_changes:!0}))},oe.Instance.prototype._normalize=function(e){return["vods","servers","auth","dvrs","edit_auth","view_auth","web_scripts","http_proxies","streams","lives","dynamics"].forEach(function(t){e[t]||(e[t]={})}),e};var ie=oe,se=n(559),le=n(555),ce=n(560),ue=n(193),pe=n(561),de=n(562),me=n(55),fe=n(177),he=n(554),ge=n(231),ve=n(72),be=n(260),ye=n(59),Ee=n(253),we=n(355),Se=n(254),Ce=n(354),Oe=n(557),xe=n(558),Ne=n(58),ke=n(120),_e=n(301),Pe=n(357),je=function(e,t){return Q.a(ve.a(e,t),ye.a)},Re=n(556),Te=he.a(me.a(void 0)),Ie=(he.a(me.a(void 0)),he.a(we.a)),De=he.a(le.a),Ae=Re.a([Ie,De]),qe=he.a(Ae),Me=function(e){return Q.a(me.a(e),ge.a)},Fe=Me("Object"),Ve=Me("Number"),Be=(he.a(Fe),Me("Function"));function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){We(e,t,n[t])})}return e}function We(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var He=he.a(me.a),Ue=Q.a(me.a("Object"),ge.a);function ze(e){return Q.a(ve.a(function(t,n){return Le({},t,We({},n,Ue(e[n])?ze(e[n]):e[n]))},{}),be.a(function(t){return Te(e[t])}),ye.a)(e)}function Ge(e,t){return Q.a(ve.a(function(n,a){var r=Ee.a(a);if(Ue(r(e))){var o=Ge(r(e),r(t));return le.a(o)||we.a(o)?n:Le({},n,We({},a,o))}return me.a(r(e),r(t))?n:Le({},n,We({},a,r(e)))},{}),ye.a)(e)}var Qe=Se.a(function(e,t){return Q.a(Ce.a,me.a(void 0),Oe.a(e))(t)}),Ke=function(e,t){return Q.a(be.a(Ie),xe.a,Ne.a(function(e){return"function"==typeof e?e(t):e}))(e)},Je=function(e,t,n){var a=ke.a(e,t.config),r=ke.a(e,n),o=_e.a(ye.a(r),ye.a(a)),i=_e.a(ye.a(r),o),s=Pe.a(o,r),l=le.a(s),c=Pe.a(i,r);return{config:s,isConfigEmpty:l,delta:c,isDeltaEmpty:le.a(c)}},Ye=function(e,t){return je(function(n,a){return Ie(e[a])&&we.a(t[a])?Le({},n,We({},a,null)):n},t)(e)};function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Xe(e,t,n[t])})}return e}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ze={config:{},delta:{},subscribers:{},subscribersApprovedDelta:{},savingDeltas:{}},et=Object(fe.a)("updateConfig"),tt=Object(fe.a)("updateDelta"),nt=Object(fe.a)("waitForSavingDelta"),at=Object(fe.a)("subscribeToConfig"),rt=Object(fe.a)("unsubscribeFromConfig"),ot=Object(fe.a)("approveDelta"),it=Object(fe.a)("resetStore"),st=function(e,t){return $e({},e,{config:se.a(t)})},lt=function(e,t){var n=Object.keys(e.savingDeltas).some(function(n){return le.a(Ge(e.savingDeltas[n],t))});if(n)return $e({},e,{config:ce.a(e.config,t),savingDeltas:ue.a(function(e){return le.a(Ge(e,t))},e.savingDeltas)});var a=Je(["streams"],e,t),r=Je(["lives"],e,t),o=Je(["vods"],e,t),i=Je(["sources"],e,t);if(!(a.isConfigEmpty&&r.isConfigEmpty&&o.isConfigEmpty&&i.isConfigEmpty)){var s=Object.assign({},e.config,!a.isConfigEmpty&&{streams:$e({},e.config.streams,a.config)},!r.isConfigEmpty&&{lives:$e({},e.config.lives,r.config)},!o.isConfigEmpty&&{vods:$e({},e.config.vods,o.config)},!i.isConfigEmpty&&{sources:$e({},e.config.sources,i.config)}),l=Object.assign({},e.delta,!a.isDeltaEmpty&&{streams:$e({},e.delta.streams,a.delta)},!r.isDeltaEmpty&&{lives:$e({},e.delta.lives,r.delta)},!o.isDeltaEmpty&&{vods:$e({},e.delta.vods,o.delta)},!i.isDeltaEmpty&&{sources:$e({},e.delta.sources,i.delta)}),c=a.isDeltaEmpty&&r.isDeltaEmpty&&o.isDeltaEmpty&&i.isDeltaEmpty?e.subscribersApprovedDelta:pe.a(de.a)(e.subscribers);return $e({},e,{config:s,delta:l,subscribersApprovedDelta:c})}return $e({},e,{delta:e.delta?ce.a(e.delta,t):t,subscribersApprovedDelta:pe.a(de.a)(e.subscribers)})},ct=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.error.bind(console),a=t.id,r=t.savingDelta;return e.savingDeltas[a]&&n("More than one saving deltas exists the same time! Case should be studied and changes applied to configStore"),$e({},e,{savingDeltas:$e({},e.savingDeltas,Xe({},a,r))})},ut=function(e,t){return $e({},e,{subscribers:$e({},e.subscribers,Xe({},t,t))})},pt=function(e,t){return ot(t),$e({},e,{subscribers:ue.a(me.a(t))(e.subscribers)})},dt=function(e,t){var n=$e({},e.subscribersApprovedDelta,Xe({},t,!0)),a=Object.keys(e.subscribersApprovedDelta).every(function(n){return n===t||e.subscribersApprovedDelta[n]});return $e({},e,{delta:a?{}:e.delta,config:a?ce.a(e.config,e.delta):e.config,subscribersApprovedDelta:a?{}:n})},mt=Object(fe.b)(Ze).on(et,st).on(tt,lt).on(nt,ct).on(at,ut).on(rt,pt).on(ot,dt).reset(it),ft=te.a.createStore({init:function(){this.listenTo(ae,this.onEvent)},start:function(){ae.send("read_config")},stop:function(){this.timer&&clearTimeout(this.timer),delete this.timer,this.stopped=!0},save:function(e){return x("/flussonic/api/modify_config",{method:"post",body:JSON.stringify(e)})},onEvent:function(e){"current_config"===e.event?(this.stopped||(this.timer=setTimeout(this.requestConfigDelta,e.partial_update?0:1e3)),this.current_config=e.data,ie.prepareStreams(this.current_config),this.trigger(this.current_config),et(this.current_config)):"current_config_delta"===e.event&&(this.stopped||(this.timer=setTimeout(this.requestConfigDelta,e.partial_update?0:1e3)),this.current_config=ie.mutateByDelta(this.current_config,e.data),ie.prepareStreams(this.current_config),this.trigger(this.current_config),tt(e.data))},requestConfigDelta:function(){ae.send("read_config_delta")}}),ht=n(150);function gt(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var vt={root:"",pulse:"pulse","global-config":"config","config-editor":"config/editor",chassis:"chassis",iptv:"iptv",watcher:"watcher",logupload:"logupload",auth:"auth",ad_injector:"ad_injector",dvrs:"dvrs","stream-item":"standalone/:mediaName","stream-item-overview":"standalone/:mediaName","stream-item-input":"standalone/:mediaName/input","stream-item-input-overview":"standalone/:mediaName/input","stream-item-input-url-options":"standalone/:mediaName/input/:sourceIndex","stream-item-transcoder":"standalone/:mediaName/transcoder","stream-item-dvr":"standalone/:mediaName/dvr","stream-item-output":"standalone/:mediaName/output","stream-item-auth":"standalone/:mediaName/auth","stream-item-clients":"standalone/:mediaName/clients","stream-item-history":"standalone/:mediaName/history","location-item":"location/:mediaName","location-item-overview":"location/:mediaName","location-item-input":"location/:mediaName/input","location-item-process":"location/:mediaName/process","location-item-dvr":"location/:mediaName/dvr","location-item-output":"location/:mediaName/output","location-item-auth":"location/:mediaName/auth","location-item-clients":"location/:mediaName/clients","location-item-history":"location/:mediaName/history","published-item":"published/:mediaName","published-item-overview":"published/:mediaName","published-item-output":"published/:mediaName/output","published-item-dvr":"published/:mediaName/dvr","published-item-clients":"published/:mediaName/clients","vod-item":"vod/:mediaName","vod-item-overview":"vod/:mediaName","vod-item-tree":"vod/:mediaName/tree/:number","vod-item-input":"vod/:mediaName/input","vod-item-output":"vod/:mediaName/output","vod-item-auth":"vod/:mediaName/auth","file-item":"file/:mediaName","file-item-overview":"file/:mediaName","file-item-output":"file/:mediaName/output","file-item-clients":"file/:mediaName/clients","mirror-item":"mirror/:mediaName","mirror-item-overview":"mirror/:mediaName","mirror-item-input":"mirror/:mediaName/input","mirror-item-process":"mirror/:mediaName/process","mirror-item-dvr":"mirror/:mediaName/dvr","mirror-item-output":"mirror/:mediaName/output","mirror-item-auth":"mirror/:mediaName/auth","mirrored-item":"mirrored/:mediaName","mirrored-item-overview":"mirrored/:mediaName","mirrored-item-output":"mirrored/:mediaName/output","mirrored-item-dvr":"mirrored/:mediaName/dvr","mirrored-item-clients":"mirrored/:mediaName/clients",cluster:"cluster","cluster-settings":"cluster/settings","cluster-ingest":"cluster/ingest","cluster-sources":"cluster/sources","cluster-peer":"cluster/peer/:name"};function bt(e,t){var n="/admin",a=vt[e];if(void 0===a)throw Error(e);return"function"==typeof a&&(a=a(t)),"string"==typeof a&&a&&(n="".concat(n,"/").concat(a)),n}function yt(e,t,n){var a=bt(e,t).split("/").map(function(e){return 0===e.indexOf(":")&&t&&Object.prototype.hasOwnProperty.call(t,e.substring(1))?"".concat(encodeURIComponent(t[e.substring(1)])):e}).join("/"),r=Object(u.stringify)(n);return r&&(a="".concat(a,"?").concat(r)),a}var Et=function(e){var t=e.to,n=e.params,a=e.className,r=e.activeClassName,i=e.onClick,s=e.children,l=gt(e,["to","params","className","activeClassName","onClick","children"]);return o.a.createElement(ht.a,{activeClassName:r,"data-testid":l["data-testid"],exact:!0,onClick:i,className:a,to:yt(t,n)},s)};function wt(e){var t=e.path?e:Z()(e,{path:{$set:bt(e.name,e.params)}});if(t.extraProps){var n=t.extraProps,a=t.component;t.render=function(e){return o.a.createElement(a,Z()(n,{$merge:e}))},delete t.component,delete t.extraProps}return o.a.createElement(k.b,t)}function St(e,t,n,a){var r=e&&e.props&&e.props.history&&"function"==typeof e.props.history.push,o=yt(t,n,a);r?e.props.history.push(o):window.location.hash=o}function Ct(e){return Object(u.parse)(e.props.location.search)}function Ot(e){var t=e.props.location.pathname.split("/");t.shift();var n=[];if("admin"!==t[0])return[];n.push({name:"root"}),t.shift();var a=null;switch(t[0]){case"standalone":a="stream";break;case"location":a="location";break;case"published":a="published";break;case"vod":a="vod";break;case"file":a="file";break;case"mirror":a="mirror";break;case"mirrored":a="mirrored"}if(a)n.push({name:"".concat(a,"-item")}),t.shift(),t.length>0&&(n.push({match:{mediaName:t[0]}}),t.shift()),t.length>0&&(n.push({name:"".concat(a,"-item-").concat(t[0])}),t.shift(),t.length>0&&(n.push({match:{number:t[0]}}),t.shift()));else switch(t[0]){case"config":n.push({name:"global-config"});break;default:t[0]&&n.push({name:t[0]})}return n}function xt(e){var t={};return Ot(e).forEach(function(e){e.match&&(t=Z()(t,{$merge:e.match}))}),t}Et.propTypes={to:Y.a.string.isRequired,params:Y.a.object,className:Y.a.string,activeClassName:Y.a.string,"data-testid":Y.a.string,onClick:Y.a.func,children:Y.a.node},Et.defaultProps={params:null,"data-testid":null,className:"",activeClassName:"",onClick:K.a(),children:null};var Nt=n(111);function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _t(){return(_t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Pt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jt(e){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dt=function(e,t){return function(n){var a=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,n=!(r=(e=jt(t)).call.apply(e,[this].concat(i)))||"object"!==kt(r)&&"function"!=typeof r?Rt(a):r,It(Rt(n),"listenTo",Nt.listenTo.bind(Rt(n))),It(Rt(n),"stopListeningToAll",Nt.stopListeningToAll.bind(Rt(n))),It(Rt(n),"fetchInitialState",Nt.fetchInitialState.bind(Rt(n))),It(Rt(n),"hasListener",Nt.hasListener.bind(Rt(n))),It(Rt(n),"validateListening",Nt.validateListening.bind(Rt(n))),n}var a,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(t,o.a.Component),a=t,(r=[{key:"componentWillUnmount",value:function(){this.stopListeningToAll()}},{key:"render",value:function(){return o.a.createElement(n,_t({},this.props,{listenTo:this.listenTo}))}}])&&Pt(a.prototype,r),i&&Pt(a,i),t}();return It(a,"propTypes",e),It(a,"defaultProps",t),a.displayName="withRefluxListener(".concat(n.name||n.displayName,")"),a}},At={listenTo:Y.a.func.isRequired};function qt(e){return(qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mt(){return(Mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ft(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Vt(e){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lt(e,t){return(Lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ht=function(e){var t=function(t){function n(){var e,t,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Vt(n)).call.apply(e,[this].concat(i)),t=!r||"object"!==qt(r)&&"function"!=typeof r?Bt(a):r,Wt(Bt(t),"getSelectedNode",function(){return c.a.findDOMNode(t.selectedItem)}),Wt(Bt(t),"pickupSelectedItem",function(e,n){t.props.selectedName===e&&(t.selectedItem=n)}),t}var a,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lt(e,t)}(n,o.a.Component),a=n,(r=[{key:"componentDidUpdate",value:function(){this.props.selectedName||(this.selectedItem=null)}},{key:"render",value:function(){return o.a.createElement(e,Mt({pickupSelectedItem:this.pickupSelectedItem,getSelectedNode:this.getSelectedNode},this.props))}}])&&Ft(a.prototype,r),i&&Ft(a,i),n}();return Wt(t,"propTypes",{selectedName:Y.a.string.isRequired}),t.displayName="withSelectedItem(".concat(e.name||e.displayName,")"),t},Ut=n(358),zt=n(564),Gt=Q.a(Ut.a,zt.a(":")),Qt=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("".concat(t,":")===y){if(a){var r=String(b);return"".concat(t,"://").concat(v).concat(r===n||""===r?"":":".concat(b))}return"".concat(t,"://").concat(v,":").concat(b)}var o=Gt(String(e[t][0]||e[t]));return a?"".concat(t,"://").concat(v).concat(o===n?"":":".concat(b)):"".concat(t,"://").concat(v,":").concat(o)},Kt=function(e,t,n){return b?"".concat(t,"://").concat(v,":").concat(b):"".concat(t,"://").concat(v,":").concat(n)},Jt={findByName:function(e,t,n){if((!n||"streams"===n)&&e.streams[t])return e.streams[t];if(!n||"lives"===n)for(var a in e.lives)if(e.lives[a].streams&&e.lives[a].streams[t])return e.lives[a].streams[t];if(!n||"dynamics"===n)for(var r in e.dynamics)if(e.dynamics[r].streams&&e.dynamics[r].streams[t])return e.dynamics[r].streams[t];if(!n||"sources"===n)for(var o in e.sources)if(e.sources[o].streams&&e.sources[o].streams[t])return e.sources[o].streams[t];if(!n||"vods"===n)for(var i in e.vods)if(e.vods[i].files&&e.vods[i].files[t])return e.vods[i].files[t]},httpHostPort:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.http&&0!==e.http.length)return Qt(e,"http","80",t)},httpsHostPort:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.https&&0!==e.https.length)return Qt(e,"https","443",t)},rtmpHostPort:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.rtmp)return Qt(e,"rtmp","1935",t)},rtspHostPort:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.rtsp)return Qt(e,"rtsp","554",t)},currentHttpHostPort:function(e){if(e.http&&0!==e.http.length)return Kt(0,"http","80")},currentHttpsHostPort:function(e){if(e.https&&0!==e.https.length)return Kt(0,"https","443")},currentRtmpHostPort:function(e){if(e.rtmp&&0!==e.rtmp.length)return Kt(0,"rtmp","1935")}};function Yt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var $t=function(e){return!!e.find(function(e){return e.url.includes("publish://")})},Xt={isUrlPublishCapabilityPresent:function(){var e=N.getServerInfo();return e.capabilities&&e.capabilities.url_publish},isPublishedOld:function(e,t){return!!e.publish_enabled&&!!t.published_from},isPublishedNew:function(e,t){return $t(e.urls)&&!!t.published_from},isPublished:function(e,t){return Xt.isUrlPublishCapabilityPresent()?Xt.isPublishedNew(e,t):Xt.isPublishedOld(e,t)},enablePublishingOld:function(e,t){return t("publish_enabled","raw").bind(null,!0)},enablePublishingNew:function(e,t){var n=$t(e.urls)?e.urls:[].concat(Yt(e.urls),[{url:"publish://"}]);return t("urls","raw").bind(null,n)},enablePublishing:function(e,t){return Xt.isUrlPublishCapabilityPresent()?Xt.enablePublishingNew(e,t):Xt.enablePublishingOld(e,t)},disablePublishingOld:function(e,t){return t("publish_enabled","raw").bind(null,!1)},disablePublishingNew:function(e,t){var n=e.urls.filter(function(e){return!e.url.includes("publish://")});return t("urls","raw").bind(null,n)},disablePublishing:function(e,t){return Xt.isUrlPublishCapabilityPresent()?Xt.disablePublishingNew(e,t):Xt.disablePublishingOld(e,t)},publishEnabledOld:function(e){return e.publish_enabled},publishEnabledNew:function(e){return $t(e.urls)},publishEnabled:function(e,t){return Xt.isUrlPublishCapabilityPresent()?Xt.publishEnabledNew(e,t):Xt.publishEnabledOld(e,t)},hasOnlyPublish:function(e){var t=e.urls&&0===e.urls.length&&e.publish_enabled,n=e.urls&&1===e.urls.length&&"publish://"===e.urls[0].url;return t||n},hasNoSources:function(e){return!(!e.urls||0!==e.urls.length||e.publish_enabled)},isUnavailable:function(e){return e.ts_delay>6e4||e.retry_count>0},nameSortFunc:function(e,t,n){return"asc"===e&&t.name>n.name||"desc"===e&&t.name<n.name?1:-1},clientsSortFunc:function(e,t,n){var a=t,r=n;t.stats&&(a=t.stats),n.stats&&(r=n.stats);var o=a.client_count,i=r.client_count;return void 0===o&&(o=-1),void 0===i&&(i=-1),o===i?0:"desc"===e&&o>i||"asc"===e&&o<i?1:-1},bitrateSortFunc:function(e,t,n){var a=t,r=n;t.stats&&(a=t.stats),n.stats&&(r=n.stats);var o=a.bitrate,i=r.bitrate;return void 0===o&&(o=-1),void 0===i&&(i=-1),(o=Math.floor(o/10))===(i=Math.floor(i/10))?0:"desc"===e&&o>i||"asc"===e&&o<i?1:-1},runtimeSortFunc:function(e,t,n){var a=t,r=n;t.stats&&(a=t.stats),n.stats&&(r=n.stats);var o=a.start_running_at,i=r.start_running_at;return void 0===o&&(o=1/0),void 0===i&&(i=1/0),o===i?0:"desc"===e&&o<i||"asc"===e&&o>i?1:-1},outputURL:function(e,t,n){var a=Jt.currentHttpHostPort(e)||Jt.currentHttpsHostPort(e),r=Jt.currentRtmpHostPort(e);switch(n){case"hls":case"hls_flash":case"hls_video":return"".concat(a,"/").concat(t,"/index.m3u8");case"hds":return"".concat(a,"/").concat(t,"/manifest.f4m");case"rtmp":return"".concat(r,"/static/").concat(t);case"dash":return"".concat(a,"/").concat(t,"/index.mpd");case"webrtc":return"".concat(a,"/").concat(t,"/webrtc");default:return""}},embedCode:function(e){return'<iframe style="width:640px; height:480px;" allowfullscreen src="'.concat(E,"/").concat(e,'/embed.html"></iframe>')},matchFilters:function(e,t){for(var n=0;n<t.length;n+=1){var a=!e.static&&!e.stats.alive,r=0===e.urls.length&&e.publish_enabled&&!e.stats.alive,o=0===e.urls.length&&!e.publish_enabled,i=!!e.stats.source_error&&"thumbnails_are_not_fetched"!==e.stats.source_error||!!Xt.isUnavailable(e.stats),s=!0;switch(t[n]){case"dvr":s=e.dvr&&e.dvr.root||!!e.stats.dvr_info;break;case"transcoder":s=e.transcoder||!!e.stats.running_transcoder;break;case"error":s=!a&&!r&&!o&&i;break;case"online":s=!i&&e.stats.alive;break;case"waiting":a=!e.static&&!e.stats.alive,r=0===e.urls.length&&e.publish_enabled&&!e.stats.alive,s=a||r}if(!s)return!1}return!0},matchQuery:function(e,t){if(!t)return!0;var n=[];n.push(e.name.trim().toLowerCase()),n.push((e.title||e.meta.comment||"").trim().toLowerCase()),e.stats.url&&n.push(e.stats.url),e.stats.published_via&&n.push(e.stats.published_via);for(var a=0;a<n.length;a+=1)if(-1!==n[a].indexOf(t))return!0;return!1}},Zt=Xt,en=n(12),tn=n.n(en),nn=n(17),an=n.n(nn);function rn(e){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function on(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function sn(e){return(sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ln(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cn(e,t){return(cn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pn=function(){},dn=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=sn(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==rn(r)&&"function"!=typeof r?ln(a):r,un(ln(n),"state",{focus:!1,changeTimeout:void 0,value:n.props.value}),un(ln(n),"inputRef",null),un(ln(n),"setInputRef",function(e){e&&!n.inputRef&&(n.inputRef=e,n.props.setRef(e))}),un(ln(n),"onLabelClick",function(){n.inputRef.focus()}),un(ln(n),"onInputFocus",function(e){n.setState({focus:!0}),n.props.expandLabel&&n.props.expandLabel(!0),n.props.onFocus&&n.props.onFocus(e)}),un(ln(n),"onInputBlur",function(e){n.setState({focus:!1}),!n.inputRef.value&&n.props.expandLabel&&n.props.expandLabel(!1),n.props.onBlur&&n.props.onBlur(e)}),un(ln(n),"onInputClick",function(e){n.props.selectOnClick&&e.target.select()}),un(ln(n),"onInputChange",function(e){return n.props.debounceInput?n.debounceChange(e):n.props.onChange(e)}),un(ln(n),"onSubmit",function(e){e.preventDefault(),n.props.onSubmit()}),un(ln(n),"debounceChange",function(e){var t;if(n.state.changeTimeout&&clearTimeout(n.state.changeTimeout),n.props.onChange){var a={target:{value:e.target.value},preventDefault:function(){}};t=setTimeout(n.props.onChange.bind(null,a),200)}n.setState({changeTimeout:t,value:e.target.value})}),un(ln(n),"resetValue",function(){return n.setState({value:n.props.value})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cn(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.expandLabel&&this.props.expandLabel(0===this.props.value||!!this.props.value),this.props.listenToLabelClick&&this.props.listenToLabelClick(this.onLabelClick),this.props.focusOnMount&&this.inputRef.focus()}},{key:"componentWillReceiveProps",value:function(e){!this.props.value&&e.value&&this.props.expandLabel&&this.props.expandLabel(!0),this.props.value&&!e.value&&this.props.expandLabel&&this.props.expandLabel(!1),this.props.value!==e.value&&this.setState({value:e.value})}},{key:"componentWillUnmount",value:function(){this.state.changeTimeout&&clearTimeout(this.state.changeTimeout)}},{key:"render",value:function(){var e=this.props.className,t=an()("form-input",e,{focus:this.state.focus,changed:this.props.changed}),n=this.props.prefix&&o.a.createElement("div",{className:an()("prefix",{clickable:this.props.onPrefixClick}),onClick:this.props.onPrefixClick},this.props.prefix),a=this.props.onSubmit?this.state.value:this.props.debounceInput&&(this.state.value||"")||this.props.value||"",r=o.a.createElement("input",{type:"text",ref:this.setInputRef,value:a,"data-testid":this.props["data-testid"],readOnly:this.props.readOnly,disabled:this.props.disabled,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onChange:this.onInputChange,onClick:this.onInputClick});return o.a.createElement("div",{className:t},n,this.props.onSubmit?o.a.createElement("form",{onSubmit:this.onSubmit},r):r)}}])&&on(n.prototype,a),r&&on(n,r),t}();un(dn,"propTypes",{value:Y.a.oneOfType([Y.a.number,Y.a.string]),changed:Y.a.bool,disabled:Y.a.bool,readOnly:Y.a.bool,selectOnClick:Y.a.bool,focusOnMount:Y.a.bool,debounceInput:Y.a.bool,className:Y.a.string,"data-testid":Y.a.string,onChange:Y.a.func,onFocus:Y.a.func,onBlur:Y.a.func,onSubmit:Y.a.func,prefix:Y.a.string,onPrefixClick:Y.a.func,expandLabel:Y.a.func,listenToLabelClick:Y.a.func,setRef:Y.a.func}),un(dn,"defaultProps",{value:"",changed:!1,disabled:!1,readOnly:!1,selectOnClick:!1,focusOnMount:!1,debounceInput:!0,"data-testid":null,className:"",onChange:pn,onFocus:pn,onBlur:pn,onSubmit:pn,prefix:"",onPrefixClick:pn,expandLabel:pn,listenToLabelClick:pn,setRef:pn});var mn=dn,fn=tn()({render:function(){var e="cycled-select notice-text";return this.props.className&&(e+=" "+this.props.className),o.a.createElement("div",{className:e,onClick:this.props.onClick},this.props.unit.label)}}),hn=tn()({displayName:"NumericUnitInput",getInitialState:function(){var e=function(e,t){if(e){for(var n in t)if(e==t[n].label)return parseInt(n,10);console.error("Unable to find unit by it's label: ",e,t)}}(this.props.defaultUnit,this.props.units),t=function(e,t,n){if(!e){var a=n||0;return{value:0,unit:t[a],index:a}}for(var r in t){var o=Math.floor(e/t[r].factor);if(o>0)return{value:o,unit:t[r],index:parseInt(r,10)}}console.error("could find suitable unit for value: ",e,t)}(this.props.value,this.props.units,e);return{unit:t.unit,index:t.index,value:t.value}},expandLabel:function(e){this.setState({expanded:e}),this.props.expandLabel(e)},onChangeValue:function(e){e.target.value||(this.setState({value:void 0}),this.props.onChange(null));var t=parseInt(e.target.value,10);isNaN(t)||(this.setState({value:t}),this.props.onChange(t*this.state.unit.factor))},onNextUnitClick:function(){var e=this.state.index+1;e>=this.props.units.length&&(e=0);var t=this.props.units[e];this.setState({unit:t,index:e}),this.props.onChange(this.state.value*t.factor)},render:function(){var e=void 0;if(this.state.expanded){var t=this.props.units.length<=1||this.props.readOnly;e=o.a.createElement(fn,{value:this.props.value,readOnly:t,unit:this.state.unit,onClick:this.onNextUnitClick,className:"margin-left-10"})}return o.a.createElement("div",{className:"numeric-unit-input"},o.a.createElement(mn,{value:this.state.value,onChange:this.onChangeValue,changed:this.props.changed,expandLabel:this.expandLabel,listenToLabelClick:this.props.listenToLabelClick,readOnly:this.props.readOnly}),e)}});function gn(e){return(gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vn(){return(vn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function bn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function yn(e,t){return!t||"object"!==gn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function En(e){return(En=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sn,Cn,On,xn=[{label:"days",factor:86400},{label:"hours",factor:3600}],Nn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yn(this,En(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wn(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement(hn,vn({},this.props,{units:xn}))}}])&&bn(n.prototype,a),r&&bn(n,r),t}();Sn=Nn,Cn="propTypes",On={value:Y.a.any,changed:Y.a.bool,onChange:Y.a.func,expandLabel:Y.a.func,listenToLabelClick:Y.a.func,defaultUnit:Y.a.string},Cn in Sn?Object.defineProperty(Sn,Cn,{value:On,enumerable:!0,configurable:!0,writable:!0}):Sn[Cn]=On;var kn=Nn;function _n(e){return(_n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pn(){return(Pn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function jn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Rn(e,t){return!t||"object"!==_n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tn(e){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function In(e,t){return(In=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Dn=[{label:"Gigabits per second",factor:1073741824},{label:"Megabits per second",factor:1048576},{label:"Kilobits per second",factor:1024}],An=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Rn(this,Tn(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&In(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement(hn,Pn({},this.props,{units:Dn}))}}])&&jn(n.prototype,a),r&&jn(n,r),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(An,"propTypes",{value:Y.a.any,changed:Y.a.bool,onChange:Y.a.func,expandLabel:Y.a.func,listenToLabelClick:Y.a.func,defaultUnit:Y.a.string});var qn=An;function Mn(e){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fn(){return(Fn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Vn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Bn(e,t){return!t||"object"!==Mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ln(e){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wn(e,t){return(Wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hn=[{label:"Gigabytes",factor:1073741824},{label:"Megabytes",factor:1048576},{label:"Kilobytes",factor:1024}],Un=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Bn(this,Ln(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wn(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement(hn,Fn({},this.props,{units:Hn}))}}])&&Vn(n.prototype,a),r&&Vn(n,r),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Un,"propTypes",{value:Y.a.any,changed:Y.a.bool,onChange:Y.a.func,expandLabel:Y.a.func,listenToLabelClick:Y.a.func,defaultUnit:Y.a.string});var zn=Un;function Gn(e){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Kn(e){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yn(e,t){return(Yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xn=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Kn(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Gn(r)&&"function"!=typeof r?Jn(a):r,$n(Jn(n),"state",{focus:!1,editing:!1}),$n(Jn(n),"hasValue",function(){return n.props.value&&0!=n.props.value.length}),$n(Jn(n),"onLabelClick",function(){n.refs.input.focus()}),$n(Jn(n),"onFocus",function(){n.setState({focus:!0}),n.props.expandLabel&&n.props.expandLabel(!0)}),$n(Jn(n),"onBlur",function(){n.props.expandLabel&&(n.refs.input.value||n.hasValue()||n.props.expandLabel(!1)),n.setState({focus:!1,editing:!1})}),$n(Jn(n),"onChange",function(e){var t=(n.props.value||[]).slice(),a=void 0,r=n.props.separators||[];for(var o in r){var i=e.target.value.split(r[o]);i.length>1&&(a=i[0])}n.state.editing?(t.pop(),a?(t.push(a),n.setState({editing:!1})):t.push(e.target.value)):n.state.editing||""==e.target.value||(n.setState({editing:!0}),t.push(e.target.value)),0==t.length||1==t.length&&""==t[0]?n.props.onChange(null):n.props.onChange(t)}),$n(Jn(n),"onKeyUp",function(e){var t=(n.props.value||[]).slice();8!=e.keyCode?n.state.editing&&13==e.keyCode&&n.setState({editing:!1}):0!=t.length&&(""==t[t.length-1]||n.state.editing?""==t[t.length-1]&&(t.pop(),n.props.onChange(t),n.setState({editing:!1})):n.setState({editing:!0}))}),$n(Jn(n),"removeToken",function(e){var t=n.props.value.slice();t.splice(e,1),n.props.onChange(t)}),$n(Jn(n),"renderToken",function(e,t){return o.a.createElement("div",{key:t},e,o.a.createElement("span",{className:"remove",onClick:n.removeToken.bind(Jn(n),t)},"×"))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yn(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.expandLabel&&this.props.expandLabel(this.hasValue()),this.props.listenToLabelClick&&this.props.listenToLabelClick(this.onLabelClick)}},{key:"componentWillReceiveProps",value:function(e){if(this.props.expandLabel){var t=this.hasValue(),n=e.value&&0!=e.value.length;!t&&n?this.props.expandLabel(!0):t&&!n&&this.props.expandLabel(!1)}}},{key:"render",value:function(){var e="tokenline";this.state.focus&&(e+=" focus"),this.props.changed&&(e+=" changed"),this.props.disabled&&(e+=" disabled");var t=(this.props.value||[]).slice(),n="";return this.state.editing&&0!=t.length&&(n=t.pop()),o.a.createElement("div",{className:e},o.a.createElement("div",{className:"tokens"},(t||[]).map(this.renderToken)),o.a.createElement("input",{type:"text",ref:"input",value:n,disabled:this.props.disabled,onChange:this.onChange,readOnly:this.props.readOnly,onFocus:this.onFocus,onBlur:this.onBlur,onKeyUp:this.onKeyUp}))}}])&&Qn(n.prototype,a),r&&Qn(n,r),t}();$n(Xn,"propTypes",{value:Y.a.array,changed:Y.a.bool,disabled:Y.a.bool,readOnly:Y.a.bool,separators:Y.a.array,onChange:Y.a.func,expandLabel:Y.a.func,listenToLabelClick:Y.a.func});var Zn=Xn,ea=tn()({displayName:"Labeled",expandLabel:function(e){this.setState({expanded:e})},listenToLabelClick:function(e){this.setState({clickCallback:e})},onLabelClick:function(){this.state.clickCallback&&this.state.clickCallback()},getInitialState:function(){return{expanded:!1,clickCallback:void 0}},render:function(){var e="row-height labeled",t=this.props.label;this.props.expanded||this.state.expanded?e+=" expanded":this.props.details&&(t+=": "),this.props.className&&(e+=" "+this.props.className);var n=this.props.details;this.props.errorMessage?(n=this.props.errorMessage,e+=" error"):this.props.warningMessage&&(n=this.props.warningMessage,e+=" warning");var a=void 0;this.props.label&&(a=o.a.createElement("span",{className:"main"},t));var r=o.a.Children.map(this.props.children,function(e){if(!e)return e;switch(e.type){case mn:case hn:case kn:case qn:case zn:case Zn:return o.a.cloneElement(e,{expandLabel:this.expandLabel,listenToLabelClick:this.listenToLabelClick});default:return e}}.bind(this));return o.a.createElement("div",{className:e},o.a.createElement("div",{className:"text-label disable-select",onClick:this.onLabelClick},a,o.a.createElement("span",null,n)),r)}}),ta=n(1422),na=n(1475);function aa(e){return(aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ra(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function oa(e){return(oa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ia(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sa(e,t){return(sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function la(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ca=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=oa(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==aa(r)&&"function"!=typeof r?ia(a):r,la(ia(n),"state",{hover:!1}),la(ia(n),"onMouseEnter",function(e){n.setState({hover:!0}),n.props.onMouseEnter&&n.props.onMouseEnter(e)}),la(ia(n),"onMouseLeave",function(e){n.setState({hover:!1}),n.props.onMouseLeave&&n.props.onMouseLeave(e)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sa(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props.isRadio,t="".concat(this.props.className||""," action-button");this.props.checked&&(t="".concat(t," active"));var n=this.props.label||"";return this.state.hover&&this.props.labelOnHover&&(n=this.props.labelOnHover),e?o.a.createElement(ta.a,{"data-testid":this.props["data-testid"],checked:this.props.checked,control:o.a.createElement(na.a,{color:"primary"}),label:n,disabled:this.props.disabled,onClick:this.props.onClick}):o.a.createElement("button",{className:t,onClick:this.props.onClick,disabled:this.props.disabled,"data-testid":this.props["data-testid"],onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,type:"button"},n)}}])&&ra(n.prototype,a),r&&ra(n,r),t}();la(ca,"propTypes",{label:Y.a.string.isRequired,labelOnHover:Y.a.string,checked:Y.a.bool,disabled:Y.a.bool,onClick:Y.a.func,className:Y.a.string,isRadio:Y.a.bool,onMouseEnter:Y.a.func,onMouseLeave:Y.a.func}),la(ca,"defaultProps",{labelOnHover:"",className:"",checked:!1,disabled:!1,isRadio:!1,onClick:function(){},onMouseEnter:function(){},onMouseLeave:function(){}});var ua=ca,pa={shouldComponentUpdate:function(){return this._skipVisibilityCheck?(this._skipVisibilityCheck=!1,!0):this.isDOMNodeVisible()},skipVisibilityCheckOnce:function(){this._skipVisibilityCheck=!0},isDOMNodeVisible:function(){var e=c.a.findDOMNode(this).getBoundingClientRect(),t=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return e.bottom>=0&&e.right>=0&&e.top<=t&&e.left<=n}},da=tn()({mixins:[pa],propTypes:{location:Y.a.object.isRequired,config:Y.a.object.isRequired,selectedName:Y.a.string},componentWillReceiveProps:function(e){(e.selectedName&&!this.props.selectedName||this.props.selectedName&&!e.selectedName)&&this.skipVisibilityCheckOnce()},onRemoveClick:function(){var e="Really delete "+this.props.location.prefix+" from config?";if(this.props.location.dvr&&(e+=" DVR archive would remain."),window.confirm(e)){var t={lives:{}};t.lives[this.props.location.prefix]=null,ft.save(t)}},renderNameDescDVR:function(){return o.a.createElement("div",{className:"name-desc-dvr group-head"},o.a.createElement("div",{className:"name"},this.props.location.prefix),o.a.createElement("div",{className:"desc padding-left-10"},this.props.location.title||this.props.location.meta.comment))},render:function(){var e="base-container row-height media-item";return this.props.selectedName&&(e+=" collapsed",this.props.selectedName==this.props.location.prefix&&(e+=" selected")),o.a.createElement("div",{className:e},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement(Et,{to:"location-item",params:{mediaName:encodeURIComponent(this.props.location.prefix)},query:this.props.query,style:{width:"100%"}},this.renderNameDescDVR())),o.a.createElement("div",{className:"right-container"},o.a.createElement(ua,{label:"✕",onClick:this.onRemoveClick,className:"danger margin-left-20"})))}}),ma=Y.a.shape({chassis:Y.a.shape({coders:Y.a.arrayOf(Y.a.shape({coder:Y.a.number,status:Y.a.string,uptime:Y.a.number,streams:Y.a.arrayOf(Y.a.shape({name:Y.a.string})),stage:Y.a.oneOf(["offline","booting"])}))}),version:Y.a.oneOfType([Y.a.string,Y.a.number]),input_kbit:Y.a.number,output_kbit:Y.a.number,total_streams:Y.a.number,online_streams:Y.a.number,opened_files:Y.a.number,total_clients:Y.a.number,build:Y.a.number,uptime:Y.a.number,retroview_enabled:Y.a.bool,retroview_configured:Y.a.bool}),fa=n(25),ha=n.n(fa),ga=Y.a.shape({channels:Y.a.number,codec:Y.a.string,content:Y.a.string,lang:Y.a.string,sample_rate:Y.a.number,track_id:Y.a.string}),va=Y.a.shape({bitrate:Y.a.number,codec:Y.a.string,content:Y.a.string,fps:Y.a.number,height:Y.a.number,lang:Y.a.string,length_size:Y.a.number,level:Y.a.string,pixel_height:Y.a.number,pixel_width:Y.a.number,profile:Y.a.string,sar_height:Y.a.number,sar_width:Y.a.number,size:Y.a.string,track_id:Y.a.string,width:Y.a.number}),ba=Y.a.oneOfType([va,ga]),ya=Y.a.arrayOf(ba),Ea=Y.a.shape({height:Y.a.number,width:Y.a.number,tracks:ya}),wa=Y.a.shape({duration:Y.a.number,from:Y.a.number}),Sa=Y.a.arrayOf(wa),Ca=Y.a.shape({depth:Y.a.number,disk_size:Y.a.number,duration:Y.a.number,from:Y.a.number,ranges:Sa}),Oa=Y.a.shape({alive:Y.a.oneOfType([Y.a.number,Y.a.bool]),bitrate:Y.a.number,bufferings:Y.a.number,bytes_in:Y.a.number,bytes_out:Y.a.number,client_count:Y.a.number,dvr_enabled:Y.a.bool,dvr_info:Ca,input_error_rate:Y.a.number,input_media_info:Ea,last_access_at:Y.a.number,last_dts:Y.a.number,last_dts_at:Y.a.number,lifetime:Y.a.number,media_info:Ea,out_bandwidth:Y.a.number,position:Y.a.number,publish_enabled:Y.a.bool,remote:Y.a.bool,retry_count:Y.a.number,running:Y.a.bool,running_transcoder:Y.a.bool,source_error:Y.a.string,start_running_at:Y.a.number,ts_delay:Y.a.number,url:Y.a.string}),xa=Y.a.shape({allow_subtitles:Y.a.string,dvbsubs_ocr:Y.a.string,pids:Y.a.string,url:Y.a.string}),Na=Y.a.arrayOf(Y.a.oneOfType([xa,Y.a.string])),ka=Y.a.shape({keyserver:Y.a.string,user_keyserver:Y.a.string,vendor:Y.a.string}),_a=Y.a.shape({reference:Y.a.string,disk_limit:Y.a.number,disk_space:Y.a.number,dvr_limit:Y.a.number,root:Y.a.string}),Pa=Y.a.object,ja=Y.a.shape({height:Y.a.string,left:Y.a.string,path:Y.a.string,top:Y.a.string,width:Y.a.string}),Ra=Y.a.shape({url:Y.a.string,extra:Y.a.object}),Ta=Y.a.shape({disk_limit:Y.a.number,time_limit:Y.a.number,path:Y.a.string}),Ia=Y.a.shape({auth:Ra,cache:Ta,disabled:Y.a.bool,drm:ka,dvr:_a,external_dvr:Y.a.string,logo:ja,name:Y.a.string,position:Y.a.number,publish_enabled:Y.a.bool,static:Y.a.bool,stats:Oa,thumbnails:Y.a.shape({enabled:Y.a.bool,url:Y.a.string}),pushes:ha()({url:Y.a.string}),transcoder:Pa,urls:Na,protocols:ha()(Y.a.bool)}),Da=ha()(Ia),Aa=Y.a.oneOfType([Y.a.number,Y.a.string]),qa=Y.a.oneOfType([Y.a.number,Y.a.string,Y.a.oneOf([null,void 0])]),Ma=Y.a.shape({name:Y.a.string,name_changed:Y.a.bool,port:Y.a.number,port_changed:Y.a.bool,position:Y.a.number,isNewPeer:Y.a.bool}),Fa=ha()(Y.a.oneOfType([Ma,Y.a.bool])),Va=Y.a.shape({allow_countries:Y.a.arrayOf(Y.a.string),deny_countries:Y.a.arrayOf(Y.a.string),allow_ips:Y.a.arrayOf(Y.a.string),deny_ips:Y.a.arrayOf(Y.a.string),allow_tokens:Y.a.arrayOf(Y.a.string),deny_tokens:Y.a.arrayOf(Y.a.string),allow_uas:Y.a.arrayOf(Y.a.string),deny_uas:Y.a.arrayOf(Y.a.string),allow_default:Y.a.bool,backends:Y.a.arrayOf(Y.a.shape({url:Y.a.string})),name:Y.a.string,position:Y.a.number}),Ba=ha()(Va),La=Y.a.shape({active:Y.a.number,copy:Y.a.string,disk_limit:Y.a.number,disk_space:Y.a.number,dvr_limit:Y.a.number,disks:ha()(Y.a.shape({position:Y.a.number,mode:Y.a.oneOf([null,"keep","readonly","abandon","migrate","rescue"])})),dvr_replicate:Y.a.bool,replication_port:Y.a.number,index:Y.a.string,name:Y.a.string.isRequired,position:Y.a.number.isRequired,no_index:Y.a.bool,raid:Y.a.oneOf([null,0]),root:Y.a.string,schedule:Y.a.arrayOf(Y.a.arrayOf(Y.a.number))}),Wa=ha()(La),Ha=Y.a.shape({auth:Ra,auto_mbr:Y.a.bool,download:Y.a.bool,files:ha()(Y.a.shape({bytes_in:Y.a.number,bytes_out:Y.a.number,client_count:Y.a.number,name:Y.a.string,position:Y.a.number,prefix:Y.a.string,url:Y.a.string,worker_count:Y.a.number})),position:Y.a.number,prefix:Y.a.string,urls:Y.a.arrayOf(Y.a.shape({url:Y.a.string}))}),Ua=ha()(Ha),za=Y.a.shape({auth:Ra,cache:Y.a.object,drm:ka,dvr:_a,except:Y.a.arrayOf(Y.a.any),meta:Y.a.object,position:Y.a.number,prefix:Y.a.string,streams:Da,urls:Y.a.arrayOf(Y.a.shape({url:Y.a.string}))}),Ga=ha()(za),Qa=J.shape({admin_http:J.string,admin_https:J.string,api:J.arrayOf(J.any),auth_backends:Ba,cluster_key:J.string,dvrs:Wa,edit_auth:J.shape({login:J.string,password:J.string}),http:J.arrayOf(Aa),https:J.arrayOf(Aa),loglevel:J.oneOf([null,"debug","notice","error"]),meta:J.string,mysql:J.oneOfType([J.number,J.string]),now_ms:J.number,nvidia_monitor:J.bool,peers:Fa,pulsedb:J.string,rtmp:Aa,rtmps:Aa,rtsp:Aa,rtsps:Aa,session_log:J.string,snmp:J.string,sources:Ga,stats:ma,streams:Da,total_bandwidth:J.string,vods:Ua}),Ka=Y.a.shape({id:Y.a.number,name:Y.a.string,type:Y.a.oneOf(["qsv","nvenc","coder"]),memFree:Y.a.number,memTotal:Y.a.number,memUsed:Y.a.number,stats:Y.a.shape({gpu_dec:Y.a.number,gpu_enc:Y.a.number,gpu_sm:Y.a.number,gpu_temp:Y.a.number})}),Ja=Y.a.shape({transcoder_devices:Y.a.arrayOf(Ka)}),Ya=function(e){var t=e.media,n=e.stats;return t.static||n.alive?Zt.hasOnlyPublish(t)&&!n.alive?o.a.createElement("div",{className:"short-status"},o.a.createElement("div",{className:"warning-border warning-text"},"off")):Zt.hasNoSources(t)?o.a.createElement("div",{className:"short-status"},o.a.createElement("div",{className:"warning-border warning-text"},"off")):t.disabled?o.a.createElement("div",{className:"short-status"},o.a.createElement("div",{className:"warning-border warning-text"},"dis")):t.source_error||Zt.isUnavailable(n)?o.a.createElement("div",{className:"short-status"},o.a.createElement("div",{className:"error-border error-text"},"err")):n.ts_delay>5e3&&n.ts_delay<6e4?o.a.createElement("div",{className:"short-status"},o.a.createElement("div",{className:"success-border success-text"},"on")):o.a.createElement("div",{className:"short-status"},o.a.createElement("div",{className:"success-text success-border"},"on")):o.a.createElement("div",{className:"short-status"},o.a.createElement("div",{className:"warning-border warning-text"},"off"))};Ya.displayName="MediaStatsColumnShort",Ya.propTypes={media:Ia.isRequired,stats:Y.a.object.isRequired};var $a=Ya,Xa=n(488),Za=n(176),er=n.n(Za),tr={},nr=Object(Xa.createStore)(function(e,t){return tr[t.type]?tr[t.type](e,t):(t.type&&"@@"!==t.type.slice(0,2)&&console.log("Reducer: unknown action",t),e)},er.a.fromJS({modal:void 0,iptvError:!1,iptvUsers:[],iptvLoadedAll:!1,textConfig:"",isTextConfigError:!1,isTextConfigSaving:!1}));tr.init=function(e){return e},tr["modal:clear"]=function(e){return e.set("modal",void 0)},tr["modal:playMedia"]=function(e,t){return e.set("modal",er.a.fromJS({type:"playMedia",path:t.path}))},tr["iptv:clearUsers"]=function(e){return e.merge({iptvUsers:er.a.List(),iptvLoadedAll:!1})},tr["iptv:refreshUsers"]=function(e,t){var n="/tv/api/users?count=".concat(30,"&from=").concat(30*t.page);return t.filter&&(n="".concat(n,"&q=").concat(encodeURIComponent(t.filter))),x(n,{method:"get"}).then(function(e){nr.dispatch({type:"iptv:users",users:e})}).catch(function(e){nr.dispatch({type:"iptv:fetchError",error:e})}),0===t.page?tr["iptv:clearUsers"](e,void 0):e},tr["iptv:users"]=function(e,t){var n=e.get("iptvUsers");return 0===t.users.users.length?e.set("iptvLoadedAll",!0):e.set("iptvUsers",n.concat(er.a.fromJS(t.users.users))).set("iptvError",!1)},tr["iptv:fetchError"]=function(e){return e.set("iptvError",!0)},tr["iptv:updateUser"]=function(e,t){return x("/tv/api/user_update",{method:"post",body:JSON.stringify(t.user.toJS())}).then(function(e){nr.dispatch({type:"iptv:userUpdated",user:er.a.fromJS(e)})}),e},tr["iptv:userUpdated"]=function(e,t){var n=e.get("iptvUsers").findIndex(function(e){return t.user.get("id")===e.get("id")});return e.setIn(["iptvUsers",n],t.user)},tr["iptv:removeUser"]=function(e,t){return x("/tv/api/user_delete",{method:"post",body:JSON.stringify(t.user)}).then(function(){nr.dispatch({type:"iptv:userRemoved",user:t.user})}),e},tr["iptv:userRemoved"]=function(e,t){var n=e.get("iptvUsers").findIndex(function(e){return t.user.get("id")===e.get("id")});return e.deleteIn(["iptvUsers",n])},tr["iptv:createUser"]=function(e,t){return x("/tv/api/user_create",{method:"post",body:JSON.stringify(t.user.toJS())}).then(function(e){nr.dispatch({type:"iptv:userCreated",user:er.a.fromJS(e)})}),e},tr["iptv:userCreated"]=function(e,t){return e.update("iptvUsers",function(e){return e.unshift(t.user)})},tr.configRead=function(e){return x("/flussonic/api/read_raw_config",{method:"get"},!0).then(function(e){return e.text()}).then(function(e){nr.dispatch({type:"configReadSuccess",textConfig:e})}),e},tr.configReadSuccess=function(e,t){return e.set("textConfig",t.textConfig)},tr.configWrite=function(e,t){return x("/flussonic/api/parse_raw_config",{method:"post",body:t.textConfig}).then(function(){nr.dispatch({type:"configParseSuccess"}),x("/flussonic/api/save_raw_config",{method:"post",body:t.textConfig}).then(function(){nr.dispatch({type:"configWriteSuccess"})}).catch(function(){nr.dispatch({type:"configWriteError"})})}).catch(function(){nr.dispatch({type:"configParseError"})}),e.set("isTextConfigSaving",!0)},tr.configWriteSuccess=function(e){return e.set("isTextConfigSaving",!1)},tr.configWriteError=function(e){return e.set("isTextConfigSaving",!1)},tr.configParseSuccess=function(e){return e.set("isTextConfigError",!1)},tr.configParseError=function(e){return e.set("isTextConfigError",!0).set("isTextConfigSaving",!1)};var ar=nr,rr=function(e){var t=e.warning,n=e.children,a=e.style,r=e.warningClassNames,i=e.warningStyle,s=e.warningWrapperChildren,l=e.warningWrapperClassNames,c=e.warningWrapperStyle;return o.a.createElement("div",{className:"list-underline padding-left-10 center-list-column",style:a},o.a.createElement("div",{className:an()("padding-left-10",l),style:c},o.a.createElement("div",{className:r||"warning-border warning-text",style:i},t),s),n)};rr.propTypes={warning:Y.a.node.isRequired,children:Y.a.node,style:Y.a.any,warningClassNames:Y.a.string,warningStyle:Y.a.any,warningWrapperChildren:Y.a.node,warningWrapperClassNames:Y.a.string,warningWrapperStyle:Y.a.any},rr.defaultProps={children:null,style:{},warningClassNames:"",warningStyle:{},warningWrapperChildren:null,warningWrapperClassNames:"",warningWrapperStyle:{}};var or=rr,ir=function(e){var t=e.status,n=e.onClick;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"online-status"},t),o.a.createElement(ua,{label:"▶ play",onClick:n}))};ir.propTypes={status:Y.a.string.isRequired,onClick:Y.a.func.isRequired};var sr=ir,lr=function(e,t){var n=e+"";return"00000000000000000000".slice(0,t-n.length)+n},cr=function(e){return e<=9?"0"+e:""+e},ur=function e(t){if(t>0){var n=Math.round(t%1e3),a=e(Math.round(t/1e3));return""==a?n+" ":a+lr(n,3)+" "}return""},pr={pad:lr,pad2:cr,add_spaces_to_int:ur,seconds:function(e){if(!(e>0))return 0;var t=e=Math.round(e),n=lr(t%60,2);return(t=Math.floor(t/60))>0?(n=lr(t%60,2)+":"+n,t=Math.floor(t/60)):n+=" s",t>0&&(n=lr(t%24,2)+":"+n,t=Math.floor(t/24)),t>0&&(n=t+"d "+n),n},bytes:function(e){if(!e)return"";var t=Math.round(e/1024);if(t<1200)return ur(t)+"KB";if(t<5e3)return ur(t).replace(" ",".")+"MB";var n=Math.round(t/1024);if(n<1200)return ur(n)+"MB";if(n<5e3)return ur(n).replace(" ",".")+"GB";var a=Math.round(n/1024);if(a<1200)return ur(a)+"GB";if(a<5e3)return ur(a).replace(" ",".")+"TB";var r=Math.round(a/1024);return ur(r)+"TB"},local_date_at:function(e){var t=new Date;return t.setTime(Math.round(e<4e9?1e3*e:e)),lr(t.getYear()+1900,4)+"-"+lr(t.getMonth()+1,2)+"-"+lr(t.getDate(),2)},local_time_at:function(e){var t=new Date;return t.setTime(Math.round(e<4e9?1e3*e:e)),lr(t.getYear()+1900,4)+"-"+lr(t.getMonth()+1,2)+"-"+lr(t.getDate(),2)+" "+lr(t.getHours(),2)+":"+lr(t.getMinutes(),2)+":"+lr(t.getSeconds(),2)},lifetimeFormat:function(e){if(!e)return"";var t=Math.floor(e/1e3),n=Math.floor(t/5184e3),a=Math.floor(t%5184e3/3600),r=Math.floor(t%3600/60),o=Math.floor(t%60),i="";return 1===n?i+="1 day ":n&&(i+=n+" days "),a&&(i+=cr(a)+":"),i+=cr(r)+":"+cr(o)},shortestTimeFormat:function(e){if(e<=999)return e+"ms";var t=Math.floor(e/1e3);if(t<=59)return t+"s";var n=Math.floor(t/60);if(n<=59)return n+"m";var a=Math.floor(n/60);return a<=23?a+"h":Math.floor(a/24)+"d"}},dr=function(e){var t=e.bitrateText,n=e.transcoderIcon,a=e.lifetime;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"kbps-column"},o.a.createElement("div",{className:"padding-left-10 padding-right-10 transcoder-column"},t," ",n)),o.a.createElement("div",{className:"runtime-column"},o.a.createElement("div",{className:"padding-left-10"},o.a.createElement("div",{style:{textAlign:"right"}},pr.lifetimeFormat(a)))))};dr.propTypes={bitrateText:Y.a.string.isRequired,transcoderIcon:Y.a.node,lifetime:Y.a.number.isRequired},dr.defaultProps={transcoderIcon:null};var mr=dr,fr=function(e){var t=e.clientsCount;return o.a.createElement("div",{className:"client-num clients-column__clients-number"},t)};fr.propTypes={clientsCount:Y.a.number.isRequired};var hr=fr,gr=function(e){var t=e.error;return o.a.createElement("div",{className:"kbps-runtime-column"},o.a.createElement("div",{className:"error-border error-text"},o.a.createElement("div",{className:"padding-left-10",style:{maxWidth:"120px"}},t)))};gr.propTypes={error:Y.a.string.isRequired};var vr=gr,br=function(e){var t=e.lifetime;return o.a.createElement("div",{className:"runtime-column"},o.a.createElement("div",{className:"warning-border",style:{textAlign:"right"}},pr.lifetimeFormat(t)))};br.propTypes={lifetime:Y.a.number.isRequired};var yr=br;function Er(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var wr=function(e,t,n){return an()(["".concat(e,"-text")].concat(Er(n?[]:["".concat(e,"-border")]),["online-play-button","clients-column__online-status".concat(t?"-".concat(t):"")]))},Sr=(n(991),function(e){return function(){ar.dispatch({type:"modal:playMedia",path:e})}}),Cr=an()("clients-column padding-left-10 padding-right-10"),Or={whiteSpace:"nowrap"},xr=function(e){var t=e.media,n=e.stats,a=e.showInputBitrate,r=e.path,i=e.delayRange;if(t.disabled)return o.a.createElement(or,{warning:"disabled"});if(n.source_error&&"thumbnails_are_not_fetched"!==n.source_error||Zt.isUnavailable(n)){var s=function(e){var t=e.source_error||"error",n=e.ts_delay&&e.ts_delay>8e3?"".concat(t,", ").concat(pr.shortestTimeFormat(e.ts_delay)," delay"):t,a=!Zt.isUnavailable(e)&&e.source_error.length<20?"".concat(t,", "):"",r=e.retry_count>0,o="".concat(e.retry_count," retries");return{mainText:n,detailText:r&&"".concat(a).concat(o)}}(n),l=s.mainText,c=s.detailText;return o.a.createElement(or,{warning:o.a.createElement(sr,{status:l,onClick:Sr(r)}),style:Or,warningClassNames:wr("error","wide"),warningWrapperClassNames:Cr},c&&o.a.createElement(vr,{error:c}))}if(Zt.hasOnlyPublish(t)&&!n.alive)return o.a.createElement(or,{warning:"expecting publication"},n.lifetime&&o.a.createElement(yr,{lifetime:n.lifetime}));if(!t.static&&!n.alive)return o.a.createElement(or,{warning:o.a.createElement(sr,{status:"waiting for ".concat(t.static?"stream":"clients"),onClick:Sr(r)}),warningClassNames:wr("warning","xwide")});if(Zt.hasNoSources(t))return o.a.createElement(or,{warning:"no sources defined"});var u=n.running_transcoder?o.a.createElement("div",{className:"transcoder-icon"}):null,p=function(e){var t=e.showInputBitrate,n=e.runningTranscoder,a=e.tracks,r=void 0===a?[]:a,o=e.stats,i=r.every(function(e){return e.bitrate}),s=t&&n&&i?" (".concat(r.reduce(function(e,t){return e+t.bitrate},0),"k)"):"";return o.bitrate?"".concat(o.bitrate,"k").concat(s):"n/a"}({showInputBitrate:a,runningTranscoder:n.running_transcoder,tracks:n&&n.input_media_info&&n.input_media_info.tracks,stats:n});if(function(e,t){var n=e.ts_delay;return n>(/^(hls|m4f)/i.test(e.url)?t.hlsLower:t.lower)&&n<t.upper}(n,i)){var d=Math.floor(n.ts_delay/1e3);return o.a.createElement(or,{warning:o.a.createElement(sr,{status:"delay ".concat(d,"s"),onClick:Sr(r)}),warningClassNames:wr("warning","xwide"),warningWrapperClassNames:Cr},o.a.createElement(mr,{bitrateText:p,transcoderIcon:u,lifetime:n.lifetime}))}return n.input_error_rate?o.a.createElement(or,{warning:o.a.createElement(sr,{status:"".concat(n.input_error_rate," drops/s"),onClick:Sr(r)}),warningWrapperChildren:o.a.createElement(hr,{clientsCount:n.client_count}),style:Or,warningStyle:Or,warningClassNames:wr("warning","xwide"),warningWrapperClassNames:Cr},o.a.createElement(mr,{bitrateText:p,transcoderIcon:u,lifetime:n.lifetime})):o.a.createElement(or,{warning:o.a.createElement(sr,{status:"online",onClick:Sr(r)}),warningWrapperChildren:o.a.createElement(hr,{clientsCount:n.client_count}),warningClassNames:wr("success","",!0),warningWrapperClassNames:Cr},o.a.createElement(mr,{bitrateText:p,transcoderIcon:u,lifetime:n.lifetime}))};xr.propTypes={media:Ia.isRequired,stats:Oa.isRequired,delayRange:Y.a.shape({lower:Y.a.number,hlsLower:Y.a.number,upper:Y.a.number}),path:Y.a.arrayOf(Aa),showInputBitrate:Y.a.bool},xr.defaultProps={path:[""],delayRange:{lower:5e3,hlsLower:1e4,upper:6e4},showInputBitrate:!1};var Nr=xr;function kr(e){return(kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Pr(e){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rr(e,t){return(Rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ir=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Pr(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==kr(r)&&"function"!=typeof r?jr(a):r,Tr(jr(n),"restartOrStop",function(){N.restart(n.props.name)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rr(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e,t=this.props,n=t.media,a=t.className;if(this.props.stats.running){var r=n.static?"restart":"stop";e=o.a.createElement(ua,{label:r,onClick:this.restartOrStop})}return o.a.createElement("div",{className:an()("row-height flex-end",a)},e)}}])&&_r(n.prototype,a),r&&_r(n,r),t}();Tr(Ir,"propTypes",{name:Y.a.string.isRequired,media:Y.a.object.isRequired,stats:Y.a.object.isRequired,className:Y.a.string}),Tr(Ir,"defaultProps",{className:""});var Dr=Ir,Ar=function(e,t,n){var a=t-e,r=0;for(var o in n)if(n[o]){if(t<n[o].from)continue;var i=Math.max(e,n[o].from),s=Math.min(t,n[o].from+n[o].duration);s>i&&(r+=s-i)}return r/a},qr=tn()({displayName:"MediaDVRLine",propTypes:{info:Y.a.object.isRequired,secondsPerCell:Y.a.number.isRequired,pxPerCell:Y.a.number.isRequired,maxWidth:Y.a.number.isRequired},getDefaultProps:function(){return{secondsPerCell:180,pxPerCell:6,maxWidth:500}},cells:function(){for(var e=Math.floor(this.props.maxWidth/this.props.pxPerCell),t=[],n=Math.round((new Date).getTime()/1e3);!(t.length>=e);){var a=n-t.length*this.props.secondsPerCell,r=a-this.props.secondsPerCell,o=Ar(r,a,this.props.info.ranges);if(0==o)t.push("empty");else if(o<=.5)t.push("some");else if(o<1)t.push("some");else{if(1!=o)throw"Unknown cell filled value: "+o;t.push("full")}}return t},render:function(){var e=this.cells(),t=[];for(var n in e)if("empty"!=e[n]){var a=void 0;switch(e[n]){case"some":a="#A7D7C0";break;case"full":a="#209A60"}var r=this.props.maxWidth-n*this.props.pxPerCell;t.push(o.a.createElement("rect",{key:n,x:r-this.props.pxPerCell,width:this.props.pxPerCell+1,height:3,style:{fill:a}}))}return o.a.createElement("div",{className:"dvr-recorded-line"},o.a.createElement("div",null,o.a.createElement("svg",{height:3,width:this.props.maxWidth},t)))}}),Mr=tn()({displayName:"PublishedListItem",mixins:[pa],propTypes:{name:Y.a.string.isRequired,location:Y.a.object.isRequired,stats:Y.a.object.isRequired,selectedName:Y.a.string},componentWillReceiveProps:function(e){(e.selectedName&&!this.props.selectedName||this.props.selectedName&&!e.selectedName)&&this.skipVisibilityCheckOnce()},renderNameDescDVR:function(){var e=this.props.name.replace(this.props.location.prefix,""),t=void 0;return this.props.stats.dvr_info&&(t=o.a.createElement(qr,{info:this.props.stats.dvr_info})),o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("div",{className:"name-desc-dvr-wrapper"},o.a.createElement("div",{className:"name-desc-dvr group-item"},o.a.createElement("div",{className:"name"},e),o.a.createElement("div",{className:"desc padding-left-10"})),o.a.createElement($a,{name:this.props.name,media:this.props.location,stats:this.props.stats})),t)},renderSource:function(){return this.props.stats.published_from?o.a.createElement("div",{className:"source list-underline padding-left-20"},this.props.stats.published_from," via ",this.props.stats.published_via):o.a.createElement("div",{className:"source list-underline padding-left-20"}," ")},render:function(){var e="base-container row-height media-item";return this.props.selectedName&&(e+=" collapsed",this.props.selectedName==this.props.name&&(e+=" selected")),o.a.createElement("div",{className:e},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container group-item"},o.a.createElement(Et,{to:"published-item",params:{mediaName:encodeURIComponent(this.props.name)},className:"left-list-column"},this.renderNameDescDVR()),o.a.createElement(Nr,{name:this.props.name,media:this.props.location,stats:this.props.stats,path:["lives",this.props.location.prefix,this.props.name]}),o.a.createElement("div",{className:"right-list-column"},this.renderSource())),o.a.createElement("div",{className:"right-container"},o.a.createElement(Dr,{name:this.props.name,media:this.props.location,stats:this.props.stats,className:"margin-left-20"})))}});function Fr(e){return(Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Br(e){return(Br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wr(e,t){return(Wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ur=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Br(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Fr(r)&&"function"!=typeof r?Lr(a):r,Hr(Lr(n),"state",{showNewItem:!1,newItemName:"",sorting:void 0}),Hr(Lr(n),"toggleNewItem",function(){n.setState(function(e){return{showNewItem:!e.showNewItem}})}),Hr(Lr(n),"changeNewItemName",function(e){n.setState({newItemName:e.target.value.replace(/\s/g,"")})}),Hr(Lr(n),"createNewItem",function(){if(n.state.newItemName){var e={lives:{}};e.lives[n.state.newItemName]={prefix:n.state.newItemName},ft.save(e).then(function(){n.setState({showNewItem:!1,newItemName:""})})}}),Hr(Lr(n),"matchLocationQuery",function(e){if(""===n.props.query)return!0;var t=[];t.push(e.prefix),t.push((e.title||"").trim().toLowerCase()),t.push((e.comment||"").trim().toLowerCase());for(var a=0;a<t.length;a+=1)if(-1!==t[a].indexOf(n.props.query))return!0;return!1}),Hr(Lr(n),"matchLocationFilters",function(e){for(var t=0;t<n.props.filters.length;t+=1){var a=!0;switch(n.props.filters[t]){case"dvr":a=!!e.dvr;break;default:a=!1}if(!a)return!1}return!0}),Hr(Lr(n),"matchLocation",function(e){return n.matchLocationQuery(e)&&n.matchLocationFilters(e)}),Hr(Lr(n),"matchPublishedQuery",function(e,t){if(""===n.props.query)return!0;var a=[];a.push(e),t.published_via&&(a.push(t.published_via),a.push(t.published_from));for(var r=0;r<a.length;r+=1)if(-1!==a[r].indexOf(n.props.query))return!0;return!1}),Hr(Lr(n),"matchPublishedFilters",function(e,t){for(var a=0;a<n.props.filters.length;a+=1){var r=!0;switch(n.props.filters[a]){case"dvr":r=!!t.dvr_info;break;case"transcoder":return!!t.running_transcoder;case"error":r=!!t.source_error||!!Zt.isUnavailable(t);break;case"online":break;case"waiting":default:r=!1}if(!r)return!1}return!0}),Hr(Lr(n),"matchPublished",function(e,t){return n.matchPublishedQuery(e,t)&&n.matchPublishedFilters(e,t)}),Hr(Lr(n),"filteredGroups",function(){for(var e=Object.keys(n.props.config.lives).sort(),t=[],a=function(a){var r=n.props.config.lives[e[a]],o=[];if(Object.keys(r.streams).forEach(function(e){var t=r.streams[e];t&&n.matchPublished(e,t)&&o.push(t)}),0===o.length)n.matchLocation(r)&&t.push({location:r,published:o});else{switch(n.state.sorting){case"name-asc":o.sort(Zt.nameSortFunc.bind(Lr(n),"asc"));break;case"name-desc":o.sort(Zt.nameSortFunc.bind(Lr(n),"desc"));break;case"clients-asc":o.sort(Zt.clientsSortFunc.bind(Lr(n),"asc"));break;case"clients-desc":o.sort(Zt.clientsSortFunc.bind(Lr(n),"desc"));break;case"bitrate-asc":o.sort(Zt.bitrateSortFunc.bind(Lr(n),"asc"));break;case"bitrate-desc":o.sort(Zt.bitrateSortFunc.bind(Lr(n),"desc"));break;case"runtime-asc":o.sort(Zt.runtimeSortFunc.bind(Lr(n),"asc"));break;case"runtime-desc":o.sort(Zt.runtimeSortFunc.bind(Lr(n),"desc"))}t.push({location:r,published:o})}},r=0;r<e.length;r+=1)a(r);return t}),Hr(Lr(n),"clearSorting",function(){n.setState({sorting:void 0})}),Hr(Lr(n),"selectSorting",function(e){n.setState({sorting:e})}),Hr(Lr(n),"renderSortableColumn",function(e,t,a){var r="".concat(a||""," column-caption");return n.state.sorting==="".concat(e,"-desc")?o.a.createElement("h1",{className:"".concat(r," caption-sortable-up"),onClick:n.clearSorting},t,o.a.createElement("div",{className:"sort-icon"})):n.state.sorting==="".concat(e,"-asc")?o.a.createElement("h1",{className:"".concat(r," caption-sortable-down"),onClick:n.selectSorting.bind(Lr(n),"".concat(e,"-desc"))},t,o.a.createElement("div",{className:"sort-icon"})):o.a.createElement("h1",{className:"".concat(r," caption-sortable-none"),onClick:n.selectSorting.bind(Lr(n),"".concat(e,"-asc"))},t,o.a.createElement("div",{className:"sort-icon"}))}),Hr(Lr(n),"renderLabels",function(){var e,t,a,r="base-container row-height";n.props.selectedName&&(r="".concat(r," collapsed")),0!==Object.keys(n.props.config.lives).length&&(e=[o.a.createElement("div",{key:1,className:"clients-column"},n.renderSortableColumn("clients","clients","padding-left-20")),o.a.createElement("div",{key:2,className:"kbps-column"},n.renderSortableColumn("bitrate","bitrate","padding-left-20")),o.a.createElement("div",{key:3,className:"runtime-column"},n.renderSortableColumn("runtime","runtime"))],t=o.a.createElement("h1",{className:"column-caption padding-left-20"},"source"),a=o.a.createElement("div",{className:"name-column"},n.renderSortableColumn("name","name")));var i="Publishing locations";return n.props.selectedName&&(i="Locations"),o.a.createElement("div",{className:r},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column flex-end"},o.a.createElement("h1",{className:"head-text"},i),o.a.createElement(ua,{label:"add",checked:n.state.showNewItem,onClick:n.toggleNewItem,className:"margin-left-10"}),a),o.a.createElement("div",{className:"center-list-column"},e),o.a.createElement("div",{className:"right-list-column"},t)),o.a.createElement("div",{className:"right-container"}))}),Hr(Lr(n),"renderNewItemForm",function(){return n.props.selectedName||!n.state.showNewItem?null:(n.state.newItemName&&(n.props.config.lives[n.state.newItemName]||n.props.config.vods[n.state.newItemName])&&(e="this name is already used"),o.a.createElement("div",null,o.a.createElement("div",{className:"new-item-form base-container row-height"},o.a.createElement("div",{className:"left-container"},o.a.createElement(ua,{label:"discard",onClick:n.toggleNewItem})),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column"},o.a.createElement(ea,{label:"Location name",errorMessage:e,className:"padding-right-10"},o.a.createElement(mn,{value:n.state.newItemName,onChange:n.changeNewItemName,onSubmit:n.createNewItem,focusOnMount:!n.state.newItemName}))),o.a.createElement("div",{className:"center-list-column padding-left-10 padding-right-10"},o.a.createElement(ua,{label:"create",disabled:!n.state.newItemName||!!e,onClick:n.createNewItem})),o.a.createElement("div",{className:"right-list-column"})),o.a.createElement("div",{className:"right-container"})),o.a.createElement("div",{className:"row-height"})));var e}),Hr(Lr(n),"renderLocationItem",function(e){return o.a.createElement(da,{config:n.props.config,location:e,selectedName:n.props.selectedName,ref:n.props.pickupSelectedItem.bind(Lr(n),e.prefix)})}),Hr(Lr(n),"renderItem",function(e,t){return o.a.createElement(Mr,{key:t.name,name:t.name,location:e,stats:t,selectedName:n.props.selectedName,ref:n.props.pickupSelectedItem.bind(Lr(n),t.name)})}),Hr(Lr(n),"renderGroup",function(e){return o.a.createElement("div",{key:e.location.prefix},n.renderLocationItem(e.location),e.published.map(n.renderItem.bind(Lr(n),e.location)),o.a.createElement("div",{className:"row-height"}))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wr(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement("div",null,this.renderLabels(),this.renderNewItemForm(),this.filteredGroups().map(this.renderGroup))}}])&&Vr(n.prototype,a),r&&Vr(n,r),t}();Hr(Ur,"propTypes",{config:Qa.isRequired,selectedName:Y.a.string,filters:Y.a.arrayOf(Y.a.string),query:Y.a.string,pickupSelectedItem:Y.a.func}),Hr(Ur,"defaultProps",{selectedName:"",filters:[],query:"",pickupSelectedItem:function(){}});var zr=Ht(Ur),Gr={componentDidUpdate:function(){this.props.selectedName||(this.selectedItem=null)},getSelectedNode:function(){return c.a.findDOMNode(this.selectedItem)},pickupSelectedItem:function(e,t){this.props.selectedName===e&&(this.selectedItem=t)}},Qr=tn()({displayName:"MirroredListItem",mixins:[pa],propTypes:{media:Y.a.object.isRequired,mirror:Y.a.object.isRequired,selectedName:Y.a.string},getInitialState:function(){return{disableButton:{ignore:!1,static:!1,onDemand:!1}}},componentWillReceiveProps:function(e){(e.selectedName&&!this.props.selectedName||this.props.selectedName&&!e.selectedName)&&this.skipVisibilityCheckOnce()},createDeltaForSource:function(e,t){var n={sources:{}};return n.sources[this.props.mirror.position]={},t(n.sources[this.props.mirror.position],this.props.mirror),n},ignoreStream:function(){var e=this.props.media.stats.name,t=this.createDeltaForSource(e,function(t,n){t.except=(n.except||[]).concat(e)});ft.save(t).catch(function(){this.setState({disableButton:{ignore:!1}})}.bind(this)),this.setState({disableButton:{ignore:!0}})},removeFromOnly:function(){var e=this.props.media.stats.name,t=this.createDeltaForSource(e,function(t,n){var a=n.only.indexOf(e);a>-1&&(n.only.splice(a,1),t.only=n.only)});ft.save(t).catch(function(){this.setState({disableButton:{static:!1}})}.bind(this)),this.setState({disableButton:{static:!0}})},addToOnly:function(){var e=this.props.media.stats.name,t=this.createDeltaForSource(e,function(t,n){t.only=n.only.concat(e)});ft.save(t).catch(function(){this.setState({disableButton:{onDemand:!1}})}.bind(this)),this.setState({disableButton:{onDemand:!0}})},renderNameDescDVR:function(){var e=void 0;return this.props.media.stats.dvr_info&&(e=o.a.createElement(qr,{info:this.props.media.stats.dvr_info})),o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("div",{className:"name-desc-dvr-wrapper"},o.a.createElement("div",{className:"name-desc-dvr group-item"},o.a.createElement("div",{className:"name"},this.props.media.stats.name),o.a.createElement("div",{className:"desc padding-left-10"})),o.a.createElement($a,{media:this.props.mirror,name:this.props.media.stats.name,stats:this.props.media.stats})),e)},renderToggleStatic:function(){return this.props.mirror.only?this.props.media.stats.static?o.a.createElement(ua,{label:"static",onClick:this.removeFromOnly,disabled:this.state.disableButton.static}):o.a.createElement(ua,{label:"on demand",onClick:this.addToOnly,disabled:this.state.disableButton.onDemand}):o.a.createElement("div",{className:"notice-text"},"static")},render:function(){var e="base-container row-height media-item";return this.props.selectedName&&(e+=" collapsed",this.props.selectedName==this.props.media.stats.name&&(e+=" selected")),o.a.createElement("div",{className:e},o.a.createElement("div",{className:"left-container"},this.renderToggleStatic()),o.a.createElement("div",{className:"center-container group-item"},o.a.createElement(Et,{to:"mirrored-item",params:{mediaName:encodeURIComponent(this.props.media.stats.name)},className:"left-list-column"},this.renderNameDescDVR()),o.a.createElement(Nr,{name:this.props.media.stats.name,media:this.props.mirror,stats:this.props.media.stats,path:["sources",this.props.mirror.position,this.props.media.stats.name]}),o.a.createElement("div",{className:"right-list-column"},o.a.createElement(ua,{label:this.state.disableButton.ignore?"ignoring...":"ignore",disabled:this.state.disableButton.ignore,onClick:this.ignoreStream,className:"danger margin-left-20 margin-right-20"}),o.a.createElement(Dr,{name:this.props.media.stats.name,media:this.props.media,stats:this.props.media.stats,className:"margin-left-20"}))),o.a.createElement("div",{className:"right-container"}))}});function Kr(e){return(Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jr(){return(Jr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Yr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function $r(e){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zr(e,t){return(Zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var to=function(e){return function(t){function n(e){var t,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),a=this,r=$r(n).call(this,e),t=!r||"object"!==Kr(r)&&"function"!=typeof r?Xr(a):r,eo(Xr(t),"skipVisibilityCheckOnce",function(){t.skipVisibilityCheck=!0}),eo(Xr(t),"isDOMNodeVisible",function(){var e=c.a.findDOMNode(Xr(t)).getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight,a=window.innerWidth||document.documentElement.clientWidth;return e.bottom>=0&&e.right>=0&&e.top<=n&&e.left<=a}),t.skipVisibilityCheck=!1,t}var a,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zr(e,t)}(n,o.a.Component),a=n,(r=[{key:"shouldComponentUpdate",value:function(){return this.skipVisibilityCheck?(this.skipVisibilityCheck=!1,!0):this.isDOMNodeVisible()}},{key:"render",value:function(){return o.a.createElement(e,Jr({skipVisibilityCheckOnce:this.skipVisibilityCheckOnce},this.props))}}])&&Yr(a.prototype,r),i&&Yr(a,i),n}()};function no(e){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ao(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ro(e,t){return!t||"object"!==no(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oo(e){return(oo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function io(e,t){return(io=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var so=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ro(this,oo(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&io(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=[];for(var t in this.props.servers){var n=this.props.setHoveredServer.bind(null,this.props.servers[t].name),a=this.props.setHoveredServer.bind(null,void 0);this.props.servers[t].error?e.push(o.a.createElement("circle",{key:t,cx:6+24*t,r:6,style:{fill:"#a02c2c"},onMouseOver:n,onMouseOut:a})):e.push(o.a.createElement("circle",{key:t,cx:6+24*t,r:6,style:{fill:"#338000"},onMouseOver:n,onMouseOut:a}))}return o.a.createElement("div",{className:"source-urls-switcher margin-left-10",style:{bottom:"-6px"}},o.a.createElement("svg",{width:200,height:6,className:"urls"},e))}}])&&ao(n.prototype,a),r&&ao(n,r),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(so,"propTypes",{servers:Y.a.array.isRequired,setHoveredServer:Y.a.func.isRequired});var lo=so;n(992);function co(e){return(co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function po(e){return(po=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fo(e,t){return(fo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ho(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var go=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=po(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==co(r)&&"function"!=typeof r?mo(a):r,ho(mo(n),"state",{hoveredServerName:void 0}),ho(mo(n),"onRemoveClick",function(){var e="Really delete ".concat(n.props.id," from config?");if(n.props.mirror.dvr&&(e="".concat(e," DVR archive would remain.")),window.confirm(e)){var t={sources:{}};t.sources[n.props.mirror.position]=null,ft.save(t)}}),ho(mo(n),"setStaticAsDefault",function(){if(n.props.mirror.only){var e={sources:{}};e.sources[n.props.mirror.position]={only:null},ft.save(e)}}),ho(mo(n),"setOndemandAsDefault",function(){if(!n.props.mirror.only){var e={sources:{}};e.sources[n.props.mirror.position]={only:[]},ft.save(e)}}),ho(mo(n),"setHoveredServer",function(e){n.setState({hoveredServerName:e})}),ho(mo(n),"renderNameDescDVR",function(){return o.a.createElement("div",{className:"name-desc-dvr group-head"},o.a.createElement("div",{className:"name"},n.props.mirror.urls.join(", ")),o.a.createElement("div",{className:"desc padding-left-10"},n.props.mirror.title||n.props.mirror.meta.comment))}),ho(mo(n),"renderServerStatus",function(e){return e.error?o.a.createElement("div",null,o.a.createElement("div",{className:"error-text error-border"},"error: ",e.error)):o.a.createElement("div",null,o.a.createElement("div",{className:"success-text"},"online"))}),ho(mo(n),"renderServersStatus",function(){var e;if(n.state.hoveredServerName){for(var t=0;t<n.props.servers;t+=1)if(n.props.servers[t].name===n.state.hoveredServerName){e=n.renderServerStatus(n.props.servers[t]);break}}else{for(var a=0;a<n.props.servers;a+=1)if(!n.props.servers[a].error){e=n.renderServerStatus(n.props.servers[a]);break}e||0===n.props.servers.length||(e=n.renderServerStatus(n.props.servers[n.props.servers.length-1]))}return o.a.createElement("div",{className:"flex-end",style:{width:"100%",position:"relative"}},o.a.createElement("div",{className:"padding-left-10"},e),o.a.createElement(lo,{servers:n.props.servers,setHoveredServer:n.setHoveredServer}))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fo(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){(e.selectedName&&!this.props.selectedName||this.props.selectedName&&!e.selectedName)&&this.props.skipVisibilityCheckOnce()}},{key:"render",value:function(){var e=this.props.mirror.only,t="base-container row-height media-item mirror-item";return this.props.selectedName&&(t="".concat(t," collapsed"),this.props.selectedName===String(this.props.id)&&(t="".concat(t," selected"))),o.a.createElement("div",{className:t},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column"},o.a.createElement(Et,{to:"mirror-item",params:{mediaName:encodeURIComponent(this.props.id)},style:{width:"100%"}},this.renderNameDescDVR())),o.a.createElement("div",{className:"center-list-column list-underline padding-left-10"},this.renderServersStatus()),o.a.createElement("div",{className:"right-list-column",style:{position:"relative"}},o.a.createElement(ua,{label:"✕",onClick:this.onRemoveClick,className:"danger margin-left-20 margin-right-20"}),o.a.createElement("div",{className:"flex-center",style:{position:"absolute",right:0,top:"-8px"}},o.a.createElement("div",{className:"notice-text"},"mirror by default as:"),o.a.createElement(ua,{label:"static",checked:!e,onClick:this.setStaticAsDefault,className:"margin-left-10 flex-center",isRadio:!0}),o.a.createElement(ua,{label:"on demand",checked:!!e,onClick:this.setOndemandAsDefault,className:"margin-left-10 flex-center",isRadio:!0})))),o.a.createElement("div",{className:"right-container"}))}}])&&uo(n.prototype,a),r&&uo(n,r),t}();ho(go,"propTypes",{id:Y.a.number.isRequired,mirror:Ga.isRequired,servers:Y.a.arrayOf(Y.a.any).isRequired,skipVisibilityCheckOnce:Y.a.func.isRequired,selectedName:Y.a.string}),ho(go,"defaultProps",{selectedName:""});var vo=to(go);function bo(e){return(bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Eo(e){return(Eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function So(e,t){return(So=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Co(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Oo=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Eo(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==bo(r)&&"function"!=typeof r?wo(a):r,Co(wo(n),"moveFromExceptToOnly",function(){var e=n.props,t=e.name,a=e.mirror.position,r={sources:{}},o=(n.props.mirror.except||[]).filter(function(e){return t!==e}),i=(n.props.mirror.except||[]).slice();i.push(t),r.sources[a]={except:o,only:i},ft.save(r)}),Co(wo(n),"removeFromExcept",function(){var e=n.props,t=e.name,a=e.mirror.position,r={sources:{}},o=(n.props.mirror.except||[]).filter(function(e){return t!==e});r.sources[a]={except:o},ft.save(r)}),Co(wo(n),"renderNameDescDVR",function(){return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("div",{className:"name-desc-dvr-wrapper"},o.a.createElement("div",{className:"name-desc-dvr group-item"},o.a.createElement("div",{className:"name"},n.props.name),o.a.createElement("div",{className:"desc padding-left-10"}))))}),Co(wo(n),"renderUse",function(){return n.props.mirror.only?o.a.createElement("div",{className:"flex-end padding-left-10"},o.a.createElement("div",{className:"notice-text action-buttons-notice"},"start use as:"),o.a.createElement("div",{className:"action-button-wrapper"},o.a.createElement(ua,{label:"static",onClick:n.moveFromExceptToOnly,className:"margin-left-10",isRadio:!0})),o.a.createElement("div",{className:"action-button-wrapper"},o.a.createElement(ua,{label:"on demand",onClick:n.removeFromExcept,className:"margin-left-10",isRadio:!0}))):o.a.createElement("div",{className:"flex-end padding-left-10"},o.a.createElement("div",{className:"notice-text"},"start use as:"),o.a.createElement(ua,{label:"static",onClick:n.removeFromExcept,className:"margin-left-10"}))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&So(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){(e.selectedName&&!this.props.selectedName||this.props.selectedName&&!e.selectedName)&&this.skipVisibilityCheckOnce()}},{key:"render",value:function(){var e="base-container row-height media-item mirrored-ignored-list-item";return this.props.selectedName&&(e="".concat(e," collapsed")),e="".concat(e," ignored"),o.a.createElement("div",{className:e},o.a.createElement("div",{className:"left-container"},o.a.createElement("div",{className:"notice-text"},"ignored")),o.a.createElement("div",{className:"center-container group-item"},o.a.createElement("div",{className:"left-list-column"},this.renderNameDescDVR()),o.a.createElement("div",{className:"center-list-column list-underline padding-left-10"},this.renderUse()),o.a.createElement("div",{className:"right-list-column"})),o.a.createElement("div",{className:"right-container"}))}}])&&yo(n.prototype,a),r&&yo(n,r),t}();Co(Oo,"propTypes",{name:Y.a.string.isRequired,mirror:Ga.isRequired,selectedName:Y.a.string}),Co(Oo,"defaultProps",{selectedName:""});var xo=to(Oo),No=tn()({displayName:"MirrorGroupItem",mixins:[Gr],propTypes:{group:Y.a.object.isRequired,config:Y.a.object.isRequired,selectedName:Y.a.string},getInitialState:function(){return{showRest:!1}},toogleShowRest:function(){this.setState({showRest:!this.state.showRest})},renderOndemandItem:function(e,t){var n={name:t,urls:[],options:e,stats:{alive:!1,running:!1}};return o.a.createElement(Qr,{key:t,media:n,mirror:this.props.group.mirror,selectedName:this.props.selectedName,ref:this.pickupSelectedItem.bind(this,t)})},renderItem:function(e){return o.a.createElement(Qr,{key:e.name,media:{stats:e},mirror:this.props.group.mirror,selectedName:this.props.selectedName,ref:this.pickupSelectedItem.bind(this,e.name)})},render:function(){var e=this.props.group.ondemandStreamNames,t=0==e.length?void 0:this.state.showRest,n=o.a.createElement(vo,{config:this.props.config,mirror:this.props.group.mirror,id:this.props.group.id,servers:this.props.group.servers,ref:this.pickupSelectedItem.bind(this,this.props.group.id.toString()),selectedName:this.props.selectedName}),a=void 0;if(this.state.showRest){var r=JSON.parse(JSON.stringify(this.props.group.mirror));r.static=!1,a=e.map(this.renderOndemandItem.bind(this,r))}var i=(this.props.group.mirror.except||[]).map(function(e){return o.a.createElement(xo,{key:e,name:e,selectedName:this.props.selectedName,mirror:this.props.group.mirror})}.bind(this)),s=void 0;return!0===t?s=o.a.createElement(MirroredExpandButton,{selectedName:this.props.selectedName,label:"hide "+e.length+" on demand streams",showRest:t,toogleShowRest:this.toogleShowRest}):!1===t&&(s=o.a.createElement(MirroredExpandButton,{selectedName:this.props.selectedName,label:"show "+e.length+" on demand streams",showRest:t,toogleShowRest:this.toogleShowRest})),o.a.createElement("div",null,n,this.props.group.mirrored.map(this.renderItem),s,a,i,o.a.createElement("div",{className:"row-height"}))}});function ko(e){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Io(e,t,n[t])})}return e}function Po(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jo(e){return(jo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ro(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function To(e,t){return(To=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Io(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Do=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=jo(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==ko(r)&&"function"!=typeof r?Ro(a):r,Io(Ro(n),"state",{showNewItem:!1,newItemUrl:"",newItemClusterKey:"",sorting:void 0,groups:{}}),Io(Ro(n),"getSelectedNode",function(){var e=null,t=n.state.groups;return t&&Object.keys(t).some(function(n){var a=t[n],r=a?a.getSelectedNode():null;return!!r&&(e=r,!0)}),e}),Io(Ro(n),"getOnlineServer",function(e){var t=!0,n=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;if(!i.error&&i.stream_names&&0!==i.stream_names.length)return i}}catch(e){n=!0,a=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}}),Io(Ro(n),"getPreparedGroup",function(e){var t=n.getOnlineServer(e.servers),a=e.mirror.except||[];return _o({},e,{ondemandStreamNames:t?t.stream_names.filter(function(e){return!a.includes(e)&&!Jt.findByName(n.props.config,e)}):[]})}),Io(Ro(n),"getFilteredGroups",function(){for(var e=se.a(n.props.config.servers),t=[],a=Object.values(n.props.config.sources),r=0;r<a.length;r++){var o=a[r],i=o.position,s=[],l=[],c=o.urls||[],u=!0,p=!1,d=void 0;try{for(var m,f=c[Symbol.iterator]();!(u=(m=f.next()).done);u=!0){var h=m.value,g=void 0,v=h.split("://");g=1===v.length?h:v[1],/:\d+$/.test(g)||(g+=":80");var b=g.split(":")[0];e[b]&&(l.push(e[b]),delete e[b])}}catch(e){p=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(p)throw d}}if(n.props.config.sources[i])for(var y in n.props.config.sources[i].streams){var E=n.props.config.sources[i].streams[y];E&&n.isMirroredMatchedQueryAndFilters(y,E)&&s.push(E)}if(0===s.length)n.isMirrorMatchQueryAndFilters(o)&&t.push(n.getPreparedGroup({mirror:o,id:i,mirrored:s,servers:l}));else{switch(n.state.sorting){case"name-asc":s.sort(Zt.nameSortFunc.bind(Ro(n),"asc"));break;case"name-desc":s.sort(Zt.nameSortFunc.bind(Ro(n),"desc"));break;case"clients-asc":s.sort(Zt.clientsSortFunc.bind(Ro(n),"asc"));break;case"clients-desc":s.sort(Zt.clientsSortFunc.bind(Ro(n),"desc"));break;case"bitrate-asc":s.sort(Zt.bitrateSortFunc.bind(Ro(n),"asc"));break;case"bitrate-desc":s.sort(Zt.bitrateSortFunc.bind(Ro(n),"desc"));break;case"runtime-asc":s.sort(Zt.runtimeSortFunc.bind(Ro(n),"asc"));break;case"runtime-desc":s.sort(Zt.runtimeSortFunc.bind(Ro(n),"desc"))}t.push(n.getPreparedGroup({mirror:o,id:i,mirrored:s,servers:l}))}}return t}),Io(Ro(n),"toggleNewItem",function(){n.setState(function(e){return{showNewItem:!e.showNewItem}})}),Io(Ro(n),"isMirrorMatchQuery",function(e){if(""===n.props.query)return!0;var t=e.urls.slice();return t.push((e.title||"").trim().toLowerCase()),t.push((e.meta.comment||"").trim().toLowerCase()),t.some(function(e){return e.includes(n.props.query)})}),Io(Ro(n),"isMirrorMatchFilters",function(e){var t=!0,a=!1,r=void 0;try{for(var o,i=n.props.filters[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value,l=!0;switch(s){case"dvr":l=!!e.dvr;break;default:l=!1}if(!l)return!1}}catch(e){a=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(a)throw r}}return!0}),Io(Ro(n),"isMirrorMatchQueryAndFilters",function(e){return n.isMirrorMatchQuery(e)&&n.isMirrorMatchFilters(e)}),Io(Ro(n),"isMirroredMatchQuery",function(e,t){if(""===n.props.query)return!0;var a=[];for(var r in a.push(e),a.push(t.name||""),a)if(-1!==a[r].indexOf(n.props.query))return!0;return!1}),Io(Ro(n),"isMirroredMatchFilters",function(e,t){var a=!0,r=!1,o=void 0;try{for(var i,s=n.props.filters[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var l=i.value,c=!0;switch(l){case"dvr":c=!!t.dvr_info;break;case"transcoder":return!!t.running_transcoder;case"error":c=!!t.source_error||!!Zt.isUnavailable(t);break;case"online":break;case"waiting":default:c=!1}if(!c)return!1}}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return!0}),Io(Ro(n),"isMirroredMatchedQueryAndFilters",function(e,t){return n.isMirroredMatchQuery(e,t)&&n.isMirroredMatchFilters(e,t)}),Io(Ro(n),"handleNewItemUrlChange",function(e){var t=e.target.value;n.setState({newItemUrl:t.replace(/\s/g,"")})}),Io(Ro(n),"handleNewItemClusterKeyChange",function(e){var t=e.target.value;n.setState({newItemClusterKey:t})}),Io(Ro(n),"handleNewItemCreate",function(){if(n.state.newItemUrl){var e={sources:{}};e.sources[-1]={urls:[n.state.newItemUrl]},n.state.newItemClusterKey&&(e.sources[-1].cluster_key=n.state.newItemClusterKey),ft.save(e).then(function(){n.setState({showNewItem:!1,newItemUrl:""})})}}),Io(Ro(n),"handleSortingClear",function(){n.setState({sorting:void 0})}),Io(Ro(n),"handleSortingSet",function(e){return function(){n.setState({sorting:e})}}),Io(Ro(n),"renderSortableColumn",function(e,t,a){var r=n.state.sorting==="".concat(e,"-desc"),i=n.state.sorting==="".concat(e,"-asc"),s=r&&n.handleSortingClear||i&&n.handleSortingSet("".concat(e,"-desc"))||n.handleSortingSet("".concat(e,"-asc")),l=an()(a,"column-caption",{"caption-sortable-up":i,"caption-sortable-down":r,"caption-sortable-none":!i&&!r});return o.a.createElement("h1",{className:l,onClick:s},t,o.a.createElement("div",{className:"sort-icon"}))}),Io(Ro(n),"renderLabels",function(){var e=0!==Object.keys(n.props.config.sources).length,t=e?[o.a.createElement("div",{key:1,className:"clients-column"},n.renderSortableColumn("clients","clients","padding-left-20")),o.a.createElement("div",{key:2,className:"kbps-column"},n.renderSortableColumn("bitrate","bitrate","padding-left-20")),o.a.createElement("div",{key:3,className:"runtime-column"},n.renderSortableColumn("runtime","runtime"))]:null,a=e?o.a.createElement("div",{className:"name-column"},n.renderSortableColumn("name","name")):null;return o.a.createElement("div",{className:an()("base-container row-height",{collapsed:n.props.selectedName})},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column flex-end"},o.a.createElement("h1",{className:"head-text"},"Origin servers"),o.a.createElement(ua,{label:"add",checked:n.state.showNewItem,onClick:n.toggleNewItem,className:"margin-left-10"}),a),o.a.createElement("div",{className:"center-list-column"},t),o.a.createElement("div",{className:"right-list-column"})),o.a.createElement("div",{className:"right-container"}))}),Io(Ro(n),"renderNewItemForm",function(){return n.props.selectedName||!n.state.showNewItem?null:o.a.createElement("div",null,o.a.createElement("div",{className:"new-item-form base-container row-height"},o.a.createElement("div",{className:"left-container"},o.a.createElement(ua,{label:"discard",onClick:n.toggleNewItem})),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column padding-right-10"},o.a.createElement(ea,{label:"Mirrored Flussonic url"},o.a.createElement(mn,{value:n.state.newItemUrl,onChange:n.handleNewItemUrlChange,onSubmit:n.handleNewItemCreate,focusOnMount:!n.state.newItemUrl}))),o.a.createElement("div",{className:"center-list-column padding-left-10"},o.a.createElement(ea,{label:"Cluster key (if available)"},o.a.createElement(mn,{value:n.state.newItemClusterKey,onChange:n.handleNewItemClusterKeyChange,onSubmit:n.handleNewItemCreate,focusOnMount:!!n.state.newItemName&&!n.state.newItemClusterKey}))),o.a.createElement("div",{className:"right-list-column padding-left-20"},o.a.createElement(ua,{label:"create",disabled:!n.state.newItemUrl,onClick:n.handleNewItemCreate})),o.a.createElement("div",{className:"right-list-column"})),o.a.createElement("div",{className:"right-container"})),o.a.createElement("div",{className:"row-height"}))}),Io(Ro(n),"renderGroup",function(e,t){return o.a.createElement(No,{key:"".concat(e.id,"/").concat(t),config:n.props.config,ref:function(t){n.state.groups[e.id]||n.setState(function(n){return{groups:_o({},n.groups,Io({},e.id,t))}})},group:e,selectedName:n.props.selectedName})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&To(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement("div",null,this.renderLabels(),this.renderNewItemForm(),this.getFilteredGroups().map(this.renderGroup))}}])&&Po(n.prototype,a),r&&Po(n,r),t}();Io(Do,"propTypes",{config:Qa.isRequired,selectedName:Y.a.string,filters:Y.a.arrayOf(Y.a.string),query:Y.a.string}),Io(Do,"defaultProps",{selectedName:void 0,filters:[],query:void 0});var Ao=Do,qo=tn()({propTypes:{media:Y.a.object.isRequired},switchToUrl:function(e){N.switchSource(this.props.media.name,e.url)},render:function(){var e="#338000";(this.props.media.stats.source_error||Zt.isUnavailable(this.props.media))&&(e="#a02c2c");var t=this.props.media.stats.url,n=[];for(var a in this.props.media.urls)this.props.media.urls[a].url==t?n.push(o.a.createElement("circle",{key:a,cx:6+24*a,r:6,style:{fill:e}})):this.props.media.stats.alive?n.push(o.a.createElement("circle",{key:a,cx:6+24*a,r:6,style:{fill:"#d9d9d9"},className:"switchable",onClick:this.switchToUrl.bind(this,this.props.media.urls[a])})):n.push(o.a.createElement("circle",{key:a,cx:6+24*a,r:6,style:{fill:"#d9d9d9"}}));var r=void 0;return Zt.publishEnabled(this.props.media)&&(r=Zt.isPublished(this.props.media,this.props.media.stats)?o.a.createElement("circle",{cx:6,r:6,style:{fill:e}}):o.a.createElement("circle",{cx:6,r:6,style:{fill:"#d9d9d9"}})),o.a.createElement("div",{className:"source-urls-switcher margin-left-20"},o.a.createElement("svg",{width:200,height:6,className:"urls"},n),o.a.createElement("svg",{width:38,height:6,className:"publishing"},r))}});function Mo(e){return(Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Vo(e){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lo(e,t){return(Lo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ho=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Vo(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Mo(r)&&"function"!=typeof r?Bo(a):r,Wo(Bo(n),"state",{loadingStaticButton:!1}),Wo(Bo(n),"onRemoveClick",function(){var e=n.props.media;if(window.confirm("Really delete ".concat(e.name," from config?"))){var t={streams:{}};t.streams[e.name]=null,ft.save(t)}}),Wo(Bo(n),"toggleStatic",function(){var e=n.props.media,t={streams:{}};t.streams[e.name]={static:!e.static},ft.save(t).then(function(){return n.setState({loadingStaticButton:!1})}),n.setState({loadingStaticButton:!0})}),Wo(Bo(n),"renderNameDescDVR",function(){var e=n.props.media,t=!!e.stats.dvr_info;return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("div",{className:"name-desc-dvr-wrapper"},o.a.createElement("div",{className:"name-desc-dvr"},o.a.createElement("div",{className:"name"},e.name),o.a.createElement("div",{className:"desc padding-left-10"},e.title||e.meta.comment||"")),o.a.createElement($a,{name:e.name,media:e,stats:e.stats})),t&&o.a.createElement(qr,{info:e.stats.dvr_info}))}),Wo(Bo(n),"renderSourceBlock",function(){var e=n.props.media,t=Zt.isPublished(e,e.stats)&&e.stats&&"".concat(e.stats.published_from," via ").concat(e.stats.published_via)||ke.a(["stats","url"],e)||ke.a(["url"],e)||ke.a(["urls",0,"url"],e)||"&nbsp;";return o.a.createElement("div",{className:"source list-underline padding-left-20"},t)}),Wo(Bo(n),"renderAgentBlock",function(){var e=n.props.media;switch(e.stats.agent_status){case null:case void 0:return null;case"rproxy_not_configured":return o.a.createElement("div",{className:"agent-info unconf notice-text"},"unconf");case"not_connected":return o.a.createElement("div",{className:"agent-info error error-text"},e.stats.current_agent_id);case"connected":return o.a.createElement("div",{className:"agent-info success success-text"},e.stats.current_agent_id)}return console.error("Unknown agent_status: ",e.stats.agent_status,"for stream: ",e.name),null}),Wo(Bo(n),"renderSource",function(){var e=n.props.media,t=n.renderSourceBlock(),a=n.renderAgentBlock();return o.a.createElement("div",{className:"flex-end",style:{width:"100%",position:"relative"}},t,a,o.a.createElement(qo,{media:e}))}),Wo(Bo(n),"renderToggleStatic",function(){var e=n.props.media,t=n.state.loadingStaticButton;return o.a.createElement(ua,{disabled:t,onClick:n.toggleStatic,label:e.static?"static":"on demand"})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lo(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.media,n=e.selectedName,a="base-container row-height media-item",r=null;return n?(a+=" collapsed",n===t.name&&(a+=" selected")):r=o.a.createElement("div",{className:"column-container"},o.a.createElement("div",{className:"stream-item-move drag-handle"})),o.a.createElement("div",{className:a},o.a.createElement("div",{className:"left-container"},this.renderToggleStatic()),r,o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column"},o.a.createElement(Et,{to:"stream-item","data-testid":"stream-link",params:{mediaName:encodeURIComponent(t.name)}},this.renderNameDescDVR())),o.a.createElement(Nr,{name:t.name,media:t,stats:t.stats,path:["streams",t.name]}),o.a.createElement("div",{className:"right-list-column"},this.renderSource())),o.a.createElement("div",{className:"right-container"},o.a.createElement(ua,{label:"✕",onClick:this.onRemoveClick,"data-testid":"stream-delete",className:"danger margin-left-20"}),o.a.createElement(Dr,{name:t.name,media:t,stats:t.stats,className:"margin-left-20"})))}}])&&Fo(n.prototype,a),r&&Fo(n,r),t}();Wo(Ho,"propTypes",{media:Y.a.shape({name:Y.a.string,static:Y.a.bool,changed:Y.a.bool,runningRequest:Y.a.bool,push:Y.a.array,push_changed:Y.a.bool,clients_timeout:Y.a.number,clients_timeout_changed:Y.a.bool,max_sessions:Y.a.number,max_sessions_changed:Y.a.bool}).isRequired,selectedName:Y.a.string.isRequired});var Uo=Ho;function zo(e){return(zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Go(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Qo(e){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ko(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jo(e,t){return(Jo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $o=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,n=!(r=(e=Qo(t)).call.apply(e,[this].concat(i)))||"object"!==zo(r)&&"function"!=typeof r?Ko(a):r,Yo(Ko(n),"setNameAttr",function(e){return function(t){t&&t.setAttribute("data-name",e)}}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jo(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props.onDragStart?"true":void 0,t="".concat(this.props.index*this.props.itemHeight,"px");return o.a.createElement("div",{ref:this.setNameAttr(this.props.media.name),className:"draggable-item",draggable:e,onDragEnd:this.props.onDragEnd,onDragStart:this.props.onDragStart,onMouseDown:this.props.mouseDownHandler,style:{position:"absolute",top:t,width:"100%"}},o.a.createElement(Uo,{media:this.props.media,selectedName:this.props.selectedName}))}}])&&Go(n.prototype,a),r&&Go(n,r),t}();Yo($o,"propTypes",{selectedName:Y.a.string.isRequired,media:Y.a.object.isRequired,itemHeight:Y.a.number.isRequired,index:Y.a.number.isRequired,mouseDownHandler:Y.a.func.isRequired,onDragStart:Y.a.func.isRequired,onDragEnd:Y.a.func.isRequired});n(993);function Xo(e){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ei(e){return(ei=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ti(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ni(e,t){return(ni=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ai(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ri(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var oi=function(){var e=document.createElement("div");e.className="dnd-placeholder base-container row-height",e.style.width="100%",e.style.position="absolute";var t=document.createElement("div");t.className="left-container";var n=document.createElement("div");n.className="center-container";var a=document.createElement("div");a.className="notice-text",a.textContent="Drop stream here",n.appendChild(a);var r=document.createElement("div");return r.className="right-container",e.appendChild(t),e.appendChild(n),e.appendChild(r),e}(),ii=function(e,t){return e.position===t.position?0:e.position>t.position?1:-1},si=function(e,t){var n=e.itemHeight,a=e.preloadItemsCount,r=t.scrollTop,o=t.scrollHeight,i=null;return o&&void 0!==r&&((i={}).start=Math.ceil((r-2*n)/n)-a,i.stop=Math.floor((r+o)/n)+a),i},li=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.config,n=void 0===t?{}:t,a=e.visibleNames,r=void 0===a?[]:a,o=n.streams,i=void 0===o?{}:o;return r.reduce(function(e,t){return i[t]?[].concat(ri(e),[i[t]]):e},[]).sort(function(e,t){return e.position-t.position})},ci=function(){},ui=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=ei(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Xo(r)&&"function"!=typeof r?ti(a):r,ai(ti(n),"state",{showNewItem:!1,newItemName:"",newItemUrl:"",localFilter:void 0,scrollTop:0,scrollHeight:0,scrollUpdateTimeout:void 0,sorting:"config",dragging:!1,streams:li(n.props)}),ai(ti(n),"refreshHeight",function(){var e=window.innerHeight-n.props.topOffset;n.setState({scrollHeight:e})}),ai(ti(n),"onMouseUp",function(e){!n.state.dragging||n.dragged&&n.dragged.parentNode||n.onDragEnd(e)}),ai(ti(n),"calculateItems",function(e,t){var a=e.itemHeight,r=e.preloadItemsCount,o=e.config,i=t.scrollTop,s=t.scrollHeight,l=t.streams,c=t.localFilter,u=t.sorting;n.calculateSortedAndFilteredItems({streams:l,localFilter:c,sorting:u}),n.calculateItemsToRender({itemHeight:a,preloadItemsCount:r,config:o},{scrollTop:i,scrollHeight:s})}),ai(ti(n),"calculateSortedAndFilteredItems",function(e){for(var t=e.streams,a=e.localFilter,r=e.sorting,o=[],i=[],s=0;s<t.length;s+=1){var l=t[s];a&&!n.matchLocalFilter(l)?i.push(l):l&&o.push(l)}switch(r){case"config":o.sort(ii);break;case"name-asc":o.sort(Zt.nameSortFunc.bind(ti(n),"asc"));break;case"name-desc":o.sort(Zt.nameSortFunc.bind(ti(n),"desc"));break;case"clients-asc":o.sort(Zt.clientsSortFunc.bind(ti(n),"asc"));break;case"clients-desc":o.sort(Zt.clientsSortFunc.bind(ti(n),"desc"));break;case"bitrate-asc":o.sort(Zt.bitrateSortFunc.bind(ti(n),"asc"));break;case"bitrate-desc":o.sort(Zt.bitrateSortFunc.bind(ti(n),"desc"));break;case"runtime-asc":o.sort(Zt.runtimeSortFunc.bind(ti(n),"asc"));break;case"runtime-desc":o.sort(Zt.runtimeSortFunc.bind(ti(n),"desc"))}n.items={sorted:o,filtered:i}}),ai(ti(n),"calculateItemsToRender",function(e,t){var a=e.itemHeight,r=e.preloadItemsCount,o=e.config,i=t.scrollTop,s=t.scrollHeight,l=n.items.sorted,c=n.items.filtered,u=si({itemHeight:a,preloadItemsCount:r},{scrollTop:i,scrollHeight:s}),p=function(e){return u&&e>=u.start&&e<=u.stop},d=(l=l.reduce(function(e,t,n){return p(n)&&e.push([t,n]),e},[])).length;c.forEach(function(e,t){var n=t+d;o.streams[e.name]&&p(n)&&l.push([e,n])}),n.itemsToRender=l}),ai(ti(n),"updateScrollTop",function(){n.scrollTop=window.pageYOffset,n.ticking||requestAnimationFrame(function(){n.setState({scrollTop:n.scrollTop}),n.ticking=!1}),n.ticking=!0}),ai(ti(n),"toggleNewItem",function(){n.setState(function(e){return{showNewItem:!e.showNewItem}})}),ai(ti(n),"changeNewItemName",function(e){n.setState({newItemName:e.target.value.replace(/\s/g,"")})}),ai(ti(n),"changeNewItemUrl",function(e){n.setState({newItemUrl:e.target.value.replace(/\s/g,"")})}),ai(ti(n),"createNewItem",function(){if(n.state.newItemName){var e={streams:{}},t=[];n.state.newItemUrl&&t.push({url:n.state.newItemUrl}),e.streams[n.state.newItemName]={name:n.state.newItemName,urls:t},ft.save(e).then(function(){var e={showNewItem:!1,newItemName:"",newItemUrl:"",expectToScrollTo:n.state.newItemName};n.setState(e)})}}),ai(ti(n),"selectLocalFilter",function(e){return function(){n.state.localFilter===e?n.setState({localFilter:void 0}):n.setState({localFilter:e})}}),ai(ti(n),"matchLocalFilter",function(e){switch(n.state.localFilter){case"published":return Zt.publishEnabled(e);case"noSources":return Zt.hasNoSources(e);default:return!0}}),ai(ti(n),"autoscroll",function(){if(bowser&&(window.bowser={}),!(window.bowser.msie||window.bowser.opera||window.bowser.chrome)){var e=1,t=0,a=ti(n).translate,r=n.props.itemHeight,o=window.bowser.firefox?document.documentElement:document.body,i=window.innerHeight-n.draggedRectTop-r/2,s=n.props.topOffset-n.draggedRectTop-r/2;a>=i-r?(t=1,e=10*Math.abs((i-r/2-a)/r)):a<=r+s&&(t=-1,e=10*Math.abs((a-r/2-s)/r)),n.autoScrollInterval&&(clearInterval(n.autoScrollInterval),n.autoScrollInterval=null),0!==t&&(n.autoScrollInterval=setInterval(function(){var a=e*t;o.scrollTop+=a,n.translate+=a},5))}}),ai(ti(n),"mouseDownHandler",function(e){n.handle=e.target}),ai(ti(n),"onDragStart",function(e){var t=e.currentTarget.querySelector(".drag-handle");if(n.dragged=e.currentTarget,n.draggedInitialOffset=e.clientY,n.draggedRectTop=n.dragged.getBoundingClientRect().top,t&&t.contains(n.handle)){e.dataTransfer.effectAllowed="move";try{e.dataTransfer.setData("text/html",e.currentTarget)}catch(t){e.dataTransfer.setData("text","")}if("function"==typeof e.dataTransfer.setDragImage){var a=e.currentTarget.getBoundingClientRect(),r=e.clientX-a.left,o=e.clientY-a.top;e.dataTransfer.setDragImage(e.currentTarget,r,o)}n.setState({dragging:!0})}else e.preventDefault()}),ai(ti(n),"onDragEnd",function(){n.dragged.style.opacity=1,n.over.previousElementSibling===oi&&n.over.parentNode.removeChild(oi);var e=n.dragged.getAttribute("data-name"),t=n.over.getAttribute("data-name");n.over.style.visibility="visible",n.putStreamBefore(e,t),clearInterval(n.autoScrollInterval),n.autoScrollInterval=null,n.dragged=null}),ai(ti(n),"onDragOver",function(e){if(e.preventDefault(),n.translate=e.clientY-n.draggedInitialOffset,n.dragged.style.opacity=.2,!e.target.classList.contains("dnd-placeholder")){for(var t=e.target;;){if("draggable-list"===t.className||t===document.body)return;if("draggable-item"===t.className)break;t=t.parentNode}oi.style.top=t.style.top,t.style.visibility="hidden",n.over&&n.over!==t&&(n.over.style.visibility=""),n.over=t,n.autoscroll(),t.parentNode.insertBefore(oi,t)}}),ai(ti(n),"isDraggingEnabled",function(){return!n.props.selectedName&&"config"===n.state.sorting}),ai(ti(n),"putStreamBefore",function(e,t){var a=n.state.streams,r=a.reduce(function(n,a,r){return a.name===e&&(n.old=[a,r]),a.name===t&&(n.new=[a,r]),n},{old:null,new:null});if(null!==r.old&&null!==r.new){var o=a.splice(r.old[1],1)[0];if(o.position+=r.new[0].position-r.old[0].position,a.splice(r.new[1],0,o),r.new[0].position-r.old[0].position>0)for(var i=r.old[0].position-1;i<r.new[0].position-1;i+=1)a[i].position-=1;else for(var s=r.new[0].position;s<r.old[0].position;s+=1)a[s].position+=1;n.setState({streams:a,dragging:!1});var l={streams:{}};l.streams[e]={position:o.position},ft.save(l)}}),ai(ti(n),"clearSorting",function(){n.setState({sorting:"config"})}),ai(ti(n),"selectSorting",function(e){n.setState({sorting:e})}),ai(ti(n),"getSelectedItemIndex",function(){var e=-1,t=n.props.selectedName;return n.items.sorted.concat(n.items.filtered).some(function(n,a){return t===n.name&&(e=a,!0)}),e}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ni(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentWillMount",value:function(){this.calculateItems(this.props,this.state)}},{key:"componentDidMount",value:function(){this.ticking=!1,this.scrollTop=0,this.refreshHeight(),this.updateScrollTop(),window.addEventListener("resize",this.refreshHeight),window.addEventListener("scroll",this.updateScrollTop),window.addEventListener("mouseup",this.onMouseUp)}},{key:"componentWillReceiveProps",value:function(e){this.setState({streams:li(e)})}},{key:"componentWillUpdate",value:function(e,t){this.calculateItems(e,t)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.refreshHeight),window.removeEventListener("scroll",this.updateScrollTop),window.removeEventListener("mouseUp",this.onMouseUp)}},{key:"renderSortableColumn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a="".concat(n," column-caption");return this.state.sorting==="".concat(e,"-desc")?o.a.createElement("h1",{className:"".concat(a," caption-sortable-up"),onClick:this.clearSorting},t,o.a.createElement("div",{className:"sort-icon"})):this.state.sorting==="".concat(e,"-asc")?o.a.createElement("h1",{className:"".concat(a," caption-sortable-down"),onClick:this.selectSorting.bind(this,"".concat(e,"-desc"))},t,o.a.createElement("div",{className:"sort-icon"})):o.a.createElement("h1",{className:"".concat(a," caption-sortable-none"),onClick:this.selectSorting.bind(this,"".concat(e,"-asc"))},t,o.a.createElement("div",{className:"sort-icon"}))}},{key:"renderLabels",value:function(){var e,t,n,a="base-container row-height";return this.props.selectedName&&(a+=" collapsed"),0!==Object.keys(this.props.config.streams).length&&(e=[o.a.createElement("div",{key:1,className:"clients-column"},this.renderSortableColumn("clients","clients","padding-left-40")),o.a.createElement("div",{key:2,className:"kbps-column"},this.renderSortableColumn("bitrate","bitrate","padding-left-20")),o.a.createElement("div",{key:3,className:"runtime-column"},this.renderSortableColumn("runtime","runtime"))],t=o.a.createElement("span",{className:"source-title-wrapper"},o.a.createElement("h1",{className:"column-caption padding-left-20 padding-right-10"},"source"),o.a.createElement(ua,{label:"published",onClick:this.selectLocalFilter("published"),checked:"published"===this.state.localFilter,isRadio:!0}),o.a.createElement(ua,{label:"no sources",onClick:this.selectLocalFilter("noSources"),checked:"noSources"===this.state.localFilter,isRadio:!0})),n=o.a.createElement("div",{className:"name-column"},this.renderSortableColumn("name","name"))),o.a.createElement("div",{className:a},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column flex-end"},o.a.createElement("h1",{className:"head-text"},"Streams"),o.a.createElement(ua,{label:"add","data-testid":"stream-add",checked:this.state.showNewItem,onClick:this.toggleNewItem,className:"margin-left-10"}),n),o.a.createElement("div",{className:"center-list-column"},e),o.a.createElement("div",{className:"right-list-column"},t)),o.a.createElement("div",{className:"right-container"}))}},{key:"renderNewItemForm",value:function(){return this.props.selectedName||!this.state.showNewItem?null:(this.state.newItemName&&Jt.findByName(this.props.config,this.state.newItemName)&&(e="this name is already used"),/^https?:\/\//.test(this.state.newItemUrl)&&(t="specify tshttp:// or hls:// protocol"),o.a.createElement("div",null,o.a.createElement("div",{className:"new-item-form base-container row-height"},o.a.createElement("div",{className:"left-container"},o.a.createElement(ua,{label:"discard",onClick:this.toggleNewItem})),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column padding-right-10"},o.a.createElement(ea,{label:"Stream name",errorMessage:e},o.a.createElement(mn,{"data-testid":"new-stream-name",value:this.state.newItemName,onChange:this.changeNewItemName,onSubmit:this.createNewItem,focusOnMount:!this.state.newItemName}))),o.a.createElement("div",{className:"center-list-column padding-left-10"},o.a.createElement(ea,{label:"Source URL (if available)",errorMessage:t},o.a.createElement(mn,{"data-testid":"new-stream-url",value:this.state.newItemUrl,onChange:this.changeNewItemUrl,onSubmit:this.createNewItem,focusOnMount:!!this.state.newItemName&&!this.state.newItemUrl}))),o.a.createElement("div",{className:"right-list-column padding-left-20"},o.a.createElement(ua,{label:"create","data-testid":"new-stream-create",disabled:!this.state.newItemName||!!e||!!t,onClick:this.createNewItem}))),o.a.createElement("div",{className:"right-container"})),o.a.createElement("div",{className:"row-height"})));var e,t}},{key:"renderItem",value:function(e,t){return o.a.createElement($o,{index:t,media:e,key:e.name,onDragEnd:this.isDraggingEnabled()?this.onDragEnd:ci,onDragStart:this.isDraggingEnabled()?this.onDragStart:ci,mouseDownHandler:this.mouseDownHandler,itemHeight:this.props.itemHeight,selectedName:this.props.selectedName})}},{key:"renderStreams",value:function(){var e=this,t=0===this.itemsToRender.length&&0!==this.props.visibleNames.length;return{streams:this.itemsToRender.map(function(t){return e.renderItem(t[0],t[1])}),noVisible:t}}},{key:"render",value:function(){var e,t=this.props.visibleNames.length,n=this.renderStreams();n.noVisible&&(e=o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"No matching streams found"))),o.a.createElement("div",{className:"right-container"})),t+=1);var a="".concat(t*this.props.itemHeight,"px");return o.a.createElement("div",{"data-testid":"stream-list"},this.renderLabels(),this.renderNewItemForm(),o.a.createElement("div",{className:"draggable-list",style:{position:"relative",height:a},onDragOver:this.isDraggingEnabled()?this.onDragOver:ci},n.streams),e)}}])&&Zo(n.prototype,a),r&&Zo(n,r),t}();ai(ui,"propTypes",{config:Qa,selectedName:Y.a.string.isRequired,visibleNames:Y.a.arrayOf(Y.a.string),itemHeight:Y.a.number,topOffset:Y.a.number.isRequired,preloadItemsCount:Y.a.number}),ai(ui,"defaultProps",{itemHeight:40,preloadItemsCount:10,visibleNames:[],config:{streams:[]}});var pi=ui,di=tn()({displayName:"VodItem",mixins:[pa],propTypes:{vod:Y.a.object.isRequired,config:Y.a.object.isRequired,selectedName:Y.a.string},componentWillReceiveProps:function(e){(e.selectedName&&!this.props.selectedName||this.props.selectedName&&!e.selectedName)&&this.skipVisibilityCheckOnce()},onRemoveClick:function(){if(window.confirm("Really delete "+this.props.vod.prefix+" from config?")){var e={vods:{}};e.vods[this.props.vod.prefix]=null,ft.save(e)}},renderNameDescDVR:function(){var e=this.props.vod.urls.map(function(e){return e.url}).join(" "),t=void 0;return this.props.vod.disabled&&(t=o.a.createElement("span",{className:"padding-left-10 warning-border warning-text"},"disabled")),o.a.createElement("div",{className:"name-desc-dvr group-head"},o.a.createElement("div",{className:"name"},this.props.vod.prefix),o.a.createElement("div",{className:"desc padding-left-10"},e),t)},render:function(){var e="base-container row-height media-item";return this.props.selectedName&&(e+=" collapsed",this.props.selectedName==this.props.vod.prefix&&(e+=" selected")),o.a.createElement("div",{className:e},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-center-list-column"},o.a.createElement(Et,{to:"vod-item",params:{mediaName:encodeURIComponent(this.props.vod.prefix)},style:{width:"100%"}},this.renderNameDescDVR())),o.a.createElement("div",{className:"right-list-column"},o.a.createElement(ua,{label:"✕",onClick:this.onRemoveClick,className:"danger margin-left-20"}))),o.a.createElement("div",{className:"right-container"}))}}),mi=tn()({displayName:"FileListItem",mixins:[pa],propTypes:{file:Y.a.object.isRequired,selectedName:Y.a.string},componentWillReceiveProps:function(e){(e.selectedName&&!this.props.selectedName||this.props.selectedName&&!e.selectedName)&&this.skipVisibilityCheckOnce()},renderNameDescDVR:function(){var e=this.props.file.name.replace(this.props.file.prefix,"");return o.a.createElement("div",{className:"name-desc-dvr-wrapper"},o.a.createElement("div",{className:"name-desc-dvr group-item"},o.a.createElement("div",{className:"name"},e),o.a.createElement("div",{className:"desc padding-left-10"})),o.a.createElement("div",{className:"short-status"},o.a.createElement("div",{className:"success-text success-border"},"on")))},renderStatsColumn:function(){return o.a.createElement("div",{className:"center-list-column list-underline padding-left-10"},o.a.createElement("div",{className:"clients-column"},o.a.createElement("div",{className:"padding-left-10 padding-right-10",style:{display:"flex"}},o.a.createElement("div",{className:"success-text",style:{flex:"0 0 41px"}},"online"),o.a.createElement("div",{style:{flex:"1 1 41px",textAlign:"right"}},this.props.file.client_count))),o.a.createElement("div",{className:"kbps-column"},o.a.createElement("div",{className:"padding-left-10 padding-right-10"}," ")),o.a.createElement("div",{className:"runtime-column"},o.a.createElement("div",{className:"padding-left-10"},o.a.createElement("div",{style:{textAlign:"right"}},this.props.file.worker_count))))},render:function(){var e="base-container row-height media-item";return this.props.selectedName&&(e+=" collapsed",this.props.selectedName==this.props.file.name&&(e+=" selected")),o.a.createElement("div",{className:e},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container group-item"},o.a.createElement(Et,{to:"file-item",params:{mediaName:encodeURIComponent(this.props.file.name)},className:"left-list-column",style:{overflow:"hidden"}},this.renderNameDescDVR()),this.renderStatsColumn(),o.a.createElement("div",{className:"right-list-column"})),o.a.createElement("div",{className:"right-container"}))}});function fi(e){return(fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hi(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gi(e){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bi(e,t){return(bi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ei=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=gi(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==fi(r)&&"function"!=typeof r?vi(a):r,yi(vi(n),"state",{showNewItem:!1,newItemName:"",newItemPath:""}),yi(vi(n),"toggleNewItem",function(){n.setState(function(e){return{showNewItem:!e.showNewItem}})}),yi(vi(n),"changeNewItemName",function(e){n.setState({newItemName:e.target.value.replace(/\s/g,"")})}),yi(vi(n),"changeNewItemPath",function(e){n.setState({newItemPath:e.target.value.replace(/\s/g,"")})}),yi(vi(n),"createNewItem",function(){if(n.state.newItemName){var e={vods:{}},t=[];n.state.newItemPath&&t.push({url:n.state.newItemPath}),e.vods[n.state.newItemName]={prefix:n.state.newItemName,urls:t},ft.save(e).then(function(){n.setState({showNewItem:!1,newItemName:"",newItemPath:""})})}}),yi(vi(n),"matchVodQuery",function(e){if(""===n.props.query)return!0;var t=e.urls.map(function(e){return e.url});t.push(e.prefix);for(var a=0;a<t.length;a+=1)if(-1!==t[a].indexOf(n.props.query))return!0;return!1}),yi(vi(n),"matchVodFilters",function(){return 0===n.props.filters.length}),yi(vi(n),"matchVod",function(e){return n.matchVodQuery(e)&&n.matchVodFilters(e)}),yi(vi(n),"matchFileQuery",function(e){if(""===n.props.query)return!0;var t=[];t.push(e.name),t.push(e.url);for(var a=0;a<t.length;a+=1)if(-1!==t[a].indexOf(n.props.query))return!0;return!1}),yi(vi(n),"matchFileFilters",function(e){for(var t=0;t<n.props.filters.length;t+=1){var a=!0;switch(e){case"dvr":case"error":a=!1;break;case"online":break;case"waiting":default:a=!1}if(!a)return!1}return!0}),yi(vi(n),"matchFile",function(e){return n.matchFileQuery(e)&&n.matchFileFilters(e)}),yi(vi(n),"filteredGroups",function(){var e=Object.keys(n.props.config.vods).sort(function(e,t){return n.props.config.vods[e].position>n.props.config.vods[t].position?1:-1}),t=[];return e.forEach(function(e){var a=n.props.config.vods[e],r=[];Object.keys(a.files).forEach(function(e){var t=a.files[e];n.matchFile(t)&&r.push(t)}),0===r.length?n.matchVod(a)&&t.push({vod:a,files:r}):t.push({vod:a,files:r})}),t}),yi(vi(n),"renderLabels",function(){var e,t="".concat(n.props.selectedName?"collapsed":""," base-container row-height");return 0!==Object.keys(n.props.config.vods).length&&(e=[o.a.createElement("div",{key:1,className:"clients-column"},o.a.createElement("h1",{className:"column-caption padding-right-10 padding-left-20"},"clients")),o.a.createElement("div",{key:2,className:"kbps-column"},o.a.createElement("div",{className:"column-caption padding-left-10"})),o.a.createElement("div",{key:3,className:"runtime-column"},o.a.createElement("h1",{className:"column-caption"},"workers"))]),o.a.createElement("div",{className:t},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column"},o.a.createElement("h1",{className:"head-text"},"Files (VOD)"),o.a.createElement(ua,{label:"add",checked:n.state.showNewItem,onClick:n.toggleNewItem,className:"margin-left-10"})),o.a.createElement("div",{className:"center-list-column"},e),o.a.createElement("div",{className:"right-list-column"})),o.a.createElement("div",{className:"right-container"}))}),yi(vi(n),"renderNewItemForm",function(){return n.props.selectedName||!n.state.showNewItem?null:(n.state.newItemName&&(n.props.config.lives[n.state.newItemName]||n.props.config.vods[n.state.newItemName])&&(e="this name is already used"),o.a.createElement("div",null,o.a.createElement("div",{className:"new-item-form base-container row-height"},o.a.createElement("div",{className:"left-container"},o.a.createElement(ua,{label:"discard",onClick:n.toggleNewItem})),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-list-column padding-right-10"},o.a.createElement(ea,{label:"VOD name",errorMessage:e},o.a.createElement(mn,{value:n.state.newItemName,onChange:n.changeNewItemName,onSubmit:n.createNewItem,focusOnMount:!n.state.newItemName}))),o.a.createElement("div",{className:"center-list-column padding-left-10"},o.a.createElement(ea,{label:"File directory path"},o.a.createElement(mn,{value:n.state.newItemPath,onChange:n.changeNewItemPath,onSubmit:n.createNewItem,focusOnMount:!!n.state.newItemName&&!n.state.newItemPath}))),o.a.createElement("div",{className:"right-list-column padding-left-20"},o.a.createElement(ua,{label:"create",disabled:!n.state.newItemName||!!e,onClick:n.createNewItem}))),o.a.createElement("div",{className:"right-container"})),o.a.createElement("div",{className:"row-height"})));var e}),yi(vi(n),"renderVodItem",function(e){return o.a.createElement(di,{config:n.props.config,vod:e,selectedName:n.props.selectedName,ref:n.props.pickupSelectedItem.bind(vi(n),e.prefix)})}),yi(vi(n),"renderItem",function(e){return o.a.createElement(mi,{key:e.name,file:e,selectedName:n.props.selectedName,ref:n.props.pickupSelectedItem.bind(vi(n),e.name)})}),yi(vi(n),"renderGroup",function(e){return o.a.createElement("div",{key:e.vod.prefix},n.renderVodItem(e.vod),e.files.map(n.renderItem),o.a.createElement("div",{className:"row-height"}))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bi(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement("div",null,this.renderLabels(),this.renderNewItemForm(),this.filteredGroups().map(this.renderGroup))}}])&&hi(n.prototype,a),r&&hi(n,r),t}();yi(Ei,"propTypes",{config:Qa.isRequired,selectedName:Y.a.string,filters:Y.a.arrayOf(Y.a.string),query:Y.a.string,pickupSelectedItem:Y.a.func}),yi(Ei,"defaultProps",{selectedName:"",filters:[],query:"",pickupSelectedItem:function(){}});var wi=Ht(Ei),Si=n(195),Ci=n(570),Oi=n(571),xi=n(567),Ni=n(568),ki=n(359),_i=function(e){return parseInt(e,10)},Pi=Se.a(function(e,t){var n=_i(t);return Number.isNaN(n)||we.a(n)?e:n}),ji=(Se.a(function(e,t,n){var a=_i(n);return Number.isNaN(a)||we.a(a)||n<t?e:a}),Se.a(function(e,t){var n=_i(t);return Number.isNaN(n)||we.a(n)||n<0?e:n}),Se.a(function(e,t){return function(e){return parseFloat(e)}(t)||e})),Ri=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ki.a(e);return function(n){return e.includes(n)?n:t}},Ti=ke.a(["target","value"]),Ii=Q.a(Pi(void 0),Ti),Di=Q.a(xi.a([[le.a,K.a(null)],[Ni.a,Si.a]]),Ti),Ai=(Q.a(Pi(null),Ti),n(569)),qi=n(649);function Mi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fi=Se.a(function(e,t){return Q.a(ve.a(function(n,a){return e(t[a],a,t)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Mi(e,t,n[t])})}return e}({},n,Mi({},a,t[a])):n},{}),ye.a)(t)}),Vi=(Q.a(qi.a(Ai.a("_changed")),ye.a),Fi(function(e,t){return he.a(Ai.a("_changed"))(t)})),Bi=Q.a(ye.a,Vi),Li=Q.a(Ne.a(_i),Bi);function Wi(e){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hi(){return(Hi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ui(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function zi(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Gi(e){return(Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ki(e,t){return(Ki=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ji(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yi={config:Qa,getConfigDelta:Y.a.func,onConfigChange:Y.a.func.isRequired,onConfigSave:Y.a.func.isRequired,onConfigResetChanges:Y.a.func.isRequired,isConfigSaving:Y.a.bool.isRequired},$i=/\"[^"]+_changed\":true,/g,Xi=/,\"[^"]+_changed\":true/g,Zi=function(e){return JSON.parse(JSON.stringify(e).replace($i,"").replace(Xi,""))},es=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){var a=function(e){function a(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),r=this,o=Gi(a).call(this,e),n=!o||"object"!==Wi(o)&&"function"!=typeof o?Qi(r):o,Ji(Qi(n),"state",{config:void 0,isConfigSaving:!1,pathInit:Ke(t,n.props)}),Ji(Qi(n),"isMounted",!0),Ji(Qi(n),"configInstance",new ie.Instance),Ji(Qi(n),"getConfigDelta",function(){return n.configInstance.delta}),Ji(Qi(n),"setStateSafe",function(){var e;return n.isMounted&&(e=n).setState.apply(e,arguments)}),Ji(Qi(n),"setDelta",function(e,t,a){var r=Ke(e,n.props),o=(void 0!==a&&"raw"===t&&Si.a||void 0!==a&&"string"===t&&!a.length&&Ti||K.a(null))(a);n.configInstance.changeDelta(r,o,t)}),Ji(Qi(n),"setConfigFromInstanceLocalConfig",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K.a(),t=n.configInstance.localConfig();e(t),n.setStateSafe({config:t})}),Ji(Qi(n),"onConfigUpdate",function(e){n.configInstance.setServerConfig(e),n.setStateSafe({config:n.configInstance.localConfig()})}),Ji(Qi(n),"handleConfigSave",function(){return n.setStateSafe({isConfigSaving:!0}),ft.save(n.configInstance.delta).then(function(){var e=n.configInstance.applyDelta();n.configInstance.resetDelta(),n.setStateSafe({isConfigSaving:!1,config:e})})}),Ji(Qi(n),"handleConfigChange",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(t,a){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:K.a();return function(o){var i=Array.isArray(t)?t:t.split("."),s=Ke(e.concat(i),n.props);console.log("handleConfigChange",s,a,o),n.setDelta(s,a,o),n.setConfigFromInstanceLocalConfig(r)}}}),Ji(Qi(n),"handleConfigValueChange",n.handleConfigChange(t)),Ji(Qi(n),"handleConfigListElementDelete",function(e){var a=Ci.a(e),r=_i(Ut.a(e)),o=Ke([].concat(Ui(t),Ui(a)),n.props),i=ke.a(o)(n.state.config),s=Li(i),l=s.length-1;s.forEach(function(e){e===l?n.handleConfigValueChange([].concat(Ui(a),[e.toString()]),"raw")(null):e>=r&&n.handleConfigValueChange([].concat(Ui(a),[e.toString()]),"raw")(Zi(i[e+1])),n.setConfigFromInstanceLocalConfig()})}),Ji(Qi(n),"handleConfigValueDelete",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n.handleConfigValueChange(e,"raw")(null)}),Ji(Qi(n),"handleConfigValueNameChange",function(e,a,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Si.a;if(a!==r){var i=[].concat(Ui(e),[r]),s=[].concat(Ui(e),[a]),l=Ke([].concat(Ui(t),Ui(e),[a]),n.props),c=o(ke.a(l,n.state.config));n.handleConfigValueChange(s,"raw")(null),n.handleConfigValueChange(i,"raw")(Zi(c)),n.setConfigFromInstanceLocalConfig()}}),Ji(Qi(n),"handleConfigResetChanges",function(){n.configInstance.resetDelta({})}),n.props.listenTo(ft,n.onConfigUpdate),n}var r,i,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ki(e,t)}(a,o.a.Component),r=a,(i=[{key:"componentWillUnmount",value:function(){this.isMounted=!1}},{key:"render",value:function(){var e=Ke(t,this.props),a=Oi.a(e);return o.a.createElement(n,Hi({},this.props,{config:this.state.config,isConfigChanged:Ee.a("changed",this.state.config),subconfig:Oe.a(a,this.state.config),isSubconfigLoaded:Oe.a(a,this.state.config),getConfigDelta:this.getConfigDelta,onConfigChange:this.handleConfigChange,onConfigValueChange:this.handleConfigValueChange,onConfigValueDelete:this.handleConfigValueDelete,onConfigValueNameChange:this.handleConfigValueNameChange,onConfigListElementDelete:this.handleConfigListElementDelete,onConfigSave:this.handleConfigSave,onConfigResetChanges:this.handleConfigResetChanges,isConfigSaving:this.state.isConfigSaving}))}}])&&zi(r.prototype,i),s&&zi(r,s),a}();return Ji(a,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Ji(e,t,n[t])})}return e}({},e,At)),a.displayName="WithConfig(".concat(n.name||n.displayName,")"),Dt()(a)}},ts=n(573),ns=te.a.createStore({init:function(){this.listenTo(ae,this.onEvent),this.subscribers={}},onEvent:function(e){if("resubscribe"==e)for(var t in this.subscribers)ae.send("sessions?name="+t);else"user.list"==e.event&&this.trigger(e)},start:function(){var e=function(){for(var t in this.interval&&clearTimeout(this.interval),this.subscribers)ae.send("sessions?name="+t);this.interval=setTimeout(e,1e3)}.bind(this);e()},stop:function(){this.interval&&clearTimeout(this.interval),this.interval=void 0},subscribe:function(e){this.subscribers[e]?this.subscribers[e]+=1:(ae.send("sessions?name="+e),this.subscribers[e]=1)},unsubscribe:function(e){this.subscribers[e]&&(this.subscribers[e]-=1),this.subscribers[e]<=0&&(ae.send("sessions?name="+e),delete this.subscribers[e])}}),as=tn()({displayName:"MediaClientsPage",mixins:[te.a.ListenerMixin],propTypes:{name:Y.a.string.isRequired,config:Y.a.object},componentDidMount:function(){this.listenTo(ns,this.onSessions),ns.subscribe(this.props.name),ns.start()},componentWillUnmount:function(){ns.unsubscribe(this.props.name),ns.stop()},onSessions:function(e){e.name==this.props.name&&this.setState({sessions:e.sessions})},killSession:function(e){N.killSessions([e])},getInitialState:function(){return{sessions:void 0}},renderColumns:function(){return o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"column-caption"},"protocol"),o.a.createElement("th",{className:"column-caption"},"address"),o.a.createElement("th",{className:"column-caption"},"country"),o.a.createElement("th",{className:"column-caption"},"transmitted"),o.a.createElement("th",{className:"column-caption"},"duration"),o.a.createElement("th",{className:"column-caption"},"token"),o.a.createElement("th",{className:"column-caption"},"user id"),o.a.createElement("th",{className:"column-caption"},"user agent"),o.a.createElement("th",{className:"column-caption"})))},renderRows:function(){var e=this.state.sessions.map(function(e){return o.a.createElement("tr",{key:e.id},o.a.createElement("td",null,e.type),o.a.createElement("td",null,e.ip),o.a.createElement("td",null,e.country),o.a.createElement("td",null,pr.bytes(e.bytes_sent)),o.a.createElement("td",null,pr.lifetimeFormat(e.duration)),o.a.createElement("td",null,e.token),o.a.createElement("td",null,e.user_id),o.a.createElement("td",null,e.user_agent),o.a.createElement("td",null,o.a.createElement(ua,{label:"kill",className:"danger",onClick:this.killSession.bind(this,e.id)})))}.bind(this));return o.a.createElement("tbody",null,e)},render:function(){return this.state.sessions?0==this.state.sessions.length?o.a.createElement("div",{"data-testid":"media-clients"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"No information about clients was recorded."))):o.a.createElement("div",{"data-testid":"media-clients"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("table",{id:"clients"},this.renderColumns(),this.renderRows())):o.a.createElement("div",{"data-testid":"media-clients"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"Loading...")))}});function rs(e){return(rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function os(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function is(e,t){return!t||"object"!==rs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ss(e){return(ss=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ls(e,t){return(ls=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cs=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),is(this,ss(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ls(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e="progressbar";if(this.props.className&&(e+=" "+this.props.className),this.props.errorText)return o.a.createElement("div",{className:e+" error-border error-text"},this.props.errorText);if(this.props.warningText)return o.a.createElement("div",{className:e+" warning-border warning-text"},this.props.warningText);if(this.props.successText)return o.a.createElement("div",{className:e+" success-border success-text"},this.props.successText);if(!this.props.progress)return o.a.createElement("div",{className:e},o.a.createElement("div",{className:"notice-text"},this.props.text));var t=Math.floor(100*this.props.progress)+"%";return o.a.createElement("div",{className:e},o.a.createElement("div",{className:"notice-text"},this.props.text),o.a.createElement("div",{className:"pline",style:{width:t}}))}}])&&os(n.prototype,a),r&&os(n,r),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(cs,"propTypes",{progress:Y.a.number,text:Y.a.string,successText:Y.a.string,warningText:Y.a.string,errorText:Y.a.string,className:Y.a.string});var us=cs;function ps(e){return(ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ds(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ms(e){return(ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hs(e,t){return(hs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vs(){return(new Date).getTime()}var bs=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=ms(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==ps(r)&&"function"!=typeof r?fs(a):r,gs(fs(n),"state",{showSuccess:!1,timer:void 0,clearTimeout:void 0,startedAt:void 0}),gs(fs(n),"clearSuccess",function(){n.setState({showSuccess:!1})}),gs(fs(n),"startTimer",function(){n.state.timer&&clearTimeout(n.state.timer);var e=vs(),t=setTimeout(n.timerTick,n.props.step);n.setState({timer:t,startedAt:e})}),gs(fs(n),"timerTick",function(){if(n.currentProgress()>1)n.setState({timer:void 0});else{var e=setTimeout(n.timerTick,n.props.step);n.setState({timer:e})}}),gs(fs(n),"currentProgress",function(){return(vs()-n.state.startedAt)/n.props.timeoutAfter}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hs(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.running&&this.startTimer()}},{key:"componentWillUnmount",value:function(){this.state.timer&&clearTimeout(this.state.timer),this.state.clearTimeout&&clearTimeout(this.state.clearTimeout)}},{key:"componentWillReceiveProps",value:function(e){if(e.running&&!this.props.running)this.startTimer();else if(!e.running&&this.props.running){this.state.timer&&clearTimeout(this.state.timer);var t={timer:void 0,startedAt:void 0,showSuccess:!0};t.clearTimeout=setTimeout(this.clearSuccess,3e3),this.setState(t)}}},{key:"render",value:function(){if(this.state.showSuccess)return o.a.createElement(us,{successText:"Saved.",className:this.props.className});if(!this.state.startedAt)return null;var e=this.currentProgress();return e>1&&this.props.running?o.a.createElement(us,{warningText:"Server response takes too long.",className:this.props.className}):o.a.createElement(us,{progress:e,text:"Saving config...",className:this.props.className})}}])&&ds(n.prototype,a),r&&ds(n,r),t}();gs(bs,"propTypes",{running:Y.a.bool,timeoutAfter:Y.a.number.isRequired,step:Y.a.number.isRequired,className:Y.a.string}),gs(bs,"defaultProps",{step:1e3,timeoutAfter:1e4});var ys=bs,Es=n(361),ws=n(123),Ss=n.n(ws),Cs=n(1474),Os=n(1423),xs=n(1481),Ns=n(1431),ks=n(1478),_s=n(588),Ps=n(1430),js=n(656),Rs=n(1483),Ts=n(1428),Is=n(679),Ds=n(397),As=n.n(Ds);function qs(){return(qs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ms(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Fs(e,t,n[t])})}return e}function Fs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Bs(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ls=function(e){var t=e.disabled,n=e.autoFocus,a=e.required,r=e.readOnly,i=e.changeOnlyValidated,s=e.fullWidth,l=e.isNilable,c=e.value,u=e.defaultValue,p=e.label,d=e.type,m=void 0===d?"text":d,f=e.helperText,h=e.inputProps,g=e.InputProps,v=e.withRemoveButton,b=e.onRemoveButtonClick,y=e.onChange,E=e.onEditingFinished,w=e.onFocus,S=e.onBlur,C=e.onKeyPress,O=e.validate,x=e.onError,N=e.onErrorResolve,k=e.error,_=e.adornment,P=e.adornmentPosition,j=e.debounce,R=Bs(e,["disabled","autoFocus","required","readOnly","changeOnlyValidated","fullWidth","isNilable","value","defaultValue","label","type","helperText","inputProps","InputProps","withRemoveButton","onRemoveButtonClick","onChange","onEditingFinished","onFocus","onBlur","onKeyPress","validate","onError","onErrorResolve","error","adornment","adornmentPosition","debounce"]),T=Vs(o.a.useState(u||c),2),I=T[0],D=T[1],A=o.a.useCallback(function(e){var t=O(e);return t.isValid?N():x(t.error),t},[O,x,N]),q=o.a.useCallback(function(e){(D(e.target.value),j)||(!A(e.target.value).isValid&&i||y(e))},[A,y,j]),M=o.a.useCallback(function(e){e.stopPropagation(),Be(w)&&w()},[w]),F=o.a.useCallback(function(){var e=A(I);e.isValid&&Be(S)&&S(),e.isValid&&Be(E)&&E({target:{value:I}})},[I,A,S,E]);Object(js.a)(function(){a&&we.a(c)&&we.a(u)&&x("".concat(p," is required"))}),Object(Rs.a)(function(){j>0&&(!A(I).isValid&&i||y({target:{value:I}}))},j,[I,A,y]);var V=Ae(c)||l?c:I;return o.a.createElement(ks.a,qs({fullWidth:s,label:p,error:k,value:V,defaultValue:Ie(u)?u:void 0,type:m,inputProps:Ms({},h,{"data-testid":R["data-testid"]}),onChange:r?K.a(void 0):q,onClick:function(e){return e.stopPropagation()},onBlur:F,onFocus:M,onKeyPress:C,disabled:t,autoFocus:n,required:a,helperText:k||f,InputProps:v?Ms({},g,{endAdornment:o.a.createElement(Ts.a,{position:"end"},o.a.createElement(Is.a,{onClick:b,edge:"end","aria-label":"remove value"},o.a.createElement(As.a,null)))}):Object.assign({},g,_&&Fs({},"".concat(P,"Adornment"),o.a.createElement(Ts.a,{position:P},_)))},ts.a(["data-testid"],R)))};Ls.propTypes={disabled:Y.a.bool,autoFocus:Y.a.bool,required:Y.a.bool,readOnly:Y.a.bool,changeOnlyValidated:Y.a.bool,fullWidth:Y.a.bool,isNilable:Y.a.bool,value:Y.a.oneOfType([Y.a.string,Y.a.number]),defaultValue:Y.a.oneOfType([Y.a.string,Y.a.number]),label:Y.a.string.isRequired,type:Y.a.oneOf(["text","number","password","time"]),helperText:Y.a.string,inputProps:Y.a.object,InputProps:Y.a.shape({endAdornment:Y.a.node,startAdornment:Y.a.node}),withRemoveButton:Y.a.bool,onRemoveButtonClick:Y.a.func,onChange:Y.a.func,onEditingFinished:Y.a.func,onFocus:Y.a.func,onBlur:Y.a.func,onKeyPress:Y.a.func,validate:Y.a.func,onError:Y.a.func,onErrorResolve:Y.a.func,error:Y.a.string,adornment:Y.a.node,adornmentPosition:Y.a.oneOf(["start","end"]),debounce:Y.a.number,"data-testid":Y.a.string},Ls.defaultProps={disabled:!1,autoFocus:!1,required:!1,readOnly:!1,changeOnlyValidated:!1,fullWidth:!1,isNilable:!1,value:void 0,defaultValue:void 0,type:"text",helperText:"",inputProps:void 0,InputProps:void 0,withRemoveButton:!1,onRemoveButtonClick:K.a(),onChange:K.a(),onEditingFinished:K.a(),onFocus:K.a(),onBlur:void 0,onKeyPress:void 0,validate:K.a({isValid:!0}),onError:K.a(),onErrorResolve:K.a(),error:"",adornment:void 0,adornmentPosition:"end",debounce:0,"data-testid":void 0};var Ws=Ls,Hs=n(1429),Us=n(304),zs=n(480);function Gs(){return(Gs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Qs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Ks(e,t,n[t])})}return e}function Ks(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Js(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ys=["default","primary","secondary","inherit"],$s=Object(Us.a)(function(e){return Object(zs.a)({root:function(t){var n=t.color,a=t.isOutlined,r=t.isContained,o=t.size,i=t.width,s=t.fontWeight,l=t.variant,c=Ys.includes(n),u=c?[]:n.includes(".")&&n.split(".")||[n,"main"],p=!c&&Es.a(null,u,e.palette),d=s||"small"===o&&"text"!==l&&"400"||null;return Object.assign({outline:"none !important"},d&&{fontWeight:d},p&&r&&{color:"white",backgroundColor:p,borderColor:p},p&&a&&{color:p,borderColor:p},p&&!a&&!r&&{color:p},i&&{width:e.spacing(i)})}})}),Xs=function(e){var t=e.children,n=e.classes,a=e.color,r=e.onClick,i=e.variant,s=e.size,l=e.width,c=e.disabled,u=e.fullWidth,p=e.fontWeight,d=e.href,m=Js(e,["children","classes","color","onClick","variant","size","width","disabled","fullWidth","fontWeight","href"]),f=$s({color:a,isOutlined:"outlined"===i,isContained:"contained"===i,size:s,width:l,fontWeight:p,variant:i});return o.a.createElement(Hs.a,Gs({classes:Qs({},n,{root:an()(Ee.a("root",n),f.root)}),color:Ys.includes(a)?a:"default",variant:i,size:s,onClick:r,disabled:c,fullWidth:u,href:d},m),t)};Xs.propTypes={children:Y.a.node.isRequired,classes:Y.a.shape({root:Y.a.string,label:Y.a.string,text:Y.a.string,textPrimary:Y.a.string,textSecondary:Y.a.string,outlined:Y.a.string,outlinedPrimary:Y.a.string,outlinedSecondary:Y.a.string,contained:Y.a.string,containedPrimary:Y.a.string,containedSecondary:Y.a.string,focusVisible:Y.a.string,disabled:Y.a.string,colorInherit:Y.a.string,sizeSmall:Y.a.string,sizeLarge:Y.a.string,fullWidth:Y.a.string}),color:Y.a.oneOf(["default","primary","secondary","inherit","red","red.light","orange","orange.light"]),variant:Y.a.oneOf(["text","outlined","contained"]),size:Y.a.oneOf(["small","medium","large"]),disabled:Y.a.bool,fullWidth:Y.a.bool,fontWeight:qa,href:Y.a.string,onClick:Y.a.func,width:Y.a.number,"data-testid":Y.a.string},Xs.defaultProps={classes:void 0,color:"default",size:"medium",variant:"text",disabled:!1,fullWidth:!1,fontWeight:void 0,href:void 0,onClick:K.a(void 0),width:void 0,"data-testid":void 0};var Zs=Xs,el=n(574),tl=Se.a(function(e,t){var n=se.a(t);return e.reduce(function(t,n,a){return t&&a===e.length-1?(delete t[n],!0):t?t[n]:t},n),n});Se.a(function(e,t){return ve.a(function(e,t){return tl(Array.isArray(t)?t:[t],e)},t,e)});function nl(e){return(nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function al(){return(al=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function rl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){cl(e,t,n[t])})}return e}function ol(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function il(e){return(il=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ll(e,t){return(ll=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ul=Q.a(el.a("_"),xe.a),pl=function(e){var t=function(t){function n(){var e,t,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=il(n)).call.apply(e,[this].concat(i)),t=!r||"object"!==nl(r)&&"function"!=typeof r?sl(a):r,cl(sl(t),"state",{errors:{},areErrorsExists:!1}),cl(sl(t),"handleError",function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.setState(function(t){return{errors:rl({},t.errors,cl({},ul(n),e)),areErrorsExists:!0}})}}),cl(sl(t),"handleErrorResolve",function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return function(){t.setState(function(e){var t=e.errors,a=tl([ul(n)],t);return{errors:a,areErrorsExists:Ce.a(le.a(a))}})}}),t}var a,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ll(e,t)}(n,r.Component),a=n,(o=[{key:"render",value:function(){return r.createElement(e,al({onError:this.handleError,onErrorResolve:this.handleErrorResolve,areErrorsExists:this.state.areErrorsExists,errors:this.state.errors},this.props))}}])&&ol(a.prototype,o),i&&ol(a,i),n}();return t.displayName="withErrorHandler(".concat(e.name||e.displayName,")"),t},dl=n(14);function ml(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fl=function(e,t){return function(n){var a=n.result||{isValid:!0},r=e(n);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){ml(e,t,n[t])})}return e}({},n,{result:{isValid:a.isValid&&r,error:r?a.error:[a.error,t].join(" ")}})}},hl=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Q.a.apply(dl,[Ee.a("result")].concat(t))},gl=fl(function(e){var t=e.value;return qe(t)||/^[^#]*$/.test(t)},"Value should not include # symbol."),vl=hl(gl),bl=fl(function(e){var t=e.key;return qe(t)||/^[a-zA-Z]+[0-9_a-zA-Z]*$/.test(t)},"Key should start with character, not digit or special symbol."),yl=hl(bl);function El(e){return(El="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wl(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Sl(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Cl(e){return(Cl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ol(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xl(e,t){return(xl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){kl(e,t,n[t])})}return e}function kl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Q.a(Ne.a(function(t){return{key:t,value:e[t]}}),ue.a(Ai.a("_changed")),ye.a)(e)},Pl=function(e){return e.reduce(function(e,t){var n=t.key,a=t.value;return n?Nl({},e,kl({},n,a)):e},{})},jl={key:"",value:""},Rl=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Cl(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==El(r)&&"function"!=typeof r?Ol(a):r,kl(Ol(n),"state",{prevExtra:JSON.stringify(n.props.extra),extra:n.props.isArray?n.props.extra:_l(n.props.extra),isEditingValue:!1,focusedIndex:null}),kl(Ol(n),"getFieldErrorPath",function(e,t){return n.props.errorPath?[].concat(wl(n.props.errorPath),[e,t]):void 0}),kl(Ol(n),"getError",function(e,t){return n.props.errors&&n.props.errorPath?n.props.errors[ul(n.getFieldErrorPath(e,t))]:void 0}),kl(Ol(n),"setEditingValue",function(e){return function(){n.setState({isEditingValue:e})}}),kl(Ol(n),"handleValidate",function(e,t){return"key"===e&&yl({key:t})||"value"===e&&vl({value:t})||{isValid:!0}}),kl(Ol(n),"handleChange",function(e,t){return function(a){var r=a.target.value,o=Oi.a([t,e]),i="key"===e&&/^\d+.*$/.test(r)?r.slice(1):r,s=Oe.a(o,n.state.extra);if(Ae(s)&&n.handleErrorResolve(s,e)(),!qe(s)||!qe(i)){var l=n.handleValidate(e,i);l.isValid||n.handleError(i,e)(l.error)}n.setState(function(n){var a=n.extra;return{focusedIndex:t,extra:t<a.length?_s.a(o,i,a):[].concat(wl(a),[Nl({},jl,kl({},e,i))])}})}}),kl(Ol(n),"handleBlur",function(e){return function(){var t=e===n.state.extra.length?jl:n.state.extra[e];t.key||t.value?n.props.onChange(n.props.isArray?n.state.extra:Pl(n.state.extra)):n.handleRemove(e)}}),kl(Ol(n),"handleRemove",function(e){return function(){var t=n.state.extra.find(function(t,n){return n===e}).key;n.setState(function(t){return{extra:t.extra.filter(function(t,n){return n!==e})}},function(){n.props.isArray?n.props.onRemove(e):Be(n.props.onRemoveByKey)?n.props.onRemoveByKey(t):n.props.onChange(Pl(n.state.extra))})}}),kl(Ol(n),"handleError",function(e,t){return function(a){return n.props.onError&&n.props.errorPath?n.props.onError(n.getFieldErrorPath(e,t))(a):void 0}}),kl(Ol(n),"handleErrorResolve",function(e,t){return n.props.onErrorResolve&&n.props.errorPath?n.props.onErrorResolve(n.getFieldErrorPath(e,t)):K.a(void 0)}),kl(Ol(n),"renderKeyValueTextFields",function(e){var t=e===n.state.extra.length?"New key":"Key ".concat(e+1),a=e===n.state.extra.length?"New value":"Value ".concat(e+1),r=e===n.state.extra.length?jl:n.state.extra[e],i=r.key,s=r.value,l=n.props["data-testid"];return o.a.createElement(Ps.a,{container:!0,spacing:1,alignItems:"flex-end",key:e||"new"},o.a.createElement(Ps.a,{container:!0,item:!0,xs:10,spacing:1},o.a.createElement(Ps.a,{item:!0,xs:!0},o.a.createElement(Ws,{fullWidth:!0,label:t,value:i,type:"text","data-testid":l?"".concat(l,"Key#").concat(e):void 0,onChange:n.handleChange("key",e),onBlur:n.handleBlur(e),onFocus:n.setEditingValue(!1),autoFocus:!n.state.isEditingValue&&e===n.state.focusedIndex,error:n.getError(i,"key")})),o.a.createElement(Ps.a,{item:!0,xs:!0},o.a.createElement(Ws,{fullWidth:!0,label:a,value:s,type:"text","data-testid":l?"".concat(l,"Value#").concat(e):void 0,onChange:n.handleChange("value",e),onBlur:n.handleBlur(e),onFocus:n.setEditingValue(!0),autoFocus:n.state.isEditingValue&&e===n.state.focusedIndex,error:n.getError(s,"value")}))),o.a.createElement(Ps.a,{container:!0,item:!0,xs:2,justify:n.props.removeAlignEnd?"flex-end":"flex-start"},n.state.extra.length!==e&&o.a.createElement(Zs,{color:"red","data-testid":l?"".concat(l,"Remove#").concat(e):void 0,variant:n.props.removeVariant,size:n.props.removeSize,onClick:n.handleRemove(e)},"remove")))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xl(e,t)}(t,o.a.Component),n=t,r=[{key:"getDerivedStateFromProps",value:function(e,t){return Ce.a(me.a(e.extra,t.prevExtra))?{prevExtra:e.extra,extra:e.isArray?e.extra:_l(e.extra)}:{}}}],(a=[{key:"render",value:function(){var e=this;return o.a.createElement(Ps.a,{container:!0},o.a.createElement(Ps.a,{item:!0,xs:12},this.state.extra.map(function(t,n){return e.renderKeyValueTextFields(n)})),o.a.createElement(Ps.a,{item:!0,xs:12},this.renderKeyValueTextFields(this.state.extra.length)))}}])&&Sl(n.prototype,a),r&&Sl(n,r),t}();kl(Rl,"propTypes",{extra:ha()(Y.a.string).isRequired,isArray:Y.a.bool,onChange:Y.a.func.isRequired,onRemove:Y.a.func,onRemoveByKey:Y.a.func,onError:Y.a.func,onErrorResolve:Y.a.func,errors:ha()(Y.a.string),errorPath:Y.a.arrayOf(Y.a.string),removeVariant:Y.a.oneOf(["text","outlined","contained"]),removeAlignEnd:Y.a.bool,removeSize:Y.a.oneOf(["small","medium","large"]),"data-testid":Y.a.string}),kl(Rl,"defaultProps",{onRemove:K.a(void 0),onRemoveByKey:K.a(void 0),onError:K.a(void 0),onErrorResolve:K.a(void 0),errors:{},errorPath:void 0,isArray:!1,removeVariant:"text",removeAlignEnd:!1,removeSize:"medium","data-testid":void 0});var Tl=Rl;function Il(e){return(Il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Al(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ql(e){return(ql=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ml(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vl(e,t){return(Vl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ll=/https?:\/\/([^\/]+)\/stalker_portal\/server\/api\/chk_flussonic_tmp_link\.php/,Wl=/^securetoken:\/\//,Hl=/^iptv:\/\//,Ul=/^vsaas:\/\//,zl=/^auth:\/\//,Gl=function(e){return e?Ll.test(e)?"stalker":Wl.test(e)?"securetoken":Ul.test(e)?"vsaas":Hl.test(e)?"iptv":"custom":"none"},Ql=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=ql(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Il(r)&&"function"!=typeof r?Ml(a):r,Bl(Ml(n),"state",{urlType:Gl(n.props.media.auth.url||""),authBackendName:""}),Bl(Ml(n),"handleDisabledClick",function(){n.props.change(["auth","allowed_countries"],"raw")(null),n.props.change(["auth","disallowed_countries"],"raw")(null)}),Bl(Ml(n),"handleWhitelistClick",function(){n.props.change(["auth","allowed_countries"],"raw")([]),n.props.change(["auth","disallowed_countries"],"raw")(null)}),Bl(Ml(n),"handleBlacklistClick",function(){n.props.change(["auth","allowed_countries"],"raw")(null),n.props.change(["auth","disallowed_countries"],"raw")([])}),Bl(Ml(n),"handleStalkerHostnameChange",function(e){var t="http://".concat(e.target.value,"/stalker_portal/server/api/chk_flussonic_tmp_link.php");n.props.change(["auth","url"],"raw")(t)}),Bl(Ml(n),"handleSecuretokenChange",function(e){var t=e.target.value;n.props.change(["auth","url"],"raw")("securetoken://".concat(Ae(t)?t:""))}),Bl(Ml(n),"handleTypeChange",function(e){return function(){if(n.setState({urlType:e}),"iptv"===n.state.urlType&&n.props.change(["auth","url"],"raw")(""),"none"===e||"custom"===e)n.props.change(["auth","url"],"raw")(null),n.props.change(["auth","extra"],"raw")({});else if("iptv"===e){var t="".concat(window.location.protocol,"//localhost");window.location.port&&(t+=":".concat(window.location.port)),t+="/tv/auth",n.props.change(["auth","url"],"raw")(t)}else"securetoken"===e&&n.props.change(["auth","url"],"raw")("securetoken://")}}),Bl(Ml(n),"handleDomainsChange",function(e){var t=e.length?e:null;n.props.change(["auth","domains"],"raw")(t)}),Bl(Ml(n),"handleAllowedCountriesChange",function(e){n.props.change(["auth","allowed_countries"],"raw")(e)}),Bl(Ml(n),"handleDisallowedCountriesChange",function(e){n.props.change(["auth","disallowed_countries"],"raw")(e)}),Bl(Ml(n),"handleAuthBackendChange",function(e){var t=e.target.value;return n.props.change(["auth","url"],"raw")(t?"auth://".concat(t):"")}),Bl(Ml(n),"handleAuthBackendUrlChange",function(e){var t=e.target.value;return n.props.change(["auth","url"],"raw")(t)}),Bl(Ml(n),"handleExtraChange",function(e){n.props.change(["auth","extra"],"raw")(e)}),Bl(Ml(n),"handleExtraRemoveByKey",function(e){n.props.change(["auth","extra",e],"raw")(null)}),Bl(Ml(n),"renderTypeSelect",function(){return o.a.createElement(ea,{expanded:!0,label:"Authentication type"},[["none","none",!0],["custom","custom",!0],["stalker","stalker",!0],["securelink","securetoken",!0],["IPTV","iptv",!!n.props.media.name],["Watcher","vsaas",!!n.props.media.name]].map(function(e){var t=Dl(e,3),a=t[0],r=t[1];return t[2]&&o.a.createElement(ua,{key:r,label:a,onClick:n.handleTypeChange(r),checked:n.state.urlType===r,className:"margin-right-10",isRadio:!0})}))}),Bl(Ml(n),"renderStalker",function(){var e=(n.props.media.auth.url||"").match(Ll),t=e&&e[1]||"";return o.a.createElement(ea,{label:"Stalker hostname:port"},o.a.createElement(mn,{value:t,onChange:n.handleStalkerHostnameChange}))}),Bl(Ml(n),"renderSecureToken",function(){var e=Q.a(Ut.a,zt.a("//"),Es.a("",["media","auth","url"]));return o.a.createElement(ea,{label:"Securelink auth key"},o.a.createElement(mn,{value:e(n.props),onChange:n.handleSecuretokenChange}))}),Bl(Ml(n),"renderAuthScript",function(){if(["none","iptv"].includes(n.state.urlType))return null;if("stalker"===n.state.urlType)return n.renderStalker();if("securetoken"===n.state.urlType)return n.renderSecureToken();var e=zl.test(n.props.media.auth.url);return o.a.createElement("div",null,Ae(n.props.authBackends)&&o.a.createElement("div",{style:{marginBottom:32,marginTop:16}},o.a.createElement(xs.a,{htmlFor:"auth-backend",className:n.props.classes.inputLabel},"Auth backend"),o.a.createElement(Cs.a,{value:e?n.state.authBackendName:"",onChange:n.handleAuthBackendChange,input:o.a.createElement(Os.a,{id:"auth-backend"})},o.a.createElement(Ns.a,{value:""}),Object.keys(n.props.authBackends).map(function(e){return o.a.createElement(Ns.a,{key:e,value:e},e)}))),o.a.createElement(ks.a,{fullWidth:!0,label:"Auth backend url",value:n.props.media.auth.url,type:"text",onChange:n.handleAuthBackendUrlChange,"data-testid":"authBackendUrl"}),n.props.media.auth.url&&o.a.createElement("div",{className:"options-content"},o.a.createElement("div",{className:"left1"},o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"Specify extra params to pass"))),o.a.createElement("div",{className:"right2"},o.a.createElement(Tl,{extra:Es.a({},["media","auth","extra"],n.props),onChange:n.handleExtraChange,onRemoveByKey:n.handleExtraRemoveByKey}))))}),Bl(Ml(n),"renderCountriesTokenline",function(e){return e.allowed_countries&&o.a.createElement("div",{style:{flexGrow:1,marginTop:"10px"}},o.a.createElement(Zn,{value:e.allowed_countries,changed:e.allowed_countries_changed,separators:[","," "],onChange:n.handleAllowedCountriesChange}))||e.disallowed_countries&&o.a.createElement("div",{style:{flexGrow:1,marginTop:"10px"}},o.a.createElement(Zn,{value:e.disallowed_countries,changed:e.disallowed_countries_changed,separators:[","," "],onChange:n.handleDisallowedCountriesChange}))}),Bl(Ml(n),"render",function(){var e=n.props.media.auth||{};return o.a.createElement("div",null,n.renderTypeSelect(),n.renderAuthScript(),o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Allowed domains",details:"Limit on which domains embed.html may be played.",className:"auto-height"},o.a.createElement(Zn,{value:e.domains||[],onChange:n.handleDomainsChange,separators:[","," "]})),o.a.createElement(ea,{expanded:!0,label:"Limit access by country by IP address",details:"Specify countries by two-letter codes",className:"auto-height"},o.a.createElement("div",{style:{display:"flex",alignItems:"flex-start"}},o.a.createElement(ua,{label:"disabled",checked:!e.allowed_countries&&!e.disallowed_countries,onClick:n.handleDisabledClick,className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"whitelist",checked:!!e.allowed_countries,onClick:n.handleWhitelistClick,className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"blacklist",checked:!!e.disallowed_countries,onClick:n.handleBlacklistClick,className:"margin-right-10",isRadio:!0}),n.renderCountriesTokenline(e))))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vl(e,t)}(t,o.a.Component),n=t,r=[{key:"getDerivedStateFromProps",value:function(e){return{authBackendName:e.media.auth.url?(e.media.auth.url.split("//")||[])[1]:""}}}],(a=null)&&Al(n.prototype,a),r&&Al(n,r),t}();Bl(Ql,"propTypes",{media:Ia.isRequired,authBackends:Ba,change:Y.a.func.isRequired,classes:Y.a.shape({inputLabel:Y.a.string})}),Bl(Ql,"defaultProps",{classes:{},authBackends:void 0});var Kl=Ss()(function(){return{inputLabel:{margin:0}}})(Ql),Jl=n(1434),Yl=n(1435),$l=n(1436),Xl=n(1432),Zl=n(1433);n(1013);function ec(){return(ec=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function tc(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var nc={XS:"XS",S:"S",M:"M",L:"L"},ac=function(e){var t=e.id,n=e.type,a=e.className,r=e.label,i=e.size,s=e.appendix,l=e.disabled,c=e.required,u=e.value,p=e.onChange,d=e.onBlur,m=e.onFocus,f=e.setInputRef,h=e.placeholder,g=e.helper,v=e.children,b=tc(e,["id","type","className","label","size","appendix","disabled","required","value","onChange","onBlur","onFocus","setInputRef","placeholder","helper","children"]);return o.a.createElement("div",{className:an()(["inputFieldGroup",a,"inputFieldGroupWidth".concat(i)])},r&&t&&o.a.createElement(Xl.a,{for:t,className:an()("inputFieldGroupLabel",{inputFieldGroupLabelRequired:c})},r),o.a.createElement(Zl.a,ec({id:t,type:n,className:an()("inputFieldGroupInput",{inputFieldGroupInputTextArea:"textarea"===n}),placeholder:h,disabled:l,value:u,onChange:p,onBlur:d,onFocus:m,innerRef:f},b),v),s&&o.a.createElement("div",{className:"inputFieldGroupInputAppendix"},s),g&&o.a.createElement("div",{className:"inputFieldGroupHelper"},g))};ac.propTypes={id:Y.a.string,type:Y.a.oneOf(["text","number","select","password","textarea"]).isRequired,className:Y.a.string,label:Y.a.string,size:Y.a.oneOf([nc.S,nc.M,nc.L]),appendix:Y.a.string,placeholder:Y.a.string,helper:Y.a.string,disabled:Y.a.bool,required:Y.a.bool,value:Y.a.oneOfType([Y.a.string,Y.a.number]),onChange:Y.a.func.isRequired,onBlur:Y.a.func,onFocus:Y.a.func,setInputRef:Y.a.func,children:Y.a.node},ac.defaultProps={id:null,className:null,label:null,size:nc.S,value:void 0,appendix:null,placeholder:null,helper:null,disabled:!1,required:!1,onBlur:null,onFocus:null,setInputRef:null,children:null};var rc,oc=ac;n(1014);function ic(e){return(ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sc(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function lc(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function cc(e){return(cc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pc(e,t){return(pc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mc="disabled",fc="aes128",hc="sample_aes",gc="conax",vc="ezdrm",bc="ezdrm_classic",yc="pallycon",Ec="widevine",wc="keyos",Sc="gsdrm",Cc="irdeto",Oc="keyserver",xc="userkey",Nc="aes_key",kc="iv",_c="signer",Pc="content_id",jc="enc_token",Rc="user",Tc="password",Ic="ic_host",Dc="account_id",Ac="user_name",qc={meta:"meta",drm:"drm"},Mc={key:"drm_id",section:qc.meta},Fc={key:Oc,isRequired:!0,placeholder:"Key server url"},Vc=[Mc,{key:Rc,isRequired:!0},{key:Tc,isRequired:!0}],Bc=(dc(rc={},mc,{name:"disabled",value:null,options:[]}),dc(rc,fc,{name:"AES-128",value:fc,options:[Mc,Fc]}),dc(rc,hc,{name:"Sample AES",value:hc,options:[Mc,Fc]}),dc(rc,gc,{name:"Conax",value:"conax",options:[Mc,Fc]}),dc(rc,wc,{name:"BuyDRM KeyOS",value:wc,options:[Mc,{key:xc,isRequired:!0}]}),dc(rc,Ec,{name:"Widevine",value:Ec,options:[{key:Nc,isRequired:!0},{key:kc,isRequired:!0},{key:Pc},{key:_c,isRequiredIfNoOptions:[Oc],helper:"required if keyserver not passed"},{key:Oc,isRequiredNoOptions:[_c],helper:"required if signer not passed"}]}),dc(rc,vc,{name:"EzDRM",value:vc,options:Vc}),dc(rc,bc,{name:"EzDRM Classic",value:bc,options:Vc}),dc(rc,yc,{name:"PallyCon",value:yc,options:[Mc,{key:jc,isRequired:!0}]}),dc(rc,Sc,{name:"GS DRM",value:Sc,options:[Mc,{key:Oc,isRequired:!0}]}),dc(rc,Cc,{name:"Irdeto",value:Cc,options:[Mc,{key:Ic,isRequired:!0},{key:Dc,isRequired:!0},{key:Ac,isRequired:!0},{key:Tc,isRequired:!0}]}),rc),Lc=function(e){return!e},Wc="",Hc=function(e){return e&&e.vendor||Wc},Uc=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=cc(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==ic(r)&&"function"!=typeof r?uc(a):r,dc(uc(n),"state",{vendors:se.a(Bc)}),dc(uc(n),"isDrmValid",function(){var e=n.props.media.drm,t=n.state.vendors;return!e||!t[e.vendor]||t[e.vendor].options.every(function(t){return t.isRequired&&!!e[t.key]||t.isRequiredIfNoOptions&&t.isRequiredIfNoOptions.some(function(t){return!!e[t]})||!0})}),dc(uc(n),"handleVendorChange",function(e){var t=e.target.value,a=n.state.vendors;n.props.change("meta.drm_id","raw")(null),Lc(t)?n.props.change("drm","raw")(null):(n.props.media.drm&&Object.keys(n.props.media.drm).forEach(function(e){n.props.change("drm.".concat(e),"raw")(null)}),n.props.change("drm.vendor","raw")(a[t].value||null))}),dc(uc(n),"handleOptionChange",function(e,t,a){return function(r){var o=a?r:r.target.value;n.props.change("".concat(e,".").concat(t),"raw")(o)}}),dc(uc(n),"renderResourceId",function(){return n.props.media.type&&"standalone"===n.props.media.type?o.a.createElement(ea,{label:"DRM resource",details:"ID of this stream in DRM middleware"},o.a.createElement(mn,{value:n.props.media.drm?n.props.media.drm.resource_id:null,onChange:n.props.change("drm.resource_id","string"),changed:n.props.media.drm?n.props.media.drm.resource_id_changed:null})):null}),dc(uc(n),"renderOptions",function(){return o.a.createElement(Jl.a,{className:"MediaAuthDRMInputMultipleContainer"},n.props.media.drm&&n.state.vendors[n.props.media.drm.vendor]&&n.state.vendors[n.props.media.drm.vendor].options&&n.state.vendors[n.props.media.drm.vendor].options.map(function(e){var t=e.key,a=e.placeholder,r=e.section,i=void 0===r?qc.drm:r,s=e.isRequired,l=e.helper;return o.a.createElement(oc,{key:t,className:"MediaAuthDRMInput",required:s,helper:l,id:t,size:nc.L,label:t,type:"text",placeholder:a,value:Es.a("",[i,t],n.props.media),onChange:n.handleOptionChange(i,t)})}),n.renderResourceId())}),dc(uc(n),"renderVendorSelector",function(){return o.a.createElement(oc,{value:Hc(n.props.media.drm),onChange:n.handleVendorChange,type:"select"},Object.keys(n.state.vendors).map(function(e){return o.a.createElement("option",{key:n.state.vendors[e].name,value:n.state.vendors[e].value||Wc},n.state.vendors[e].name)}))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pc(e,t)}(t,o.a.Component),n=t,r=[{key:"getDerivedStateFromProps",value:function(e,t){var n=null;if(e.media.drm&&Object.keys(e.media.drm).length>0&&!Object.keys(t.vendors).includes(e.media.drm.vendor)){var a=t.vendors,r=Object.keys(e.media.drm);r.splice(r.indexOf("vendor"),1);var o=r.map(function(e){return{key:e,isRequired:!0}});e.media.meta&&e.media.meta.drm_id&&(o=[Mc].concat(sc(o))),a[e.media.drm.vendor]={name:e.media.drm.vendor,value:e.media.drm.vendor,options:o},n={vendors:a}}return n}}],(a=[{key:"render",value:function(){return o.a.createElement(Jl.a,{className:"MediaAuthDRMContainer"},o.a.createElement(Yl.a,null,o.a.createElement("p",{className:"MediaAuthDRMHeader"},"Require DRM authorization")),o.a.createElement(Yl.a,null,o.a.createElement($l.a,null,this.renderVendorSelector()),o.a.createElement($l.a,null,this.props.media.drm&&this.props.media.drm.vendor&&this.renderOptions())))}}])&&lc(n.prototype,a),r&&lc(n,r),t}();dc(Uc,"propTypes",{change:Y.a.func.isRequired,media:Y.a.shape({type:Y.a.string,drm:Y.a.shape({vendor:Y.a.string,resource_id:Y.a.string,resource_id_changed:Y.a.bool,keyserver:Y.a.string,keyserver_changed:Y.a.bool,user_keyserver:Y.a.string,user_keyserver_changed:Y.a.bool}),meta:Y.a.shape({drm_id:Y.a.string})}).isRequired});var zc=Uc,Gc=n(659),Qc=n.n(Gc);function Kc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jc(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Yc=function(e,t,n,a,r,o){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:3,l=arguments.length>8?arguments[8]:void 0;return function(c){var u=Ke(a,o),p=Q.a(xi.a([[Fe,r],[Ni.a,Si.a]]),Es.a(n,u)),d=p(e.config),m=p(e.delta),f=Q.a(Ce.a,le.a,Es.a({},["savingDeltas",t]))(e),h=c.isInitialSet?d:c.userDelta,g=!Ae(h),v=c.isInitialSet&&g&&i<s,b=He(ze(d),ze(h)),y=e.subscribersApprovedDelta[t]?{}:Ge(m,h);return l&&console.log("withConfig -> getStateFromConfigStore",{storeState:e,state:c,config:d,delta:m,conflictDelta:y,userDelta:h,isConfigChanged:b,isInitialSet:v,isSaving:f}),{config:d,delta:m,conflictDelta:y,userDelta:h,isConfigChanged:b,isInitialSet:v,isSaving:f}}},$c=function(e){return function(t){var n=t.config;return{userDelta:e,isConfigChanged:He(n,e)}}},Xc=function(e,t,n,a,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Si.a,i=[].concat(Jc(n),[a]),s=Oi.a(i),l=o(Oe.a(s,e)),c=Oi.a([].concat(Jc(n),[r]));return Q.a(xi.a([[K.a(Qe(s,t)),_s.a(s,null)],[Ni.a,tl(i)]]),_s.a(c,l))(e)},Zc=function(e,t){return function(n){var a=n.delta,r=n.userDelta,o=n.resolvedDelta,i=Oi.a(e),s=Oe.a(i,t?r:a),l=Oe.a(i,a);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Kc(e,t,n[t])})}return e}({},$c(_s.a(i,s,r)),{resolvedDelta:_s.a(i,l,o)})}};function eu(e){return(eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tu(){return(tu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function nu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){su(e,t,n[t])})}return e}function au(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ru(e){return(ru=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ou(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iu(e,t){return(iu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function su(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lu,cu,uu=!1,pu=(lu=a,cu=x,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Si.a;return function(r){var i=function(i){function s(){var n,r,o,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return o=this,i=(n=ru(s)).call.apply(n,[this].concat(c)),r=!i||"object"!==eu(i)&&"function"!=typeof i?ou(o):i,su(ou(r),"state",{config:t,delta:t,userDelta:t,conflictDelta:t,resolvedDelta:t,isConfigChanged:!1,isInitialSet:!0,isSaving:!1}),su(ou(r),"id",Qc()()),su(ou(r),"configWatcherCounter",0),su(ou(r),"configWatcherCounterMax",3),su(ou(r),"isMounted",!0),su(ou(r),"setStateFromConfigStore",function(n){r.isMounted&&r.setState(Yc(n,r.id,t,e,a,r.props,r.configWatcherCounter,r.configWatcherCounterMax,uu),function(){r.configWatcherCounter+=1})}),su(ou(r),"setUserDeltaAndIsConfigChanged",function(e,t){return r.setState($c(e),t)}),su(ou(r),"handleConfigValueChange",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:K.a();return function(a){var o=r.state,i=o.userDelta,s=o.config,l=Oi.a(e),c=Ie(a)&&_s.a(l,a,i)||Qe(l,s)&&_s.a(l,null,i)||tl(e,i);t&&r.setState({isInitialSet:!1}),r.setUserDeltaAndIsConfigChanged(c,n),uu&&console.log("withConfig.handleConfigValueChange",{stateConfig:s,stateUserDelta:i,rawValue:a,rawValueIsNotNil:Ie(a),rawValueExists:Qe(l,s),valueWithDeletedKey:tl(e,i),valuePath:e,shouldUnsetIsInitialSet:t,userDeltaWithUpdatedValue:c})}}),su(ou(r),"handleConfigValueDelete",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];r.handleConfigValueChange(e)(null),uu&&console.log("withConfig.handleConfigValueDelete",{valuePath:e})}),su(ou(r),"handleConfigValueNameChange",function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Si.a;if(t!==n){var o=Xc(r.state.userDelta,r.state.config,e,t,n,a);r.setUserDeltaAndIsConfigChanged(o),uu&&console.log("withConfig.handleConfigValueNameChange",{valuePath:e,valueName:t,newValueName:n,userDeltaWithChangedName:o})}}),su(ou(r),"handleConfigListElementDelete",function(e){var t=Ci.a(e),n=ke.a(t,r.state.userDelta),a=ke.a(t,r.state.config),o=_i(Ut.a(e)),i=ye.a(n).length-1,s=o===i?nu({},n,su({},o,null)):je(function(e,t){return _i(t)<=o?nu({},e,su({},t,n[t])):nu({},e,su({},_i(t)-1,null===n[t]?null:Ye(Es.a({},[_i(t)-1],a),n[t])))},su({},i,null))(n);uu&&console.log("handleConfigListElementDelete",{rawPath:e,listPath:t,elementId:o},s),r.handleConfigValueChange(t)(s)}),su(ou(r),"handleConfigReset",function(){r.setUserDeltaAndIsConfigChanged(r.state.config)}),su(ou(r),"handleConfigSave",function(){var t=r.state,n=t.userDelta,a=t.config,o=Oi.a(Ke(e,r.props)),i=null===n&&Ie(a)?null:Ge(n,a),s=_s.a(o,i,{});lu.waitForSavingDelta({id:r.id,savingDelta:s}),cu("/flussonic/api/modify_config",{method:"post",body:JSON.stringify(s)}),uu&&console.log("withConfig.handleConfigSave",{userDelta:n,stateConfig:a,savingDelta:i,diff:s})}),su(ou(r),"handleConflictResolve",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.setState(Zc(e,t))}),r}var l,c,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iu(e,t)}(s,o.a.Component),l=s,(c=[{key:"componentDidMount",value:function(){lu.subscribeToConfig(this.id),this.setStateFromConfigStore(lu.store.getState(),!0),lu.store.watch(this.setStateFromConfigStore)}},{key:"componentDidUpdate",value:function(e,n){var a=this.state,r=a.conflictDelta,o=a.resolvedDelta,i=a.delta,s=me.a(r,o),l=He(r,n.conflictDelta),c=He(o,n.resolvedDelta);s&&(l||c)&&lu.approveDelta(this.id),le.a(i)&&He(i,n.delta)&&this.setState({resolvedDelta:t})}},{key:"componentWillUnmount",value:function(){lu.unsubscribeFromConfig(this.id),this.isMounted=!1}},{key:"render",value:function(){var e=this.state,t=e.config,a=e.userDelta,i=e.conflictDelta,s=e.resolvedDelta,l=e.isConfigChanged,c=e.isSaving;return n?o.a.createElement(r,nu({},this.props,su({},n,{config:a,oldConfig:t,isConfigChanged:l,conflictDelta:i,resolvedDelta:s,onConflictResolve:this.handleConflictResolve,onConfigValueChange:this.handleConfigValueChange,onConfigValueDelete:this.handleConfigValueDelete,onConfigValueNameChange:this.handleConfigValueNameChange,onConfigListElementDelete:this.handleConfigListElementDelete,onConfigReset:this.handleConfigReset,onConfigSave:this.handleConfigSave,isSaving:c}))):o.a.createElement(r,tu({config:a,oldConfig:t,isConfigChanged:l,conflictDelta:i,resolvedDelta:s,onConflictResolve:this.handleConflictResolve,onConfigValueChange:this.handleConfigValueChange,onConfigValueDelete:this.handleConfigValueDelete,onConfigValueNameChange:this.handleConfigValueNameChange,onConfigListElementDelete:this.handleConfigListElementDelete,onConfigReset:this.handleConfigReset,onConfigSave:this.handleConfigSave,isSaving:c},ts.a(["config"],this.props)))}}])&&au(l.prototype,c),u&&au(l,u),s}();return su(i,"propTypes",{}),su(i,"defaultProps",{}),i.displayName="withSubconfig(".concat(r.name||r.displayName,")"),i}}),du=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me.a();return function(t){var n=o.a.memo(t,e);return n.displayName="withMemo(".concat(t.name||t.displayName,")"),n}};function mu(e){return(mu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fu(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function hu(e){return(hu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vu(e,t){return(vu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yu=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=hu(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==mu(r)&&"function"!=typeof r?gu(a):r,bu(gu(n),"mediaAuthDrmRef",o.a.createRef()),bu(gu(n),"isDrmValid",function(){return!!n.mediaAuthDrmRef.current&&n.mediaAuthDrmRef.current.isDrmValid()}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vu(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.subconfig,n=e.onConfigValueChange,a=e.isConfigSaving,r=e.isConfigChanged,i=e.onConfigSave,s=e.config;return s&&t?o.a.createElement("div",{"data-testid":"media-auth"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(Kl,{media:t,change:n,authBackends:s.auth_backends}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(zc,{ref:this.mediaAuthDrmRef,media:t,change:n}),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:!this.isDrmValid()||a||!r,onClick:this.isDrmValid()?i:K.a(void 0),className:"rect filled"}),o.a.createElement(ys,{running:a,className:"margin-left-10"}))),o.a.createElement("div",{className:"right-page margin-left-10"},o.a.createElement("div",{className:"row-height"}))),o.a.createElement("div",{className:"right-page-container"}))):null}}])&&fu(n.prototype,a),r&&fu(n,r),t}();bu(yu,"propTypes",{config:Qa,subconfig:Ia,isConfigChanged:Y.a.bool,onConfigValueChange:Y.a.func,onConfigSave:Y.a.func,isConfigSaving:Y.a.bool}),bu(yu,"defaultProps",{config:void 0,subconfig:void 0,isConfigChanged:!1,onConfigValueChange:function(){},onConfigSave:function(){},isConfigSaving:!1});var Eu=Q.a(es(yu.propTypes,[Ee.a("entity"),Ee.a("name")]),du())(yu);function wu(e){return(wu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Su(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Cu(e){return(Cu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ou(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xu(e,t){return(xu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ku=function(e){if(/^http:\/\//.test(e)){if(/\.m3u8$/.test(e))return"hls".concat(e.slice(4));if(/ts$/.test(e))return"tshttp".concat(e.slice(4));if(/\/udp\//.test(e))return"tshttp".concat(e.slice(4))}else if(/^https:\/\//.test(e)){if(/\.m3u8$/.test(e))return"hlss".concat(e.slice(5));if(/ts$/.test(e))return"tshttps".concat(e.slice(5));if(/\/udp\//.test(e))return"tshttps".concat(e.slice(5))}return e},_u=function(){},Pu=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Cu(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==wu(r)&&"function"!=typeof r?Ou(a):r,Nu(Ou(n),"state",{switchRequestRunning:!1,url:ku(n.props.url.url)}),Nu(Ou(n),"setStateSafe",n.setState.bind(Ou(n))),Nu(Ou(n),"onSwitchClick",function(){n.setStateSafe({switchRequestRunning:!0}),N.switchSource(n.props.media.name,n.state.url).then(function(){setTimeout(function(){n.setStateSafe({switchRequestRunning:!1})},3e3)})}),Nu(Ou(n),"onChange",function(e){e.preventDefault();var t=ku(e.target.value),a=JSON.parse(JSON.stringify(n.props.media.urls));a[n.props.index]?a[n.props.index].url=t:a[n.props.index]={url:t},n.props.change("urls","raw")(a),n.setStateSafe({url:ku(n.props.url.url)})}),Nu(Ou(n),"onBlur",function(){!n.state.url&&n.props.media.urls[n.props.index]&&n.delete()}),Nu(Ou(n),"delete",function(){var e=JSON.parse(JSON.stringify(n.props.media.urls));e.splice(n.props.index,1),n.props.change("urls","raw")(e)}),Nu(Ou(n),"errorMessage",function(){if(/^https?:\/\//.test(n.state.url))return"specify tshttp:// or hls:// protocol"}),Nu(Ou(n),"renderSwitchBlock",function(){var e=n.props.media.stats.url,t=n.state.url;return e===t?o.a.createElement("div",{className:"success-text underline"},"online"):t&&!n.props.media.stats.alive?o.a.createElement("div",{className:"underline"},"offline"):t&&!n.props.url.url_changed?o.a.createElement(ua,{label:"switch",disabled:n.state.switchRequestRunning,onClick:n.onSwitchClick}):t?o.a.createElement("div",{className:"underline"},"unsaved"):null}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xu(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){e.url.url!==this.props.url.url&&this.setStateSafe({url:ku(e.url.url)})}},{key:"componentWillUnmount",value:function(){this.setStateSafe=_u}},{key:"render",value:function(){var e={sourceIndex:this.props.index,mediaName:this.props.media.name},t=!this.state.url&&this.props.index===this.props.media.urls.length?"New URL":"URL ".concat(this.props.index+1),n=this.props.url.url_changed;return o.a.createElement("div",{className:"stream-input-url"},o.a.createElement("div",{className:"row-height flex-end switch-block margin-right-10"},this.renderSwitchBlock()),o.a.createElement(ea,{label:t,errorMessage:this.errorMessage()},o.a.createElement(mn,{onChange:this.onChange,changed:n,onBlur:this.onBlur,value:this.state.url,setRef:this.props.setInputRef,ref:this.props.setInputComponentRef})),this.state.url&&o.a.createElement("div",{className:an()(["row-height","flex-end","more-block","margin-left-10","margin-right-10"])},o.a.createElement(Et,{to:"stream-item-input-url-options",params:e,className:"action-button"},"options")),this.state.url&&o.a.createElement("div",{key:2,className:"row-height flex-end more-block margin-left-10"},o.a.createElement(ua,{label:"remove",className:"danger",onClick:this.delete})))}}])&&Su(n.prototype,a),r&&Su(n,r),t}();Nu(Pu,"propTypes",{index:Y.a.number.isRequired,url:Y.a.shape({url:Y.a.string.isRequired,url_changed:Y.a.bool}).isRequired,media:Y.a.shape({name:Y.a.string,urls:Y.a.arrayOf(Y.a.shape({url:Y.a.string})),stats:Y.a.shape({url:Y.a.string,alive:Y.a.bool})}).isRequired,change:Y.a.func.isRequired,setInputRef:Y.a.func,setInputComponentRef:Y.a.func}),Nu(Pu,"defaultProps",{setInputRef:_u,setInputComponentRef:_u});var ju=Pu;function Ru(e){return(Ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tu(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Iu(e){return(Iu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Du(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Au(e,t){return(Au=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mu=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Iu(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Ru(r)&&"function"!=typeof r?Du(a):r,qu(Du(n),"state",{isNewItemAdded:!1}),qu(Du(n),"lastItemInputRef",null),qu(Du(n),"newItemInputRef",null),qu(Du(n),"setLastItemInputRef",function(e){!e||n.lastItemInputRef&&!n.state.isNewItemAdded||(n.lastItemInputRef=e,n.state.isNewItemAdded&&n.setState({isNewItemAdded:!1}))}),qu(Du(n),"setNewItemInputComponentRef",function(e){e&&!n.newItemInputRef&&(n.newItemInputRef=e)}),qu(Du(n),"handleItemInput",function(e,t){return function(a){n.setState({isNewItemAdded:!0},function(){n.props.change(e,t)(a)})}}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Au(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidUpdate",value:function(e){if(this.props.list.length!==e.list.length){this.lastItemInputRef.focus();var t=this.lastItemInputRef.value;this.lastItemInputRef.value="",this.lastItemInputRef.value=t,this.newItemInputRef.resetValue()}}},{key:"render",value:function(){return(0,this.props.children)({setLastItemInputRef:this.setLastItemInputRef,setNewItemInputComponentRef:this.setNewItemInputComponentRef,handleItemInput:this.handleItemInput})}}])&&Tu(n.prototype,a),r&&Tu(n,r),t}();qu(Mu,"propTypes",{list:Y.a.arrayOf(Y.a.string),change:Y.a.func.isRequired,children:Y.a.func.isRequired}),qu(Mu,"defaultProps",{list:[]});var Fu=n(492),Vu=Object(Fu.SortableContainer)(function(e){var t=e.children;return o.a.createElement("div",null,t)});Vu.displayName="SortableContainer";var Bu=Object(Fu.SortableElement)(function(e){var t=e.children;return o.a.createElement("div",null,t)});Bu.displayName="SortableElement";var Lu=n(660),Wu=n.n(Lu);function Hu(e){return(Hu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uu(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function zu(e){return(zu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qu(e,t){return(Qu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ku(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ju=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=zu(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Hu(r)&&"function"!=typeof r?Gu(a):r,Ku(Gu(n),"state",{needpublish:!1}),Ku(Gu(n),"videoInitTimeout",null),Ku(Gu(n),"videoRef",null),Ku(Gu(n),"setVideoRef",function(e){!n.videoRef&&e&&(n.videoRef=e)}),Ku(Gu(n),"startPublishing",function(){var e=setTimeout(n.initIfVideoRefAvailable,0);n.setState({needpublish:!0}),n.videoInitTimeout=e}),Ku(Gu(n),"initIfVideoRefAvailable",function(){if(n.state.needpublish)if(n.videoRef)n.videoInitTimeout=null,n.publisher=new Wu.a.Publisher("".concat(E,"/").concat(n.props.name),{preview:n.videoRef,previewOptions:{autoplay:!0,controls:!0,muted:!0},constraints:{video:!0,audio:!0},onWebsocketClose:n.stopPublishing}),n.publisher.start({openPeerConnectionOptions:{getMediaOptions:{onGetUserMediaError:n.stopPublishing}}});else{var e=setTimeout(n.initIfVideoRefAvailable,50);n.videoInitTimeout=e}}),Ku(Gu(n),"stopPublishing",function(){if(n.videoRef)try{n.stopWebRTCVideo()}catch(e){console.error(e)}n.setState({needpublish:!1}),n.videoRef=null}),Ku(Gu(n),"stopWebRTCVideo",function(){n.publisher&&(n.publisher.stop(),n.publisher.destroy())}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qu(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){e.name!==this.props.name&&this.stopPublishing()}},{key:"componentWillUnmount",value:function(){this.stopWebRTCVideo()}},{key:"render",value:function(){var e=this.state.needpublish?o.a.createElement("div",{className:"labeled"},o.a.createElement("video",{ref:this.setVideoRef,width:"640",height:"480"})):null;return o.a.createElement("div",null,o.a.createElement(ea,{label:"WebRTC",expanded:!0},o.a.createElement(ua,{label:"Publish from webcam",className:"rect filled",disabled:this.state.needpublish,onClick:this.startPublishing}),o.a.createElement(ua,{label:"Stop publishing",className:"rect filled",disabled:!this.videoRef||!this.state.needpublish,onClick:this.stopPublishing})),e)}}])&&Uu(n.prototype,a),r&&Uu(n,r),t}();Ku(Ju,"propTypes",{name:Y.a.string.isRequired});var Yu=Ju;function $u(e){return($u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xu(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Zu(e){return(Zu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ep(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tp(e,t){return(tp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function np(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ap=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Zu(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==$u(r)&&"function"!=typeof r?ep(a):r,np(ep(n),"passwordQuery",function(){return n.props.media.password?"?password=".concat(n.props.media.password):""}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tp(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=Jt.httpHostPort(this.props.config),t=Jt.httpsHostPort(this.props.config),n=Jt.rtmpHostPort(this.props.config),a=Jt.rtspHostPort(this.props.config),r=o.a.createElement("div",{className:"row-height notice-text flex-end"},"RTMP is not configured, please enable it on ",o.a.createElement(Et,{to:"global-config"},"global config page"));if(n){var i=this.props.name.includes("/")?"":"static",s=this.props.media.prefix||i,l="".concat(n,"/").concat(s?"".concat(s,"/"):"").concat(this.props.name).concat(this.passwordQuery());r=o.a.createElement(ea,{label:"RTMP"},o.a.createElement(mn,{value:l,readOnly:!0,selectOnClick:!0}))}var c=o.a.createElement("div",{className:"row-height notice-text flex-end"},"RTSP is not configured, please enable it on ",o.a.createElement(Et,{to:"global-config"},"global config page"));if(a){var u="".concat(a,"/").concat(this.props.name).concat(this.passwordQuery());c=o.a.createElement(ea,{label:"RTSP"},o.a.createElement(mn,{value:u,readOnly:!0,selectOnClick:!0}))}var p=null;if(t){var d="".concat(t,"/").concat(this.props.name,"/mpegts").concat(this.passwordQuery());p=o.a.createElement(ea,{label:"HTTPS MPEG-TS"},o.a.createElement(mn,{value:d,readOnly:!0,selectOnClick:!0}))}var m=null;if(e){var f="".concat(e,"/").concat(this.props.name,"/mpegts").concat(this.passwordQuery());m=o.a.createElement(ea,{label:"HTTP MPEG-TS"},o.a.createElement(mn,{value:f,readOnly:!0,selectOnClick:!0}))}var h=null;return this.props.hideWebRTC||(h=o.a.createElement(Yu,{name:this.props.name})),o.a.createElement("div",null,m,p,c,r,h,o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Password",details:"Protect your publishing with password"},o.a.createElement(mn,{value:this.props.media.password,onChange:this.props.change("password","string"),changed:this.props.media.password_changed})),o.a.createElement(ea,{label:"Max bitrate",details:"Cap maximum allowed for publishing bitrate in Kbits per second"},o.a.createElement(mn,{value:this.props.media.max_bitrate,onChange:this.props.change("max_bitrate","integer"),changed:this.props.media.max_bitrate_changed})),o.a.createElement(ea,{label:"On publish script path",details:"This HTTP/Lua handler will be called on start and stop of publishing"},o.a.createElement(mn,{value:this.props.media.on_publish,onChange:this.props.change("on_publish","string"),changed:this.props.media.on_publish_changed})))}}])&&Xu(n.prototype,a),r&&Xu(n,r),t}();np(ap,"propTypes",{name:Y.a.string.isRequired,media:Y.a.object.isRequired,config:Y.a.object.isRequired,change:Y.a.func.isRequired,hideWebRTC:Y.a.bool}),np(ap,"defaultProps",{hideWebRTC:!1});var rp=ap,op=function(e){var t=e.media,n=e.config,a=e.change;return Zt.publishEnabled(t)?o.a.createElement("div",null,o.a.createElement(rp,{name:t.name,config:n,media:t,change:a}),o.a.createElement("div",{className:"row-height"})):null};op.displayName="PublishingBlock";var ip=op;function sp(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var lp=function(e){var t=e.array,n=e.oldIndex,a=e.newIndex,r=t[n];return[].concat(sp(t.slice(0,n)),sp(t.slice(n+1)),[void 0]).reduce(function(e,t,n){return[].concat(sp(e),n!==a?[t]:[r,t])},[]).slice(0,t.length)};function cp(e){return(cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function up(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function pp(e){return(pp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mp(e,t){return(mp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hp=function(){},gp=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=pp(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==cp(r)&&"function"!=typeof r?dp(a):r,fp(dp(n),"state",{newUrl:{url:""}}),fp(dp(n),"handleUrlsReorder",function(e){var t=e.oldIndex,a=e.newIndex,r=n.props,o=r.media,i=r.change,s=lp({array:o.urls,oldIndex:t,newIndex:a});i("urls","raw")(s)}),n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mp(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){var e=this,t=this.props,n=t.media,a=t.change,r=t.config,i=t.runningRequest,s=t.saveConfig,l=this.state.newUrl;return o.a.createElement("div",null,o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(Mu,{change:a,list:n.urls},function(t){var r=t.setLastItemInputRef,i=t.setNewItemInputComponentRef,s=t.handleItemInput;return o.a.createElement("div",null,o.a.createElement(Vu,{onSortEnd:e.handleUrlsReorder},n.urls.map(function(e,t){return o.a.createElement(Bu,{key:t,index:t},o.a.createElement(ju,{index:t,url:e,media:n,change:a,setInputRef:t===n.urls.length-1?r:hp}))})),o.a.createElement(ju,{index:n.urls.length,url:l,media:n,change:s,setInputComponentRef:i}))}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Source timeout",details:"How many seconds Flussonic should wait before considering source as dead"},o.a.createElement(hn,{value:n.source_timeout,changed:n.source_timeout_changed,onChange:a("source_timeout","raw"),units:[{label:"seconds",factor:1}]})),o.a.createElement(ea,{label:"Cluster key",details:"If one of your urls points to other Flussonic, it may require specify key for authorization"},o.a.createElement(mn,{value:n.cluster_key,onChange:a("cluster_key","string"),changed:n.cluster_key_changed})),o.a.createElement(ea,{label:"Fallback video",details:"If all your sources are dead, then mp4 file on this VOD/path will be played"},o.a.createElement(mn,{value:n.backup,onChange:a("backup","string"),changed:n.backup_changed}))),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{expanded:!0,label:"Published input",details:"Allow users to push video instead of streaming from particular url"},o.a.createElement(ua,{label:"accept",checked:Zt.publishEnabled(n),onClick:Zt.enablePublishing(n,a),className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"ignore",checked:!Zt.publishEnabled(n),onClick:Zt.disablePublishing(n,a),isRadio:!0})),o.a.createElement("div",{className:"row-height"}),o.a.createElement(ip,{media:n,config:r,change:a})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:i||!n.changed,onClick:s,className:"rect filled"}),o.a.createElement(ys,{running:i,className:"margin-left-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}}])&&up(n.prototype,a),i&&up(n,i),t}();fp(gp,"propTypes",{media:Y.a.shape({urls:Y.a.arrayOf(Y.a.shape({url:Y.a.string}))}),config:Y.a.any.isRequired,change:Y.a.func.isRequired,runningRequest:Y.a.bool,saveConfig:Y.a.func}),fp(gp,"defaultProps",{media:{urls:[]},runningRequest:!1,saveConfig:hp});var vp=gp,bp=n(367),yp=n(372),Ep=n(256);function wp(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Sp(e){return(Sp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Op(e,t){return(Op=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Np(e){return(Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var kp={priority:!0,user_agent:!0,source_timeout:!0,url:!0,buffer:!0,rtp:!0,tracks:!0,program:!0,pids:!0,dvbsubs_ocr:!0,allow_subtitles:!0},_p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=function(e){return"object"===Np(e)&&Object.keys(e).filter(function(e){return!kp[e]}).map(function(t){return{key:t,value:e[t]}})}(e)||[],a=t||[];return Q.a(bp.a(Ee.a("key")),Ne.a(function(e){return ce.a(a.find(function(t){return t.key===e.key}),e)}),yp.a(Ep.a,[Si.a,Si.a]))(n,a)},Pp=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Sp(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Np(r)&&"function"!=typeof r?Cp(a):r,xp(Cp(n),"state",{extra:null,isExtraChanged:!1,extraOrigin:_p(n.props.media.urls[n.props.sourceIndex]),shouldUpdateExtraOrigin:!1}),xp(Cp(n),"handleStrChange",function(e){return function(t){t.preventDefault();var a=n.props,r=a.sourceIndex,o=a.media,i=se.a(o.urls);t.target.value?i[r][e]=t.target.value:delete i[r][e],n.props.change("urls","raw")(i)}}),xp(Cp(n),"handleIntChange",function(e){return function(t){t.preventDefault();var a=n.props,r=a.sourceIndex,o=a.media,i=se.a(o.urls);t.target.value?i[r][e]=parseInt(t.target.value,10):delete i[r][e],n.props.change("urls","raw")(i)}}),xp(Cp(n),"handleRawChange",function(e){return function(t){var a=n.props,r=a.sourceIndex,o=a.media,i=se.a(o.urls);t?i[r][e]=t:delete i[r][e],n.props.change("urls","raw")(i)}}),xp(Cp(n),"handleBoolChange",function(e,t){return function(){var a=n.props,r=a.sourceIndex,o=a.media,i=se.a(o.urls);t?i[r][e]=t:delete i[r][e],n.props.change("urls","raw")(i)}}),xp(Cp(n),"handleRtpChange",function(e){return function(){var t=n.props,a=t.sourceIndex,r=t.media,o=se.a(r.urls);e?o[a].rtp="udp":delete o[a].rtp,n.props.change("urls","raw")(o)}}),xp(Cp(n),"handleMpegtsPidsChange",function(e){var t=n.props,a=t.sourceIndex,r=t.media,o=se.a(r.urls),i=e.target.value;if(i){var s=i.split(",").map(function(e){return parseInt(e,10)}).filter(function(e){return e>0&&e<8192}).join(",");","===Ut.a(i)&&(s+=","),o[a].pids=s}else delete o[a].pids;n.props.change("urls","raw")(o)}),xp(Cp(n),"handleExtraChange",function(e){n.setState({extra:e})}),xp(Cp(n),"handleConfigSave",function(){var e=se.a(n.props.media.urls),t=e[n.props.sourceIndex];n.state.extra.filter(function(e){return!kp[e.key]}).forEach(function(e){t[e.key]=e.value}),n.props.change("urls","raw")(e),n.props.saveConfig(function(){n.setState({shouldUpdateExtraOrigin:!0})})}),xp(Cp(n),"handleCustomOptionRemove",function(e){var t=se.a(n.props.media.urls);delete t[n.props.sourceIndex][n.state.extra[e].key],n.props.change("urls","raw")(t),n.setState(function(t){return{extra:t.extra.filter(function(t,n){return n!==e})}})}),xp(Cp(n),"renderHlsOptions",function(e){var t=e.url;return o.a.createElement("div",null,o.a.createElement(ea,{label:"HLS segments buffer",details:"Forces to collect extra N segments first. Useful for bad connectibity, but increases lag"},o.a.createElement(mn,{value:t.buffer,onChange:n.handleIntChange("buffer"),changed:t.buffer_changed,debounceInput:!1})),o.a.createElement("div",{className:"row-height"}))}),xp(Cp(n),"renderRtspOptions",function(e){var t=e.url;return o.a.createElement("div",null,o.a.createElement(ea,{expanded:!0,label:"RTP transport type",details:"Some cameras work good only on UDP"},o.a.createElement(ua,{label:"tcp",checked:!t.rtp,onClick:n.handleRtpChange(!1),className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"udp",checked:"udp"===t.rtp,onClick:n.handleRtpChange(!0),isRadio:!0})),o.a.createElement(ea,{label:"RTSP tracks",details:"Force to use specific track numbers"},o.a.createElement(mn,{value:t.tracks,onChange:n.handleStrChange("tracks"),changed:t.tracks_changed})),o.a.createElement("div",{className:"row-height"}))}),xp(Cp(n),"renderTsAllowSubtitles",function(){return o.a.createElement(ea,{expanded:!0,label:"Allow subtitles"},o.a.createElement(ua,{label:"enabled",onClick:n.handleBoolChange("allow_subtitles","true"),checked:"false"!==n.props.media.urls[n.props.sourceIndex].allow_subtitles,className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"disabled",onClick:n.handleBoolChange("allow_subtitles","false"),checked:"false"===n.props.media.urls[n.props.sourceIndex].allow_subtitles,isRadio:!0}))}),xp(Cp(n),"renderTsDvbSubtitlesOcr",function(){return o.a.createElement(ea,{expanded:!0,label:"Convert DVB subtitles to WebVTT"},o.a.createElement(ua,{label:"enabled",onClick:n.handleBoolChange("dvbsubs_ocr","true"),checked:"true"===n.props.media.urls[n.props.sourceIndex].dvbsubs_ocr,className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"disabled",onClick:n.handleBoolChange("dvbsubs_ocr","false"),checked:"true"!==n.props.media.urls[n.props.sourceIndex].dvbsubs_ocr,isRadio:!0}))}),xp(Cp(n),"renderTsOptions",function(e){var t=e.url;return o.a.createElement("div",null,n.renderTsAllowSubtitles(),n.renderTsDvbSubtitlesOcr(),o.a.createElement(ea,{label:"MPEG-TS program",details:"Select only specific program from MPTS MPEG-TS"},o.a.createElement(mn,{value:t.program,onChange:n.handleIntChange("program"),changed:t.program_changed})),o.a.createElement(ea,{label:"MPEG-TS pids",details:"Select only specific pids MPEG-TS"},o.a.createElement(mn,{value:t.pids,onChange:n.handleMpegtsPidsChange,changed:t.pids_changed})),o.a.createElement("div",{className:"row-height"}))}),xp(Cp(n),"renderSpecificOptions",function(e){var t=e.url,a=/([^:]+)/.exec(t.url),r=a&&a[1],o="hls"===r||t.buffer,i="rtsp"===r||"rtsp2"===r||t.rtp||t.tracks,s=["tshttp","tstcp","udp","udp1","udp2"].some(function(e){return r.includes(e)})||t.program||t.pids;return o&&n.renderHlsOptions({url:t})||i&&n.renderRtspOptions({url:t})||s&&n.renderTsOptions({url:t})||null}),n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Op(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.state,t=e.extra,n=e.isExtraChanged,a=this.props.media.urls[this.props.sourceIndex]||{},r=this.props.media.changed||n;return o.a.createElement("div",null,o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(Et,{to:"stream-item-input",params:{mediaName:this.props.media.name},className:"action-button"},"← back to input"),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("h1",{className:"head-text"},a.value)),o.a.createElement(ea,{label:"Priority",details:"How much this url is prefered over others. Lower number is more preffered"},o.a.createElement(mn,{value:a.priority,onChange:this.handleStrChange("priority"),changed:a.priority_changed,debounceInput:!1})),o.a.createElement(ea,{label:"Source timeout",details:"Specific timeout for this url"},o.a.createElement(hn,{value:a.source_timeout,onChange:this.handleRawChange("source_timeout"),changed:a.source_timeout_changed,debounceInput:!1,units:[{label:"seconds",factor:1}]})),o.a.createElement(ea,{label:"User-Agent",details:"Overriden HTTP header that used by Flussonic while fetching"},o.a.createElement(mn,{value:a.user_agent,onChange:this.handleStrChange("user_agent"),changed:this.props.media.user_agent_changed})),o.a.createElement("div",{className:"row-height"}),this.renderSpecificOptions({url:a}),o.a.createElement("div",{className:"options-content"},o.a.createElement("div",{className:"left1"},o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"Specify extra source params to pass"))),o.a.createElement("div",{className:"right2"},o.a.createElement(Tl,{isArray:!0,extra:t||{},onChange:this.handleExtraChange,onRemove:this.handleCustomOptionRemove}))),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:!r,onClick:this.handleConfigSave,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}}])&&wp(n.prototype,a),i&&wp(n,i),t}();xp(Pp,"propTypes",{media:Ia.isRequired,sourceIndex:Y.a.number.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,runningRequest:Y.a.bool}),xp(Pp,"defaultProps",{runningRequest:!1}),xp(Pp,"getDerivedStateFromProps",function(e,t){var n=_p(e.media.urls[e.sourceIndex],t.extra),a=t.shouldUpdateExtraOrigin?n:t.extraOrigin;return{extra:n,extraOrigin:a,isExtraChanged:!me.a(n,a),shouldUpdateExtraOrigin:!1}});var jp=Pp,Rp=Object(k.f)(function(e){return o.a.createElement(k.d,null,wt({extraProps:e,name:"stream-item-input-overview",component:vp,exact:!0}),wt({name:"stream-item-input-url-options",render:function(t){return o.a.createElement(jp,(n=e,a=t,Z()(n,{sourceIndex:{$set:parseInt(a.match.params.sourceIndex,10)},$merge:a})));var n,a}}))});function Tp(e){return(Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ip(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Dp(e,t){return!t||"object"!==Tp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ap(e){return(Ap=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qp(e,t){return(qp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fp=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Dp(this,Ap(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qp(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.resetChanges()}},{key:"render",value:function(){return o.a.createElement("div",{"data-testid":"stream-input"},o.a.createElement(Rp,{media:this.props.media,change:this.props.change,saveConfig:this.props.saveConfig,runningRequest:this.props.runningRequest,config:this.props.config}))}}])&&Ip(n.prototype,a),r&&Ip(n,r),t}();Mp(Fp,"propTypes",{media:Y.a.object.isRequired,config:Y.a.object.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool}),Mp(Fp,"defaultProps",{runningRequest:!1});var Vp=Fp;function Bp(e){return(Bp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lp(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Wp(e){return(Wp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Up(e,t){return(Up=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gp=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Wp(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Bp(r)&&"function"!=typeof r?Hp(a):r,zp(Hp(n),"disableOrEnable",function(){var e={streams:{}};e.streams[n.props.media.name]={disabled:!n.props.media.disabled},ft.save(e)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Up(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props.media.disabled?"enable":"disable",t=o.a.createElement(ua,{label:e,onClick:this.disableOrEnable}),n="row-height flex-end";return this.props.className&&(n+=" "+this.props.className),o.a.createElement("div",{className:n},t)}}])&&Lp(n.prototype,a),r&&Lp(n,r),t}();zp(Gp,"propTypes",{name:Y.a.string.isRequired,media:Y.a.object.isRequired,className:Y.a.string});var Qp=Gp,Kp=function(e){return e.width&&e.height&&" ".concat(e.width,"x").concat(e.height)||e.size&&" ".concat(e.size)||""},Jp=function(e,t){return"".concat(function(e){return"".concat(e.track_id," ").concat(e.codec," ").concat(e.content)}(e)).concat(Kp(e)).concat(function(e){return e?" (".concat(e.codec).concat(Kp(e),")"):""}(t))},Yp=function(e){var t=e.track,n=e.inputTrack;return o.a.createElement("div",{key:t.track_id,className:"margin-right-10 track track-".concat(t.content),style:{display:"inline-block"}},Jp(t,n))};Yp.propTypes={track:ba.isRequired,inputTrack:ba},Yp.defaultProps={inputTrack:void 0};var $p=Yp,Xp=function(e,t){return(t&&t.tracks||[]).find(function(t){return t.content===e.content})},Zp=function(e){var t=e.mediaInfo,n=e.inputMediaInfo;return t&&o.a.createElement("div",null,o.a.createElement(ea,{expanded:!0,label:"Media info"},t&&t.tracks&&t.tracks.map(function(e){return o.a.createElement($p,{key:e.track_id,track:e,inputTrack:Xp(e,n)})})),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).tracks;return(void 0===e?[]:e).some(function(e){return"mpeg2"===e.codec})}(t)&&o.a.createElement("div",{className:"notice-text"},"This track uses MPEG-2 codec and probably would not play in your browser.")))};Zp.propTypes={mediaInfo:Ea,inputMediaInfo:Ea},Zp.defaultProps={mediaInfo:null,inputMediaInfo:null};var ed=Zp,td=te.a.createStore({init:function(){this.listenTo(ae,this.onEvent),this.subscribers={}},onEvent:function(e){if("resubscribe"==e)for(var t in this.subscribers)ae.send("pulse_subscribe:"+t);else"pulse.traffic"==e.event&&this.trigger(e)},subscribe:function(e){this.subscribers[e]?this.subscribers[e]+=1:(ae.send("pulse_subscribe:"+e),this.subscribers[e]=1)},unsubscribe:function(e){this.subscribers[e]&&(this.subscribers[e]-=1),this.subscribers[e]<=0&&(ae.send("pulse_unsubscribe:"+e),delete this.subscribers[e])}}),nd=n(661),ad=function(e){function t(e,t){return t*Math.floor(e/t)}function n(e,t,n,a){if("function"==typeof e.strftime)return e.strftime(t);var r,o=function(e,t){return t=""+(null==t?"0":t),1==(e=""+e).length?t+e:e},i=[],s=!1,l=e.getHours(),c=l<12;null==n&&(n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),null==a&&(a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]),r=l>12?l-12:0==l?12:l;for(var u=0;u<t.length;++u){var p=t.charAt(u);if(s){switch(p){case"a":p=""+a[e.getDay()];break;case"b":p=""+n[e.getMonth()];break;case"d":p=o(e.getDate());break;case"e":p=o(e.getDate()," ");break;case"h":case"H":p=o(l);break;case"I":p=o(r);break;case"l":p=o(r," ");break;case"m":p=o(e.getMonth()+1);break;case"M":p=o(e.getMinutes());break;case"q":p=""+(Math.floor(e.getMonth()/3)+1);break;case"S":p=o(e.getSeconds());break;case"y":p=o(e.getFullYear()%100);break;case"Y":p=""+e.getFullYear();break;case"p":p=c?"am":"pm";break;case"P":p=c?"AM":"PM";break;case"w":p=""+e.getDay()}i.push(p),s=!1}else"%"==p?s=!0:i.push(p)}return i.join("")}function a(e){function t(e,t,n,a){e[t]=function(){return n[a].apply(n,arguments)}}var n={date:e};null!=e.strftime&&t(n,"strftime",e,"strftime"),t(n,"getTime",e,"getTime"),t(n,"setTime",e,"setTime");for(var a=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],r=0;r<a.length;r++)t(n,"get"+a[r],e,"getUTC"+a[r]),t(n,"set"+a[r],e,"setUTC"+a[r]);return n}function r(e,t){if("browser"==t.timezone)return new Date(e);if(t.timezone&&"utc"!=t.timezone){if("undefined"!=typeof timezoneJS&&void 0!==timezoneJS.Date){var n=new timezoneJS.Date;return n.setTimezone(t.timezone),n.setTime(e),n}return a(new Date(e))}return a(new Date(e))}var o={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,quarter:7776e6,year:525949.2*60*1e3},i=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],s=i.concat([[3,"month"],[6,"month"],[1,"year"]]),l=i.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);e.plot.plugins.push({init:function(a){a.hooks.processOptions.push(function(a,i){e.each(a.getAxes(),function(e,a){var i=a.options;"time"==i.mode&&(a.tickGenerator=function(e){var n=[],a=r(e.min,i),c=0,u=i.tickSize&&"quarter"===i.tickSize[1]||i.minTickSize&&"quarter"===i.minTickSize[1]?l:s;null!=i.minTickSize&&(c="number"==typeof i.tickSize?i.tickSize:i.minTickSize[0]*o[i.minTickSize[1]]);for(var p=0;p<u.length-1&&!(e.delta<(u[p][0]*o[u[p][1]]+u[p+1][0]*o[u[p+1][1]])/2&&u[p][0]*o[u[p][1]]>=c);++p);var d=u[p][0],m=u[p][1];if("year"==m){if(null!=i.minTickSize&&"year"==i.minTickSize[1])d=Math.floor(i.minTickSize[0]);else{var f=Math.pow(10,Math.floor(Math.log(e.delta/o.year)/Math.LN10)),h=e.delta/o.year/f;d=h<1.5?1:h<3?2:h<7.5?5:10,d*=f}d<1&&(d=1)}e.tickSize=i.tickSize||[d,m];var g=e.tickSize[0];m=e.tickSize[1];var v=g*o[m];"second"==m?a.setSeconds(t(a.getSeconds(),g)):"minute"==m?a.setMinutes(t(a.getMinutes(),g)):"hour"==m?a.setHours(t(a.getHours(),g)):"month"==m?a.setMonth(t(a.getMonth(),g)):"quarter"==m?a.setMonth(3*t(a.getMonth()/3,g)):"year"==m&&a.setFullYear(t(a.getFullYear(),g)),a.setMilliseconds(0),v>=o.minute&&a.setSeconds(0),v>=o.hour&&a.setMinutes(0),v>=o.day&&a.setHours(0),v>=4*o.day&&a.setDate(1),v>=2*o.month&&a.setMonth(t(a.getMonth(),3)),v>=2*o.quarter&&a.setMonth(t(a.getMonth(),6)),v>=o.year&&a.setMonth(0);var b,y=0,E=Number.NaN;do{if(b=E,E=a.getTime(),n.push(E),"month"==m||"quarter"==m)if(g<1){a.setDate(1);var w=a.getTime();a.setMonth(a.getMonth()+("quarter"==m?3:1));var S=a.getTime();a.setTime(E+y*o.hour+(S-w)*g),y=a.getHours(),a.setHours(0)}else a.setMonth(a.getMonth()+g*("quarter"==m?3:1));else"year"==m?a.setFullYear(a.getFullYear()+g):a.setTime(E+v)}while(E<e.max&&E!=b);return n},a.tickFormatter=function(e,t){var a=r(e,t.options);if(null!=i.timeformat)return n(a,i.timeformat,i.monthNames,i.dayNames);var s=t.options.tickSize&&"quarter"==t.options.tickSize[1]||t.options.minTickSize&&"quarter"==t.options.minTickSize[1],l=t.tickSize[0]*o[t.tickSize[1]],c=t.max-t.min,u=i.twelveHourClock?" %p":"",p=i.twelveHourClock?"%I":"%H";return n(a,l<o.minute?p+":%M:%S"+u:l<o.day?c<2*o.day?p+":%M"+u:"%b %d "+p+":%M"+u:l<o.month?"%b %d":s&&l<o.quarter||!s&&l<o.year?c<o.year?"%b":"%b %Y":s&&l<o.year?c<o.year?"Q%q":"Q%q %Y":"%Y",i.monthNames,i.dayNames)})})})},options:{xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}},name:"time",version:"1.0"}),e.plot.formatDate=n,e.plot.dateGenerator=r};function rd(e){return(rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var od=n.n(nd).a;od.color={},od.color.make=function(e,t,n,a){var r={};return r.r=e||0,r.g=t||0,r.b=n||0,r.a=null!=a?a:1,r.add=function(e,t){for(var n=0;n<e.length;++n)r[e.charAt(n)]+=t;return r.normalize()},r.scale=function(e,t){for(var n=0;n<e.length;++n)r[e.charAt(n)]*=t;return r.normalize()},r.toString=function(){return r.a>=1?"rgb("+[r.r,r.g,r.b].join(",")+")":"rgba("+[r.r,r.g,r.b,r.a].join(",")+")"},r.normalize=function(){function e(e,t,n){return t<e?e:t>n?n:t}return r.r=e(0,parseInt(r.r),255),r.g=e(0,parseInt(r.g),255),r.b=e(0,parseInt(r.b),255),r.a=e(0,r.a,1),r},r.clone=function(){return od.color.make(r.r,r.b,r.g,r.a)},r.normalize()},od.color.extract=function(e,t){var n;do{if(""!=(n=e.css(t).toLowerCase())&&"transparent"!=n)break;e=e.parent()}while(e.length&&!od.nodeName(e.get(0),"body"));return"rgba(0, 0, 0, 0)"==n&&(n="transparent"),od.color.parse(n)},od.color.parse=function(e){var t,n=od.color.make;if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10));if(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4]));if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return n(2.55*parseFloat(t[1]),2.55*parseFloat(t[2]),2.55*parseFloat(t[3]));if(t=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(2.55*parseFloat(t[1]),2.55*parseFloat(t[2]),2.55*parseFloat(t[3]),parseFloat(t[4]));if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return n(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return n(parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16));var a=od.trim(e).toLowerCase();return"transparent"==a?n(255,255,255,0):n((t=id[a]||[0,0,0])[0],t[1],t[2])};var id={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]},sd=Object.prototype.hasOwnProperty;function ld(e,t){var n=t.children("."+e)[0];if(null==n&&((n=document.createElement("canvas")).className=e,od(n).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(t),!n.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");n=window.G_vmlCanvasManager.initElement(n)}this.element=n;var a=this.context=n.getContext("2d"),r=window.devicePixelRatio||1,o=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;this.pixelRatio=r/o,this.resize(t.width(),t.height()),this.textContainer=null,this.text={},this._textCache={}}function cd(e,t,n,a){var r=[],o={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},i=null,s=null,l=null,c=null,u=null,p=[],d=[],m={left:0,right:0,top:0,bottom:0},f=0,h=0,g={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},v=this;function b(e,t){t=[v].concat(t);for(var n=0;n<e.length;++n)e[n].apply(this,t)}function y(e){r=function(e){for(var t=[],n=0;n<e.length;++n){var a=od.extend(!0,{},o.series);null!=e[n].data?(a.data=e[n].data,delete e[n].data,od.extend(!0,a,e[n]),e[n].data=a.data):a.data=e[n],t.push(a)}return t}(e),function(){var e,t=r.length,n=-1;for(e=0;e<r.length;++e){var a=r[e].color;null!=a&&(t--,"number"==typeof a&&a>n&&(n=a))}t<=n&&(t=n+1);var i,s=[],l=o.colors,c=l.length,u=0;for(e=0;e<t;e++)i=od.color.parse(l[e%c]||"#666"),e%c==0&&e&&(u=u>=0?u<.5?-u-.2:0:-u),s[e]=i.scale("rgb",1+u);var m,f=0;for(e=0;e<r.length;++e){if(null==(m=r[e]).color?(m.color=s[f].toString(),++f):"number"==typeof m.color&&(m.color=s[m.color].toString()),null==m.lines.show){var h,g=!0;for(h in m)if(m[h]&&m[h].show){g=!1;break}g&&(m.lines.show=!0)}null==m.lines.zero&&(m.lines.zero=!!m.lines.fill),m.xaxis=C(p,E(m,"x")),m.yaxis=C(d,E(m,"y"))}}(),function(){var e,t,n,a,o,i,s,l,c,u,p,d,m=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,h=Number.MAX_VALUE;function v(e,t,n){t<e.datamin&&t!=-h&&(e.datamin=t),n>e.datamax&&n!=h&&(e.datamax=n)}for(od.each(w(),function(e,t){t.datamin=m,t.datamax=f,t.used=!1}),e=0;e<r.length;++e)(o=r[e]).datapoints={points:[]},b(g.processRawData,[o,o.data,o.datapoints]);for(e=0;e<r.length;++e){if(o=r[e],p=o.data,!(d=o.datapoints.format)){if((d=[]).push({x:!0,number:!0,required:!0}),d.push({y:!0,number:!0,required:!0}),o.bars.show||o.lines.show&&o.lines.fill){var y=!!(o.bars.show&&o.bars.zero||o.lines.show&&o.lines.zero);d.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:y}),o.bars.horizontal&&(delete d[d.length-1].y,d[d.length-1].x=!0)}o.datapoints.format=d}if(null==o.datapoints.pointsize){o.datapoints.pointsize=d.length,s=o.datapoints.pointsize,i=o.datapoints.points;var E=o.lines.show&&o.lines.steps;for(o.xaxis.used=o.yaxis.used=!0,t=n=0;t<p.length;++t,n+=s){var S=null==(u=p[t]);if(!S)for(a=0;a<s;++a)l=u[a],(c=d[a])&&(c.number&&null!=l&&(l=+l,isNaN(l)?l=null:l==1/0?l=h:l==-1/0&&(l=-h)),null==l&&(c.required&&(S=!0),null!=c.defaultValue&&(l=c.defaultValue))),i[n+a]=l;if(S)for(a=0;a<s;++a)null!=(l=i[n+a])&&!1!==(c=d[a]).autoscale&&(c.x&&v(o.xaxis,l,l),c.y&&v(o.yaxis,l,l)),i[n+a]=null;else if(E&&n>0&&null!=i[n-s]&&i[n-s]!=i[n]&&i[n-s+1]!=i[n+1]){for(a=0;a<s;++a)i[n+s+a]=i[n+a];i[n+1]=i[n-s+1],n+=s}}}}for(e=0;e<r.length;++e)o=r[e],b(g.processDatapoints,[o,o.datapoints]);for(e=0;e<r.length;++e){o=r[e],i=o.datapoints.points,s=o.datapoints.pointsize,d=o.datapoints.format;var C=m,O=m,x=f,N=f;for(t=0;t<i.length;t+=s)if(null!=i[t])for(a=0;a<s;++a)l=i[t+a],(c=d[a])&&!1!==c.autoscale&&l!=h&&l!=-h&&(c.x&&(l<C&&(C=l),l>x&&(x=l)),c.y&&(l<O&&(O=l),l>N&&(N=l)));if(o.bars.show){var k;switch(o.bars.align){case"left":k=0;break;case"right":k=-o.bars.barWidth;break;default:k=-o.bars.barWidth/2}o.bars.horizontal?(O+=k,N+=k+o.bars.barWidth):(C+=k,x+=k+o.bars.barWidth)}v(o.xaxis,C,x),v(o.yaxis,O,N)}od.each(w(),function(e,t){t.datamin==m&&(t.datamin=null),t.datamax==f&&(t.datamax=null)})}()}function E(e,t){var n=e[t+"axis"];return"object"==rd(n)&&(n=n.n),"number"!=typeof n&&(n=1),n}function w(){return od.grep(p.concat(d),function(e){return e})}function S(e){var t,n,a={};for(t=0;t<p.length;++t)(n=p[t])&&n.used&&(a["x"+n.n]=n.c2p(e.left));for(t=0;t<d.length;++t)(n=d[t])&&n.used&&(a["y"+n.n]=n.c2p(e.top));return void 0!==a.x1&&(a.x=a.x1),void 0!==a.y1&&(a.y=a.y1),a}function C(e,t){return e[t-1]||(e[t-1]={n:t,direction:e==p?"x":"y",options:od.extend(!0,{},e==p?o.xaxis:o.yaxis)}),e[t-1]}function O(){D&&clearTimeout(D),l.unbind("mousemove",A),l.unbind("mouseleave",q),l.unbind("click",M),b(g.shutdown,[l])}function x(e){var t=e.labelWidth,n=e.labelHeight,a=e.options.position,r="x"===e.direction,s=e.options.tickLength,l=o.grid.axisMargin,c=o.grid.labelMargin,u=!0,f=!0,h=!0,g=!1;od.each(r?p:d,function(t,n){n&&(n.show||n.reserveSpace)&&(n===e?g=!0:n.options.position===a&&(g?f=!1:u=!1),g||(h=!1))}),f&&(l=0),null==s&&(s=h?"full":5),isNaN(+s)||(c+=+s),r?(n+=c,"bottom"==a?(m.bottom+=n+l,e.box={top:i.height-m.bottom,height:n}):(e.box={top:m.top+l,height:n},m.top+=n+l)):(t+=c,"left"==a?(e.box={left:m.left+l,width:t},m.left+=t+l):(m.right+=t+l,e.box={left:i.width-m.right,width:t})),e.position=a,e.tickLength=s,e.box.padding=c,e.innermost=u}function N(){var t,n=w(),a=o.grid.show;for(var s in m){var l=o.grid.margin||0;m[s]="number"==typeof l?l:l[s]||0}for(var s in b(g.processOffset,[m]),m)"object"==rd(o.grid.borderWidth)?m[s]+=a?o.grid.borderWidth[s]:0:m[s]+=a?o.grid.borderWidth:0;if(od.each(n,function(e,t){var n=t.options;t.show=null==n.show?t.used:n.show,t.reserveSpace=null==n.reserveSpace?t.show:n.reserveSpace,function(e){var t=e.options,n=+(null!=t.min?t.min:e.datamin),a=+(null!=t.max?t.max:e.datamax),r=a-n;if(0==r){var o=0==a?1:.01;null==t.min&&(n-=o),null!=t.max&&null==t.min||(a+=o)}else{var i=t.autoscaleMargin;null!=i&&(null==t.min&&(n-=r*i)<0&&null!=e.datamin&&e.datamin>=0&&(n=0),null==t.max&&(a+=r*i)>0&&null!=e.datamax&&e.datamax<=0&&(a=0))}e.min=n,e.max=a}(t)}),a){var c=od.grep(n,function(e){return e.show||e.reserveSpace});for(od.each(c,function(e,t){!function(e){var t,n=e.options;t="number"==typeof n.ticks&&n.ticks>0?n.ticks:.3*Math.sqrt("x"==e.direction?i.width:i.height);var a=(e.max-e.min)/t,r=-Math.floor(Math.log(a)/Math.LN10),o=n.tickDecimals;null!=o&&r>o&&(r=o);var s,l=Math.pow(10,-r),c=a/l;c<1.5?s=1:c<3?(s=2,c>2.25&&(null==o||r+1<=o)&&(s=2.5,++r)):s=c<7.5?5:10;s*=l,null!=n.minTickSize&&s<n.minTickSize&&(s=n.minTickSize);if(e.delta=a,e.tickDecimals=Math.max(0,null!=o?o:r),e.tickSize=n.tickSize||s,"time"==n.mode&&!e.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");e.tickGenerator||(e.tickGenerator=function(e){var t,n,a,r=[],o=(n=e.min,(a=e.tickSize)*Math.floor(n/a)),i=0,s=Number.NaN;do{t=s,s=o+i*e.tickSize,r.push(s),++i}while(s<e.max&&s!=t);return r},e.tickFormatter=function(e,t){var n=t.tickDecimals?Math.pow(10,t.tickDecimals):1,a=""+Math.round(e*n)/n;if(null!=t.tickDecimals){var r=a.indexOf("."),o=-1==r?0:a.length-r-1;if(o<t.tickDecimals)return(o?a:a+".")+(""+n).substr(1,t.tickDecimals-o)}return a});od.isFunction(n.tickFormatter)&&(e.tickFormatter=function(e,t){return""+n.tickFormatter(e,t)});if(null!=n.alignTicksWithAxis){var u=("x"==e.direction?p:d)[n.alignTicksWithAxis-1];if(u&&u.used&&u!=e){var m=e.tickGenerator(e);if(m.length>0&&(null==n.min&&(e.min=Math.min(e.min,m[0])),null==n.max&&m.length>1&&(e.max=Math.max(e.max,m[m.length-1]))),e.tickGenerator=function(e){var t,n,a=[];for(n=0;n<u.ticks.length;++n)t=(u.ticks[n].v-u.min)/(u.max-u.min),t=e.min+t*(e.max-e.min),a.push(t);return a},!e.mode&&null==n.tickDecimals){var f=Math.max(0,1-Math.floor(Math.log(e.delta)/Math.LN10)),h=e.tickGenerator(e);h.length>1&&/\..*0$/.test((h[1]-h[0]).toFixed(f))||(e.tickDecimals=f)}}}}(t),function(e){var t,n,a=e.options.ticks,r=[];null==a||"number"==typeof a&&a>0?r=e.tickGenerator(e):a&&(r=od.isFunction(a)?a(e):a);for(e.ticks=[],t=0;t<r.length;++t){var o=null,i=r[t];"object"==rd(i)?(n=+i[0],i.length>1&&(o=i[1])):n=+i,null==o&&(o=e.tickFormatter(n,e)),isNaN(n)||e.ticks.push({v:n,label:o})}}(t),function(e,t){e.options.autoscaleMargin&&t.length>0&&(null==e.options.min&&(e.min=Math.min(e.min,t[0].v)),null==e.options.max&&t.length>1&&(e.max=Math.max(e.max,t[t.length-1].v)))}(t,t.ticks),function(e){for(var t=e.options,n=e.ticks||[],a=t.labelWidth||0,r=t.labelHeight||0,o=a||("x"==e.direction?Math.floor(i.width/(n.length||1)):null),s=e.direction+"Axis "+e.direction+e.n+"Axis",l="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+s,c=t.font||"flot-tick-label tickLabel",u=0;u<n.length;++u){var p=n[u];if(p.label){var d=i.getTextInfo(l,p.label,c,null,o);a=Math.max(a,d.width),r=Math.max(r,d.height)}}e.labelWidth=t.labelWidth||a,e.labelHeight=t.labelHeight||r}(t)}),t=c.length-1;t>=0;--t)x(c[t]);!function(){var e,t=o.grid.minBorderMargin;if(null==t)for(t=0,e=0;e<r.length;++e)t=Math.max(t,2*(r[e].points.radius+r[e].points.lineWidth/2));var n={left:t,right:t,top:t,bottom:t};od.each(w(),function(e,t){t.reserveSpace&&t.ticks&&t.ticks.length&&("x"===t.direction?(n.left=Math.max(n.left,t.labelWidth/2),n.right=Math.max(n.right,t.labelWidth/2)):(n.bottom=Math.max(n.bottom,t.labelHeight/2),n.top=Math.max(n.top,t.labelHeight/2)))}),m.left=Math.ceil(Math.max(n.left,m.left)),m.right=Math.ceil(Math.max(n.right,m.right)),m.top=Math.ceil(Math.max(n.top,m.top)),m.bottom=Math.ceil(Math.max(n.bottom,m.bottom))}(),od.each(c,function(e,t){!function(e){"x"==e.direction?(e.box.left=m.left-e.labelWidth/2,e.box.width=i.width-m.left-m.right+e.labelWidth):(e.box.top=m.top-e.labelHeight/2,e.box.height=i.height-m.bottom-m.top+e.labelHeight)}(t)})}f=i.width-m.left-m.right,h=i.height-m.bottom-m.top,od.each(n,function(e,t){!function(e){function t(e){return e}var n,a,r=e.options.transform||t,o=e.options.inverseTransform;"x"==e.direction?(n=e.scale=f/Math.abs(r(e.max)-r(e.min)),a=Math.min(r(e.max),r(e.min))):(n=-(n=e.scale=h/Math.abs(r(e.max)-r(e.min))),a=Math.max(r(e.max),r(e.min))),e.p2c=r==t?function(e){return(e-a)*n}:function(e){return(r(e)-a)*n},e.c2p=o?function(e){return o(a+e/n)}:function(e){return a+e/n}}(t)}),a&&od.each(w(),function(e,t){var n,a,r,o,s,l=t.box,c=t.direction+"Axis "+t.direction+t.n+"Axis",u="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+c,p=t.options.font||"flot-tick-label tickLabel";if(i.removeText(u),t.show&&0!=t.ticks.length)for(var d=0;d<t.ticks.length;++d)!(n=t.ticks[d]).label||n.v<t.min||n.v>t.max||("x"==t.direction?(o="center",a=m.left+t.p2c(n.v),"bottom"==t.position?r=l.top+l.padding:(r=l.top+l.height-l.padding,s="bottom")):(s="middle",r=m.top+t.p2c(n.v),"left"==t.position?(a=l.left+l.width-l.padding,o="right"):a=l.left+l.padding),i.addText(u,a,r,n.label,p,null,null,o,s))}),function(){null!=o.legend.container?od(o.legend.container).html(""):e.find(".legend").remove();if(!o.legend.show)return;for(var t,n,a=[],i=[],s=!1,l=o.legend.labelFormatter,c=0;c<r.length;++c)(t=r[c]).label&&(n=l?l(t.label,t):t.label)&&i.push({label:n,color:t.color});if(o.legend.sorted)if(od.isFunction(o.legend.sorted))i.sort(o.legend.sorted);else if("reverse"==o.legend.sorted)i.reverse();else{var u="descending"!=o.legend.sorted;i.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=u?1:-1})}for(var c=0;c<i.length;++c){var p=i[c];c%o.legend.noColumns==0&&(s&&a.push("</tr>"),a.push("<tr>"),s=!0),a.push('<td class="legendColorBox"><div style="border:1px solid '+o.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+p.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+p.label+"</td>")}s&&a.push("</tr>");if(0==a.length)return;var d='<table style="font-size:smaller;color:'+o.grid.color+'">'+a.join("")+"</table>";if(null!=o.legend.container)od(o.legend.container).html(d);else{var f="",h=o.legend.position,g=o.legend.margin;null==g[0]&&(g=[g,g]),"n"==h.charAt(0)?f+="top:"+(g[1]+m.top)+"px;":"s"==h.charAt(0)&&(f+="bottom:"+(g[1]+m.bottom)+"px;"),"e"==h.charAt(1)?f+="right:"+(g[0]+m.right)+"px;":"w"==h.charAt(1)&&(f+="left:"+(g[0]+m.left)+"px;");var v=od('<div class="legend">'+d.replace('style="','style="position:absolute;'+f+";")+"</div>").appendTo(e);if(0!=o.legend.backgroundOpacity){var b=o.legend.backgroundColor;null==b&&((b=(b=o.grid.backgroundColor)&&"string"==typeof b?od.color.parse(b):od.color.extract(v,"background-color")).a=1,b=b.toString());var y=v.children();od('<div style="position:absolute;width:'+y.width()+"px;height:"+y.height()+"px;"+f+"background-color:"+b+';"> </div>').prependTo(v).css("opacity",o.legend.backgroundOpacity)}}}()}function k(){i.clear(),b(g.drawBackground,[c]);var e=o.grid;e.show&&e.backgroundColor&&(c.save(),c.translate(m.left,m.top),c.fillStyle=G(o.grid.backgroundColor,h,0,"rgba(255, 255, 255, 0)"),c.fillRect(0,0,f,h),c.restore()),e.show&&!e.aboveData&&P();for(var t=0;t<r.length;++t)b(g.drawSeries,[c,r[t]]),j(r[t]);b(g.draw,[c]),e.show&&e.aboveData&&P(),i.render(),V()}function _(e,t){for(var n,a,r,o,i=w(),s=0;s<i.length;++s)if((n=i[s]).direction==t&&(e[o=t+n.n+"axis"]||1!=n.n||(o=t+"axis"),e[o])){a=e[o].from,r=e[o].to;break}if(e[o]||(n="x"==t?p[0]:d[0],a=e[t+"1"],r=e[t+"2"]),null!=a&&null!=r&&a>r){var l=a;a=r,r=l}return{from:a,to:r,axis:n}}function P(){var e,t,n,a;c.save(),c.translate(m.left,m.top);var r=o.grid.markings;if(r)for(od.isFunction(r)&&((t=v.getAxes()).xmin=t.xaxis.min,t.xmax=t.xaxis.max,t.ymin=t.yaxis.min,t.ymax=t.yaxis.max,r=r(t)),e=0;e<r.length;++e){var i=r[e],s=_(i,"x"),l=_(i,"y");if(null==s.from&&(s.from=s.axis.min),null==s.to&&(s.to=s.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),!(s.to<s.axis.min||s.from>s.axis.max||l.to<l.axis.min||l.from>l.axis.max)){s.from=Math.max(s.from,s.axis.min),s.to=Math.min(s.to,s.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max);var u=s.from===s.to,p=l.from===l.to;if(!u||!p)if(s.from=Math.floor(s.axis.p2c(s.from)),s.to=Math.floor(s.axis.p2c(s.to)),l.from=Math.floor(l.axis.p2c(l.from)),l.to=Math.floor(l.axis.p2c(l.to)),u||p){var d=i.lineWidth||o.grid.markingsLineWidth,g=d%2?.5:0;c.beginPath(),c.strokeStyle=i.color||o.grid.markingsColor,c.lineWidth=d,u?(c.moveTo(s.to+g,l.from),c.lineTo(s.to+g,l.to)):(c.moveTo(s.from,l.to+g),c.lineTo(s.to,l.to+g)),c.stroke()}else c.fillStyle=i.color||o.grid.markingsColor,c.fillRect(s.from,l.to,s.to-s.from,l.from-l.to)}}t=w(),n=o.grid.borderWidth;for(var b=0;b<t.length;++b){var y,E,S,C,O=t[b],x=O.box,N=O.tickLength;if(O.show&&0!=O.ticks.length){for(c.lineWidth=1,"x"==O.direction?(y=0,E="full"==N?"top"==O.position?0:h:x.top-m.top+("top"==O.position?x.height:0)):(E=0,y="full"==N?"left"==O.position?0:f:x.left-m.left+("left"==O.position?x.width:0)),O.innermost||(c.strokeStyle=O.options.color,c.beginPath(),S=C=0,"x"==O.direction?S=f+1:C=h+1,1==c.lineWidth&&("x"==O.direction?E=Math.floor(E)+.5:y=Math.floor(y)+.5),c.moveTo(y,E),c.lineTo(y+S,E+C),c.stroke()),c.strokeStyle=O.options.tickColor,c.beginPath(),e=0;e<O.ticks.length;++e){var k=O.ticks[e].v;S=C=0,isNaN(k)||k<O.min||k>O.max||"full"==N&&("object"==rd(n)&&n[O.position]>0||n>0)&&(k==O.min||k==O.max)||("x"==O.direction?(y=O.p2c(k),C="full"==N?-h:N,"top"==O.position&&(C=-C)):(E=O.p2c(k),S="full"==N?-f:N,"left"==O.position&&(S=-S)),1==c.lineWidth&&("x"==O.direction?y=Math.floor(y)+.5:E=Math.floor(E)+.5),c.moveTo(y,E),c.lineTo(y+S,E+C))}c.stroke()}}n&&(a=o.grid.borderColor,"object"==rd(n)||"object"==rd(a)?("object"!==rd(n)&&(n={top:n,right:n,bottom:n,left:n}),"object"!==rd(a)&&(a={top:a,right:a,bottom:a,left:a}),n.top>0&&(c.strokeStyle=a.top,c.lineWidth=n.top,c.beginPath(),c.moveTo(0-n.left,0-n.top/2),c.lineTo(f,0-n.top/2),c.stroke()),n.right>0&&(c.strokeStyle=a.right,c.lineWidth=n.right,c.beginPath(),c.moveTo(f+n.right/2,0-n.top),c.lineTo(f+n.right/2,h),c.stroke()),n.bottom>0&&(c.strokeStyle=a.bottom,c.lineWidth=n.bottom,c.beginPath(),c.moveTo(f+n.right,h+n.bottom/2),c.lineTo(0,h+n.bottom/2),c.stroke()),n.left>0&&(c.strokeStyle=a.left,c.lineWidth=n.left,c.beginPath(),c.moveTo(0-n.left/2,h+n.bottom),c.lineTo(0-n.left/2,0),c.stroke())):(c.lineWidth=n,c.strokeStyle=o.grid.borderColor,c.strokeRect(-n/2,-n/2,f+n,h+n))),c.restore()}function j(e){e.lines.show&&function(e){function t(e,t,n,a,r){var o=e.points,i=e.pointsize,s=null,l=null;c.beginPath();for(var u=i;u<o.length;u+=i){var p=o[u-i],d=o[u-i+1],m=o[u],f=o[u+1];if(null!=p&&null!=m){if(d<=f&&d<r.min){if(f<r.min)continue;p=(r.min-d)/(f-d)*(m-p)+p,d=r.min}else if(f<=d&&f<r.min){if(d<r.min)continue;m=(r.min-d)/(f-d)*(m-p)+p,f=r.min}if(d>=f&&d>r.max){if(f>r.max)continue;p=(r.max-d)/(f-d)*(m-p)+p,d=r.max}else if(f>=d&&f>r.max){if(d>r.max)continue;m=(r.max-d)/(f-d)*(m-p)+p,f=r.max}if(p<=m&&p<a.min){if(m<a.min)continue;d=(a.min-p)/(m-p)*(f-d)+d,p=a.min}else if(m<=p&&m<a.min){if(p<a.min)continue;f=(a.min-p)/(m-p)*(f-d)+d,m=a.min}if(p>=m&&p>a.max){if(m>a.max)continue;d=(a.max-p)/(m-p)*(f-d)+d,p=a.max}else if(m>=p&&m>a.max){if(p>a.max)continue;f=(a.max-p)/(m-p)*(f-d)+d,m=a.max}p==s&&d==l||c.moveTo(a.p2c(p)+t,r.p2c(d)+n),s=m,l=f,c.lineTo(a.p2c(m)+t,r.p2c(f)+n)}}c.stroke()}c.save(),c.translate(m.left,m.top),c.lineJoin="round";var n=e.lines.lineWidth,a=e.shadowSize;if(n>0&&a>0){c.lineWidth=a,c.strokeStyle="rgba(0,0,0,0.1)";var r=Math.PI/18;t(e.datapoints,Math.sin(r)*(n/2+a/2),Math.cos(r)*(n/2+a/2),e.xaxis,e.yaxis),c.lineWidth=a/2,t(e.datapoints,Math.sin(r)*(n/2+a/4),Math.cos(r)*(n/2+a/4),e.xaxis,e.yaxis)}c.lineWidth=n,c.strokeStyle=e.color;var o=T(e.lines,e.color,0,h);o&&(c.fillStyle=o,function(e,t,n){var a=e.points,r=e.pointsize,o=Math.min(Math.max(0,n.min),n.max),i=0,s=!1,l=1,u=0,p=0;for(;!(r>0&&i>a.length+r);){var d=a[(i+=r)-r],m=a[i-r+l],f=a[i],h=a[i+l];if(s){if(r>0&&null!=d&&null==f){p=i,r=-r,l=2;continue}if(r<0&&i==u+r){c.fill(),s=!1,l=1,i=u=p+(r=-r);continue}}if(null!=d&&null!=f){if(d<=f&&d<t.min){if(f<t.min)continue;m=(t.min-d)/(f-d)*(h-m)+m,d=t.min}else if(f<=d&&f<t.min){if(d<t.min)continue;h=(t.min-d)/(f-d)*(h-m)+m,f=t.min}if(d>=f&&d>t.max){if(f>t.max)continue;m=(t.max-d)/(f-d)*(h-m)+m,d=t.max}else if(f>=d&&f>t.max){if(d>t.max)continue;h=(t.max-d)/(f-d)*(h-m)+m,f=t.max}if(s||(c.beginPath(),c.moveTo(t.p2c(d),n.p2c(o)),s=!0),m>=n.max&&h>=n.max)c.lineTo(t.p2c(d),n.p2c(n.max)),c.lineTo(t.p2c(f),n.p2c(n.max));else if(m<=n.min&&h<=n.min)c.lineTo(t.p2c(d),n.p2c(n.min)),c.lineTo(t.p2c(f),n.p2c(n.min));else{var g=d,v=f;m<=h&&m<n.min&&h>=n.min?(d=(n.min-m)/(h-m)*(f-d)+d,m=n.min):h<=m&&h<n.min&&m>=n.min&&(f=(n.min-m)/(h-m)*(f-d)+d,h=n.min),m>=h&&m>n.max&&h<=n.max?(d=(n.max-m)/(h-m)*(f-d)+d,m=n.max):h>=m&&h>n.max&&m<=n.max&&(f=(n.max-m)/(h-m)*(f-d)+d,h=n.max),d!=g&&c.lineTo(t.p2c(g),n.p2c(m)),c.lineTo(t.p2c(d),n.p2c(m)),c.lineTo(t.p2c(f),n.p2c(h)),f!=v&&(c.lineTo(t.p2c(f),n.p2c(h)),c.lineTo(t.p2c(v),n.p2c(h)))}}}}(e.datapoints,e.xaxis,e.yaxis));n>0&&t(e.datapoints,0,0,e.xaxis,e.yaxis);c.restore()}(e),e.bars.show&&function(e){var t;switch(c.save(),c.translate(m.left,m.top),c.lineWidth=e.bars.lineWidth,c.strokeStyle=e.color,e.bars.align){case"left":t=0;break;case"right":t=-e.bars.barWidth;break;default:t=-e.bars.barWidth/2}var n=e.bars.fill?function(t,n){return T(e.bars,e.color,t,n)}:null;(function(t,n,a,r,o,i){for(var s=t.points,l=t.pointsize,u=0;u<s.length;u+=l)null!=s[u]&&R(s[u],s[u+1],s[u+2],n,a,r,o,i,c,e.bars.horizontal,e.bars.lineWidth)})(e.datapoints,t,t+e.bars.barWidth,n,e.xaxis,e.yaxis),c.restore()}(e),e.points.show&&function(e){function t(e,t,n,a,r,o,i,s){for(var l=e.points,u=e.pointsize,p=0;p<l.length;p+=u){var d=l[p],m=l[p+1];null==d||d<o.min||d>o.max||m<i.min||m>i.max||(c.beginPath(),d=o.p2c(d),m=i.p2c(m)+a,"circle"==s?c.arc(d,m,t,0,r?Math.PI:2*Math.PI,!1):s(c,d,m,t,r),c.closePath(),n&&(c.fillStyle=n,c.fill()),c.stroke())}}c.save(),c.translate(m.left,m.top);var n=e.points.lineWidth,a=e.shadowSize,r=e.points.radius,o=e.points.symbol;0==n&&(n=1e-4);if(n>0&&a>0){var i=a/2;c.lineWidth=i,c.strokeStyle="rgba(0,0,0,0.1)",t(e.datapoints,r,null,i+i/2,!0,e.xaxis,e.yaxis,o),c.strokeStyle="rgba(0,0,0,0.2)",t(e.datapoints,r,null,i/2,!0,e.xaxis,e.yaxis,o)}c.lineWidth=n,c.strokeStyle=e.color,t(e.datapoints,r,T(e.points,e.color),0,!1,e.xaxis,e.yaxis,o),c.restore()}(e)}function R(e,t,n,a,r,o,i,s,l,c,u){var p,d,m,f,h,g,v,b,y;c?(b=g=v=!0,h=!1,f=t+a,m=t+r,(d=e)<(p=n)&&(y=d,d=p,p=y,h=!0,g=!1)):(h=g=v=!0,b=!1,p=e+a,d=e+r,(f=t)<(m=n)&&(y=f,f=m,m=y,b=!0,v=!1)),d<i.min||p>i.max||f<s.min||m>s.max||(p<i.min&&(p=i.min,h=!1),d>i.max&&(d=i.max,g=!1),m<s.min&&(m=s.min,b=!1),f>s.max&&(f=s.max,v=!1),p=i.p2c(p),m=s.p2c(m),d=i.p2c(d),f=s.p2c(f),o&&(l.fillStyle=o(m,f),l.fillRect(p,f,d-p,m-f)),u>0&&(h||g||v||b)&&(l.beginPath(),l.moveTo(p,m),h?l.lineTo(p,f):l.moveTo(p,f),v?l.lineTo(d,f):l.moveTo(d,f),g?l.lineTo(d,m):l.moveTo(d,m),b?l.lineTo(p,m):l.moveTo(p,m),l.stroke()))}function T(e,t,n,a){var r=e.fill;if(!r)return null;if(e.fillColor)return G(e.fillColor,n,a,t);var o=od.color.parse(t);return o.a="number"==typeof r?r:.4,o.normalize(),o.toString()}v.setData=y,v.setupGrid=N,v.draw=k,v.getPlaceholder=function(){return e},v.getCanvas=function(){return i.element},v.getPlotOffset=function(){return m},v.width=function(){return f},v.height=function(){return h},v.offset=function(){var e=l.offset();return e.left+=m.left,e.top+=m.top,e},v.getData=function(){return r},v.getAxes=function(){var e={};return od.each(p.concat(d),function(t,n){n&&(e[n.direction+(1!=n.n?n.n:"")+"axis"]=n)}),e},v.getXAxes=function(){return p},v.getYAxes=function(){return d},v.c2p=S,v.p2c=function(e){var t,n,a,r={};for(t=0;t<p.length;++t)if((n=p[t])&&n.used&&(a="x"+n.n,null==e[a]&&1==n.n&&(a="x"),null!=e[a])){r.left=n.p2c(e[a]);break}for(t=0;t<d.length;++t)if((n=d[t])&&n.used&&(a="y"+n.n,null==e[a]&&1==n.n&&(a="y"),null!=e[a])){r.top=n.p2c(e[a]);break}return r},v.getOptions=function(){return o},v.highlight=L,v.unhighlight=W,v.triggerRedrawOverlay=V,v.pointOffset=function(e){return{left:parseInt(p[E(e,"x")-1].p2c(+e.x)+m.left,10),top:parseInt(d[E(e,"y")-1].p2c(+e.y)+m.top,10)}},v.shutdown=O,v.destroy=function(){O(),e.removeData("plot").empty(),r=[],o=null,i=null,s=null,l=null,c=null,u=null,p=[],d=[],g=null,I=[],v=null},v.resize=function(){var t=e.width(),n=e.height();i.resize(t,n),s.resize(t,n)},v.hooks=g,function(){for(var e={Canvas:ld},t=0;t<a.length;++t){var n=a[t];n.init(v,e),n.options&&od.extend(!0,o,n.options)}}(),function(t){od.extend(!0,o,t),t&&t.colors&&(o.colors=t.colors);null==o.xaxis.color&&(o.xaxis.color=od.color.parse(o.grid.color).scale("a",.22).toString());null==o.yaxis.color&&(o.yaxis.color=od.color.parse(o.grid.color).scale("a",.22).toString());null==o.xaxis.tickColor&&(o.xaxis.tickColor=o.grid.tickColor||o.xaxis.color);null==o.yaxis.tickColor&&(o.yaxis.tickColor=o.grid.tickColor||o.yaxis.color);null==o.grid.borderColor&&(o.grid.borderColor=o.grid.color);null==o.grid.tickColor&&(o.grid.tickColor=od.color.parse(o.grid.color).scale("a",.22).toString());var n,a,r,i=e.css("font-size"),s=i?+i.replace("px",""):13,l={style:e.css("font-style"),size:Math.round(.8*s),variant:e.css("font-variant"),weight:e.css("font-weight"),family:e.css("font-family")};for(r=o.xaxes.length||1,n=0;n<r;++n)(a=o.xaxes[n])&&!a.tickColor&&(a.tickColor=a.color),a=od.extend(!0,{},o.xaxis,a),o.xaxes[n]=a,a.font&&(a.font=od.extend({},l,a.font),a.font.color||(a.font.color=a.color),a.font.lineHeight||(a.font.lineHeight=Math.round(1.15*a.font.size)));for(r=o.yaxes.length||1,n=0;n<r;++n)(a=o.yaxes[n])&&!a.tickColor&&(a.tickColor=a.color),a=od.extend(!0,{},o.yaxis,a),o.yaxes[n]=a,a.font&&(a.font=od.extend({},l,a.font),a.font.color||(a.font.color=a.color),a.font.lineHeight||(a.font.lineHeight=Math.round(1.15*a.font.size)));o.xaxis.noTicks&&null==o.xaxis.ticks&&(o.xaxis.ticks=o.xaxis.noTicks);o.yaxis.noTicks&&null==o.yaxis.ticks&&(o.yaxis.ticks=o.yaxis.noTicks);o.x2axis&&(o.xaxes[1]=od.extend(!0,{},o.xaxis,o.x2axis),o.xaxes[1].position="top",null==o.x2axis.min&&(o.xaxes[1].min=null),null==o.x2axis.max&&(o.xaxes[1].max=null));o.y2axis&&(o.yaxes[1]=od.extend(!0,{},o.yaxis,o.y2axis),o.yaxes[1].position="right",null==o.y2axis.min&&(o.yaxes[1].min=null),null==o.y2axis.max&&(o.yaxes[1].max=null));o.grid.coloredAreas&&(o.grid.markings=o.grid.coloredAreas);o.grid.coloredAreasColor&&(o.grid.markingsColor=o.grid.coloredAreasColor);o.lines&&od.extend(!0,o.series.lines,o.lines);o.points&&od.extend(!0,o.series.points,o.points);o.bars&&od.extend(!0,o.series.bars,o.bars);null!=o.shadowSize&&(o.series.shadowSize=o.shadowSize);null!=o.highlightColor&&(o.series.highlightColor=o.highlightColor);for(n=0;n<o.xaxes.length;++n)C(p,n+1).options=o.xaxes[n];for(n=0;n<o.yaxes.length;++n)C(d,n+1).options=o.yaxes[n];for(var c in g)o.hooks[c]&&o.hooks[c].length&&(g[c]=g[c].concat(o.hooks[c]));b(g.processOptions,[o])}(n),function(){e.css("padding",0).children().filter(function(){return!od(this).hasClass("flot-overlay")&&!od(this).hasClass("flot-base")}).remove(),"static"==e.css("position")&&e.css("position","relative");i=new ld("flot-base",e),s=new ld("flot-overlay",e),c=i.context,u=s.context,l=od(s.element).unbind();var t=e.data("plot");t&&(t.shutdown(),s.clear());e.data("plot",v)}(),y(t),N(),k(),function(){o.grid.hoverable&&(l.mousemove(A),l.bind("mouseleave",q));o.grid.clickable&&l.click(M);b(g.bindEvents,[l])}();var I=[],D=null;function A(e){o.grid.hoverable&&F("plothover",e,function(e){return 0!=e.hoverable})}function q(e){o.grid.hoverable&&F("plothover",e,function(e){return!1})}function M(e){F("plotclick",e,function(e){return 0!=e.clickable})}function F(t,n,a){var i=l.offset(),s=n.pageX-i.left-m.left,c=n.pageY-i.top-m.top,u=S({left:s,top:c});u.pageX=n.pageX,u.pageY=n.pageY;var p=function(e,t,n){var a,i,s,l=o.grid.mouseActiveRadius,c=l*l+1,u=null;for(a=r.length-1;a>=0;--a)if(n(r[a])){var p=r[a],d=p.xaxis,m=p.yaxis,f=p.datapoints.points,h=d.c2p(e),g=m.c2p(t),v=l/d.scale,b=l/m.scale;if(s=p.datapoints.pointsize,d.options.inverseTransform&&(v=Number.MAX_VALUE),m.options.inverseTransform&&(b=Number.MAX_VALUE),p.lines.show||p.points.show)for(i=0;i<f.length;i+=s){var y=f[i],E=f[i+1];if(null!=y&&!(y-h>v||y-h<-v||E-g>b||E-g<-b)){var w=Math.abs(d.p2c(y)-e),S=Math.abs(m.p2c(E)-t),C=w*w+S*S;C<c&&(c=C,u=[a,i/s])}}if(p.bars.show&&!u){var O,x;switch(p.bars.align){case"left":O=0;break;case"right":O=-p.bars.barWidth;break;default:O=-p.bars.barWidth/2}for(x=O+p.bars.barWidth,i=0;i<f.length;i+=s){y=f[i],E=f[i+1];var N=f[i+2];null!=y&&(r[a].bars.horizontal?h<=Math.max(N,y)&&h>=Math.min(N,y)&&g>=E+O&&g<=E+x:h>=y+O&&h<=y+x&&g>=Math.min(N,E)&&g<=Math.max(N,E))&&(u=[a,i/s])}}}return u?(a=u[0],i=u[1],s=r[a].datapoints.pointsize,{datapoint:r[a].datapoints.points.slice(i*s,(i+1)*s),dataIndex:i,series:r[a],seriesIndex:a}):null}(s,c,a);if(p&&(p.pageX=parseInt(p.series.xaxis.p2c(p.datapoint[0])+i.left+m.left,10),p.pageY=parseInt(p.series.yaxis.p2c(p.datapoint[1])+i.top+m.top,10)),o.grid.autoHighlight){for(var d=0;d<I.length;++d){var f=I[d];f.auto!=t||p&&f.series==p.series&&f.point[0]==p.datapoint[0]&&f.point[1]==p.datapoint[1]||W(f.series,f.point)}p&&L(p.series,p.datapoint,t)}e.trigger(t,[u,p])}function V(){var e=o.interaction.redrawOverlayInterval;-1!=e?D||(D=setTimeout(B,e)):B()}function B(){var e,t;for(D=null,u.save(),s.clear(),u.translate(m.left,m.top),e=0;e<I.length;++e)(t=I[e]).series.bars.show?z(t.series,t.point):U(t.series,t.point);u.restore(),b(g.drawOverlay,[u])}function L(e,t,n){if("number"==typeof e&&(e=r[e]),"number"==typeof t){var a=e.datapoints.pointsize;t=e.datapoints.points.slice(a*t,a*(t+1))}var o=H(e,t);-1==o?(I.push({series:e,point:t,auto:n}),V()):n||(I[o].auto=!1)}function W(e,t){if(null==e&&null==t)return I=[],void V();if("number"==typeof e&&(e=r[e]),"number"==typeof t){var n=e.datapoints.pointsize;t=e.datapoints.points.slice(n*t,n*(t+1))}var a=H(e,t);-1!=a&&(I.splice(a,1),V())}function H(e,t){for(var n=0;n<I.length;++n){var a=I[n];if(a.series==e&&a.point[0]==t[0]&&a.point[1]==t[1])return n}return-1}function U(e,t){var n=t[0],a=t[1],r=e.xaxis,o=e.yaxis,i="string"==typeof e.highlightColor?e.highlightColor:od.color.parse(e.color).scale("a",.5).toString();if(!(n<r.min||n>r.max||a<o.min||a>o.max)){var s=e.points.radius+e.points.lineWidth/2;u.lineWidth=s,u.strokeStyle=i;var l=1.5*s;n=r.p2c(n),a=o.p2c(a),u.beginPath(),"circle"==e.points.symbol?u.arc(n,a,l,0,2*Math.PI,!1):e.points.symbol(u,n,a,l,!1),u.closePath(),u.stroke()}}function z(e,t){var n,a="string"==typeof e.highlightColor?e.highlightColor:od.color.parse(e.color).scale("a",.5).toString(),r=a;switch(e.bars.align){case"left":n=0;break;case"right":n=-e.bars.barWidth;break;default:n=-e.bars.barWidth/2}u.lineWidth=e.bars.lineWidth,u.strokeStyle=a,R(t[0],t[1],t[2]||0,n,n+e.bars.barWidth,function(){return r},e.xaxis,e.yaxis,u,e.bars.horizontal,e.bars.lineWidth)}function G(e,t,n,a){if("string"==typeof e)return e;for(var r=c.createLinearGradient(0,n,0,t),o=0,i=e.colors.length;o<i;++o){var s=e.colors[o];if("string"!=typeof s){var l=od.color.parse(a);null!=s.brightness&&(l=l.scale("rgb",s.brightness)),null!=s.opacity&&(l.a*=s.opacity),s=l.toString()}r.addColorStop(o/(i-1),s)}return r}}function ud(e,t,n){return new cd(od(e),t,n,od.plot.plugins)}od.fn.detach||(od.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})}),ld.prototype.resize=function(e,t){if(e<=0||t<=0)throw new Error("Invalid dimensions for plot, width = "+e+", height = "+t);var n=this.element,a=this.context,r=this.pixelRatio;this.width!=e&&(n.width=e*r,n.style.width=e+"px",this.width=e),this.height!=t&&(n.height=t*r,n.style.height=t+"px",this.height=t),a.restore(),a.save(),a.scale(r,r)},ld.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},ld.prototype.render=function(){var e=this._textCache;for(var t in e)if(sd.call(e,t)){var n=this.getTextLayer(t),a=e[t];for(var r in n.hide(),a)if(sd.call(a,r)){var o=a[r];for(var i in o)if(sd.call(o,i)){for(var s,l=o[i].positions,c=0;s=l[c];c++)s.active?s.rendered||(n.append(s.element),s.rendered=!0):(l.splice(c--,1),s.rendered&&s.element.detach());0==l.length&&delete o[i]}}n.show()}},ld.prototype.getTextLayer=function(e){var t=this.text[e];return null==t&&(null==this.textContainer&&(this.textContainer=od("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),t=this.text[e]=od("<div></div>").addClass(e).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),t},ld.prototype.getTextInfo=function(e,t,n,a,r){var o,i,s,l;if(t=""+t,o="object"===rd(n)?n.style+" "+n.variant+" "+n.weight+" "+n.size+"px/"+n.lineHeight+"px "+n.family:n,null==(i=this._textCache[e])&&(i=this._textCache[e]={}),null==(s=i[o])&&(s=i[o]={}),null==(l=s[t])){var c=od("<div></div>").html(t).css({position:"absolute","max-width":r,top:-9999}).appendTo(this.getTextLayer(e));"object"===rd(n)?c.css({font:o,color:n.color}):"string"==typeof n&&c.addClass(n),l=s[t]={width:c.outerWidth(!0),height:c.outerHeight(!0),element:c,positions:[]},c.detach()}return l},ld.prototype.addText=function(e,t,n,a,r,o,i,s,l){var c=this.getTextInfo(e,a,r,o,i),u=c.positions;"center"==s?t-=c.width/2:"right"==s&&(t-=c.width),"middle"==l?n-=c.height/2:"bottom"==l&&(n-=c.height);for(var p,d=0;p=u[d];d++)if(p.x==t&&p.y==n)return void(p.active=!0);p={active:!0,rendered:!1,element:u.length?c.element.clone():c.element,x:t,y:n},u.push(p),p.element.css({top:Math.round(n),left:Math.round(t),"text-align":s})},ld.prototype.removeText=function(e,t,n,a,r,o){if(null==a){var i=this._textCache[e];if(null!=i)for(var s in i)if(sd.call(i,s)){var l=i[s];for(var c in l)if(sd.call(l,c))for(var u=l[c].positions,p=0;d=u[p];p++)d.active=!1}}else{var d;for(u=this.getTextInfo(e,a,r,o).positions,p=0;d=u[p];p++)d.x==t&&d.y==n&&(d.active=!1)}},od.plot=ud,od.plot.version="0.8.3",od.plot.plugins=[],od.fn.plot=function(e,t){return this.each(function(){od.plot(this,e,t)})},ad(od);var pd=tn()({displayName:"PulsePlot",mixins:[te.a.ListenerMixin],propTypes:{topic:Y.a.string.isRequired,resolution:Y.a.string.isRequired,options:Y.a.object},componentDidMount:function(){this.subscribe(this.props.topic)},componentWillUnmount:function(){this.unsubscribe(this.props.topic)},componentWillReceiveProps:function(e){e.topic!=this.props.topic&&(this.unsubscribe(this.props.topic),this.subscribe(e.topic))},subscribe:function(e){e&&(this.listenTo(td,this.onPulseEvent),td.subscribe(e)),this.props.data&&(this.setState({data:this.props.data}),this.draw(this.props.data))},unsubscribe:function(e){this.plot&&(this.plot.shutdown(),delete this.plot),td.unsubscribe(e)},onPulseEvent:function(e){var t=this.props.topic;if(/^custom\//.test(t)&&(t=t.slice(7)),e[t]){var n=e[t][this.props.resolution];if(n)if(e.partial_update){if(!this.state.data)return void console.log("partial update, but no data",e);var a=this.state.data;if(function(e,t,n){for(var a=0,r=0;r<t.length;r++){a<t[r].data[t[r].data.length-1][0]&&(a=t[r].data[t[r].data.length-1][0]);for(var o=0;o<e.length;o++){var i=e[o];if(i.label==t[r].label){(!i.last_dts||i.last_dts<t[r].data[0][0])&&(i.data.push(t[r].data[0]),i.data.splice(0,1),i.last_dts=t[r].data[0][0]);break}}}for(var s=0;s<e.length;s++)for(;e[s].data[0]<a-n;)e[s].data.splice(0,1)}(a,n,this.duration),!a)return;this.setState({data:a}),this.draw(a)}else{for(var r=0,o=0,i=0;i<n.length;i++)if(n[i].data&&n[i].data.length){var s=n[i].data;n[i].last_dts=n[i].data[s.length-1][0],(!r||r>n[i].data[0][0])&&(r=n[i].data[0][0]),o<n[i].last_dts&&(o=n[i].last_dts)}if(this.duration=o-r,!n)return;this.setState({data:n}),this.draw(n)}}},draw:function(e){if(this.refs.plot){var t={xaxis:{mode:"time",timeformat:"%H:%M:%S",timezone:"browser"},yaxis:{min:0,tickDecimals:0},legend:{position:"nw"}};this.props.options&&(t=Z()(t,{$merge:this.props.options})),"hour"==this.props.resolution&&(t.xaxis.timeformat="%H:%M");var n=function(e){var t=e.type;"net"!==t&&"memory"!==t||(e.tickDecimals=1,"net"===t&&(e.tickFormatter=function(e,t){return function(e,t,n){var a=n?n*e:e;return a>7e8?(a/1e9).toFixed(t.tickDecimals)+" Gb":a>7e5?(a/1e6).toFixed(t.tickDecimals)+" Mb":a>700?(a/1e3).toFixed(t.tickDecimals)+" Kb":a.toFixed(t.tickDecimals)+" b"}(e,t,this.plot?this.plot.getOptions().yaxis.ratio:t.options.ratio)}))};if(t.yaxis&&n(t.yaxis),t.yaxes&&t.yaxes.length&&t.yaxes.forEach(n),this.plot){var a=this.plot.getOptions();if(a.yaxis.type===t.yaxis.type){var r=Z()(a.legend,{$merge:t.legend});return(a=Z()(a,{$merge:t})).legend=r,this.plot.setupGrid(),this.plot.setData(e),void this.plot.draw()}}this.plot=ud(this.refs.plot,e,t)}},getInitialState:function(){return{}},render:function(){var e={width:"100%",height:"100%",padding:0,position:"relative"};this.props.style&&(e=Z()(e,{$merge:this.props.style}));var t="pulse-flow",n=void 0;return this.state.data||(t+=" loading",n="Loading..."),o.a.createElement("div",{ref:"plot",className:t,style:e},n)}}),dd=function(e){var t=e.name,n=e.hideStats,a=e.stats,r=e.media;return o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{style:{height:"150px"}},o.a.createElement(pd,{topic:"media/".concat(t),resolution:"minute",options:{yaxes:[{position:"left"},{position:"right"}],yaxis:{type:"net",min:0,tickDecimals:0}}}))),o.a.createElement("div",{className:"right-page margin-left-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},!n&&o.a.createElement(Nr,{name:t,media:r,stats:a,showInputBitrate:!0})),o.a.createElement(ed,{mediaInfo:a.media_info,inputMediaInfo:a.input_media_info}))),o.a.createElement("div",{className:"right-page-container"}))};dd.propTypes={name:Y.a.string.isRequired,media:Y.a.shape({disable:Y.a.bool,static:Y.a.bool}).isRequired,stats:Y.a.shape({media_info:Ea,input_media_info:Ea,bytes_in:Y.a.number,bytes_out:Y.a.number,client_count:Y.a.number}).isRequired,hideStats:Y.a.bool},dd.defaultProps={hideStats:!1};var md=dd;n(1020);function fd(e){return(fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hd(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gd(e){return(gd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bd(e,t){return(bd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ed=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=gd(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==fd(r)&&"function"!=typeof r?vd(a):r,yd(vd(n),"state",{proto:"hls",isPlayerVisible:n.props.media.static}),yd(vd(n),"setPlayerVisible",function(){return n.setState({isPlayerVisible:!0})}),yd(vd(n),"setPlayerInvisible",function(){return n.setState({isPlayerVisible:!1})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bd(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidUpdate",value:function(e){e.name!==this.props.name&&(this.props.media.static?this.setPlayerVisible():this.setPlayerInvisible())}},{key:"render",value:function(){var e=this.state.isPlayerVisible,t=this.props.media,n=t.static,a=t.disabled,r="&autoplay=".concat(n?"false":"true"),i="".concat(N.getHost(),"/").concat(this.props.name,"/embed.html?version=3").concat(r,"=false&").concat(N.adminToken());return o.a.createElement("div",{className:"media-player-content","data-testid":"media-player-content"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10",style:{position:"relative",minHeight:this.props.height+40}},e?o.a.createElement("div",null,!a&&o.a.createElement("iframe",{title:"Player",frameBorder:"0",src:i,className:"mediaOverviewPlayerContent",style:{minHeight:this.props.height+40}})):o.a.createElement("div",{onClick:this.setPlayerVisible,className:"mediaOverviewPlayerContentBlank",style:{minHeight:this.props.height+40}},o.a.createElement("div",{className:"mediaOverviewPlayerContentTriangle"})))),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement(ea,{label:"URL"},o.a.createElement(mn,{readOnly:!0,value:Zt.outputURL(this.props.config,this.props.name,this.state.proto)})),o.a.createElement(ea,{label:"HTML code"},o.a.createElement(mn,{readOnly:!0,value:Zt.embedCode(this.props.name)}))),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}}])&&hd(n.prototype,a),r&&hd(n,r),t}();yd(Ed,"propTypes",{name:Y.a.string.isRequired,media:Y.a.shape({static:Y.a.bool,disabled:Y.a.bool}).isRequired,config:Y.a.object.isRequired,height:Y.a.number}),yd(Ed,"defaultProps",{height:480});var wd=Ed,Sd=te.a.createStore({init:function(){this.listenTo(ae,this.onEvent),this.subscribers={}},onEvent:function(e){if("resubscribe"==e)for(var t in this.subscribers)ae.send("log_media_start:"+t);else"log.entry"==e.event&&this.trigger(e)},subscribe:function(e){this.subscribers[e]?this.subscribers[e]+=1:(ae.send("log_media_start:"+e),this.subscribers[e]=1)},unsubscribe:function(e){this.subscribers[e]&&(this.subscribers[e]-=1),this.subscribers[e]<=0&&(ae.send("log_media_stop:"+e),delete this.subscribers[e])}}),Cd=tn()({displayName:"MediaOverviewLogs",mixins:[te.a.ListenerMixin],propTypes:{name:Y.a.string.isRequired},componentDidMount:function(){this.listenTo(Sd,this.onLogEntry)},componentWillUnmount:function(){this.state.subscribed&&Sd.unsubscribe(this.props.name)},componentWillUpdate:function(){if(this.refs.scrollbox){var e=this.refs.scrollbox;this.shouldScrollBottom=Math.abs(e.scrollTop+e.offsetHeight-e.scrollHeight)<100}},componentDidUpdate:function(){if(this.refs.scrollbox&&this.shouldScrollBottom){var e=this.refs.scrollbox;e.scrollTop=e.scrollHeight}},onLogEntry:function(e){var t=this.state.entries.slice();t.push(e);var n=t.length-1e3;n>0&&t.splice(0,n),this.setState({entries:t})},onToggleClick:function(){var e={expanded:!this.state.expanded};this.state.subscribed||(e.subscribed=!0,Sd.subscribe(this.props.name)),this.setState(e)},getInitialState:function(){return{expanded:!1,subscribed:!1,entries:[],windowHeight:void 0}},renderEntries:function(){if(!this.state.expanded)return null;var e=Math.floor(window.innerHeight*(2/3));return o.a.createElement("div",{ref:"scrollbox",style:{height:e+"px",overflowY:"scroll",overflowX:"hidden"}},o.a.createElement("div",{className:"log-entries monospaced"},this.state.entries.map(function(e,t){return o.a.createElement("div",{key:t},e.text)})))},render:function(){var e="row-height flex-end";return this.state.expanded&&(e+=" logline"),o.a.createElement("div",null,o.a.createElement("div",{className:e},o.a.createElement(ua,{label:"logs",checked:this.state.expanded,onClick:this.onToggleClick})),o.a.createElement("div",null,this.renderEntries()))}});function Od(e){return(Od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xd(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Nd(e){return(Nd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _d(e,t){return(_d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jd=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Nd(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Od(r)&&"function"!=typeof r?kd(a):r,Pd(kd(n),"toggleStatic",function(){var e={streams:{}};e.streams[n.props.media.name]={static:!n.props.media.static},ft.save(e)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_d(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.resetChanges()}},{key:"render",value:function(){return o.a.createElement("div",{"data-testid":"stream-overview"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Name"},o.a.createElement(mn,{value:this.props.media.name,onChange:this.props.change("name","string"),changed:this.props.media.name_changed})),o.a.createElement(ea,{label:"Title"},o.a.createElement(mn,{value:this.props.media.title,onChange:this.props.change("title","string"),changed:this.props.media.title_changed})),o.a.createElement(ea,{label:"Description"},o.a.createElement(mn,{value:this.props.media.meta.comment,onChange:this.props.change("meta.comment","string"),changed:this.props.media.meta.comment_changed})),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:this.props.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"}))),o.a.createElement("div",{className:"right-page margin-left-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(Qp,{name:this.props.media.name,media:this.props.media}),o.a.createElement(Dr,{name:this.props.media.name,media:this.props.media,stats:this.props.media.stats}),o.a.createElement(ea,{expanded:!0,label:"Start conditions"},o.a.createElement(ua,{label:"static",onClick:this.toggleStatic,checked:this.props.media.static,isRadio:!0}),o.a.createElement(ua,{label:"on demand",onClick:this.toggleStatic,checked:!this.props.media.static,className:"margin-left-10",isRadio:!0})))),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement(md,{name:this.props.media.name,media:this.props.media,stats:this.props.media.stats}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(wd,{name:this.props.media.name,media:this.props.media,stats:this.props.media.stats,config:this.props.config}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(Cd,{name:this.props.media.name}),o.a.createElement("div",{className:"row-height"}))}}])&&xd(n.prototype,a),r&&xd(n,r),t}();Pd(jd,"propTypes",{media:Ia.isRequired,config:Qa.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool}),Pd(jd,"defaultProps",{runningRequest:!1});var Rd=jd,Td=n(1473),Id=n(116);n(1021);function Dd(e){return(Dd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ad(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function qd(e){return(qd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Md(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fd(e,t){return(Fd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bd={title:Y.a.string.isRequired,onChange:Y.a.func.isRequired,value:Y.a.string.isRequired,selected:Y.a.string.isRequired},Ld={value:Y.a.string.isRequired,selected:Y.a.string.isRequired},Wd=function(e){var t=e.title,n=e.onChange,a=e.value,r=e.selected;return o.a.createElement("label",{onClick:function(){return n(t)},className:"switchLabel ".concat(a===r?"switchLabelChecked":"")},t?t.split(/\s+/).map(function(e){return e[0].toUpperCase()+e.slice(1)}).join(" "):t)};Wd.propTypes=Bd;var Hd=function(e){var t=e.value,n=e.selected;return o.a.createElement("input",{type:"radio",name:"switch",checked:n===t,className:"switchRadio"})};Hd.propTypes=Ld;var Ud=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=qd(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Dd(r)&&"function"!=typeof r?Md(a):r,Vd(Md(n),"state",{selected:n.props.selected}),Vd(Md(n),"handleChange",function(e){n.setState({selected:e}),n.props.handleSwitchChange(e)}),Vd(Md(n),"selectionStyle",function(){var e=n.state.selected,t="#BCBEC0";switch(e){case"only":t="#4caf50";break;case"except":t="#dc004e";break;default:t="#BCBEC0"}return{left:"".concat(n.props.values.indexOf(e)/3*100,"%"),background:t}}),n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fd(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){var e=this,t=this.state.selected;return o.a.createElement("div",{className:"switch"},this.props.values.map(function(n){return o.a.createElement("span",null,o.a.createElement(Hd,{value:n,selected:t}),o.a.createElement(Wd,{title:n,onChange:e.handleChange,value:n,selected:t}))}),o.a.createElement("span",{className:"switchSelection",style:this.selectionStyle()}))}}])&&Ad(n.prototype,a),i&&Ad(n,i),t}();Vd(Ud,"propTypes",{values:Y.a.arrayOf(Y.a.string).isRequired,selected:Y.a.string.isRequired,handleSwitchChange:Y.a.func.isRequired});var zd=Ud;function Gd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qd={label:Y.a.string.isRequired,getSelectedValue:Y.a.func.isRequired,handleSwitchChange:Y.a.func.isRequired},Kd={readOnly:Y.a.bool.isRequired,label:Y.a.string.isRequired,details:Y.a.string.isRequired,disabled:Y.a.bool.isRequired,hidden:Y.a.bool.isRequired,value:Y.a.string.isRequired},Jd=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Gd(e,t,n[t])})}return e}({showSwitch:Y.a.bool,protocolsAll:ha()(Y.a.bool),protocol:Y.a.bool,isInputDisabled:Y.a.bool.isRequired,isInputHidden:Y.a.bool.isRequired},ts.a(["disabled",Kd]),Qd),Yd=function(e){var t=e.label,n=e.getSelectedValue,a=e.handleSwitchChange;return o.a.createElement(Ps.a,{container:!0},o.a.createElement(Ps.a,{item:!0,xs:4},o.a.createElement(Id.a,{variant:"subtitle2",component:"p",gutterBottom:!0},t)),o.a.createElement(Ps.a,{item:!0,xs:8},o.a.createElement(zd,{values:["except","","only"],selected:n(),handleSwitchChange:a})))};Yd.propTypes=Qd;var $d=function(e){var t=e.readOnly,n=e.label,a=e.details,r=e.disabled,i=e.value,s=e.hidden;return o.a.createElement("div",null,s?o.a.createElement("div",{className:"row-height"}):o.a.createElement(ea,{label:t?n:null,details:a},o.a.createElement(mn,{value:i,readOnly:!0,selectOnClick:!0,disabled:r})))};$d.propTypes=Kd;var Xd=function(e){var t=e.readOnly,n=e.label,a=e.details,r=e.value,i=e.showSwitch,s=e.protocolsAll,l=e.protocol,c=e.handleSwitchChange,u=e.isInputDisabled,p=e.isInputHidden;return o.a.createElement(Ps.a,{container:!0,alignItems:"center"},o.a.createElement(Ps.a,{item:!0,xs:4},!t&&i&&o.a.createElement(Yd,{label:n,getSelectedValue:function(){return s&&l?"only":!s||we.a(l)||l?"":"except"},handleSwitchChange:c})),o.a.createElement(Ps.a,{item:!0,xs:8},o.a.createElement($d,{readOnly:t,label:n,details:a,disabled:u,value:r,hidden:p})))};function Zd(e){return(Zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function em(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function tm(e){return(tm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function am(e,t){return(am=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Xd.propTypes=Jd,Xd.defaultProps={showSwitch:!1};var om=Q.a(Ut.a,zt.a("//")),im=["hls","mss","hds","mpegts","dash","m4f","m4s","rtmp","rtsp"],sm=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=tm(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Zd(r)&&"function"!=typeof r?nm(a):r,rm(nm(n),"handleSwitchChange",function(e){return function(t){n.props.change&&(""===t?n.props.change(["protocols",e],"raw")(null):n.props.change(["protocols",e],"raw")("only"===t))}}),rm(nm(n),"isInputDisabled",function(e){var t=n.props.media.protocols;return!!t&&(!t[e]&&(!we.a(t[e])&&!t[e]||!!we.a(t[e])&&im.some(function(e){return t[e]})))}),rm(nm(n),"isInputHidden",function(e){var t=n.props.media.protocols;return!!t&&(!we.a(t[e])&&!t[e])}),rm(nm(n),"renderHLS",function(e,t){return o.a.createElement(o.a.Fragment,null,o.a.createElement(Xd,{readOnly:e,label:"HLS",details:"Apple HLS standard URL all extra tracks in distinct playlists",value:"".concat(t,"/").concat(n.props.name,"/index.m3u8"),showSwitch:!0,protocolsAll:n.props.media.protocols,protocol:n.props.media.protocols?n.props.media.protocols.hls:null,handleSwitchChange:n.handleSwitchChange("hls"),isInputDisabled:n.isInputDisabled("hls"),isInputHidden:n.isInputHidden("hls")}),o.a.createElement(Xd,{readOnly:e,label:"HLS",details:"Non-Apple devices standard URL all tracks in single playlist",value:"".concat(t,"/").concat(n.props.name,"/video.m3u8"),isInputDisabled:n.isInputDisabled("hls"),isInputHidden:n.isInputHidden("hls")}))}),rm(nm(n),"renderMSS",function(e,t){return o.a.createElement(Xd,{readOnly:e,label:"MSS",value:"".concat(t,"/").concat(n.props.name,".isml/manifest"),showSwitch:!0,protocolsAll:n.props.media.protocols,protocol:n.props.media.protocols?n.props.media.protocols.mss:null,handleSwitchChange:n.handleSwitchChange("mss"),isInputDisabled:n.isInputDisabled("mss"),isInputHidden:n.isInputHidden("mss")})}),rm(nm(n),"renderHDS",function(e,t){return o.a.createElement(Xd,{readOnly:e,label:"HDS",value:"".concat(t,"/").concat(n.props.name,"/manifest.f4m"),showSwitch:!0,protocolsAll:n.props.media.protocols,protocol:n.props.media.protocols?n.props.media.protocols.hds:null,handleSwitchChange:n.handleSwitchChange("hds"),isInputDisabled:n.isInputDisabled("hds"),isInputHidden:n.isInputHidden("hds")})}),rm(nm(n),"renderMPEGTS",function(e,t){return o.a.createElement(Xd,{readOnly:e,label:"MPEG-TS",value:"".concat(t,"/").concat(n.props.name,"/mpegts"),showSwitch:!0,protocolsAll:n.props.media.protocols,protocol:n.props.media.protocols?n.props.media.protocols.mpegts:null,handleSwitchChange:n.handleSwitchChange("mpegts"),isInputDisabled:n.isInputDisabled("mpegts"),isInputHidden:n.isInputHidden("mpegts")})}),rm(nm(n),"renderDASH",function(e,t){return o.a.createElement(Xd,{readOnly:e,label:"DASH",value:"".concat(t,"/").concat(n.props.name,"/index.mpd"),showSwitch:!0,protocolsAll:n.props.media.protocols,protocol:n.props.media.protocols?n.props.media.protocols.dash:null,handleSwitchChange:n.handleSwitchChange("dash"),isInputDisabled:n.isInputDisabled("dash"),isInputHidden:n.isInputHidden("dash")})}),rm(nm(n),"renderM4F",function(e,t){return o.a.createElement(Xd,{readOnly:e,label:"M4F",details:"Flussonic-to-Flussonic protocol (fragment)",value:"m4f://".concat(t,"/").concat(n.props.name),showSwitch:!0,protocolsAll:n.props.media.protocols,protocol:n.props.media.protocols?n.props.media.protocols.m4f:null,handleSwitchChange:n.handleSwitchChange("m4f"),isInputDisabled:n.isInputDisabled("m4f"),isInputHidden:n.isInputHidden("m4f")})}),rm(nm(n),"renderM4S",function(e,t){return o.a.createElement(Xd,{readOnly:e,label:"M4S",details:"Flussonic-to-Flussonic protocol (stream)",value:"m4s://".concat(t,"/").concat(n.props.name),showSwitch:!0,protocolsAll:n.props.media.protocols,protocol:n.props.media.protocols?n.props.media.protocols.m4s:null,handleSwitchChange:n.handleSwitchChange("m4s"),isInputDisabled:n.isInputDisabled("m4s"),isInputHidden:n.isInputHidden("m4s")})}),rm(nm(n),"renderRtXpReadonlyWithoutHostPort",function(e){return o.a.createElement(Ps.a,{container:!0},o.a.createElement(Ps.a,{item:!0,xs:2}),o.a.createElement(Ps.a,{container:!0,item:!0,xs:10},o.a.createElement(Td.a,{mt:2,mb:-2,color:"text.secondary"},o.a.createElement(ea,{expanded:!0,label:"RT".concat(e,"P")},o.a.createElement("div",null,"RT",e,"P not configured yet, please follow"," ",o.a.createElement(Et,{to:"global-config"},"global config page"),".")))))}),rm(nm(n),"renderRtXpWithoutHostPort",function(e){return o.a.createElement(Ps.a,{container:!0,alignItems:"center"},o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Td.a,{mt:2},o.a.createElement(Yd,{label:"RT".concat(e,"P"),disabled:!0}))),o.a.createElement(Ps.a,{container:!0,item:!0,xs:10},o.a.createElement(Td.a,{mb:-2,color:"text.secondary"},"RT",e,"P not configured yet, please follow"," ",o.a.createElement(Et,{to:"global-config"},"global config page"),".")))}),rm(nm(n),"renderRTMP",function(e,t){if(!t&&e)return n.renderRtXpReadonlyWithoutHostPort("M");if(!t&&!e)return n.renderRtXpWithoutHostPort("M");var a=n.props.name.includes("/")?"":"static",r=n.props.media.prefix||a,i="".concat(t,"/").concat(r?"".concat(r,"/"):"").concat(n.props.name);return o.a.createElement(Xd,{readOnly:e,label:"RTMP",value:i,showSwitch:!0,protocolsAll:n.props.media.protocols,protocol:n.props.media.protocols?n.props.media.protocols.rtmp:null,handleSwitchChange:n.handleSwitchChange("rtmp"),isInputDisabled:n.isInputDisabled("rtmp"),isInputHidden:n.isInputHidden("rtmp")})}),rm(nm(n),"renderRTSP",function(e,t){if(!t&&e)return n.renderRtXpReadonlyWithoutHostPort("S");t||e||n.renderRtXpWithoutHostPort("S");var a="".concat(t,"/").concat(n.props.name);return o.a.createElement(Xd,{readOnly:e,label:"RTSP",value:a,showSwitch:!0,protocolsAll:n.props.media.protocols,protocol:n.props.media.protocols?n.props.media.protocols.rtsp:null,handleSwitchChange:n.handleSwitchChange("rtsp"),isInputDisabled:n.isInputDisabled("rtsp"),isInputHidden:n.isInputHidden("rtsp")})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&am(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=!this.props.change,t=Jt.httpsHostPort(this.props.config,!0)||Jt.httpHostPort(this.props.config,!0)||"",n=om(t);return o.a.createElement(o.a.Fragment,null,this.renderHLS(e,t),this.renderMSS(e,t),this.renderHDS(e,t),!this.props.hideMpegts&&this.renderMPEGTS(e,t),this.renderDASH(e,t),this.renderRTMP(e,Jt.rtmpHostPort(this.props.config,!0)),this.renderRTSP(e,Jt.rtspHostPort(this.props.config,!0)),this.renderM4F(e,n),this.renderM4S(e,n))}}])&&em(n.prototype,a),r&&em(n,r),t}();function lm(e){return(lm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cm(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function um(e){return(um=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dm(e,t){return(dm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}rm(sm,"propTypes",{name:Y.a.string.isRequired,config:Qa.isRequired,media:Ia.isRequired,change:Y.a.func.isRequired,hideMpegts:Y.a.bool}),rm(sm,"defaultProps",{hideMpegts:!1});var fm=/^https?:\/\/[0-9a-zA-Z.-]+(:[0-9]+)?\/?$/,hm=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=um(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==lm(r)&&"function"!=typeof r?pm(a):r,mm(pm(n),"state",{urlPrefix:n.props.media.url_prefix}),mm(pm(n),"handlePrefixChange",function(e){n.setState({urlPrefix:e.target.value}),!fm.test(e.target.value)&&e.target.value||n.props.change("url_prefix","raw")(e.target.value)}),mm(pm(n),"renderPersistentOpts",function(){if(!n.props.hidePrepush){var e="number"==typeof n.props.media.prepush,t=e?o.a.createElement(ea,{label:"Duration",details:"How many seconds keep preloaded"},o.a.createElement(hn,{value:n.props.media.prepush,onChange:n.props.change("prepush","raw"),changed:n.props.media.prepush_changed,units:[{label:"seconds",factor:1}]})):null;return o.a.createElement(o.a.Fragment,null,o.a.createElement(Td.a,{color:"text.secondary",mt:2},"Persistent protocols (HTTP MPEG-TS, RTMP, RTSP)"),o.a.createElement(ea,{expanded:!0,label:"Prepush",details:"Allows to start playing right after connection",className:"auto-height"},o.a.createElement(ua,{label:"disabled",checked:!1===n.props.media.prepush,onClick:function(){return n.props.change("prepush","raw")(!1)},className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"enabled",checked:(n.props.media.prepush||!Object.prototype.hasOwnProperty.call(n.props.media,"prepush"))&&!e,onClick:function(){return n.props.change("prepush","raw")(null)},className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"enabled specific",checked:e,onClick:function(){return n.props.change("prepush","raw")(3)},isRadio:!0})),t)}}),mm(pm(n),"renderMpegtsSpecific",function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(Td.a,{color:"text.secondary",mt:2},"MPEG-TS specific"),o.a.createElement(ea,{label:"Provider"},o.a.createElement(mn,{value:n.props.media.provider,onChange:n.props.change("provider","string"),changed:n.props.media.provider_changed})),o.a.createElement(ea,{label:"Title"},o.a.createElement(mn,{value:n.props.media.title,onChange:n.props.change("title","string"),changed:n.props.media.title_changed})),o.a.createElement("div",{className:"row-height"}))}),mm(pm(n),"renderSegmentBasedProtocolsOpts",function(){var e=n.props.hideSegmentCount?null:o.a.createElement(ea,{label:"Segment count",details:"How many segments playlist should have"},o.a.createElement(mn,{value:n.props.media.segment_count,onChange:n.props.change("segment_count","integer"),changed:n.props.media.segment_count_changed})),t=n.state.urlPrefix&&!fm.test(n.state.urlPrefix)?"Please specify in proto://hostname:port format":null;return o.a.createElement(o.a.Fragment,null,o.a.createElement(Td.a,{color:"text.secondary",mt:2},"Segment based protocols (HLS, HDS, DASH)"),o.a.createElement(ea,{expanded:!0,label:"Generate audio-only HLS playlists",details:"Required by Apple validation rules"},o.a.createElement(ua,{label:"disabled",checked:!n.props.media.add_audio_only,onClick:function(){return n.props.change("add_audio_only","raw")(null)},className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"enabled",checked:n.props.media.add_audio_only,onClick:function(){return n.props.change("add_audio_only","raw")(!0)},isRadio:!0})),e,o.a.createElement(ea,{label:"Segment duration",details:"How many seconds lasts each segment"},o.a.createElement(hn,{value:n.props.media.segment_duration,onChange:n.props.change("segment_duration","raw"),changed:n.props.media.segment_duration_changed,units:[{label:"seconds",factor:1e3}]})),o.a.createElement(ea,{label:"URL prefix",errorMessage:t,details:"Enables absolute urls in playlists"},o.a.createElement(mn,{value:n.state.urlPrefix,onChange:n.handlePrefixChange,changed:n.props.media.url_prefix_changed})))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dm(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){e.media.url_prefix!==this.props.media.url_prefix&&this.setState({urlPrefix:e.media.url_prefix})}},{key:"render",value:function(){return o.a.createElement(Ps.a,{container:!0},o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement("h1",{className:"head-text"},"Additional options for")),o.a.createElement(Ps.a,{container:!0,item:!0,xs:12,spacing:2},o.a.createElement(Ps.a,{item:!0,xs:!0},this.renderSegmentBasedProtocolsOpts()),o.a.createElement(Ps.a,{item:!0,xs:!0},this.renderPersistentOpts(),this.renderMpegtsSpecific())))}}])&&cm(n.prototype,a),r&&cm(n,r),t}();mm(hm,"propTypes",{media:Y.a.object.isRequired,change:Y.a.func.isRequired,hidePrepush:Y.a.bool,hideSegmentCount:Y.a.bool}),mm(hm,"defaultProps",{hidePrepush:!1,hideSegmentCount:!1});var gm=hm;function vm(e){return(vm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bm(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ym(e){return(ym=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Em(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wm(e,t){return(wm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cm=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=ym(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==vm(r)&&"function"!=typeof r?Em(a):r,Sm(Em(n),"handleChange",function(e){var t=e.target.value,a=n.props;(0,a.onChange)(["pushes",a.pushKey.toString(),"url"],"raw")(t)}),Sm(Em(n),"handleBlur",function(){n.props.push.url||n.handleDelete()}),Sm(Em(n),"handleDelete",function(){var e=n.props;(0,e.onDelete)(["pushes",e.pushKey.toString()])}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wm(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.push,n=e.isNew,a=e.pushKey,r=e.setInputComponentRef,i=e.setInputRef,s=n?"New push URL":"Push to URL ".concat(parseInt(a,10)+1);return o.a.createElement(Ps.a,{container:!0},o.a.createElement(Ps.a,{item:!0,xs:10},o.a.createElement(ea,{label:s},o.a.createElement(mn,{onChange:this.handleChange,onBlur:this.handleBlur,value:t.url,ref:r,setRef:i}))),o.a.createElement(Ps.a,{container:!0,item:!0,xs:2,alignItems:"flex-end"},!n&&Ie(t.url)&&o.a.createElement(Td.a,{ml:1,mb:1},o.a.createElement(ua,{label:"remove",className:"danger",onClick:this.handleDelete}))))}}])&&bm(n.prototype,a),r&&bm(n,r),t}();Sm(Cm,"propTypes",{push:Y.a.shape({url:Y.a.string}).isRequired,pushKey:Y.a.string.isRequired,isNew:Y.a.bool,onChange:Y.a.func.isRequired,onDelete:Y.a.func.isRequired,setInputRef:Y.a.func,setInputComponentRef:Y.a.func}),Sm(Cm,"defaultProps",{isNew:!1,setInputRef:function(){},setInputComponentRef:function(){}});var Om=Cm;function xm(e){return(xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nm(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function km(e){return(km=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pm(e,t){return(Pm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rm=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=km(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==xm(r)&&"function"!=typeof r?_m(a):r,jm(_m(n),"renderTimeoutBlock",function(){var e=n.props,t=e.subconfig,a=e.onConfigValueChange;return t.static?o.a.createElement(ea,{label:"Client timeout",details:"After this timeout from last client ondemand stream will be turned off"},o.a.createElement(hn,{value:t.clients_timeout,onChange:a(["clients_timeout"]),units:[{label:"seconds",factor:1}]})):null}),jm(_m(n),"renderThumbnails",function(){var e=n.props,t=e.subconfig,a=e.onConfigValueChange;return o.a.createElement(o.a.Fragment,null,o.a.createElement(ea,{expanded:!0,label:"Thumbnails",details:"Generate picture for each output segment"},o.a.createElement(ua,{label:"enabled",checked:t.thumbnails&&t.thumbnails.enabled,onClick:function(){return a(["thumbnails","enabled"],"raw")(!0)},isRadio:!0}),o.a.createElement(ua,{label:"disabled",checked:!t.thumbnails||!t.thumbnails.enabled,onClick:function(){return a(["thumbnails","enabled"],"raw")(!1)},className:"margin-left-10",isRadio:!0})),t.thumbnails&&t.thumbnails.enabled&&o.a.createElement(ea,{label:"Thumbnail URL",details:"take prepared thumbnail directly from source"},o.a.createElement(mn,{value:t.thumbnails.url,onChange:a(["thumbnails","url"],"string"),changed:t.thumbnails.url_changed})))}),jm(_m(n),"renderPushNodes",function(){var e=n.props,t=e.subconfig,a=e.onConfigValueChange,r=e.onConfigListElementDelete,i=t.pushes,s=void 0===i?{}:i,l=Bi(s);return o.a.createElement(Mu,{change:a,list:l},function(e){var t=e.setLastItemInputRef,n=e.setNewItemInputComponentRef,i=e.handleItemInput;return o.a.createElement(o.a.Fragment,null,l.map(function(e,n){return Ae(s[e])?o.a.createElement(Om,{key:e,pushes:s,push:s[e],pushKey:e,onChange:a,onDelete:r,setInputRef:n===l.length-1?t:K.a()}):null}),o.a.createElement(Om,{key:l.length,pushes:s,push:{url:""},pushKey:l.length,isNew:!0,onChange:i,onDelete:K.a(),setInputComponentRef:n}))})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pm(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.subconfig,n=e.config,a=e.onConfigValueChange,r=e.isConfigSaving,i=e.isConfigChanged,s=e.isSubconfigLoaded,l=e.onConfigSave;return s?o.a.createElement(Td.a,{px:"2.5%",pt:4,"data-testid":"stream-output"},o.a.createElement(Ps.a,{container:!0,spacing:2},o.a.createElement(Ps.a,{item:!0,xs:9},o.a.createElement(sm,{config:n,media:t,name:t.name,change:a})),o.a.createElement(Ps.a,{item:!0,xs:9},this.renderThumbnails()),o.a.createElement(Ps.a,{item:!0,xs:9},o.a.createElement(ea,{label:"Max sessions",details:"Maximum simultaneous users for this media"},o.a.createElement(mn,{value:t.auth?t.auth.max_sessions:"",onChange:function(e){return a(["auth","max_sessions"])(_i(e.target.value))},changed:!!t.auth&&t.auth.max_sessions_changed})),this.renderTimeoutBlock()),o.a.createElement(Ps.a,{item:!0,xs:9},o.a.createElement(gm,{media:t,change:this.props.onConfigValueChange})),o.a.createElement(Ps.a,{item:!0,xs:9},o.a.createElement("h1",{className:"head-text"},"Push live video to certain URLs")),o.a.createElement(Ps.a,{item:!0,xs:9},this.renderPushNodes()),o.a.createElement(Ps.a,{container:!0,item:!0,xs:9},o.a.createElement(Ps.a,{item:!0,xs:1},o.a.createElement(ua,{label:"save",disabled:r||!i,onClick:l,className:"rect filled"})),o.a.createElement(Ps.a,{item:!0,xs:11},o.a.createElement(ys,{running:r,className:"margin-left-10"}))))):null}}])&&Nm(n.prototype,a),r&&Nm(n,r),t}();jm(Rm,"propTypes",{config:Qa.isRequired,subconfig:Ia.isRequired,isConfigChanged:Y.a.bool.isRequired,isSubconfigLoaded:Y.a.bool.isRequired,onConfigValueChange:Y.a.func.isRequired,onConfigListElementDelete:Y.a.func.isRequired,onConfigSave:Y.a.func.isRequired,isConfigSaving:Y.a.bool.isRequired});var Tm=Q.a(es(Rm.propTypes,["streams",Ee.a("name")]),du())(Rm),Im=n(587),Dm=n(1424),Am=n(1437),qm=n(493),Mm=n.n(qm),Fm=n(364),Vm=function(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return clearTimeout(n),n=setTimeout(function(){n=null,Fm.a(t,o)},e),a?function(){clearTimeout(n)}:n}};function Bm(){return(Bm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Lm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Wm(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Hm=function(e){var t=e.defaultValue,n=e.label,a=e.fullWidth,i=e.debounceTime,s=e.onChange,l=e.validate,c=e.isRequired,u=e.getUnitString,p=e.getUnitValue,d=e.helperText,m=e.validateUnitString,f=Wm(e,["defaultValue","label","fullWidth","debounceTime","onChange","validate","isRequired","getUnitString","getUnitValue","helperText","validateUnitString"]),h=Lm(Object(r.useState)(u(t)),2),g=h[0],v=h[1],b=Lm(Object(r.useState)(!1),2),y=b[0],E=b[1],w=Lm(Object(r.useState)(""),2),S=w[0],C=w[1],O=Object(r.useCallback)(function(e){v(e.target.value)},[v]);return Object(r.useEffect)(Vm(i,function(){if(y){var e=m(g,c);if(e.isValid){var t=p(g),n=l(t,g);n.isValid?(s(t),C("")):C(n.validationError)}else C(e.validationError)}else E(!0)},!0),[g,t]),o.a.createElement(Ws,Bm({},f,{error:S,helperText:S||d,fullWidth:a,label:n,value:g,type:"text",onChange:O}))};Hm.propTypes={defaultValue:qa,label:Y.a.string,fullWidth:Y.a.bool,onChange:Y.a.func.isRequired,validate:Y.a.func,debounceTime:Y.a.number,isRequired:Y.a.bool,getUnitString:Y.a.func.isRequired,getUnitValue:Y.a.func.isRequired,helperText:Y.a.string,validateUnitString:Y.a.func.isRequired},Hm.defaultProps={label:null,debounceTime:1e3,fullWidth:!1,validate:K.a({isValid:!0}),isRequired:!1,helperText:null,defaultValue:null};function Um(){return(Um=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function zm(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Gm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Qm,Km=/(\d+)([g|t|p]?i?b?)/i,Jm=function(e){return(e?Mm()(e).format("0ib"):"").replace("i","")},Ym=function(e){if(e){var t=Gm(e.match(Km),3),n=t[1],a=t[2],r=(a.toLowerCase().startsWith("g")?"GiB":a.toLowerCase().startsWith("t")&&"TiB")||a.toLowerCase().startsWith("p")&&"PiB"||"GiB";return Mm()("".concat(n).concat(r)).value()}return null},$m=function(e,t){var n=Km.test(e),a=le.a(e),r=n||!t&&a,o="It's not correct size, good examples are 1024, 1Kb, 32gb, 50TB";return r||console.error(o,e),{isValid:r,validationError:r?"":o}},Xm=function(e){var t=e.defaultValue,n=e.label,a=e.fullWidth,r=e.debounceTime,i=e.onChange,s=e.validate,l=e.isRequired,c=zm(e,["defaultValue","label","fullWidth","debounceTime","onChange","validate","isRequired"]);return o.a.createElement(Hm,Um({},c,{onChange:i,defaultValue:t,label:n,fullWidth:a,debounceTime:r,validate:s,isRequired:l,getUnitString:Jm,getUnitValue:Ym,validateUnitString:$m,helperText:"Available size formats: 32Gb, 4Tb, ..."}))};function Zm(){return(Zm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ef(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Xm.propTypes={defaultValue:qa,label:Y.a.string,fullWidth:Y.a.bool,onChange:Y.a.func.isRequired,validate:Y.a.func,debounceTime:Y.a.number,isRequired:Y.a.bool},Xm.defaultProps={label:null,debounceTime:1e3,fullWidth:!1,validate:K.a({isValid:!0}),isRequired:!1,defaultValue:null};var nf={s:"s",m:"m",h:"h",d:"d",w:"w"},af=(tf(Qm={},nf.s,1),tf(Qm,nf.m,60),tf(Qm,nf.h,3600),tf(Qm,nf.d,86400),tf(Qm,nf.w,604800),Qm),rf=function(e){return e?Q.a(function(t){return"".concat(e/af[t]).concat(t)},ve.a(function(t,n){return e%af[n]==0&&af[t]<af[n]?n:t},nf.s),ye.a)(nf):""},of=function(e){var t=nf[Ut.a(e)],n=t?Ci.a(e):e;return parseInt(n,10)*(af[t]||1)},sf=function(e,t){var n=/^\d+(s|m|h|d|w)?$/.test(e),a=le.a(e),r=n||!t&&a,o="Time string should contains only digits and time unit at the end (s, m, h, d, w)";return r||console.error(o,e),{isValid:r,validationError:r?"":o}},lf=function(e){var t=e.defaultValue,n=e.label,a=e.fullWidth,r=e.debounceTime,i=e.onChange,s=e.validate,l=e.isRequired,c=ef(e,["defaultValue","label","fullWidth","debounceTime","onChange","validate","isRequired"]);return o.a.createElement(Hm,Zm({},c,{onChange:i,defaultValue:t,label:n,fullWidth:a,debounceTime:r,validate:s,isRequired:l,getUnitString:rf,getUnitValue:of,validateUnitString:sf,helperText:"Available time formats: 3600, 600s, 90m, 3h, 7d, 5w"}))};lf.propTypes={defaultValue:qa,label:Y.a.string,fullWidth:Y.a.bool,onChange:Y.a.func.isRequired,validate:Y.a.func,debounceTime:Y.a.number,isRequired:Y.a.bool},lf.defaultProps={label:null,debounceTime:1e3,fullWidth:!1,validate:K.a({isValid:!0}),isRequired:!1,defaultValue:null};var cf=function(e){var t=e.cache,n=e.onCacheChange;return o.a.createElement("div",null,o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left2-page margin-right-10"},o.a.createElement(ks.a,{fullWidth:!0,label:"Archive cache path",value:t.path,type:"text",inputProps:{"data-testid":"cachePath"},onChange:n(["path"],Di)})),o.a.createElement("div",{className:"right-page margin-left-10"},t.path&&o.a.createElement(Ps.a,{container:!0,spacing:1},o.a.createElement(Ps.a,{item:!0,xs:12,sm:4,md:12},o.a.createElement(Xm,{fullWidth:!0,label:"Maximum disk consumption (bytes)",defaultValue:t.disk_limit,onChange:n(["disk_limit"],Si.a),inputProps:{"data-testid":"cacheDiskLimit"}})),o.a.createElement(Ps.a,{item:!0,xs:12,sm:4,md:12},o.a.createElement(lf,{fullWidth:!0,label:"Cache expires",defaultValue:t.time_limit,onChange:n(["time_limit"],Si.a),inputProps:{"data-testid":"cacheTimeLimit"}}))))),o.a.createElement("div",{className:"right-page-container"})))};cf.propTypes={cache:Ta,onCacheChange:Y.a.func.isRequired},cf.defaultProps={cache:{}};var uf=cf,pf=function(e){var t=e.dvr,n=e.onValueChange,a=e.disabled;return r.createElement(Ps.a,{container:!0,spacing:1},r.createElement(Ps.a,{item:!0,xs:12,sm:4,md:12},r.createElement(Ws,{fullWidth:!0,disabled:a,label:"Maximum disk consumption",value:t.disk_limit,type:"number",inputProps:{min:0,max:100,"data-testid":"dvrDiskLimit"},InputProps:{endAdornment:r.createElement(Ts.a,{position:"end"},r.createElement(Id.a,{variant:"h6"},"%"))},onChange:n([t.name,"disk_limit"],Ii)})),r.createElement(Ps.a,{item:!0,xs:12,sm:4,md:12},r.createElement(Xm,{fullWidth:!0,disabled:a,label:"Maximum disk consumption",defaultValue:t.disk_space,onChange:n([t.name,"disk_space"],Si.a),inputProps:{"data-testid":"dvrDiskSpace"}})),r.createElement(Ps.a,{item:!0,xs:12,sm:4,md:12},r.createElement(lf,{fullWidth:!0,disabled:a,label:"Archive depth",defaultValue:t.dvr_limit,onChange:n([t.name,"dvr_limit"],Si.a),inputProps:{"data-testid":"dvrDvrLimit"}})))};pf.propTypes={dvr:La.isRequired,disabled:Y.a.bool,onValueChange:Y.a.func.isRequired},pf.defaultProps={disabled:!1};var df=pf,mf=n(1477),ff=function(e){var t=e.dvr,n=e.onValueToggle,a=e.onValueChange,o=e.disabled;return r.createElement(Ps.a,{container:!0,item:!0,xs:12,alignItems:"flex-end",spacing:1},r.createElement(Ps.a,{item:!0,xs:3},r.createElement(ta.a,{control:r.createElement(mf.a,{disabled:o,checked:t.dvr_replicate,onChange:n([t.name,"dvr_replicate"]),color:"primary","data-testid":"dvrReplicate"}),label:"Dvr replicate"})),r.createElement(Ps.a,{item:!0,xs:9},t.dvr_replicate&&r.createElement(ks.a,{fullWidth:!0,disabled:o||!t.dvr_replicate,label:"Replication port",value:t.replication_port,type:"number",inputProps:{min:1,max:65535},onChange:a([t.name,"replication_port"],Ii),"data-testid":"dvrReplicationPort"})))};ff.propTypes={dvr:La.isRequired,disabled:Y.a.bool,onValueToggle:Y.a.func.isRequired,onValueChange:Y.a.func.isRequired},ff.defaultProps={disabled:!1};var hf=ff;function gf(e){return(gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vf(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function bf(e){return(bf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ef(e,t){return(Ef=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Sf=function(e){var t=e.dvr,n=e.name;return Q.a(xi.a([[me.a(!1),K.a("")],[Ni.a,K.a("No need to specify stream directory, it will be created automatically.")]]),Re.a([K.a(Ae(n)),me.a(n)]),Ut.a,be.a(Ae),zt.a("/"),Im.a("","root"))(t)},Cf=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=bf(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==gf(r)&&"function"!=typeof r?yf(a):r,wf(yf(n),"handlePathChange",function(e){var t=e.target.value;t?(n.props.onExternalDvrChange(null),n.props.onDvrValueChange([],Si.a)(Object.assign({root:t},void 0!==n.props.dvr.reference&&{reference:n.props.dvr.reference}))):n.handleDvrDelete()}),wf(yf(n),"handleDvrDelete",function(){n.props.onExternalDvrChange(null),n.props.onDvrValueChange([])(null)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ef(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.externalDvr,n=e.dvr,a=e.name,r=function(e){var t=e.externalDvr,n=e.dvr;return{isExternal:Ie(t),isCustom:Ie(n.root)}}({externalDvr:t,dvr:n}),i=r.isExternal,s=r.isCustom,l=s||i?this.props.dvr.root:"";return o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left2-page margin-right-10"},o.a.createElement(Ws,{fullWidth:!0,label:"Path",type:"text",helperText:Sf({dvr:n,name:a})||"Where archive is stored",withRemoveButton:l&&!i,readOnly:i,value:l,onChange:this.handlePathChange,onRemoveButtonClick:this.handleDvrDelete,"data-testid":"streamDvrPath"}),(s||i)&&o.a.createElement(hf,{dvr:n,disabled:i,onValueToggle:this.props.onDvrValueToggle,onValueChange:this.props.onDvrValueChange})),o.a.createElement("div",{className:"right-page margin-left-10"},(s||i)&&o.a.createElement(df,{dvr:this.props.dvr,disabled:i,onValueChange:this.props.onDvrValueChange}))),o.a.createElement("div",{className:"right-page-container"}))}}])&&vf(n.prototype,a),r&&vf(n,r),t}();wf(Cf,"propTypes",{name:Y.a.string.isRequired,dvr:La.isRequired,onDvrValueChange:Y.a.func.isRequired,onDvrValueToggle:Y.a.func.isRequired,externalDvr:Y.a.string.isRequired,onExternalDvrChange:Y.a.func.isRequired});var Of=Cf,xf=n(677);function Nf(e){return(Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kf(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _f(e){return(_f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jf(e,t){return(jf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tf=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=_f(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Nf(r)&&"function"!=typeof r?Pf(a):r,Rf(Pf(n),"isMounted",!1),Rf(Pf(n),"state",{shouldMountDvr:!0,error:null}),Rf(Pf(n),"setStateSafe",function(){for(var e,t,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return n.isMounted?(e=n).setState.apply(e,r):(t=console).log.apply(t,["MediaDVRTimeline's setState called for unmounted component with args: "].concat(r))}),n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jf(e,t)}(t,r["Component"]),n=t,i=[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}],(a=[{key:"componentDidMount",value:function(){this.isMounted=!0}},{key:"componentDidUpdate",value:function(e){this.props.name!==e.name&&this.state.shouldMountDvr&&this.setStateSafe({shouldMountDvr:!1}),this.state.shouldMountDvr||this.setStateSafe({shouldMountDvr:!0})}},{key:"componentWillUnmount",value:function(){this.isMounted=!1}},{key:"componentDidCatch",value:function(e,t){console.log("DvrTimeline failed",{error:e,errorInfo:t})}},{key:"render",value:function(){return Ee.a("dvr_info",this.props.subconfig)||Ee.a("dvr_info",this.props.stats)?o.a.createElement("div",null,this.state.error?null:o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page"},o.a.createElement("div",{className:"ng-react-dvr",style:{position:"relative"}},this.state.shouldMountDvr?o.a.createElement(o.a.Fragment,null,o.a.createElement(xf.a,{name:this.props.name,streamer_http:E,streamer_rtmp:w,auth_token:N.adminToken(),autoPlay:!1,thumbnails_enabled:!1})):o.a.createElement("div",null,"Loading...")))),o.a.createElement("div",{className:"right-page-container"}))):null}}])&&kf(n.prototype,a),i&&kf(n,i),t}();Rf(Tf,"propTypes",{entityPath:Y.a.string,name:Y.a.string.isRequired,subconfig:Oa.isRequired,stats:Oa.isRequired,statsPath:Y.a.arrayOf(Y.a.string)}),Rf(Tf,"defaultProps",{statsPath:null});var If=Q.a(es(Tf.propTypes,[Ee.a("entityPath"),Ee.a("name"),Im.a(["stats"],"statsPath")]),du())(Tf);function Df(e){return(Df="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Af(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function qf(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Mf(e){return(Mf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ff(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vf(e,t){return(Vf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lf=function(e,t,n){return Q.a(xi.a([[Ie,Si.a],[Ni.a,K.a(ke.a(e,n[t.reference]))]]),ke.a(e))(t)},Wf=function(e){var t=e.dvr,n=e.dvrs;return{root:Lf(["root"],t,n),disk_limit:Lf(["disk_limit"],t,n),disk_space:Lf(["disk_space"],t,n),dvr_limit:Lf(["dvr_limit"],t,n),dvr_replicate:Lf(["dvr_replicate"],t,n),replication_port:Lf(["replication_port"],t,n),reference:t.reference}},Hf=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Mf(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Df(r)&&"function"!=typeof r?Ff(a):r,Bf(Ff(n),"handleExternalDvrChange",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Si.a;n.props.onConfigValueChange(["external_dvr"],"raw")(t(e))}),Bf(Ff(n),"handleDvrValueChange",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ti;return function(a){var r=e.filter(Boolean);n.props.onConfigValueChange(["dvr"].concat(Af(r)),"raw")(t(a))}}),Bf(Ff(n),"handleDvrValueToggle",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ce.a;return function(){var a=e.filter(Boolean),r=t(ke.a(["dvr"].concat(Af(a)),n.props.subconfig));n.props.onConfigValueChange(["dvr"].concat(Af(a)),"raw")(r)}}),Bf(Ff(n),"handleCacheChange",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ti;return function(a){var r=e.filter(Boolean);n.props.onConfigValueChange(["cache"].concat(Af(r)),"raw")(t(a))}}),Bf(Ff(n),"renderDvrSelector",function(e){var t=e.dvrs,n=e.stream,a=e.onConfigValueChange;return o.a.createElement(Dm.a,{fullWidth:!0},o.a.createElement(xs.a,{htmlFor:"dvrSelector"},"Global DVR config"),o.a.createElement(Cs.a,{autoWidth:!0,value:ke.a(["dvr","reference"],n),onChange:function(e){var t=e.target.value;a(["dvr"],"raw")(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Bf(e,t,n[t])})}return e}({},n.dvr,{root:null,reference:t}))},inputProps:{id:"dvrSelector"},"data-testid":"dvrSelector"},Object.keys(t).map(function(e){return o.a.createElement(Ns.a,{key:e,value:e},e)})),o.a.createElement(Et,{to:"dvrs"},"Edit DVR configurations"))}),Bf(Ff(n),"renderActions",function(e){var t=e.isConfigSaving,n=e.isConfigChanged,a=e.onConfigSave,r=e.onConfigResetChanges;return o.a.createElement(Td.a,{mt:2},o.a.createElement(Ps.a,{container:!0,spacing:1},o.a.createElement(Ps.a,{item:!0},o.a.createElement(Hs.a,{color:"primary",variant:"contained",onClick:a,disabled:!n,"data-testid":"dvrSaveButton"},t&&o.a.createElement(Am.a,{size:20,color:"primary"}),"Save")),o.a.createElement(Ps.a,{item:!0},o.a.createElement(Hs.a,{variant:"contained",onClick:r,disabled:!n,"data-testid":"dvrResetButton"},"Reset"))))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vf(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.isConfigSaving,n=e.isConfigChanged,a=e.onConfigSave,r=e.onConfigResetChanges,i=e.onConfigValueChange,s=Vi(this.props.subconfig),l=Vi(s.dvr)||{},c=Vi(Im.a({},"dvrs",this.props.config));return Ae(s)?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{"data-testid":"dvrPage"},this.props.shouldRenderTimeline?o.a.createElement(If,{name:s.name,entityPath:this.props.entityPath,statsPath:this.props.statsPath}):o.a.createElement("div",{className:"row-height"}),!this.props.hideSettings&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},this.renderDvrSelector({dvrs:c,stream:s,onConfigValueChange:i}))),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"row-height"}),o.a.createElement(Of,{name:s.name||l.reference,dvr:Wf({dvr:l,dvrs:c}),externalDvr:s.external_dvr,onExternalDvrChange:this.handleExternalDvrChange,onDvrValueChange:this.handleDvrValueChange,onDvrValueToggle:this.handleDvrValueToggle}),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("h1",{className:"head-text"},"SSD disk cache"),o.a.createElement("div",{className:"notice-text"},"Cache requested archive segments. Useful even if no local dvr defined, for proxied remote dvr."))),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement(uf,{cache:s.cache,onCacheChange:this.handleCacheChange}),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},this.renderActions({isConfigSaving:t,isConfigChanged:n,onConfigSave:a,onConfigResetChanges:r})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"}))))):null}}])&&qf(n.prototype,a),r&&qf(n,r),t}();Bf(Hf,"propTypes",{config:Qa.isRequired,subconfig:Ia.isRequired,isConfigChanged:Y.a.bool.isRequired,onConfigValueChange:Y.a.func.isRequired,onConfigSave:Y.a.func.isRequired,onConfigResetChanges:Y.a.func.isRequired,isConfigSaving:Y.a.bool.isRequired,shouldRenderTimeline:Y.a.bool,entityPath:Y.a.arrayOf(Y.a.oneOfType([Y.a.string,Y.a.number])),statsPath:Y.a.arrayOf(Y.a.string),hideSettings:Y.a.bool}),Bf(Hf,"defaultProps",{shouldRenderTimeline:!1,entityPath:["streams"],statsPath:null,hideSettings:!1});var Uf=Q.a(es(Hf.propTypes,[Ee.a("entity"),Ee.a("name"),Ee.a("subentity"),Ee.a("subentityName")]),du())(Hf),zf=n(579),Gf=n(575),Qf=n(119),Kf=n(365),Jf=n(1446),Yf=n(1438),$f=n(666),Xf=n.n($f),Zf=n(1440),eh=n(1384),th=n(680),nh=n(1439),ah=n(1426);function rh(){return(rh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function oh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ih(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var sh=function(e){var t=e.buttonText,n=e.onButtonClick,a=e.items,r=e.color,i=ih(e,["buttonText","onButtonClick","items","color"]),s=oh(o.a.useState(!1),2),l=s[0],c=s[1],u=o.a.useRef(null),p=function(){c(function(e){return!e})},d=function(e){u.current&&u.current.contains(e.target)||c(!1)},m=o.a.useCallback(function(e){return function(t){p(),e(t)}});return o.a.createElement(Td.a,null,o.a.createElement(Ps.a,{container:!0},o.a.createElement(Ps.a,{container:!0,item:!0,xs:12,align:"center",justify:"flex-end"},o.a.createElement(Yf.a,{color:r,variant:"contained",ref:u,"aria-label":"split button"},o.a.createElement(Zs,{color:r,variant:"contained",onClick:n||p,"data-testid":"".concat(i["data-testid"],"Button")},t),o.a.createElement(Zs,{color:r,variant:"contained",size:"small",onClick:p,"data-testid":"".concat(i["data-testid"],"DropdownButton")},o.a.createElement(Xf.a,null))),o.a.createElement(nh.a,{open:l,anchorEl:u.current,transition:!0},function(e){var t=e.TransitionProps,n=e.placement;return o.a.createElement(eh.a,rh({},t,{style:{transformOrigin:"bottom"===n?"center top":"center bottom"}}),o.a.createElement(th.a,{id:"menu-list-grow"},o.a.createElement(Zf.a,{onClickAway:d},o.a.createElement(ah.a,null,a.map(function(e){var t=e.text,n=e.onClick,a=e["data-testid"];return o.a.createElement(Ns.a,{key:t,onClick:m(n),"data-testid":a},t)})))))}))))};sh.propTypes={buttonText:Y.a.string.isRequired,onButtonClick:Y.a.func,items:Y.a.arrayOf(Y.a.shape({text:Y.a.string,onClick:Y.a.func})),"data-testid":Y.a.string,color:Y.a.string},sh.defaultProps={onButtonClick:void 0,items:[],color:"primary","data-testid":void 0};var lh=sh,ch=n(585),uh=n(369),ph=n(199);function dh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mh=Se.a(function(e,t){var n=_i(t);return Number.isNaN(n)||we.a(n)||n<1?e:n}),fh=Si.a,hh=function(e){return ch.a(["global","hw"],e)},gh=hh("coder"),vh=hh("nvenc"),bh=hh("qsv"),yh=function(e){return hh("cpu")(e)||!vh(e)&&!bh(e)},Eh=function(e){return function(t,n){return ch.a(["video",n,"codec"],e,t)}},wh=Eh("h264"),Sh=Eh("hevc"),Ch=Eh("mp2v"),Oh=-1,xh=function(e){return[0,Oh].includes(e)||we.a(e)||le.a(e)},Nh=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){var a,r="width"===e?"height":"width",o=t[r],i=qe(n),s=qe(o),l=n===Oh,c=o===Oh;return i&&s||l&&c||l&&s||i&&c?null:(dh(a={},e,i&&!s?Oh:n),dh(a,r,!i&&s?Oh:o),a)}},kh=function(e){return xh(e)?"auto":e},_h=function(e){return"copy"===Ee.a("bitrate",e)},Ph=Q.a(uh.a(1e3),Pi("0")),jh=function(e){var t=e.path,n=e.x,a=e.y,r=e.r;return{path:t.trim(),x:n,y:a,r:r}},Rh=function(e){return Ie(e)?1e3*Pi(null,e):e},Th="cpu",Ih="qsv",Dh="nvenc",Ah="coder",qh=[Th,Ih,Dh,Ah],Mh=["adaptive","bob","weave"],Fh=[!1,!0].concat(Mh),Vh=[1,2,4,5,6,8],Bh=[0,8e3,16e3,32e3,44100,48e3],Lh=["0","8000","16000","32000","44100","48000"],Wh=["aac","mp2a","opus"],Hh=["h264","hevc","mp2v"],Uh=["veryslow","slower","slow","medium","fast","faster","veryfast"],zh=["bd","default","ll","llhq","loseless","loselesshq","medium","veryfast","zerolatency"],Gh=["baseline","high","main"],Qh=["main","main10"],Kh=["high","main","simple"],Jh=["1","1b","1.1","1.2","1.3","2","2.1","2.2","3","3.1","3.2","4","4.1","4.2","5","5.1","5.2"],Yh=["1","2","2.1","3","4","4.1","5","5.1","5.2","6","6.1","6.2"],$h=["high","high1440","low","main"],Xh=[24,25,30,50,60],Zh=[0,1,2,3],eg=[1,2,3,4,5,6],tg={global:{hw:Ri(qh),deviceid:function(e){return xi.a([[le.a,K.a(null)],[Ni.a,Pi(null)]])(e)},external:function(e,t){return!!vh(t)&&(!!we.a(e)||e)},seamless:Si.a},decoder:{deinterlace:function(e,t){return vh(t)?Ri(Fh,null)(e):e},drop_second:function(e,t){return vh(t)&&!!e||null},threads:function(e,t){return yh(t)?Pi(null,e):null},crop:function(e,t){return vh(t)?e:{}}},audio:{bitrate:Si.a,sample_rate:function(e){return Bh.includes(e)?e:Lh.includes(e)?parseInt(e,10):null},codec:Ri(Wh),channels:xi.a([[ph.a(Ai.a)(Vh),Si.a],[Ni.a,K.a(null)]])},video:{bitrate:fh,codec:Ri(Hh),preset:function(e,t){return(yh(t)||bh(t))&&Ri(Uh,null)(e)||vh(t)&&Ri(zh,null)(e)||null},profile:function(e,t,n){return wh(t,n)&&Ri(Gh,null)(e)||Sh(t,n)&&Ri(Qh,null)(e)||Ch(t,n)&&Ri(Kh,null)(e)||Ri(Gh,null)(e)},level:function(e,t,n){return wh(t,n)&&Ri(Jh,null)(e)||Sh(t,n)&&Ri(Yh,null)(e)||Ch(t,n)&&Ri($h,null)(e)||Ri(Jh,null)(e)},size:Si.a,logo:jh,alogo:jh,fps:Ri(Xh,null),bframes:Ri(Zh,null),refs:Ri(eg,null),g:mh("auto"),disable_cgop:Boolean,aspect:function(e){return Ie(e)&&Ie(e.x)&&Ie(e.y)&&!Number.isNaN(e.x)&&!Number.isNaN(e.y)?e:null}}},ng=n(1476),ag=n(1441),rg=n(1442),og=n(266),ig=n.n(og);var sg=Object(Us.a)(function(e){return Object(zs.a)({borderedSection:{borderTop:"1px solid ".concat(e.palette.grey.light)},expansionPanelSummary:{padding:0,flexDirection:"row-reverse","& > div[class*=expandIcon]":{paddingLeft:0,paddingRight:e.spacing(3)},"& > div[class*=expandIcon][class*=expanded]":{paddingRight:0,marginRight:0,paddingLeft:e.spacing(1.5)}},expansionPanelDetails:{padding:function(t){return t.isPadded?"0 ".concat(e.spacing(3),"px"):0}}})}),lg=function(e){var t,n,a,r=e.header,i=e.children,s=e.headerRight,l=e.className,c=e.isTopIndented,u=e.isBold,p=e.isBordered,d=e.isExpanded,m=e.isPadded,f=e.onChange,h=e["data-testid"],g=sg({isPadded:m});return o.a.createElement(Td.a,{className:an()(l,(t={},n=g.borderedSection,a=p,n in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t)),mt:c?2:0,"data-testid":h},o.a.createElement(Ps.a,{container:!0},o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(ng.a,{elevation:0,expanded:d,onChange:f},o.a.createElement(ag.a,{classes:{root:g.expansionPanelSummary},expandIcon:o.a.createElement(ig.a,null)},o.a.createElement(Td.a,{width:"100%"},s?o.a.createElement(Ps.a,{container:!0,item:!0,xs:12,sm:6,md:8,xl:9,justify:"flex-start"},o.a.createElement(Td.a,{fontWeight:u?"600":"inherit",width:"100%"},r)):o.a.createElement(Ps.a,{container:!0,item:!0,xs:12,justify:"flex-start"},o.a.createElement(Td.a,{fontWeight:u?"600":"inherit",width:"100%"},r)),s&&o.a.createElement(Ps.a,{container:!0,item:!0,xs:12,sm:6,md:4,xl:3,justify:"flex-end",width:"100%"},s))),o.a.createElement(rg.a,{classes:{root:g.expansionPanelDetails}},i)))))};lg.propTypes={className:Y.a.string,header:Y.a.node.isRequired,isTopIndented:Y.a.bool,isBold:Y.a.bool,isBordered:Y.a.bool,isExpanded:Y.a.bool,isPadded:Y.a.bool,onChange:Y.a.func,children:Y.a.node,headerRight:Y.a.node,"data-testid":Y.a.string},lg.defaultProps={className:null,children:null,headerRight:null,isTopIndented:!1,isBold:!1,isBordered:!1,isExpanded:void 0,isPadded:!1,onChange:void 0,"data-testid":void 0};var cg=lg,ug=n(190),pg=n(1443),dg=n(668),mg=n.n(dg),fg=n(1425);function hg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var gg=Object(Us.a)(function(e){return Object(zs.a)({typography:{margin:e.spacing(2)},paper:{maxWidth:function(e){return e.maxWidth||"100%"}}})}),vg=function(e){var t=e.message,n=e.maxWidth,a=gg({maxWidth:n}),r=hg(o.a.useState(null),2),i=r[0],s=r[1],l=o.a.useCallback(function(e){e.stopPropagation(),s(e.currentTarget)},[s]),c=o.a.useCallback(function(e){e.stopPropagation(),s(null)},[s]),u=Boolean(i);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Is.a,{size:"small",color:"primary",onClick:l},o.a.createElement(mg.a,{fontSize:"inherit"})),o.a.createElement(fg.a,{open:u,anchorEl:i,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},classes:{paper:a.paper}},o.a.createElement(Id.a,{variant:"subtitle1",className:a.typography},o.a.createElement("span",{dangerouslySetInnerHTML:{__html:t}}))))};function bg(){return(bg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function yg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Eg(e,t,n[t])})}return e}function Eg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wg(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}vg.propTypes={message:Y.a.string.isRequired,maxWidth:Y.a.oneOfType([Y.a.number,Y.a.string])},vg.defaultProps={maxWidth:"50%"};var Sg=Object(Us.a)(function(){return Object(zs.a)({formControlLabelRoot:{marginBottom:0}})}),Cg=function(e){var t=e.isSwitch,n=e.isRadio,a=e.checked,r=e.onChange,i=e.value,s=e.label,l=e.labelPlacement,c=e.disabled,u=e.color,p=e.size,d=e.HelperDocProps,m=wg(e,["isSwitch","isRadio","checked","onChange","value","label","labelPlacement","disabled","color","size","HelperDocProps"]),f=Sg(),h=t&&pg.a||n&&na.a||mf.a;return o.a.createElement(Td.a,{display:"flex",alignItems:"center"},o.a.createElement(ta.a,{classes:{root:f.formControlLabelRoot},label:s,disabled:c,onClick:function(e){return e.stopPropagation()},labelPlacement:l,control:o.a.createElement(h,bg({checked:a,onChange:r,onClick:function(e){return e.stopPropagation()},value:i,color:u,size:p,inputProps:yg({},m.inputProps,{"data-testid":m["data-testid"]})},ts.a(["data-testid","inputProps"],m)))}),d&&o.a.createElement(vg,d))};Cg.propTypes={isSwitch:Y.a.bool,isRadio:Y.a.bool,checked:Y.a.bool.isRequired,onChange:Y.a.func.isRequired,label:Y.a.string.isRequired,disabled:Y.a.bool,wrapperClassName:Y.a.string,value:qa,labelPlacement:Y.a.oneOf(["end","start","bottom","top"]),color:Y.a.oneOf(["default","primary","secondary","inherit"]),size:Y.a.oneOf(["small","medium","large"]),HelperDocProps:Y.a.shape({message:Y.a.string.isRequired,maxWidth:Y.a.oneOfType([Y.a.number,Y.a.string])}),"data-testid":Y.a.string},Cg.defaultProps={isSwitch:!1,isRadio:!1,disabled:!1,value:void 0,color:"default",size:"medium",labelPlacement:"end",wrapperClassName:void 0,HelperDocProps:void 0,"data-testid":void 0};var Og=Cg,xg=n(1427);function Ng(){return(Ng=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function kg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _g(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Pg=Object(Us.a)(function(){return Object(zs.a)({formControl:{display:"flex"}})}),jg=function(e){var t=e.label,n=e.value,a=e.onChange,r=e.onClose,i=e.inputProps,s=e.displayEmpty,l=e.name,c=e.formClassName,u=e.autoWidth,p=e.helperText,d=e.multiple,m=e.items,f=e.disabled,h=e.HelperDocProps,g=_g(e,["label","value","onChange","onClose","inputProps","displayEmpty","name","formClassName","autoWidth","helperText","multiple","items","disabled","HelperDocProps"]),v=Pg();return o.a.createElement(Td.a,{width:"100%"},o.a.createElement(Td.a,{display:"flex"},o.a.createElement(Td.a,{width:h?"calc(100% - 24px)":"100%"},o.a.createElement(Dm.a,{className:an()(c,v.formControl),disabled:f},o.a.createElement(xs.a,null,t),o.a.createElement(Cs.a,Ng({value:n,onChange:a,onClick:function(e){return e.stopPropagation()},onClose:r,inputProps:i,displayEmpty:s,autoWidth:u,name:l,multiple:d},g),m.map(function(e){var t=kg(e,3),n=t[0],a=t[1],r=t[2],i=void 0===r?n:r;return o.a.createElement(Ns.a,{key:n,value:n,onClick:function(e){return e.stopPropagation()},"data-testid":i},a)})),p&&o.a.createElement(xg.a,null,p))),h&&o.a.createElement(Td.a,{display:"flex",flexDirection:"column-reverse",mb:"4px"},o.a.createElement(vg,h))))};jg.propTypes={label:Y.a.string.isRequired,value:qa,onChange:Y.a.func.isRequired,onClose:Y.a.func,inputProps:Y.a.any,displayEmpty:Y.a.bool,name:Y.a.string,formClassName:Y.a.string,autoWidth:Y.a.bool,helperText:Y.a.string,multiple:Y.a.bool,disabled:Y.a.bool,items:Y.a.arrayOf(Y.a.arrayOf(qa)).isRequired,"data-testid":Y.a.string,HelperDocProps:Y.a.shape({message:Y.a.string.isRequired,maxWidth:Y.a.oneOfType([Y.a.number,Y.a.string])})},jg.defaultProps={value:void 0,onClose:K.a(),inputProps:void 0,displayEmpty:!1,name:void 0,formClassName:void 0,autoWidth:!1,helperText:void 0,multiple:!1,disabled:!1,HelperDocProps:void 0,"data-testid":void 0};var Rg=jg;function Tg(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ig=Aa,Dg=Y.a.shape({path:Y.a.string,x:Aa,y:Aa,r:Y.a.bool}),Ag=Y.a.shape({bitrate:Ig,codec:Y.a.oneOf(Hh),preset:Y.a.oneOfType([Y.a.oneOf(Uh),Y.a.oneOf(zh)]),profile:Y.a.oneOfType([Y.a.oneOf(Gh),Y.a.oneOf(Qh),Y.a.oneOf(Kh)]),level:Y.a.oneOfType([Y.a.oneOf(Jh),Y.a.oneOf(Yh),Y.a.oneOf($h)]),size:Y.a.shape({height:Y.a.number,width:Y.a.number}),logo:Dg,alogo:Dg,fps:Y.a.oneOf([].concat(Tg(Xh),Tg(["24","25","30","60"]))),bframes:Y.a.oneOf([].concat(Tg(Zh),Tg(["0","1","2","3"]))),refs:Y.a.oneOf([].concat(Tg(eg),Tg(["1","2","3","4","5","6"]))),g:Aa,gop:Aa,disable_cgop:Y.a.oneOf([0,1,"0","1"])}),qg=Y.a.shape({global:Y.a.shape({hw:Y.a.oneOf(qh),deviceid:Aa}),decoder:Y.a.shape({deinterlace:Y.a.oneOf(Fh),drop_second:Y.a.string,threads:Aa,crop:Y.a.arrayOf(Y.a.number)}),audio:Y.a.shape({bitrate:Ig,sample_rate:Y.a.oneOf([].concat(Tg(Bh),Tg(Lh))),codec:Y.a.oneOf(Wh)}),video:ha()(Ag)}),Mg=n(376),Fg=Ee.a("left"),Vg=Ee.a("top"),Bg=Ee.a("width"),Lg=Ee.a("height"),Wg=hl(fl(function(e){var t=e.crop,n=e.field,a=Pi(0,t[n]);return qe(t[n])||a>0},"Should be greater than zero."),fl(function(e){var t=e.crop,n=e.field,a=qe(t)||Mg.a(Ae,[Fg(t),Vg(t),Bg(t),Lg(t)])||Mg.a(qe,[Fg(t),Vg(t),Bg(t),Lg(t)]),r=Ae(t)&&Ae(t[n]);return a||r},"Required, if crop set.")),Hg=hl(fl(function(e){var t=e.value,n=Pi(0,t);return qe(t)||n>0},"Should be greater than zero.")),Ug=Q.a(Ae,Ee.a("value")),zg=hl(fl(function(e){var t=e.value,n=Pi(0,t);return qe(t)||n>0},"Should be greater than zero."),fl(Ug,"Bitrate is required."));function Gg(e){return(Gg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qg(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Kg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Zg(e,t,n[t])})}return e}function Jg(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Yg(e){return(Yg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xg(e,t){return(Xg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ev=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Yg(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Gg(r)&&"function"!=typeof r?$g(a):r,Zg($g(n),"handleCropAllFieldsValidate",function(e,t){var a=Kg({},Es.a({},["decoder","crop"],n.props.transcoderSettings),Zg({},e,t));["left","top","width","height"].forEach(function(e){var t=Wg({field:e,crop:a});t.isValid?n.props.onErrorResolve(["decoder","crop",e])():n.props.onError(["decoder","crop",e])(t.error)})}),Zg($g(n),"handleTranscoderFieldChange",function(e){return function(t){var a=Pi(void 0),r=a(Ti(t));n.props.onTranscoderChange(["decoder","crop"],e,a)(t),n.handleCropAllFieldsValidate(e,r)}}),Zg($g(n),"handleTranscoderCropRemove",function(){n.props.onTranscoderChange(["decoder"],"crop",K.a(null))(),n.props.onErrorResolve(["decoder","crop","left"])(),n.props.onErrorResolve(["decoder","crop","top"])(),n.props.onErrorResolve(["decoder","crop","width"])(),n.props.onErrorResolve(["decoder","crop","height"])()}),Zg($g(n),"renderDecoderThreadsSettings",function(){var e=tg.decoder.threads,t=n.props,a=t.transcoderSettings,r=t.onTranscoderChange,i=t.onError,s=t.onErrorResolve,l=t.errors,c=a.decoder;return yh(a)&&o.a.createElement(Ws,{type:"number","data-testid":"decoder-threads",label:"Decoder threads",value:e(Ee.a("threads",c),a),onChange:r(["decoder"],"threads",function(t){return e(t,a)}),validate:function(e){return Hg({value:e})},onError:i(["decoder","threads"]),onErrorResolve:s(["decoder","threads"]),error:l[ul(["decoder","threads"])]})}),Zg($g(n),"renderDecoderDropSecondSettings",function(){var e=tg.decoder.drop_second,t=n.props,a=t.transcoderSettings,r=t.onTranscoderChange,i=a.decoder;return vh(a)&&o.a.createElement(Og,{label:"Drop second","data-testid":"decoder-drop-second",color:"primary",checked:e(Ee.a("drop_second",i),a),onChange:r(["decoder"],"drop_second",function(t){return e(t,a)},!0)})}),Zg($g(n),"renderGlobalExternalSettings",function(){var e=tg.global.external,t=n.props,a=t.onTranscoderChange,r=t.transcoderSettings,i=r.global;return vh(r)&&o.a.createElement(Og,{label:"Speed up the transcoder by running it as part of Flussonic (use with caution)",color:"primary","data-testid":"global-external",checked:!e(Ee.a("external",i),r),onChange:a(["global"],"external",function(t){return!e(t,r)},!0)})}),Zg($g(n),"renderDecoderCropSettings",function(){var e=tg.decoder.crop,t=n.props.transcoderSettings,a=t.decoder;return vh(t)&&o.a.createElement(Ps.a,{container:!0,spacing:1},o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Ws,{type:"number","data-testid":"decoder-crop-x",label:"Crop - X",isNilable:!0,value:Ee.a("left",e(Ee.a("crop",a),t)),onChange:n.handleTranscoderFieldChange("left"),error:n.props.errors[ul(["decoder","crop","left"])]})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Ws,{type:"number","data-testid":"decoder-crop-y",label:"Crop - Y",isNilable:!0,value:Ee.a("top",e(Ee.a("crop",a),t)),onChange:n.handleTranscoderFieldChange("top"),error:n.props.errors[ul(["decoder","crop","top"])]})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Ws,{type:"number","data-testid":"decoder-crop-width",label:"Crop - Width",isNilable:!0,value:Ee.a("width",e(Ee.a("crop",a),t)),onChange:n.handleTranscoderFieldChange("width"),error:n.props.errors[ul(["decoder","crop","width"])]})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Ws,{type:"number","data-testid":"decoder-crop-height",label:"Crop - Height",isNilable:!0,value:Ee.a("height",e(Ee.a("crop",a),t)),onChange:n.handleTranscoderFieldChange("height"),error:n.props.errors[ul(["decoder","crop","height"])]})),o.a.createElement(Ps.a,{container:!0,item:!0,xs:4,justify:"flex-end",alignItems:"center"},o.a.createElement(Zs,{variant:"outlined",color:"red","data-testid":"decoder-crop-remove",size:"small",onClick:n.handleTranscoderCropRemove},"remove crop")))}),Zg($g(n),"renderOtherSettings",function(){var e=n.props,t=e.onToggleSettings,a=e.isSettingsExpanded;return o.a.createElement(cg,{toggleOpen:t("other"),isOpen:a.other,header:"Other settings",isTopIndented:!0,isBold:!0,"data-testid":"transcoderOtherSettings"},o.a.createElement(Ps.a,{container:!0},o.a.createElement(Ps.a,{item:!0,xs:12},n.renderDecoderCropSettings()),o.a.createElement(Ps.a,{item:!0,xs:12},n.renderDecoderThreadsSettings()),o.a.createElement(Ps.a,{item:!0,xs:12},n.renderDecoderDropSecondSettings()),o.a.createElement(Ps.a,{item:!0,xs:12},n.renderGlobalExternalSettings())))}),Zg($g(n),"renderAudioTitle",function(){return o.a.createElement(Td.a,{fontWeight:500,fontSize:16},"Audio")}),Zg($g(n),"renderAudioBitrate",function(){var e=n.props,t=e.transcoderSettings,a=e.onTranscoderChange,r=e.errors,i=e.onErrorResolve,s=e.onError,l=t.audio;return o.a.createElement(Ws,{type:_h(l)?"text":"number","data-testid":"audio-bitrate",label:"Bitrate",adornment:o.a.createElement(Td.a,{fontSize:16},"K"),disabled:_h(l),value:(_h(l)?"copy":l&&Ie(l.bitrate)&&Im.a(0,"bitrate",l)/1e3)||"",onChange:_h(l)?K.a():a(["audio"],"bitrate",Rh),validate:function(e){return zg({value:e})},onError:s(["audio","bitrate"]),onErrorResolve:i(["audio","bitrate"]),error:r[ul(["audio","bitrate"])]})}),Zg($g(n),"renderAudioSampleRate",function(){var e=tg.audio.sample_rate,t=n.props,a=t.transcoderSettings,r=t.onTranscoderChange,i=a.audio;return o.a.createElement(Rg,{label:"Sample rate",value:e(Ee.a("sample_rate",i)),"data-testid":"audio-sample-rate",onChange:r(["audio"],"sample_rate",Q.a(e,Pi(-1))),items:[[null,""],[Bh[0],"bypass"]].concat(Qg(ug.a(Bh).map(function(e){return[e,e]})))})}),Zg($g(n),"renderAudioCodec",function(){var e=tg.audio.codec,t=n.props,a=t.transcoderSettings,r=t.onTranscoderChange,i=a.audio;return o.a.createElement(Rg,{label:"Codec",value:e(Ee.a("codec",i))||"","data-testid":"audio-codec",onChange:r(["audio"],"codec",e),items:Wh.map(function(e){return[e,e]})})}),Zg($g(n),"renderAudioChannels",function(){var e=tg.audio.channels,t=n.props,a=t.transcoderSettings,r=t.onTranscoderChange,i=a.audio;return o.a.createElement(Rg,{displayEmpty:!0,label:"Channels",value:e(Ee.a("channels",i))||"","data-testid":"audio-channels",onChange:r(["audio"],"channels",_i),items:[[null,""]].concat(Qg(Vh.map(function(e){return[e,e]})))})}),Zg($g(n),"renderAudioSwitch",function(){var e=n.props,t=e.transcoderSettings,a=e.onTranscoderChange,r=t.audio;return o.a.createElement(Td.a,{mr:-1.5},o.a.createElement(Og,{isSwitch:!0,label:"Use defaults",checked:we.a(r),"data-testid":"audio-defaults",color:"primary",value:r,onChange:a([],"audio",function(e){return e?null:{bitrate:64e3,sample_rate:null,codec:"aac"}},!0)}))}),Zg($g(n),"renderAudioCopy",function(){var e=n.props,t=e.transcoderSettings,a=e.transcoderSettingsBackup,r=e.onTranscoderChange,i=t.audio;return o.a.createElement(Og,{isSwitch:!0,size:"small",label:"Copy from origin",checked:_h(i),color:"primary",value:i&&i.bitrate||void 0,"data-testid":"audio-bitrate-copy",onChange:r([],"audio",function(e){return e?Kg({},Object.keys(Vi(t.audio)).reduce(function(e,t){return Kg({},e,Zg({},t,null))},{}),{bitrate:"copy"}):Kg({},Object.keys(Vi(a.audio)).reduce(function(e,t){return Kg({},e,Zg({},t,a.audio[t]))},{}),{bitrate:a.audio&&a.audio.bitrate||null})},!0)})}),Zg($g(n),"renderAudioSettings",function(){var e=n.props.transcoderSettings.audio;return o.a.createElement(Td.a,{mt:2,ml:4.5},o.a.createElement(Ps.a,{container:!0,spacing:2},o.a.createElement(Td.a,{display:"flex",alignItems:"center",width:80},n.renderAudioTitle()),o.a.createElement(Ps.a,{container:!0,item:!0,xs:4,alignItems:"center"},Ie(e)&&n.renderAudioCopy()),o.a.createElement(Ps.a,{container:!0,item:!0,xs:!0,justify:"flex-end",alignItems:"center"},o.a.createElement(Td.a,{mr:.5},n.renderAudioSwitch()))),o.a.createElement(Ps.a,{container:!0,spacing:1,wrap:"nowrap"},o.a.createElement(Ps.a,{item:!0,xs:2},Ie(e)&&n.renderAudioBitrate()),!_h(e)&&Ie(e)&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ps.a,{item:!0,xs:2},n.renderAudioSampleRate()),o.a.createElement(Ps.a,{item:!0,xs:2},n.renderAudioCodec()),o.a.createElement(Ps.a,{item:!0,xs:2},n.renderAudioChannels()))))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xg(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,this.renderAudioSettings(),this.renderOtherSettings())}}])&&Jg(n.prototype,a),r&&Jg(n,r),t}();Zg(ev,"propTypes",{transcoderSettings:qg.isRequired,transcoderSettingsBackup:qg.isRequired,onToggleSettings:Y.a.func.isRequired,isSettingsExpanded:Y.a.shape({global:Y.a.bool,decoder:Y.a.bool,audio:Y.a.bool,video:ha()(Y.a.bool)}).isRequired,onTranscoderChange:Y.a.func.isRequired,onError:Y.a.func.isRequired,onErrorResolve:Y.a.func.isRequired,errors:ha()(Y.a.string).isRequired});var tv=n(586),nv='<span data-helper="transcoder-hardware-acceleration"><strong>Hardware acceleration</strong> &#x2014; enables <a href="https://flussonic.com/doc/transcoder" target="_blank" rel="noopener" target="_blank">hardware transcoding</a>. Hardware transcoding allows for significantly more streams to be transcoded on a single server.</span>',av='<span data-helper="transcoder-deinterlace-mode"><strong>Deinterlace mode</strong> (off|on) &#x2014; activates deinterlacing. Deinterlacing is necessary for comfortable viewing of legacy TV video on desktop computers and mobile devices.\nWhen transcoding with an Nvidia NVENC-capable device, you can select modes <code>bob|adaptive|weave</code>.</span>',rv='<span data-helper="transcoder-seamless"><strong>Seamless source change</strong> &#x2014; <a href="https://flussonic.com/doc/transcoder#immutable" target="_blank">prevents blinking</a> when a stream source is changed.</span>',ov='<span data-helper="transcoder-video-bitrate-copy-from-origin">To get the same output video characteristics as in the input stream, turn on <strong>Copy from origin</strong>.</span>',iv='<span data-helper="transcoder-hardware-video-logo">If you would like to burn a logo into your video stream, you should specify the path to the logo file (resized with respect to the output video) in <strong>Track alogo path</strong>, and then select where the logo will appear on the video.</span>';n(1368);function sv(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var lv=tg.global,cv=lv.hw,uv=lv.deviceid,pv=lv.seamless,dv=tg.decoder.deinterlace,mv=function(e){return Object.keys(e.video||{}).some(function(t){var n=e.video[t];return n&&n.bitrate&&"copy"!==n.bitrate})},fv=function(e){var t=e.transcoderSettings,n=e.transcoderDevices;return Q.a(Ne.a(function(e){var t=e.id,n=e.type;return[t,"".concat(n).concat(t)]}),xi.a([[we.a,K.a([])],[K.a(gh(t)),be.a(tv.a("type","coder"))],[K.a(vh(t)),be.a(tv.a("type","nvenc"))],[K.a(bh(t)),be.a(tv.a("type","qsv"))],[Ni.a,K.a([])]]))(n)},hv=function(e){var t=e.transcoderDevices,n=e.transcoderSettings,a=e.onTranscoderChange,r=e.renderAddVideoTrackButton,i=n.global,s=n.decoder;return o.a.createElement(Ps.a,{container:!0,spacing:1},o.a.createElement(Ps.a,{container:!0,item:!0,xs:2,alignItems:"center"},o.a.createElement(Rg,{fullWidth:!0,"data-testid":"global-hardware-acceleration",label:"Hardware",disabled:!mv(n),value:cv(Ee.a("hw",i))||"",onChange:a(["global"],"hw",cv),onClose:function(){var e=cv(Ee.a("hw",i)),t=Ee.a("external",i);e!==Dh&&t&&a(["global"],"external",K.a(null))(null)},items:[[Th,"CPU"],[Ih,"Intel Quicksync"],[Dh,"Nvidia NVENC"],[Ah,"Coder"]],HelperDocProps:{message:nv}})),o.a.createElement(Ps.a,{container:!0,item:!0,xs:2,alignItems:"center"},o.a.createElement(Rg,{"data-testid":"decoder-deinterlace",label:"Deinterlace mode",disabled:!mv(n),value:Ee.a("deinterlace",s),onChange:a(["decoder"],"deinterlace",function(e){return dv(e,n)}),items:[[null,"","default"],[!1,"Off","off"],[!0,"On","on"]].concat(sv(vh(n)?Mh.map(function(e){return[e,e]}):[])),HelperDocProps:{message:av}})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Rg,{displayEmpty:!0,"data-testid":"global-deviceid",label:"Device ID",disabled:!mv(n),value:uv(Ee.a("deviceid",i),n),onChange:a(["global"],"deviceid",function(e){return uv(e,n)}),items:[[null,"","default"]].concat(sv(fv({transcoderSettings:n,transcoderDevices:t})))})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Rg,{displayEmpty:!0,"data-testid":"global-seamless-acceleration",label:"Seamless switch",disabled:!mv(n),value:pv(Ee.a("seamless",i)),onChange:a(["global"],"seamless"),items:[[null,"","default"],[!1,"Off","off"],[!0,"On","on"]],HelperDocProps:{message:rv}})),o.a.createElement(Ps.a,{container:!0,item:!0,xs:4,justify:"flex-end"},r()),o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(Td.a,{color:"secondary.main"},o.a.createElement("span",null,"Add video tracks to be able to set transcoder options."))))};hv.propTypes={transcoderSettings:qg.isRequired,onTranscoderChange:Y.a.func.isRequired,renderAddVideoTrackButton:Y.a.node.isRequired,transcoderDevices:Y.a.arrayOf(Ka).isRequired};var gv=hv,vv=n(1479),bv=n(1445),yv=n(1444);function Ev(){return(Ev=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function wv(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Sv=Object(Us.a)(function(){return Object(zs.a)({input:{display:"none"},label:{margin:0}})}),Cv=function(e){var t=e.accept,n=e.multiple,a=e.id,r=e.onChange,i=e.children,s=e.variant,l=wv(e,["accept","multiple","id","onChange","children","variant"]),c=Sv();return o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{accept:t,className:c.input,id:a,multiple:n,type:"file",onChange:r}),o.a.createElement("label",{htmlFor:a,className:c.label},o.a.createElement(Zs,Ev({variant:s,component:"span"},l),i)))};function Ov(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xv(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}Cv.propTypes={accept:Y.a.string.isRequired,multiple:Y.a.bool,id:Y.a.string.isRequired,onChange:Y.a.func.isRequired,children:Y.a.node.isRequired,variant:Y.a.oneOf(["text","outlined","contained"])},Cv.defaultProps={multiple:!1,variant:"text"};var Nv=function(e,t,n){var a=new FileReader;a.onload=function(t){x("/flussonic/api/logo/".concat(e),{method:"put",body:t.target.result}).then(function(){var e=btoa(String.fromCharCode.apply(String,xv(new Uint8Array(t.target.result)))),a="data:image/jpg;base64, ".concat(e);n(null,a)}).catch(n)},a.readAsArrayBuffer(t)},kv=function(e,t){x("/flussonic/api/logo/".concat(e),{method:"delete"}).then(function(){return t(null)}).catch(t)},_v=function(e){x("/flussonic/api/logo",{method:"get"}).then(function(t){var n=t;e(null,n),Object.keys(t).forEach(function(a){x("/flussonic/api/logo/".concat(a),{method:"get",headers:{Accept:"image/*"}},!0).then(function(e){return e.blob()}).then(function(r){var o=new FileReader;o.onload=function(r){var o=r.target.result;n[a]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Ov(e,t,n[t])})}return e}({},t[a],{img:o}),e(null,n)},o.readAsDataURL(r)}).catch(e)})})};function Pv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function jv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Rv(e,t,n[t])})}return e}function Rv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tv=Object(Us.a)(function(){return Object(zs.a)({dialog:{minWidth:"40%"},logoImage:{width:64,height:64,cursor:"zoom-in"},popover:{zIndex:9999,cursor:"zoom-out"},actions:{padding:"8px 24px"}})}),Iv=function(e){var t=e.isOpened,n=e.onClose,a=e.logo,r=e.onChange,i=e.name,s=Tv(),l=Pv(o.a.useState(null),2),c=l[0],u=l[1],p=Pv(o.a.useState(null),2),d=p[0],m=p[1],f=Pv(o.a.useState(a),2),h=f[0],g=f[1],v=Pv(o.a.useState([]),2),b=v[0],y=v[1],E=function(e){return console.error(e)},w=o.a.useCallback(function(e){return function(){g(e)}},[]),S=o.a.useCallback(function(){h&&r(h),n()},[h,r,n]),C=o.a.useCallback(function(){u(null),m(null)},[]),O=o.a.useCallback(function(e){return function(t){u(t.currentTarget),m(e)}},[]),x=o.a.useCallback(function(e){return function(t){if(t.target.files.length>0){var n=t.target.files[0],a=e||n.name;Nv(a,n,function(e,t){if(e)E(e);else{var n=function(e,t,n){return{streams:e[t]?e[t].streams:[],img:n}}(b,a,t),r=jv({},b,Rv({},a,n));y((o=r,Object.keys(o).sort(function(e,t){return e>t}).reduce(function(e,t){return jv({},e,Rv({},t,o[t]))},{})))}var o})}}},[b,y]),N=o.a.useCallback(function(e){return function(){kv(e,function(t){t?E(t):y(tl([e],b))})}},[b,y]);return o.a.useEffect(function(){_v(function(e,t){e?E(e):y(t)})},[]),o.a.createElement(vv.a,{open:t,onClose:n,classes:{paper:s.dialog},"data-testid":"logoManager_".concat(i,"_dialog_backdrop"),PaperProps:{"data-testid":"logoManager_".concat(i,"_dialog_main")}},o.a.createElement(yv.a,null,o.a.createElement(Ps.a,{container:!0,justify:"space-between"},o.a.createElement(Ps.a,{container:!0,item:!0,xs:!0},"Select logo file"),o.a.createElement(Ps.a,{container:!0,item:!0,xs:!0,justify:"flex-end"},o.a.createElement(Cv,{id:"logo-new-upload",accept:"image/*",onChange:x(),width:12,color:"primary","data-testid":"logoManager_".concat(i,"_dialog_button_add_new")},"Add new")))),o.a.createElement(bv.a,{dividers:!0},o.a.createElement(Ps.a,{container:!0},o.a.createElement(Ps.a,{container:!0,item:!0,xs:12,alignItems:"center"},Ae(b)&&Object.entries(b).map(function(e,t){var n=Pv(e,2),a=n[0],r=n[1],l=r.img,u=r.streams;return o.a.createElement(o.a.Fragment,{key:a},o.a.createElement(Ps.a,{item:!0,xs:1},o.a.createElement(na.a,{checked:h===a,onChange:w(a),value:h,name:a,inputProps:{"data-testid":"logoManager_".concat(i,"_dialog_").concat(a,"_radio")}})),o.a.createElement(Ps.a,{container:!0,item:!0,xs:6,alignItems:"center"},o.a.createElement(fg.a,{id:"logo-".concat(a,"-popover"),open:Boolean(c),anchorEl:c,onClose:C,onClick:C,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},className:s.popover},d&&o.a.createElement("img",{src:d,alt:"logo"})),o.a.createElement(Ps.a,{item:!0},l?o.a.createElement("img",{className:s.logoImage,src:l,alt:a,onClick:O(l)}):o.a.createElement(Am.a,{size:64})),o.a.createElement(Ps.a,{item:!0},a)),o.a.createElement(Ps.a,{container:!0,item:!0,xs:5,justify:"flex-end",alignItems:"center"},o.a.createElement(Ps.a,{item:!0},!Ae(u)&&o.a.createElement(Zs,{width:12,onClick:N(a),color:"red","data-testid":"logoManager_".concat(i,"_dialog_").concat(a,"_button_delete")},"Delete")),o.a.createElement(Ps.a,{item:!0},o.a.createElement(Cv,{id:"logo-".concat(t,"-change"),accept:"image/*",width:12,onChange:x(a),color:"primary","data-testid":"logoManager_".concat(i,"_dialog_").concat(a,"_button_change")},"Change"))))})))),o.a.createElement(Ps.a,{container:!0,className:s.actions,justify:"flex-end"},o.a.createElement(Zs,{onClick:n,width:12,color:"red","data-testid":"logoManager_".concat(i,"_dialog_button_cancel")},"Cancel"),o.a.createElement(Zs,{onClick:S,width:12,color:"primary","data-testid":"logoManager_".concat(i,"_dialog_button_ok")},"OK")))};function Dv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Iv.propTypes={isOpened:Y.a.bool.isRequired,onChange:Y.a.func.isRequired,onClose:Y.a.func.isRequired,logo:Y.a.string.isRequired,name:Y.a.string},Iv.defaultProps={name:""};var Av,qv=function(e){var t=e.onChange,n=e.logo,a=e.buttonTitle,r=e.buttonWidth,i=e.buttonColor,s=e.name,l=Dv(o.a.useState(!1),2),c=l[0],u=l[1],p=o.a.useCallback(function(e){return function(){u(e)}},[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Zs,{"data-testid":"logoManager_".concat(s,"_button_open"),color:i,width:r,onClick:p(!0)},a),c&&o.a.createElement(Iv,{isOpened:c,onClose:p(!1),onChange:t,logo:n,name:s}))};function Mv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}qv.propTypes={onChange:Y.a.func.isRequired,logo:Y.a.string.isRequired,name:Y.a.string,buttonTitle:Y.a.string.isRequired,buttonWidth:Y.a.number,buttonColor:Y.a.string},qv.defaultProps={buttonWidth:32,buttonColor:void 0,name:""};var Fv=function(e,t){return ke.a([e,"path_changed"])(t)},Vv="TOP_LEFT",Bv="TOP_RIGHT",Lv="CENTER",Wv="BOTTOM_LEFT",Hv="BOTTOM_RIGHT",Uv=(Mv(Av={},Vv,{x:"10",y:"10"}),Mv(Av,Bv,{x:"(main_w-overlay_w-10)",y:"10"}),Mv(Av,Lv,{x:"(main_w-overlay_w-10)/2",y:"(main_h-overlay_h-10)/2"}),Mv(Av,Wv,{x:"10",y:"(main_h-overlay_h-10)"}),Mv(Av,Hv,{x:"(main_w-overlay_w-10)",y:"(main_h-overlay_h-10)"}),Av),zv=function(e,t){var n=t.x,a=t.y;return Uv[e]&&n===Uv[e].x&&a===Uv[e].y},Gv=function(e,t){return zv(Vv,e[t]||{})&&Vv||zv(Bv,e[t]||{})&&Bv||zv(Lv,e[t]||{})&&Lv||zv(Wv,e[t]||{})&&Wv||zv(Hv,e[t]||{})&&Hv||null},Qv=function(e){var t=e.track,n=e.trackId,a=e.field,r=e.onTranscoderChange,i=function(e,t){return Es.a("",[e,"path"])(t)}(a,t),s=Ae(i)&&i.startsWith("@")?i.slice(1):i,l=o.a.useCallback(function(e){var o="@".concat(e).trim();r(["video",n,a],"path",null,!1,!0)(o),Fv(a,t)&&qe(i.trim())&&r(["video",n],a,K.a(null),!1,!0)()},[r,n,a,t,i,Fv]);return o.a.createElement(Td.a,{width:"100%"},o.a.createElement(Ps.a,{container:!0,spacing:1,alignItems:"flex-end"},o.a.createElement(Ps.a,{container:!0,item:!0,xs:9,alignItems:"flex-end"},o.a.createElement(Ps.a,{item:!0,xs:6},o.a.createElement(Ws,{isNilable:!0,fullWidth:!0,disabled:!0,type:"text","data-testid":"video-".concat(a,"-").concat(n),value:s})),o.a.createElement(Ps.a,{item:!0,xs:3},o.a.createElement(qv,{buttonTitle:"Select",buttonWidth:12,buttonColor:"default",logo:s,onChange:l,name:"video-".concat(a,"-").concat(n)})),o.a.createElement(Ps.a,{item:!0,xs:3},o.a.createElement(Rg,{displayEmpty:!0,disabled:qe(i),label:"Position","data-testid":"video-".concat(a,"-position-").concat(n),value:Gv(t,a),onChange:function(e){var t=e.target.value;return r(["video",n],a,function(e,n){return{path:Ee.a("path",n),r:Ee.a("r",n),x:Uv[t]?Uv[t].x:null,y:Uv[t]?Uv[t].y:null}})()},items:[[null,""],[Vv,"Top left corner"],[Bv,"Top right corner"],[Lv,"Center"],[Wv,"Bottom left corner"],[Hv,"Bottom right corner"]]}))),o.a.createElement(Ps.a,{container:!0,item:!0,xs:3,alignContent:"center",justify:"flex-end"},o.a.createElement(Td.a,{mr:-.75},o.a.createElement(Zs,{color:"red",size:"small",variant:"text","data-testid":"video-".concat(a,"-remove-").concat(n),width:10,onClick:function(){return r(["video",n],a,K.a(null),!1,!0)(null)}},"remove")))))};Qv.propTypes={track:Ag.isRequired,trackId:Aa.isRequired,field:Y.a.string.isRequired,onTranscoderChange:Y.a.func.isRequired};var Kv=Qv,Jv=Ee.a("x"),Yv=Ee.a("y"),$v=hl(fl(function(e){var t=e.aspect,n=e.field,a=Pi(0,t[n]);return qe(t)||qe(t[n])||a>0},"Should be greater than zero."),fl(function(e){var t=e.aspect,n=e.field,a=qe(t)||Mg.a(Ae,[Jv(t),Yv(t)])||Mg.a(qe,[Jv(t),Yv(t)]),r=Ae(t)&&Ae(t[n]);return a||r},"Required, if aspect set.")),Xv=hl(fl(function(e){var t=e.value,n=Pi(0,t);return qe(t)||n>0},"Should be greater than zero."));function Zv(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function eb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tb=tg.video,nb=tb.refs,ab=tb.fps,rb=tb.disable_cgop,ob=tb.bframes,ib=tb.profile,sb=tb.level,lb=function(e,t){return wh(e,t)&&Gh||Sh(e,t)&&Qh||Ch(e,t)&&Kh||Gh},cb=function(e,t){return wh(e,t)&&Jh||Sh(e,t)&&Yh||Ch(e,t)&&$h||Jh},ub=Q.a(ab,ji(25)),pb=Q.a(nb,ji(1)),db=Q.a(ob,ji(0)),mb=function(e){var t=e.track,n=e.trackId,a=e.transcoderSettings,r=e.onTranscoderChange,i=e.onError,s=e.onErrorResolve,l=e.errors,c=o.a.useCallback(function(e){return function(t){var a=["video",n,"aspect",t],r=$v({field:t,aspect:e});r.isValid?s(a)():i(a)(r.error)}},[s,i]),u=o.a.useCallback(function(e){return function(a){var o=Pi(null),i=o(Ti(a)),s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){eb(e,t,n[t])})}return e}({},t.aspect||{},eb({},e,i));r(["video",n,"aspect"],e,o)(a),["x","y"].forEach(c(s))}},[t.aspect,r,c]),p=o.a.useCallback(function(){Ae(t.aspect)&&qe(t.aspect.x)&&qe(t.aspect.y)&&r(["video",n],"aspect",null,!1,!0)(null)},[t.aspect,n]);return o.a.createElement(Td.a,{width:"100%"},o.a.createElement(Ps.a,{container:!0,spacing:1},o.a.createElement(Ps.a,{item:!0,xs:3},o.a.createElement(Rg,{displayEmpty:!0,label:"Profile","data-testid":"video-profile-".concat(n),value:(ib(t.profile,a,n)||"").toString(),onChange:r(["video",n],"profile",function(e){return ib(e,a,n)}),items:[[null,""]].concat(Zv(lb(a,n).map(function(e){return[e,e]})))})),o.a.createElement(Ps.a,{item:!0,xs:3},o.a.createElement(Rg,{displayEmpty:!0,label:"Level","data-testid":"video-level-".concat(n),value:(sb(t.level,a,n)||"").toString(),onChange:r(["video",n],"level",function(e){return sb(e,a,n)}),items:[[null,""]].concat(Zv(cb(a,n).map(function(e){return[e,e]})))})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Ws,{type:"number","data-testid":"video-aspect-x-".concat(n),label:"Aspect (X)",value:Ie(t.aspect)?t.aspect.x:null,onChange:u("x"),onBlur:p,error:l[ul(["video",n,"aspect","x"])]})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Ws,{type:"number","data-testid":"video-aspect-y-".concat(n),label:"Aspect (Y)",value:Ie(t.aspect)?t.aspect.y:null,onChange:u("y"),onBlur:p,error:l[ul(["video",n,"aspect","y"])]}))),o.a.createElement(Ps.a,{container:!0,spacing:1},o.a.createElement(Ps.a,{item:!0,xs:3},o.a.createElement(Rg,{displayEmpty:!0,label:"Frames per second","data-testid":"video-fps-".concat(n),value:ab(t.fps),onChange:r(["video",n],"fps",ub),items:[[null,""]].concat(Zv(Xh.map(function(e){return[e,e]})))})),o.a.createElement(Ps.a,{item:!0,xs:3},o.a.createElement(Rg,{displayEmpty:!0,label:"Reference frames","data-testid":"video-refs-".concat(n),value:nb(t.refs),onChange:r(["video",n],"refs",pb),items:[[null,""]].concat(Zv(eg.map(function(e){return[e,e]})))})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Rg,{displayEmpty:!0,label:"B-frames","data-testid":"video-bframes-".concat(n),value:ob(t.bframes),onChange:r(["video",n],"bframes",db),items:[[null,""]].concat(Zv(Zh.map(function(e){return[e,e]})))})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Ws,{type:"number","data-testid":"video-gop-".concat(n),label:"Frames in GOP",value:Pi("",t.gop),onChange:r(["video",n],"gop",Pi(null)),validate:function(e){return Xv({value:e})},onError:i(["video",n,"gop"]),onErrorResolve:s(["video",n,"gop"]),error:l[ul(["video",n,"gop"])]})),o.a.createElement(Ps.a,{container:!0,item:!0,xs:1,alignItems:"flex-end"},o.a.createElement(Og,{label:"Disable CGOP",color:"primary","data-testid":"video-disable-cgop-".concat(n),checked:!!t.disable_cgop,onChange:r(["video",n],"disable_cgop",rb,!0)}))))};mb.propTypes={track:Ag.isRequired,trackId:Aa.isRequired,transcoderSettings:qg.isRequired,onTranscoderChange:Y.a.func.isRequired,onError:Y.a.func.isRequired,onErrorResolve:Y.a.func.isRequired,errors:ha()(Y.a.string).isRequired};var fb=mb,hb=Q.a(zf.a(Gf.a,0),Pi(0),Ee.a("value")),gb=Q.a(Ae,Ee.a("value")),vb=hl(fl(hb,"Should be greater than zero."),fl(gb,"Bitrate is required.")),bb=function(e){return hl(fl(function(e){var t=e.value,n=Pi(0,t);return qe(t)||-1===n||n%2==0},"".concat(e," should be multiple of 2.")),fl(function(e){var t=e.value,n=Pi(0,t);return qe(t)||-1===n||n>0},"".concat(e," should be -1 or greater than zero.")))},yb=bb("Width"),Eb=bb("Height");function wb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Sb(e,t,n[t])})}return e}function Sb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cb(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ob=Es.a(Oh,["size","width"]),xb=Q.a(xh,Ob),Nb=Es.a(Oh,["size","height"]),kb=Q.a(xh,Nb),_b=Q.a(uh.a(1e3),Pi(null)),Pb=tg.video,jb=Pb.codec,Rb=Pb.preset,Tb=function(e){var t=e.number;return o.a.createElement(Td.a,{fontSize:16,fontWeight:500},"Video #",t)},Ib=function(e){var t=e.track,n=e.trackId,a=e.onTranscoderChange,r=e.onError,i=e.onErrorResolve,s=e.errors;return o.a.createElement(Ws,{fullWidth:!0,required:!0,type:_h(t)?"text":"number","data-testid":"video-bitrate-".concat(n),label:"Bitrate",adornment:o.a.createElement(Td.a,{fontSize:16},"K"),disabled:_h(t),value:_h(t)?"copy":Ve(t.bitrate)&&t.bitrate/1e3||"",onChange:_h(t)?K.a(void 0):a(["video",n],"bitrate",_b),validate:function(e){return vb({value:e})},onError:r(["video",n,"bitrate"]),onErrorResolve:i(["video",n,"bitrate"]),error:s[ul(["video",n,"bitrate"])]})},Db=function(e){var t=e.track,n=e.trackId,a=e.onTranscoderChange,r=e.onError,i=e.onErrorResolve,s=e.errors;return o.a.createElement(Ws,{type:"number","data-testid":"video-width-".concat(n),label:"Width",value:xb(t)?"":kh(Ob(t)),onChange:a(["video",n],"size",Nh("width",t.size)),validate:function(e){return yb({value:e})},onError:r(["video",n,"width"]),onErrorResolve:i(["video",n,"width"]),error:s[ul(["video",n,"width"])]})},Ab=function(e){var t=e.track,n=e.trackId,a=e.onTranscoderChange,r=e.onError,i=e.onErrorResolve,s=e.errors;return o.a.createElement(Ws,{type:"number","data-testid":"video-height-".concat(n),label:"Height",value:kb(t)?"":kh(Nb(t)),onChange:a(["video",n],"size",Nh("height",t.size)),validate:function(e){return Eb({value:e})},onError:r(["video",n,"height"]),onErrorResolve:i(["video",n,"height"]),error:s[ul(["video",n,"height"])]})},qb=function(e){var t=e.track,n=e.trackId,a=e.onTranscoderChange;return o.a.createElement(Rg,{"data-testid":"video-codec-".concat(n),label:"Codec",value:jb(t.codec)||"",onChange:a(["video",n],"codec",jb),items:Hh.map(function(e){return[e,e]})})},Mb=function(e){var t=e.track,n=e.trackId,a=e.transcoderSettings,r=e.onTranscoderChange;return o.a.createElement(Rg,{displayEmpty:!0,"data-testid":"video-preset-".concat(n),label:"Preset",value:Rb(t.preset,a)||"",onChange:r(["video",n],"preset",function(e){return Rb(e,a)}),items:[[null,""]].concat(Cb((vh(a)?zh:Uh).map(function(e){return[e,e]})))})},Fb=function(e){var t=e.onTranscoderCopyTrack,n=e.onTranscoderRemoveTrack,a=e.trackId;return o.a.createElement(o.a.Fragment,null,o.a.createElement(Zs,{variant:"text",color:"primary",size:"small",onClick:t,"data-testid":"video-duplicate-".concat(a)},"Duplicate"),o.a.createElement(Zs,{variant:"text",color:"red",size:"small",onClick:n,"data-testid":"video-remove-".concat(a)},"Remove"))},Vb=function(e){var t=e.trackId,n=e.transcoderSettings,a=e.transcoderSettingsBackup,r=e.onTranscoderChange;return o.a.createElement(Og,{isSwitch:!0,"data-testid":"video-bitrate-copy-".concat(t),checked:_h(n.video[t]),color:"primary",size:"small",label:"Copy from origin",onChange:r(["video"],t,function(e){return e?wb({},Object.keys(Vi(n.video[t])).reduce(function(e,t){return wb({},e,Sb({},t,null))},{}),{bitrate:"copy"}):a.video[t]||{bitrate:1e6}},!0),HelperDocProps:{message:ov}})},Bb=function(e){var t=e.track,n=e.trackId,a=e.transcoderSettings,r=e.transcoderSettingsBackup,i=e.onTranscoderChange,s=e.onTranscoderCopyTrack,l=e.onTranscoderRemoveTrack,c=e.onError,u=e.onErrorResolve,p=e.errors;return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ps.a,{container:!0,spacing:2},o.a.createElement(Td.a,{display:"flex",alignItems:"center",width:80},o.a.createElement(Tb,{number:Pi(0,n)+1})),o.a.createElement(Ps.a,{container:!0,item:!0,xs:4,alignItems:"center"},o.a.createElement(Vb,{trackId:n,transcoderSettings:a,transcoderSettingsBackup:r,onTranscoderChange:i})),o.a.createElement(Ps.a,{container:!0,item:!0,xs:!0,justify:"flex-end",alignItems:"center"},o.a.createElement(Fb,{onTranscoderCopyTrack:s,onTranscoderRemoveTrack:l,trackId:n}))),o.a.createElement(Ps.a,{container:!0,spacing:1},o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Ib,{track:t,trackId:n,onTranscoderChange:i,onErrorResolve:u,onError:c,errors:p})),!_h(t)&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Db,{track:t,trackId:n,onTranscoderChange:i,onErrorResolve:u,onError:c,errors:p})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(Ab,{track:t,trackId:n,onTranscoderChange:i,onErrorResolve:u,onError:c,errors:p})),o.a.createElement(Ps.a,{item:!0,xs:2},o.a.createElement(qb,{track:t,trackId:n,onTranscoderChange:i})),o.a.createElement(Ps.a,{item:!0,xs:3,lg:2},o.a.createElement(Mb,{track:t,trackId:n,onTranscoderChange:i,transcoderSettings:a})))))};Bb.propTypes={track:Ag.isRequired,trackId:Aa.isRequired,transcoderSettings:qg.isRequired,transcoderSettingsBackup:qg.isRequired,onTranscoderChange:Y.a.func.isRequired,onTranscoderCopyTrack:Y.a.func.isRequired,onTranscoderRemoveTrack:Y.a.func.isRequired,onError:Y.a.func.isRequired,onErrorResolve:Y.a.func.isRequired,errors:ha()(Y.a.string).isRequired};var Lb=Bb;function Wb(e){return(Wb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ub(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Yb(e,t,n[t])})}return e}function zb(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Gb(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Qb(e){return(Qb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jb(e,t){return(Jb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $b=Q.a(ve.a(Qf.a,-1),Ne.a(Ee.a("key")),be.a(Q.a(Ie,Ee.a("value"))),Kf.a,pe.a(function(e,t){return{value:e,key:_i(t)}})),Xb=Q.a(Ce.a,we.a,Ee.a("bitrate")),Zb=ke.a(["target","value"]),ey=ke.a(["target","checked"]),ty=[["3500k",1080],["2500k",720],["1500k",576],["1000k",480],["700k",360]],ny=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Qb(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Wb(r)&&"function"!=typeof r?Kb(a):r,Yb(Kb(n),"state",{transcoderSettingsBackup:{global:{},decoder:{},audio:{},video:{}},isAddTrackOpened:!1,isTrackDetailsExpanded:{},isSettingsExpanded:{audio:!0,other:!1},isTracksVisible:!0}),Yb(Kb(n),"handleTranscoderChangeTimers",{}),Yb(Kb(n),"handleTranscoderChange",function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(i){var s=n.props.transcoderSettings,l=n.state.transcoderSettingsBackup,c=[].concat(zb(e),[t]),u="function"==typeof a&&a||a&&a.getValueFn||Si.a,p=(r&&ey||o&&Si.a||Zb)(i),d=Oi.a(c),m=Oe.a(d,s),f=_s.a(d,m,l);n.props.onTranscoderSettingsChange(c,"raw")(u(p,m)),n.setState({transcoderSettingsBackup:f}),a&&a.delay&&a.getDelayedValueFn&&n.handleTranscoderDelayedChange(Ub({path:c,currentValue:m,eventValue:p},a))}}),Yb(Kb(n),"handleTranscoderDelayedChange",function(e){var t=e.path,a=e.getDelayedValueFn,r=e.delay,o=e.eventValue,i=e.currentValue,s="".concat(t.join("."),".").concat(Ut.a(t));clearTimeout(n.handleTranscoderChangeTimers[s]),n.handleTranscoderChangeTimers[s]=setTimeout(function(){n.props.onTranscoderSettingsChange(t,"raw")(a(o,i))},r)}),Yb(Kb(n),"handleVideoTrackExtraChange",function(e){return function(t){n.props.onTranscoderSettingsChange(["video",e,"extra"],"raw")(t)}}),Yb(Kb(n),"handleVideoTrackExtraRemove",function(e){return function(t){n.props.onTranscoderSettingsChange(["video",e,"extra",t],"raw")(null)}}),Yb(Kb(n),"handleTranscoderAddVideoTrack",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isCopy,a=e.track,r=void 0===a?{}:a;return function(){var e=n.props.transcoderSettings,a=n.state.isTrackDetailsExpanded,o=we.a(e.video)||le.a(e.video)?0:$b(e.video)+1,i=t?"copy":r.bitrate||1e6;n.props.onTranscoderSettingsChange(["video",o],"raw")(Ub({codec:"h264",bitrate:i},r)),n.setState({isTrackDetailsExpanded:Ub({},Object.keys(a).reduce(function(e,t){return Yb({},t,!1)},{}),Yb({},o,!0))})}}),Yb(Kb(n),"handleTranscoderCopyTrack",function(e){return function(t){t.stopPropagation();var a=Vi(n.props.transcoderSettings.video[e]);n.handleTranscoderAddVideoTrack({track:a})()}}),Yb(Kb(n),"handleTranscoderRemoveTrack",function(e){return function(t){t.stopPropagation(),n.props.onTranscoderSettingsTrackDelete(["video",e]),n.setState({isTracksVisible:!1},function(){n.setState({isTracksVisible:!0})})}}),Yb(Kb(n),"handleVideoTrackDetailsToggle",function(e){return function(){return n.setState(function(t){var n=t.isTrackDetailsExpanded;return{isTrackDetailsExpanded:Ub({},n,Yb({},e,!n[e]))}})}}),Yb(Kb(n),"handleCommonSettingsToggle",function(e){return function(){n.setState(function(t){var n=t.isSettingsExpanded;return{isSettingsExpanded:Ub({},n,Yb({},e,!n[e]))}})}}),Yb(Kb(n),"renderAddVideoTrackButton",function(){return o.a.createElement(lh,{buttonText:"Add video track","data-testid":"transcoderAddTrack",onButtonClick:n.handleTranscoderAddVideoTrack({track:{bitrate:Ph("1000k")}}),items:ty.map(function(e){var t=Hb(e,2),a=t[0],r=t[1];return{text:"".concat(a,", ").concat(r,"p"),onClick:n.handleTranscoderAddVideoTrack({track:{bitrate:Ph(a),size:{height:r,width:-1}}}),"data-testid":"transcoderAddTrackB".concat(a,"H").concat(r)}})})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jb(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this,t=this.props.transcoderSettings,n=this.state,a=n.transcoderSettingsBackup,r=n.isSettingsExpanded,i=Object.keys(t.video||{}).filter(function(e){return Xb(t.video[e])}).map(function(e){return[t.video[e],e]});return o.a.createElement(Td.a,{my:2,width:"100%"},o.a.createElement(gv,{transcoderDevices:this.props.transcoderDevices,onTranscoderChange:this.handleTranscoderChange,transcoderSettings:t,renderAddVideoTrackButton:this.renderAddVideoTrackButton}),this.state.isTracksVisible&&i.map(function(n,r){var i=Hb(n,2),s=i[0],l=i[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement(cg,{isTopIndented:0===r,key:l,toggleOpen:e.handleVideoTrackDetailsToggle(l),isOpen:e.state.isTrackDetailsExpanded[l],header:o.a.createElement(Lb,{track:s,trackId:l,onTranscoderChange:e.handleTranscoderChange,onTranscoderRemoveTrack:e.handleTranscoderRemoveTrack(l),onTranscoderCopyTrack:e.handleTranscoderCopyTrack(l),transcoderSettings:t,transcoderSettingsBackup:a,onError:e.props.onError,onErrorResolve:e.props.onErrorResolve,errors:e.props.errors}),"data-testid":"transcoderVideoTrackMain#".concat(l)},o.a.createElement(Ps.a,{container:!0},!_h(s)&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(Ps.a,{container:!0,spacing:2},o.a.createElement(Ps.a,{container:!0,item:!0,xs:2,md:1,alignItems:"flex-end"},o.a.createElement(Td.a,{fontWeight:500,width:"100%",display:"flex"},"Logo ",o.a.createElement(vg,{message:iv}))),o.a.createElement(Ps.a,{item:!0,xs:10,md:11},o.a.createElement(Kv,{track:s,trackId:l,field:"logo",onTranscoderChange:e.handleTranscoderChange})))),o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(Ps.a,{container:!0,spacing:2},o.a.createElement(Ps.a,{container:!0,item:!0,xs:2,md:1,alignItems:"flex-end"},o.a.createElement(Td.a,{fontWeight:500,width:"100%",display:"flex"},"Alogo ",o.a.createElement(vg,{message:iv}))),o.a.createElement(Ps.a,{item:!0,xs:10,md:11},o.a.createElement(Kv,{track:s,trackId:l,field:"alogo",onTranscoderChange:e.handleTranscoderChange})))),o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(cg,{toggleOpen:e.handleVideoTrackDetailsToggle("advanced-".concat(l)),isOpen:e.state.isTrackDetailsExpanded["advanced-".concat(l)],header:"Advanced options",isTopIndented:!0,"data-testid":"transcoderVideoTrackAdvanced#".concat(l)},o.a.createElement(fb,{track:s,trackId:l,onTranscoderChange:e.handleTranscoderChange,transcoderSettings:t,onError:e.props.onError,onErrorResolve:e.props.onErrorResolve,errors:e.props.errors}))),o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(Td.a,{mb:4},o.a.createElement(cg,{toggleOpen:e.handleVideoTrackDetailsToggle("extra-".concat(l)),isOpen:e.state.isTrackDetailsExpanded["extra-".concat(l)],header:"Extra params","data-testid":"transcoderVideoTrackExtra#".concat(l)},o.a.createElement(Tl,{extra:s.extra,onChange:e.handleVideoTrackExtraChange(l),onRemoveByKey:e.handleVideoTrackExtraRemove(l),onError:e.props.onError,onErrorResolve:e.props.onErrorResolve,errors:e.props.errors,errorPath:["video",l,"extra"],removeVariant:"text",removeSize:"small",removeAlignEnd:!0,"data-testid":"transcoderVideoTrackExtraParamsEditor#".concat(l)}))))))),o.a.createElement(Jf.a,null))}),o.a.createElement(ev,{transcoderSettings:t,transcoderSettingsBackup:a,isSettingsExpanded:r,onToggleSettings:this.handleCommonSettingsToggle,onTranscoderChange:this.handleTranscoderChange,onError:this.props.onError,onErrorResolve:this.props.onErrorResolve,errors:this.props.errors}))}}])&&Gb(n.prototype,a),r&&Gb(n,r),t}();Yb(ny,"propTypes",{transcoderSettings:qg.isRequired,onTranscoderSettingsChange:Y.a.func.isRequired,onTranscoderSettingsDelete:Y.a.func.isRequired,onTranscoderSettingsTrackDelete:Y.a.func.isRequired,isSaving:Y.a.bool.isRequired,onError:Y.a.func.isRequired,onErrorResolve:Y.a.func.isRequired,errors:ha()(Y.a.string).isRequired,transcoderDevices:Y.a.arrayOf(Ka).isRequired});var ay=o.a.memo(ny),ry=n(1447);function oy(){return(oy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function iy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var sy=function(e,t){return function(n){return function(a){var r=iy(Object(ry.a)(e,t),2),i=r[0],s=r[1];return o.a.createElement(n,oy({},a,{localStorageValue:i,setLocalStorageValue:s}))}}};function ly(e){return(ly="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function uy(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function py(e){return(py=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function my(e,t){return(my=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hy=he.a(we.a),gy=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=py(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==ly(r)&&"function"!=typeof r?dy(a):r,fy(dy(n),"handleTranscoderEnable",function(){n.props.onConfigValueChange([],"raw")({global:{hw:"cpu"},audio:{bitrate:64e3,sample_rate:null,codec:"aac"},video:{0:{bitrate:1e6,codec:"h264"}}})}),fy(dy(n),"handleTranscoderDisable",function(){confirm("Config will be reseted and saved, no restoration options available. Reset and save?")&&n.props.onConfigValueChange([],"raw",function(){n.props.onConfigSave()})(null)}),fy(dy(n),"handleTranscoderCopySettings",function(){if(n.props.subconfig){var e=Object.assign({},n.props.subconfig.global?{global:Vi(n.props.subconfig.global)}:{},n.props.subconfig.audio?{audio:Vi(n.props.subconfig.audio)}:{},n.props.subconfig.decoder?{decoder:Object.assign({},Vi(n.props.subconfig.decoder),n.props.subconfig.decoder.crop?{crop:Vi(n.props.subconfig.decoder.crop)}:{})}:{},n.props.subconfig.video?{video:Object.entries(Vi(n.props.subconfig.video)).reduce(function(e,t){var n=cy(t,2),a=n[0],r=n[1];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){fy(e,t,n[t])})}return e}({},e,fy({},a,Object.assign({},Vi(r),r.size?{size:Vi(r.size)}:{},r.aspect?{aspect:Vi(r.aspect)}:{},r.logo?{logo:Vi(r.logo)}:{},r.alogo?{alogo:Vi(r.alogo)}:{},r.extra?{extra:Vi(r.extra)}:{})))},{})}:{});n.props.setLocalStorageValue(e)}}),fy(dy(n),"handleTranscoderPasteSettings",function(){n.props.localStorageValue&&(n.props.onConfigValueChange(["global"],"raw")(n.props.localStorageValue.global),n.props.onConfigValueChange(["decoder"],"raw")(n.props.localStorageValue.decoder),n.props.onConfigValueChange(["audio"],"raw")(n.props.localStorageValue.audio),n.props.subconfig&&n.props.subconfig.video&&Object.keys(n.props.subconfig.video).forEach(function(e){n.props.onConfigValueChange(["video",e],"raw")(null)}),n.props.localStorageValue.video&&Object.keys(n.props.localStorageValue.video||{}).forEach(function(e){n.props.onConfigValueChange(["video",e],"raw")(n.props.localStorageValue.video[e])}))}),fy(dy(n),"handleConfigSaveButtonClick",function(){Q.a(zf.a(Gf.a,0),Ee.a("length"),ye.a)(n.props.subconfig.video)?setTimeout(n.props.onConfigSave,100):confirm("No video tracks configured (only audio will be in the output). Save this configuration?")&&n.props.onConfigSave()}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&my(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement(Td.a,{py:2,width:"60vw"},o.a.createElement(Ps.a,{container:!0,"data-testid":"stream-transcoder"},hy(this.props.subconfig)&&o.a.createElement(ay,{transcoderDevices:this.props.serverInfo&&this.props.serverInfo.transcoder_devices,transcoderSettings:this.props.subconfig,onTranscoderSettingsChange:this.props.onConfigValueChange,onTranscoderSettingsDelete:this.props.onConfigValueDelete,onTranscoderSettingsTrackDelete:this.props.onConfigListElementDelete,onError:this.props.onError,onErrorResolve:this.props.onErrorResolve,errors:this.props.errors,isSaving:this.props.isConfigSaving}),o.a.createElement(Td.a,{mt:2,width:"100%"},o.a.createElement(Ps.a,{container:!0,justify:"space-between"},o.a.createElement(Ps.a,{container:!0,item:!0,xs:!0,spacing:2},hy(this.props.subconfig)?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ps.a,{item:!0},o.a.createElement(Zs,{variant:"contained",color:"primary","data-testid":"transcoderSave",width:24,disabled:this.props.areErrorsExists||this.props.isConfigSaving||!this.props.isConfigChanged,onClick:this.handleConfigSaveButtonClick},"Save",this.props.isConfigSaving&&o.a.createElement(Am.a,{size:20,color:"primary"}))),o.a.createElement(Ps.a,{item:!0},o.a.createElement(Zs,{variant:"contained",color:"red.light","data-testid":"transcoderDisable",width:24,onClick:this.handleTranscoderDisable},"Disable transcoder"))):this.props.config&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ps.a,{item:!0},o.a.createElement(Zs,{variant:"contained",color:"primary","data-testid":"transcoderEnable",width:24,onClick:this.handleTranscoderEnable},"Enable transcoder")),this.props.localStorageValue&&o.a.createElement(Ps.a,{item:!0},o.a.createElement(Zs,{variant:"contained",color:"primary","data-testid":"transcoderEnableAndPaste",width:32,onClick:this.handleTranscoderPasteSettings},"Enable and paste settings")))),this.props.subconfig&&hy(this.props.subconfig)&&o.a.createElement(Ps.a,{container:!0,item:!0,xs:!0,justify:"flex-end",spacing:2},o.a.createElement(o.a.Fragment,null,o.a.createElement(Ps.a,{item:!0},o.a.createElement(Zs,{variant:"contained",color:"secondary","data-testid":"transcoderCopy",width:24,onClick:this.handleTranscoderCopySettings},"Copy settings")),this.props.localStorageValue&&o.a.createElement(Ps.a,{item:!0},o.a.createElement(Zs,{variant:"contained",color:"secondary","data-testid":"transcoderPaste",width:24,onClick:this.handleTranscoderPasteSettings},"Paste settings"))))))))}}])&&uy(n.prototype,a),r&&uy(n,r),t}();fy(gy,"propTypes",{config:Qa.isRequired,subconfig:qg.isRequired,isConfigChanged:Y.a.bool.isRequired,onConfigValueChange:Y.a.func.isRequired,onConfigValueDelete:Y.a.func.isRequired,onConfigListElementDelete:Y.a.func.isRequired,onConfigSave:Y.a.func.isRequired,isConfigSaving:Y.a.bool.isRequired,onError:Y.a.func.isRequired,onErrorResolve:Y.a.func.isRequired,errors:ha()(Y.a.string).isRequired,areErrorsExists:Y.a.bool.isRequired,serverInfo:Ja,localStorageValue:qg.isRequired,setLocalStorageValue:Y.a.func.isRequired}),fy(gy,"defaultProps",{serverInfo:null});var vy=Q.a(pl,sy("transcoder",null),es(gy.propTypes,["streams",Ee.a("name"),"transcoder"]),function(e){return o.a.memo(e,me.a)})(gy),by=te.a.createStore({fetch:function(e){var t=this,n="/flussonic/api/history";return e&&(n=n+"?media="+e),x(n,{method:"get"}).then(function(e){return t.trigger(e),e})},fetch2:function(e){var t=this,n="/flussonic/api/history?vsn=2";return e.name&&(n=n+"&name="+e.name),e.from&&(n=n+"&from="+e.from),e.to&&(n=n+"&to="+e.to),e.pulse&&(n+="&pulse=true"),e.sessions&&(n+="&sessions=true"),e.sort&&(n=n+"&sort="+e.sort),e.sort_dir&&(n=n+"&sort_dir="+e.sort_dir),e.group&&(n=n+"&group="+e.group),x(n,{method:"get"}).then(function(e){return t.trigger(e),e})}}),yy=tn()({displayName:"StreamHistoryPage",mixins:[te.a.ListenerMixin],componentDidMount:function(){this.listenTo(by,this.onHistoryLoaded);var e={load_sessions:!0,load_pulse:!1};Ct(this).pulse&&(e.load_pulse="true"==Ct(this).pulse),Ct(this).sessions&&(e.load_sessions="true"==Ct(this).sessions),Ct(this).report&&(e.report="true"==Ct(this).report),this.setState(e,this.refetchData)},refetchData:function(){var e={pulse:this.state.load_pulse,sessions:this.state.load_sessions};for(var t in this.props.media&&(e.name=this.props.media.name),1==this.state.report&&(e.group="type"),this.state.q)if(this.state.q[t].sort){switch(t){case"proto":e.sort="type";break;case"bytes":e.sort="bytes_sent";break;default:e.sort=t}e.sort_dir=this.state.q[t].sort}by.fetch2(e)},getInitialState:function(){return{loading:!0,q:{proto:{},ip:{},country:{},created_at:{},duration:{},bytes:{},user_id:{}}}},onHistoryLoaded:function(e){e.loading=!1,this.setState(e)},renderSession:function(e){return this.state.report?o.a.createElement("tr",{key:e.id},o.a.createElement("td",null,e.type),o.a.createElement("td",null,e.country),o.a.createElement("td",null,pr.seconds(Math.round(e.avg_duration/1e3))),o.a.createElement("td",null,pr.seconds(Math.round(e.total_duration/1e3))),o.a.createElement("td",null,pr.bytes(Math.round(e.avg_bytes))),o.a.createElement("td",null,pr.bytes(e.total_bytes)),o.a.createElement("td",null,e.count)):o.a.createElement("tr",{key:e.id},o.a.createElement("td",null,e.type),o.a.createElement("td",null,e.ip),o.a.createElement("td",null,e.country),o.a.createElement("td",null,pr.local_time_at(Math.round(e.created_at/1e3))),o.a.createElement("td",null,pr.seconds(Math.round((e.deleted_at-e.created_at)/1e3))),o.a.createElement("td",null,pr.bytes(e.bytes_sent)),o.a.createElement("td",null,e.user_id))},hideGraph:function(){this.setState({load_pulse:!1,pulse:null})},showGraph:function(){this.setState({load_pulse:!0},this.refetchData)},hideTable:function(){this.setState({load_sessions:!1,sessions:null})},showTable:function(){this.setState({load_sessions:!0},this.refetchData)},hideReport:function(){this.setState({report:!1},this.refetchData)},showReport:function(){this.setState({report:!0},this.refetchData)},sort:function(e,t){return function(n){n.preventDefault();var a={q:{}};this.state.q[e].sort==t?a.q[e]={sort:{$set:null}}:a.q[e]={sort:{$set:t}},this.setState(o.a.addons.update(this.state,a),this.refetchData)}.bind(this)},header:function(e,t){return o.a.createElement("th",{key:e},this.state.report||o.a.createElement("div",{style:{float:"left",height:"100%"}},o.a.createElement("a",{style:{display:"block",color:"true"==this.state.q[e].sort?"grey":null},href:"#",onClick:this.sort(e,"true")},o.a.createElement("span",{className:"glyphicon glyphicon-arrow-up","aria-hidden":"true"}," ")),o.a.createElement("a",{style:{display:"block",color:"down"==this.state.q[e].sort?"grey":null},href:"#",onClick:this.sort(e,"down")},o.a.createElement("span",{className:"glyphicon glyphicon-arrow-down","aria-hidden":"true"}," "))),o.a.createElement("div",{style:{float:"left",height:"100%"}},t))},render:function(){var e={pulse:this.state.load_pulse,sessions:this.state.load_sessions},t=function(e,t){var n={};for(var a in e)n[a]=e[a];for(var r in t)n[r]=t[r];return n};return o.a.createElement("div",null,this.state.load_pulse?o.a.createElement(Et,{to:"stream-item-history",onClick:this.hideGraph,params:{name:encodeURIComponent(this.props.media.name)},query:t(e,{pulse:!1})},"Hide graph"):o.a.createElement(Et,{to:"stream-item-history",onClick:this.showGraph,params:{name:encodeURIComponent(this.props.media.name)},query:t(e,{pulse:!0})},"Show graph"),this.state.pulse&&o.a.createElement("div",{style:{height:400}},o.a.createElement(Fl.PulsePlot,{data:this.state.pulse,resolution:"minute",options:{yaxes:[{position:"left"},{position:"right"}],yaxis:{type:"net"}}})),o.a.createElement("br",null),this.state.load_sessions?o.a.createElement(Et,{to:"stream-item-history",onClick:this.hideTable,params:{name:encodeURIComponent(this.props.media.name)},query:t(e,{sessions:!1})},"Hide sessions"):o.a.createElement(Et,{to:"stream-item-history",onClick:this.showTable,params:{name:encodeURIComponent(this.props.media.name)},query:t(e,{sessions:!0})},"Show sessions"),o.a.createElement("br",null),this.state.report?o.a.createElement(Et,{to:"stream-item-history",onClick:this.hideReport,params:{name:encodeURIComponent(this.props.media.name)},query:t(e,{report:!1})},"Show sessions"):o.a.createElement(Et,{to:"stream-item-history",onClick:this.showReport,params:{name:encodeURIComponent(this.props.media.name)},query:t(e,{report:!0})},"Show report"),this.state.sessions&&o.a.createElement("div",{className:"table-responsive"},o.a.createElement("table",{className:"table table-hover table-bordered table-condensed"},o.a.createElement("thead",null,o.a.createElement("tr",null,this.header("proto","Protocol"),this.state.report||this.header("ip","IP"),this.header("country","Country"),this.state.report||this.header("created_at","Created at"),this.state.report||this.header("duration","Duration"),this.state.report&&this.header("avg_duration","Avg duration"),this.state.report&&this.header("total_duration","Total duration"),this.state.report||this.header("bytes","Bytes"),this.state.report||this.header("user_id","UserID"),this.state.report&&this.header("avg_bytes","Avg bytes"),this.state.report&&this.header("total_bytes","Total bytes"),this.state.report&&this.header("count","Count"))),o.a.createElement("tbody",null,this.state.sessions.map(this.renderSession)))))}});function Ey(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){wy(e,t,n[t])})}return e}function wy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Sy=Object(k.f)(function(e){return o.a.createElement(k.d,null,wt({extraProps:e,name:"stream-item-overview",component:Rd,exact:!0}),wt({extraProps:e,name:"stream-item-input",component:Vp}),wt({extraProps:e,name:"stream-item-output",component:Tm}),wt({extraProps:Ey({},ts.a(["config"],e),{entity:"streams",shouldRenderTimeline:!0}),name:"stream-item-dvr",component:Uf}),wt({extraProps:Ey({},ts.a(["config"],e),{entity:"streams"}),name:"stream-item-auth",component:Eu}),wt({extraProps:e,name:"stream-item-transcoder",component:vy}),wt({extraProps:e,name:"stream-item-clients",component:as}),wt({extraProps:e,name:"stream-item-history",component:yy}))});function Cy(e){return(Cy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oy(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function xy(e){return(xy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ny(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ky(e,t){return(ky=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Py={name:Y.a.string,serverInfo:Ja},jy=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=xy(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Cy(r)&&"function"!=typeof r?Ny(a):r,_y(Ny(n),"handleConfigSave",function(e){var t=n.props.getConfigDelta();if(t.streams&&t.streams[n.props.name]){var a=t.streams[n.props.name].name;n.props.onConfigSave().then(function(){a&&St(Ny(n),"stream-item",{mediaName:encodeURIComponent(a)}),"function"==typeof e&&e(n.props.config)})}}),_y(Ny(n),"renderLoader",function(){return o.a.createElement("div",{className:"stream-page"},o.a.createElement("div",null,"Loading stream ",n.props.name,"..."))}),_y(Ny(n),"renderRoutes",function(){return o.a.createElement("div",{id:"media-page"},o.a.createElement(Sy,{media:n.props.config.streams[n.props.name],serverInfo:n.props.serverInfo,name:n.props.name,config:n.props.config,runningRequest:n.props.isConfigSaving,change:n.props.onConfigChange(["streams",n.props.name]),saveConfig:n.handleConfigSave,resetChanges:n.props.onConfigResetChanges}))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ky(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return this.props.config&&this.props.config.streams[this.props.name]?this.renderRoutes():this.renderLoader()}}])&&Oy(n.prototype,a),r&&Oy(n,r),t}();_y(jy,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){_y(e,t,n[t])})}return e}({},Yi,Py));var Ry=es(Py)(jy);function Ty(e){return(Ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Iy(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Dy(e,t){return!t||"object"!==Ty(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ay(e){return(Ay=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qy(e,t){return(qy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var My=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Dy(this,Ay(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qy(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.resetChanges()}},{key:"render",value:function(){return o.a.createElement("div",{"data-testid":"location-overview"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Name"},o.a.createElement(mn,{value:this.props.media.prefix,onChange:this.props.change("prefix","string"),changed:this.props.media.prefix_changed})),o.a.createElement(ea,{label:"Description"},o.a.createElement(mn,{value:this.props.media.meta.comment,onChange:this.props.change("meta.comment","string"),changed:this.props.media.meta.comment_changed})),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:this.props.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"}))),o.a.createElement("div",{className:"right-page margin-left-10"},o.a.createElement("div",{className:"row-height"}))),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"row-height"}))}}])&&Iy(n.prototype,a),r&&Iy(n,r),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(My,"propTypes",{media:Y.a.object.isRequired,config:Y.a.object.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool});var Fy=My;function Vy(e){return(Vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function By(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ly(e,t){return!t||"object"!==Vy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wy(e){return(Wy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hy(e,t){return(Hy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Uy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zy=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ly(this,Wy(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hy(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.resetChanges()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{"data-testid":"location-process"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{expanded:!0,label:"Thumbnails",details:"Generate picture for each output segment"},o.a.createElement(ua,{label:"enabled",checked:!!this.props.media.thumbnails,onClick:function(){return e.props.change("thumbnails.enabled","raw")(!0)},isRadio:!0}),o.a.createElement(ua,{label:"disabled",checked:!this.props.media.thumbnails,onClick:function(){return e.props.change("thumbnails","raw")(null)},className:"margin-left-10",isRadio:!0}))),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:this.props.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}}])&&By(n.prototype,a),r&&By(n,r),t}();Uy(zy,"propTypes",{media:za.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool}),Uy(zy,"defaultProps",{runningRequest:!1});var Gy=zy,Qy=function(e){return o.a.createElement("div",{"data-testid":"location-output"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height notice-text"},"You should replace ","{","NAME","}"," with stream name, to access published stream."),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement(sm,{name:"{NAME}",media:e.media,config:e.config,change:e.change})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Max sessions",details:"Maximum simultaneous users for each published stream"},o.a.createElement(mn,{value:e.media.auth&&e.media.auth.max_sessions,onChange:e.change("auth.max_sessions","integer"),changed:e.media.auth&&e.media.auth.max_sessions_changed})),o.a.createElement(ea,{label:"Client timeout",details:"After this timeout from last client ondemand stream will be turned off"},o.a.createElement(hn,{value:e.media.clients_timeout,onChange:e.change("clients_timeout","raw"),changed:e.media.clients_timeout_changed,units:[{label:"seconds",factor:1}]})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"row-height"}),o.a.createElement(gm,{media:e.media,change:e.change}),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:e.runningRequest||!e.media.changed,onClick:e.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:e.runningRequest,className:"margin-left-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))};Qy.propTypes={media:Y.a.object.isRequired,config:Y.a.object.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,runningRequest:Y.a.bool},Qy.defaultProps={runningRequest:!1};var Ky=Qy,Jy=tn()({displayName:"LocationInputPage",propTypes:{media:Y.a.object.isRequired,config:Y.a.object.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool},componentDidMount:function(){this.props.resetChanges()},render:function(){return o.a.createElement("div",{"data-testid":"location-input"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height notice-text"},"You should replace ","{","NAME","}"," with any path, to publish to this location."),o.a.createElement(rp,{name:"{NAME}",media:this.props.media,config:this.props.config,change:this.props.change,hideWebRTC:!0}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Source timeout",details:"How many seconds Flussonic should wait before considering source as dead"},o.a.createElement(hn,{value:this.props.media.source_timeout,changed:this.props.media.source_timeout_changed,onChange:this.props.change("source_timeout","raw"),units:[{label:"seconds",factor:1}]}))),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:this.props.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}});function Yy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){$y(e,t,n[t])})}return e}function $y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xy=tn()({displayName:"LocationPage",propTypes:{name:Y.a.string.isRequired,config:Qa.isRequired},mixins:[te.a.ListenerMixin],getInitialState:function(){return{config:void 0,runningRequest:!1}},componentWillMount:function(){this.listenTo(ft,this.onConfigChange)},componentDidMount:function(){this.conf=new ie.Instance,this.conf.setServerConfig(this.props.config),this.setState({config:this.conf.localConfig()})},onConfigChange:function(e){this.conf.setServerConfig(e),this.setState({config:this.conf.localConfig()})},resetChanges:function(){this.conf.setDelta({})},validatedChange:function(e,t){var n=this,a=Array.isArray(e)?e:e.split("."),r=["lives",this.props.name].concat(a);return function(e){n.conf.changeDelta(r,"raw"===t?e:e.target.value,t),n.setState({config:n.conf.localConfig()})}},saveConfig:function(){var e=this;this.setState({runningRequest:!0});var t=this.conf.delta.lives[this.props.name].prefix;ft.save(this.conf.delta).then(function(){e.conf.resetDelta(),t&&St(e,"location-item",{mediaName:encodeURIComponent(t)}),e.setState({runningRequest:!1,config:e.conf.localConfig()})})},render:function(){return this.state.config&&this.state.config.lives[this.props.name]?o.a.createElement("div",{id:"media-page"},o.a.createElement(Zy,{media:this.state.config.lives[this.props.name],name:this.props.name,config:this.state.config,change:this.validatedChange,resetChanges:this.resetChanges,saveConfig:this.saveConfig,runningRequest:this.state.runningRequest})):o.a.createElement("div",null,"Loading live location...")}}),Zy=Object(k.f)(function(e){return o.a.createElement(k.d,null,wt({extraProps:e,name:"location-item-overview",component:Fy,exact:!0}),wt({extraProps:e,name:"location-item-input",component:Jy}),wt({extraProps:e,name:"location-item-output",component:Ky}),wt({extraProps:Yy({},e,{streamName:"lives",entity:"lives"}),name:"location-item-dvr",component:Uf}),wt({extraProps:Yy({},ts.a(["config"],e),{entity:"lives"}),name:"location-item-auth",component:Eu}),wt({extraProps:e,name:"location-item-process",component:Gy}),wt({extraProps:e,name:"location-item-clients",component:as}))}),eE=Xy,tE=n(650);function nE(e){return(nE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function rE(e,t){return!t||"object"!==nE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oE(e){return(oE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iE(e,t){return(iE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sE=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rE(this,oE(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iE(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement("div",{"data-testid":"published-overview"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Name"},o.a.createElement(mn,{value:this.props.name,readOnly:!0}))),o.a.createElement("div",{className:"right-page"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(Dr,{name:this.props.name,media:this.props.location,stats:this.props.stats,className:"margin-left-10"}))),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement(md,{name:this.props.name,media:this.props.location,stats:this.props.stats}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(wd,{name:this.props.name,media:this.props.location,stats:this.props.stats,config:this.props.config}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(Cd,{name:this.props.name}),o.a.createElement("div",{className:"row-height"}))}}])&&aE(n.prototype,a),r&&aE(n,r),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(sE,"propTypes",{name:Y.a.string.isRequired,location:Y.a.object.isRequired,stats:Y.a.object.isRequired,config:Y.a.object.isRequired});var lE=sE,cE=function(e){return o.a.createElement("div",{"data-testid":"published-output"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement(sm,{name:e.name,media:e.location,config:e.config})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))};cE.propTypes={name:Y.a.string.isRequired,location:Y.a.object.isRequired,config:Y.a.object.isRequired};var uE=cE,pE=function(e){var t=e.name,n=e.stats,a=e.liveName;return o.a.createElement("div",null,o.a.createElement("div",{className:"row-height"}),o.a.createElement(If,{name:t,stats:n,entityPath:["lives",a,"streams"]}))};pE.propTypes={name:Y.a.string.isRequired,liveName:Y.a.string.isRequired,stats:Oa.isRequired};var dE=pE,mE=Object(k.f)(function(e){return o.a.createElement(k.d,null,wt({extraProps:e,name:"published-item-overview",component:lE,exact:!0}),wt({extraProps:e,name:"published-item-output",component:uE}),wt({extraProps:e,name:"published-item-dvr",component:dE}),wt({extraProps:e,name:"published-item-clients",component:as}))});function fE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hE={name:Y.a.string.isRequired,config:Qa.isRequired},gE=function(e){var t=e.name,n=e.config,a=function(e,t){return Q.a(tE.a(function(n){return ke.a(["lives",n,"streams",e],t)}),ye.a,Es.a({},["lives"]))(t)}(t,n),r=a?n.lives[a]:null,i=r?r.streams[t]:null;return r&&i?o.a.createElement("div",{id:"media-page"},o.a.createElement(mE,{name:t,location:r,stats:i,config:n,liveName:a})):o.a.createElement("div",{id:"media-page"})};gE.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){fE(e,t,n[t])})}return e}({},Yi,hE);var vE=es(hE)(gE);function bE(e){return(bE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function EE(e){return(EE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SE(e,t){return(SE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function CE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var OE=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=EE(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==bE(r)&&"function"!=typeof r?wE(a):r,CE(wE(n),"onChange",function(e){e.preventDefault();var t=JSON.parse(JSON.stringify(n.props.media.urls));t[n.props.index]?t[n.props.index].url=e.target.value:t[n.props.index]={url:e.target.value},n.props.change(["vods",n.props.prefix])("urls","raw")(t)}),CE(wE(n),"onBlur",function(){!n.props.path.url&&n.props.media.urls[n.props.index]&&n.delete()}),CE(wE(n),"delete",function(){var e=JSON.parse(JSON.stringify(n.props.media.urls));e.splice(n.props.index,1),n.props.change(["vods",n.props.prefix])("urls","raw")(e)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SE(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e,t={mediaName:this.props.media.prefix,number:this.props.index},n=o.a.createElement("div",{className:"browse-block margin-right-10"});this.props.path.url&&(e=o.a.createElement("div",{className:"row-height flex-end more-block margin-left-10"},o.a.createElement(ua,{label:"remove",className:"danger",onClick:this.delete})),n=this.props.media.urls_changed?o.a.createElement("div",{className:"row-height flex-end browse-block margin-right-10"},o.a.createElement("div",{className:"underline"},"unsaved")):o.a.createElement("div",{className:"row-height flex-end browse-block margin-right-10"},o.a.createElement(Et,{to:"vod-item-tree",params:t,className:"action-button"},"browse")));var a="Path ".concat(this.props.index+1);return this.props.path.url||this.props.index!==this.props.media.urls.length||(a="New path"),o.a.createElement("div",{className:"vod-input-path"},n,o.a.createElement(ea,{label:a},o.a.createElement(mn,{onChange:this.onChange,changed:this.props.media.urls_changed,onBlur:this.onBlur,value:this.props.path.url})),e)}}])&&yE(n.prototype,a),r&&yE(n,r),t}();CE(OE,"propTypes",{index:Y.a.number.isRequired,path:Y.a.shape({url:Y.a.string}).isRequired,media:Ha.isRequired,prefix:Y.a.string.isRequired,change:Y.a.func.isRequired});var xE=OE;function NE(e){return(NE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _E(e){return(_E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jE(e,t){return(jE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var TE=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=_E(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==NE(r)&&"function"!=typeof r?PE(a):r,RE(PE(n),"disableOrEnable",function(){var e={vods:{}};e.vods[n.props.media.prefix]={disabled:!n.props.media.disabled},ft.save(e)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jE(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props.media.disabled?"enable":"disable",t=o.a.createElement(ua,{label:e,onClick:this.disableOrEnable}),n="row-height flex-end";return this.props.className&&(n+=" "+this.props.className),o.a.createElement("div",{className:n},t)}}])&&kE(n.prototype,a),r&&kE(n,r),t}();RE(TE,"propTypes",{prefix:Y.a.string.isRequired,media:Y.a.object.isRequired,className:Y.a.string});var IE=TE;function DE(e){return(DE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function qE(e,t){return!t||"object"!==DE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ME(e){return(ME=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FE(e,t){return(FE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var BE=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qE(this,ME(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FE(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.resetChanges()}},{key:"render",value:function(){var e=this,t=this.props.media.urls.concat([{url:""}]).map(function(t,n){return o.a.createElement(xE,{key:n,index:n,path:t,media:e.props.media,change:e.props.change,prefix:e.props.media.prefix})});return o.a.createElement("div",{"data-testid":"vod-overview"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Name"},o.a.createElement(mn,{value:this.props.media.prefix,onChange:this.props.change("prefix","string"),changed:this.props.media.prefix_changed})),o.a.createElement(ea,{label:"Description"},o.a.createElement(mn,{value:this.props.media.meta.comment,onChange:this.props.change("meta.comment","string"),changed:this.props.media.meta.comment_changed})),o.a.createElement("div",{className:"row-height"}),t,o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:this.props.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"}))),o.a.createElement("div",{className:"right-page margin-left-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(IE,{prefix:this.props.media.prefix,media:this.props.media}))),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"row-height"}))}}])&&AE(n.prototype,a),r&&AE(n,r),t}();VE(BE,"propTypes",{media:Ha.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool}),VE(BE,"defaultProps",{runningRequest:!1});var LE=BE;function WE(e){return(WE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function UE(e){return(UE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GE(e,t){return(GE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var KE=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=UE(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==WE(r)&&"function"!=typeof r?zE(a):r,QE(zE(n),"state",{running:!1,errorText:void 0,successText:void 0,progress:0}),QE(zE(n),"uploadForm",null),QE(zE(n),"uploadField",null),QE(zE(n),"handleUploadProgress",function(e){if(e.lengthComputable){var t=e.loaded/e.total;n.setState({progress:t})}}),QE(zE(n),"handleUploadSuccess",function(){setTimeout(n.resetUploadForm,3e3),n.setState({successText:"Upload complete."}),n.props.onComplete&&n.props.onComplete("success")}),QE(zE(n),"handleUploadError",function(){setTimeout(n.resetUploadForm,3e3),n.setState({successText:"Something went wrong"}),n.props.onComplete&&n.props.onComplete("error")}),QE(zE(n),"resetUploadForm",function(){n.uploadForm.reset(),n.setState({running:!1,successText:void 0,errorText:void 0,progress:0})}),QE(zE(n),"handleFilesUpload",function(e){e.preventDefault(),n.setState({running:!0});for(var t=[],a=n.uploadField.files,r=0;r<a.length;r+=1)t.push("".concat(a[r].name,":").concat(a[r].size));var o=new XMLHttpRequest;o.upload.addEventListener("progress",n.handleUploadProgress),o.upload.addEventListener("load",n.handleUploadSuccess),o.upload.addEventListener("error",n.handleUploadError),o.open("POST","/flussonic/api/upload"),o.setRequestHeader("Cache-Control","no-cache"),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("X-Prefix",n.props.prefix),o.setRequestHeader("X-Path",n.props.path),o.setRequestHeader("X-Subpath",n.props.subPath),o.setRequestHeader("X-File-Sizes",t.join("|")),o.send(new FormData(n.uploadForm))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GE(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this,t={display:this.state.running?"none":"initial"};return o.a.createElement("div",null,o.a.createElement("div",{style:t},o.a.createElement(ea,{expanded:!0,label:"Upload new files"},o.a.createElement("form",{ref:function(t){!e.uploadForm&&t&&(e.uploadForm=t)},encType:"multipart/form-data",action:"/flussonic/api/upload"},o.a.createElement("input",{type:"file",ref:function(t){!e.uploadField&&t&&(e.uploadField=t)},multiple:!0,name:"file",onChange:this.handleFilesUpload})))),this.state.running&&o.a.createElement(us,{progress:this.state.progress,text:"Uploading files...",successText:this.state.successText,errorText:this.state.errorText}))}}])&&HE(n.prototype,a),r&&HE(n,r),t}();QE(KE,"propTypes",{prefix:Y.a.string.isRequired,path:Y.a.string.isRequired,subPath:Y.a.string.isRequired,onComplete:Y.a.func.isRequired});var JE=KE;function YE(e){return(YE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function XE(e){return(XE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ZE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ew(e,t){return(ew=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nw(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var aw=function(e){return Object.values(e).reduce(function(e,t){var n,a=e.videos,r=e.dirs,o=e.other,i="directory"===t.type,s="file"===t.type&&(n=t.name,/\.mp4$/.test(n)||/\.flv$/.test(n)||/\.m4v$/.test(n)||/\.mov$/.test(n)||/\.mkv$/.test(n));return{dirs:i?[].concat(nw(r),[t]):r,videos:!i&&s?[].concat(nw(a),[t]):a,other:i||s?o:[].concat(nw(o),[t])}},{videos:[],dirs:[],other:[]})},rw=function(e,t){var n=e&&"/"!==Ut.a(e)?"".concat(e,"/"):e||"",a=[],r=!0,o=!1,i=void 0;try{for(var s,l=t[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;0===c.indexOf(n)&&function(){var e=c.replace(n,"").split("/")[0];a.find(function(t){return t.name===e})||a.push({name:e})}()}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return a},ow=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=XE(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==YE(r)&&"function"!=typeof r?ZE(a):r,tw(ZE(n),"state",{subPath:"",newDirName:"",createdDirs:[],refreshTimeout:void 0,selectedFile:void 0,files:[],listLoading:!1,showListLoading:!1}),tw(ZE(n),"handlePathClear",function(){n.setState({subPath:""},function(){n.loadFiles("")})}),tw(ZE(n),"handleNavigateToParentDirectory",function(e){e.preventDefault();var t=(n.state.subPath||"").split("/");t.pop(),n.state.subPath&&"/"===n.state.subPath[n.state.subPath.length-1]&&t.pop();var a=t.join("/");n.setState({subPath:a},function(){n.loadFiles(a)})}),tw(ZE(n),"handleNavigateToDirectory",function(e,t){t.preventDefault(),n.state.refreshTimeout&&clearTimeout(n.state.refreshTimeout);var a="".concat(n.state.subPath&&"/"!==Ut.a(n.state.subPath)?"".concat(n.state.subPath,"/"):n.state.subPath||"").concat(e);n.setState({subPath:a,refreshTimeout:void 0},function(){n.loadFiles(a)})}),tw(ZE(n),"handleNavigateToFile",function(e,t){t.preventDefault();var a="/"!==Ut.a(n.state.subPath)?"".concat(n.state.subPath,"/"):n.state.subPath||"";n.setState({selectedFile:n.state.selectedFile&&e===n.state.selectedFile.name?void 0:{name:e,subPath:a}})}),tw(ZE(n),"handleFileRemove",function(e){return function(){var t=n.props.media.urls[n.props.number].url,a="".concat("/"!==Ut.a(n.state.subPath)?"".concat(n.state.subPath,"/"):n.state.subPath||"").concat(e);N.vodRemoveFile(t,n.props.media.prefix,a).then(function(){n.loadFiles(n.state.subPath,!0)})}}),tw(ZE(n),"handleNewDirNameChange",function(e){n.setState({newDirName:e.target.value})}),tw(ZE(n),"handleDirectoryCreate",function(){var e=n.state.subPath||"";if(e&&"/"!==e[e.length-1]&&(e+="/"),e+=n.state.newDirName,-1===n.state.createdDirs.indexOf(e)){var t=n.state.createdDirs.slice();t.push(e),n.loadFiles(e),n.setState({createdDirs:t,newDirName:"",subPath:e})}}),tw(ZE(n),"loadFiles",function(e,t){var a=n.props.media.urls[n.props.number].url,r=e||n.state.subPath,o={mediaName:n.props.mediaName,number:n.props.number},i=n.props.query||{},s=r?Z()(i,{path:{$set:r}}):Z()(i,{$unset:["path"]});n.setState({listLoading:!0,showListLoading:!1}),setTimeout(function(){n.state.listLoading&&n.setState({showListLoading:!0})},300),N.vodList(a,n.props.media.prefix,r).then(function(e){n.setState({files:e.files,listLoading:!1,showListLoading:!1}),t||St(ZE(n),"vod-item-tree",o,s)})}),tw(ZE(n),"renderNewDirAction",function(){var e;for(var t in n.state.files)if(n.state.files[t].name===n.state.newDirName){e="This name is already taken";break}return o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ea,{label:"New directory",errorMessage:e},o.a.createElement(mn,{value:n.state.newDirName,onChange:n.handleNewDirNameChange,onSubmit:n.handleDirectoryCreate})),o.a.createElement(ua,{label:"save",onClick:n.handleDirectoryCreate,disabled:!n.state.newDirName&&!e,className:"margin-left-10"}))}),tw(ZE(n),"renderParentDirAction",function(){return n.state.subPath&&"/"!==n.state.subPath?o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("a",{href:"",onClick:n.handleNavigateToParentDirectory,readOnly:!0},". . parent directory")):o.a.createElement("div",{className:"row-height flex-end"})}),tw(ZE(n),"renderActions",function(){var e,t=n.props.media.urls[n.props.number].url;return e=n.state.showListLoading?o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"warning-text warning-border"},"Loading file list from server, please wait.")):o.a.createElement(JE,{onComplete:function(){return n.loadFiles(void 0,!0)},path:t,subPath:n.state.subPath,prefix:n.props.media.prefix}),o.a.createElement("div",null,n.renderNewDirAction(),e,n.renderParentDirAction())}),tw(ZE(n),"renderVideoEntry",function(e,t){return o.a.createElement("div",{key:t,className:"file-list-item video"},o.a.createElement("div",{className:"icon"}),o.a.createElement("a",{"data-testid":"vod-browser-file",className:"name",href:"",onClick:function(t){return n.handleNavigateToFile(e.name,t)}},e.name),o.a.createElement(ua,{onClick:n.handleFileRemove(e.name),label:"remove",className:"danger"}))}),tw(ZE(n),"renderDirEntry",function(e,t){return o.a.createElement("div",{key:t,className:"file-list-item directory"},o.a.createElement("div",{className:"icon"}),o.a.createElement("a",{className:"name",href:"",onClick:function(t){return n.handleNavigateToDirectory(e.name,t)}},e.name))}),tw(ZE(n),"renderOtherEntry",function(e,t){return o.a.createElement("div",{key:t,className:"file-list-item file"},o.a.createElement("div",{className:"icon"}),o.a.createElement("div",{className:"name"},e.name),o.a.createElement(ua,{onClick:n.handleFileRemove(e.name),label:"remove",className:"danger"}))}),tw(ZE(n),"renderFileList",function(){var e=aw(n.state.files),t=rw(n.state.subPath,n.state.createdDirs);return o.a.createElement("div",null,e.videos.map(n.renderVideoEntry),t.map(n.renderDirEntry),e.dirs.map(n.renderDirEntry),e.other.map(n.renderOtherEntry))}),tw(ZE(n),"renderSelectedFile",function(){if(!n.state.selectedFile)return null;var e="".concat(n.props.media.prefix,"/");""===n.state.selectedFile.subPath||"/"===n.state.selectedFile.subPath?e+=n.state.selectedFile.name:(e+=n.state.selectedFile.subPath,e+=n.state.selectedFile.name);var t=Z()(n.props.media,{name:{$set:e}});return o.a.createElement("div",null,o.a.createElement(wd,{height:300,name:e,media:t,stats:{},config:n.props.config}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(sm,{name:t.name,media:t,hideMpegts:!0,config:n.props.config}))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ew(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.loadFiles()}},{key:"render",value:function(){var e=this.props.media.urls[this.props.number].url;return"/"!==e[e.length-1]&&(e+="/"),o.a.createElement("div",{id:"vod-browser",className:"page-container","data-testid":"vod-browser"},o.a.createElement("div",{className:"left1-column margin-right-10",style:{maxWidth:this.state.selectedFile?"30%":"100%",overflow:"hidden"}},o.a.createElement("div",{className:"row-height"}),o.a.createElement(Et,{to:"vod-item-overview",query:this.props.query,params:{mediaName:this.props.mediaName},className:"action-button",activeClassName:""},"← back to VOD settings"),o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,null,o.a.createElement(mn,{prefix:e,onPrefixClick:this.handlePathClear,value:this.state.subPath,onChange:this.changePath})),this.renderActions(),this.renderFileList(),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right1-column margin-left-10 margin-right-10",style:{maxWidth:this.state.selectedFile?"70%":"10%"}},o.a.createElement("div",{className:"row-height"}),this.renderSelectedFile(),o.a.createElement("div",{className:"row-height"})))}}])&&$E(n.prototype,a),r&&$E(n,r),t}();tw(ow,"propTypes",{media:Ha.isRequired,config:Qa.isRequired,number:Y.a.string.isRequired,mediaName:Y.a.string.isRequired,query:ha()(Y.a.oneOfType([Y.a.string,Y.a.number]))}),tw(ow,"defaultProps",{query:{}});var iw=ow,sw=tn()({displayName:"VodInputPage",propTypes:{media:Y.a.object.isRequired,config:Y.a.object.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool},componentDidMount:function(){this.props.resetChanges()},render:function(){return o.a.createElement("div",{"data-testid":"vod-input"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Max simultaneous disk requests",details:"Fine-tune settings for 1G+ load"},o.a.createElement(mn,{value:this.props.media.read_queue,onChange:this.props.change("read_queue","integer")})),o.a.createElement(ea,{label:"Max disk readers per file",details:"Fine-tune settings for 1G+ load"},o.a.createElement(mn,{value:this.props.media.max_readers,onChange:this.props.change("max_readers","integer")}))),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:this.props.media.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.media.runningRequest,className:"margin-left-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}}),lw=function(e){return o.a.createElement("div",{"data-testid":"vod-output"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{expanded:!0,label:"Allow direct file download",details:"HTTP Range headers are supported"},o.a.createElement(ua,{label:"disabled",checked:!e.media.download,onClick:function(){return e.change("download","raw")(!1)},className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"enabled",checked:e.media.download,onClick:function(){return e.change("download","raw")(!0)},isRadio:!0})),o.a.createElement(ea,{expanded:!0,label:"Enable MBR from multiple files"},o.a.createElement(ua,{label:"disabled",checked:!e.media.auto_mbr,onClick:function(){return e.change("auto_mbr","raw")(!1)},className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{label:"enabled",checked:e.media.auto_mbr,onClick:function(){return e.change("auto_mbr","raw")(!0)},isRadio:!0})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Max sessions",details:"Maximum simultaneous users for each opened file"},o.a.createElement(mn,{value:e.media.auth&&e.media.auth.max_sessions,onChange:e.change("auth.max_sessions","integer"),changed:e.media.auth&&e.media.auth.max_sessions_changed})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"row-height"}),o.a.createElement(gm,{media:e.media,change:e.change,hidePrepush:!0,hideSegmentCount:!0}),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:e.media.runningRequest||!e.media.changed,onClick:e.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:e.media.runningRequest,className:"margin-left-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))};lw.propTypes={change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,media:Y.a.shape({download:Y.a.bool,auto_mbr:Y.a.bool,changed:Y.a.bool,runningRequest:Y.a.bool,auth:Y.a.shape({max_sessions:Y.a.number,max_sessions_changed:Y.a.bool}).isRequired}).isRequired};var cw=lw;function uw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){pw(e,t,n[t])})}return e}function pw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dw=Object(k.f)(function(e){var t=e;return o.a.createElement(k.d,null,wt({extraProps:e,name:"vod-item-overview",component:LE,exact:!0}),wt({name:"vod-item-tree",render:function(e){return o.a.createElement(iw,(n=e,Z()(t,{number:{$set:n.match.params.number},$merge:n})));var n}}),wt({extraProps:e,name:"vod-item-input",component:sw}),wt({extraProps:e,name:"vod-item-output",component:cw}),wt({extraProps:uw({},ts.a(["config"],e),{entity:"vods"}),name:"vod-item-auth",component:Eu}))});function mw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fw={name:Y.a.string.isRequired,config:Qa},hw=function(e){var t=e.config,n=e.name,a=e.onConfigChange,r=e.onConfigSave,i=e.isConfigSaving,s=e.onConfigResetChanges;return t&&t.vods[n]?o.a.createElement("div",{id:"media-page"},o.a.createElement(dw,{media:t.vods[n],mediaName:n,name:n,config:t,runningRequest:i,change:a,resetChanges:s,saveConfig:r})):o.a.createElement("div",{className:"stream-page"},o.a.createElement("div",null,"Loading VOD..."))};hw.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){mw(e,t,n[t])})}return e}({},Yi,fw);var gw=es(fw)(hw);function vw(e){return(vw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bw(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function yw(e,t){return!t||"object"!==vw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ew(e){return(Ew=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ww(e,t){return(ww=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sw=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yw(this,Ew(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ww(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement("div",{"data-testid":"file-overview"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Name"},o.a.createElement(mn,{value:this.props.file.name,readOnly:!0}))),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement(md,{name:this.props.file.name,media:this.props.file,stats:this.props.file,hideStats:!0,config:this.props.config}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(wd,{name:this.props.file.name,media:this.props.file,stats:this.props.file,config:this.props.config}),o.a.createElement("div",{className:"row-height"}))}}])&&bw(n.prototype,a),r&&bw(n,r),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Sw,"propTypes",{file:Y.a.object.isRequired,config:Y.a.object.isRequired});var Cw=Sw,Ow=function(e){return o.a.createElement("div",{"data-testid":"file-output"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement(sm,{name:e.file.name,media:e.file,config:e.config})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))};Ow.propTypes={file:Y.a.object.isRequired,config:Y.a.object.isRequired};var xw=Ow;function Nw(e){return(Nw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kw(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _w(e,t){return!t||"object"!==Nw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pw(e){return(Pw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jw(e,t){return(jw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rw=tn()({displayName:"FilePage",mixins:[te.a.ListenerMixin],propTypes:{name:Y.a.string.isRequired,config:Y.a.object.isRequired},render:function(){var e=Jt.findByName(this.props.config,this.props.name);return e?o.a.createElement("div",{id:"media-page"},o.a.createElement(Iw,{file:e,config:this.props.config,name:this.props.name})):o.a.createElement("div",{id:"media-page"})}}),Tw=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_w(this,Pw(t).apply(this,arguments))}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jw(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){return o.a.createElement(k.d,null,wt({extraProps:this.props,name:"file-item-overview",component:Cw,exact:!0}),wt({extraProps:this.props,name:"file-item-output",component:xw}),wt({extraProps:this.props,name:"file-item-clients",component:as}))}}])&&kw(n.prototype,a),i&&kw(n,i),t}(),Iw=Object(k.f)(Tw),Dw=Rw,Aw=n(399),qw=n.n(Aw);function Mw(e){return(Mw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fw(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Vw(e,t){return!t||"object"!==Mw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bw(e){return(Bw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lw(e,t){return(Lw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ww(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Hw=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Vw(this,Bw(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lw(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.resetChanges()}},{key:"render",value:function(){return o.a.createElement("div",{"data-testid":"mirror-overview"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Description"},o.a.createElement(mn,{value:this.props.media.meta.comment,onChange:this.props.change("meta.comment","string"),changed:this.props.media.meta.comment_changed})),o.a.createElement(ea,{label:"Ignored streams",details:"Specify names of streams that shouldn't be mirrored",className:"auto-height"},o.a.createElement(Zn,{value:this.props.media.except||[],onChange:this.props.change("except","raw"),separators:[","," "]})),o.a.createElement(ea,{label:"Taken streams",details:"If specified, only these streams will be mirrored",className:"auto-height"},o.a.createElement(Zn,{value:this.props.media.only||[],onChange:this.props.change("only","raw"),separators:[","," "]})),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:this.props.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"}))),o.a.createElement("div",{className:"right-page margin-left-10"},o.a.createElement("div",{className:"row-height"}))),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"row-height"}))}}])&&Fw(n.prototype,a),r&&Fw(n,r),t}();Ww(Hw,"propTypes",{media:za.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool}),Ww(Hw,"defaultProps",{runningRequest:!1});var Uw=Hw,zw=tn()({displayName:"MirrorInputURL",propTypes:{index:Y.a.number.isRequired,value:Y.a.string.isRequired,media:Y.a.object.isRequired},onChange:function(e){e.preventDefault();var t=JSON.parse(JSON.stringify(this.props.media.urls));t[this.props.index]=e.target.value,this.props.change("urls","raw")(t)},onBlur:function(){this.props.value||null==this.props.media.urls[this.props.index]||this.delete()},delete:function(){var e=JSON.parse(JSON.stringify(this.props.media.urls));e.splice(this.props.index,1),this.props.change("urls","raw")(e)},render:function(){var e=void 0;this.props.value&&(e=o.a.createElement("div",{className:"row-height flex-end margin-left-10"},o.a.createElement(ua,{label:"remove",className:"danger",onClick:this.delete})));var t="Server URL "+(this.props.index+1);this.props.value||this.props.index!=this.props.media.urls.length||(t="New URL");return o.a.createElement("div",{className:"mirror-input-url"},o.a.createElement(ea,{label:t},o.a.createElement(mn,{onChange:this.onChange,changed:!1,onBlur:this.onBlur,value:this.props.value})),e)}}),Gw=tn()({displayName:"MirrorInputPage",propTypes:{media:Y.a.object.isRequired,config:Y.a.object.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool},componentDidMount:function(){this.props.resetChanges()},render:function(){var e=this.props.media.urls.concat([""]).map(function(e,t){return o.a.createElement(zw,{key:t,index:t,value:e,media:this.props.media,change:this.props.change})}.bind(this));return o.a.createElement("div",{"data-testid":"mirror-input"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),e,o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Cluster key",details:"Remote Flussonic may require cluster authorization key"},o.a.createElement(mn,{value:this.props.media.cluster_key,onChange:this.props.change("cluster_key","string"),changed:this.props.media.cluster_key_changed})),o.a.createElement("div",{className:"row-height"}),o.a.createElement(ua,{label:"save",disabled:this.props.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}});function Qw(e){return(Qw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kw(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Jw(e,t){return!t||"object"!==Qw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yw(e){return(Yw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $w(e,t){return($w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zw=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Jw(this,Yw(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$w(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.resetChanges()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{"data-testid":"mirror-process"},o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{expanded:!0,label:"Thumbnails",details:"Generate picture for each output segment"},o.a.createElement(ua,{label:"enabled",checked:!!this.props.media.thumbnails,onClick:function(){return e.props.change("thumbnails.enabled","raw")(!0)},isRadio:!0}),o.a.createElement(ua,{label:"disabled",checked:!this.props.media.thumbnails,onClick:function(){return e.props.change("thumbnails","raw")(null)},className:"margin-left-10",isRadio:!0}))),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:this.props.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}}])&&Kw(n.prototype,a),r&&Kw(n,r),t}();Xw(Zw,"propTypes",{media:za.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool}),Xw(Zw,"defaultProps",{runningRequest:!1});var eS=Zw;function tS(e){return(tS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nS(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function aS(e,t){return!t||"object"!==tS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rS(e){return(rS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oS(e,t){return(oS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iS=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),aS(this,rS(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oS(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement("div",{"data-testid":"mirror-output"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(sm,{name:"{NAME}",config:this.props.config,media:this.props.media,change:this.props.change}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(gm,{media:this.props.media,change:this.props.change}),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:this.props.runningRequest||!this.props.media.changed,onClick:this.props.saveConfig,className:"rect filled"}),o.a.createElement(ys,{running:this.props.runningRequest,className:"margin-left-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}}])&&nS(n.prototype,a),r&&nS(n,r),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(iS,"propTypes",{media:Y.a.object.isRequired,config:Y.a.object.isRequired,change:Y.a.func.isRequired,saveConfig:Y.a.func.isRequired,resetChanges:Y.a.func.isRequired,runningRequest:Y.a.bool});var sS=iS;function lS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){fS(e,t,n[t])})}return e}function cS(e){return(cS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uS(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function pS(e){return(pS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mS(e,t){return(mS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hS=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=pS(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==cS(r)&&"function"!=typeof r?dS(a):r,fS(dS(n),"state",{config:null,runningRequest:!1}),fS(dS(n),"onConfigChange",function(e){n.conf.setServerConfig(e),n.setState({config:n.conf.localConfig()})}),fS(dS(n),"resetChanges",function(){n.conf.setDelta({})}),fS(dS(n),"validatedChange",function(e,t){var a=Array.isArray(e)?e:e.split("."),r=["sources",n.props.name].concat(a);return function(e){n.conf.changeDelta(r,"raw"===t?e:e.target.value,t),n.setState({config:n.conf.localConfig()})}}),fS(dS(n),"saveConfig",function(){n.setState({runningRequest:!0}),ft.save(n.conf.delta).then(function(){n.conf.resetDelta(),n.setState({runningRequest:!1,config:n.conf.localConfig()})})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mS(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentWillMount",value:function(){this.listenTo(ft,this.onConfigChange)}},{key:"componentDidMount",value:function(){this.conf=new ie.Instance,this.conf.setServerConfig(this.props.config),this.setState({config:this.conf.localConfig()})}},{key:"render",value:function(){var e=this.state,t=e.config,n=e.runningRequest,a=this.props.name;return t&&t.sources&&a?o.a.createElement("div",{id:"media-page"},o.a.createElement(gS,{media:t.sources[a],name:a,config:t,change:this.validatedChange,resetChanges:this.resetChanges,saveConfig:this.saveConfig,runningRequest:n})):o.a.createElement("div",null,"Loading...")}}])&&uS(n.prototype,a),r&&uS(n,r),t}();fS(hS,"propTypes",{name:Y.a.string.isRequired,config:Y.a.object}),fS(hS,"defaultProps",{config:null});var gS=Object(k.f)(function(e){return o.a.createElement(k.d,null,wt({extraProps:e,name:"mirror-item-overview",component:Uw,exact:!0}),wt({extraProps:e,name:"mirror-item-input",component:Gw}),wt({extraProps:e,name:"mirror-item-process",component:eS}),wt({extraProps:lS({},e,{streamName:"sources",entity:"sources"}),name:"mirror-item-dvr",component:Uf}),wt({extraProps:e,name:"mirror-item-output",component:sS}),wt({extraProps:lS({},ts.a(["config"],e),{entity:"sources"}),name:"mirror-item-auth",component:Eu}))}),vS=qw.a.decorate(te.a.ListenerMixin)(hS);function bS(e){return(bS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yS(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ES(e,t){return!t||"object"!==bS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wS(e){return(wS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SS(e,t){return(SS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CS=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ES(this,wS(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SS(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e,t=this.props.name,n=this.props.config.sources;return Object.keys(n).some(function(a){var r=n[a];if(r.streams[t])return e=r.streams[t],!0}),o.a.createElement("div",null,o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Name"},o.a.createElement(mn,{value:e.name,readOnly:!0}))),o.a.createElement("div",{className:"right-page"},o.a.createElement("div",{className:"row-height"}),o.a.createElement(Dr,{name:e.name,media:e,stats:e,className:"margin-left-10"}))),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement(md,{name:e.name,media:e,stats:e}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(wd,{name:e.name,media:e,stats:e,config:this.props.config}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(Cd,{name:e.name}),o.a.createElement("div",{className:"row-height"}))}}])&&yS(n.prototype,a),r&&yS(n,r),t}();function OS(e){return(OS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xS(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function NS(e,t){return!t||"object"!==OS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kS(e){return(kS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _S(e,t){return(_S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var PS=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),NS(this,kS(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_S(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e,t=this.props.name,n=this.props.config.sources;return Object.keys(n).some(function(a){var r=n[a];if(r.streams[t])return e=r.streams[t],!0}),o.a.createElement("div",null,o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement(sm,{name:e.name,media:e,config:this.props.config})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})),o.a.createElement("div",{className:"page-container"},o.a.createElement("div",{className:"center-page-container"},o.a.createElement("div",{className:"left3-page margin-right-10"},o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-page"})),o.a.createElement("div",{className:"right-page-container"})))}}])&&xS(n.prototype,a),r&&xS(n,r),t}();function jS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){RS(e,t,n[t])})}return e}function RS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var TS=Object(k.f)(function(e){return o.a.createElement(k.d,null,wt({extraProps:e,name:"mirrored-item-overview",component:CS,exact:!0}),wt({extraProps:e,name:"mirrored-item-output",component:PS}),wt({extraProps:jS({},ts.a(["config"],e),{shouldRenderTimeline:!0,entity:"sources",name:ke.a(["mirror","position"],e),subentity:"streams",subentityName:ke.a(["name"],e),entityPath:["sources",ke.a(["mirror","position"],e),"streams"],statsPath:[],hideSettings:!0}),name:"mirrored-item-dvr",component:Uf}),wt({extraProps:e,name:"mirrored-item-clients",component:as}))}),IS=Q.a(Ut.a,Ci.a,zt.a("/")),DS=function(e){var t=e.config,n=e.name,a=Jt.findByName(t,n,"sources"),r=function(e,t){for(var n=IS(e.source_hostname||"")||IS(e.url||""),a=Object.keys(t),r=0;r<a.length;r++){var o=t[a[r]],i=!0,s=!1,l=void 0;try{for(var c,u=o.urls[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var p=c.value,d=Q.a(Ut.a,zt.a("//"));if((/:\d+$/.test(p)?d(p):"".concat(d(p),":80"))===n||p===n)return o}}catch(e){s=!0,l=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw l}}}return null}(a,t.sources);return o.a.createElement("div",{id:"media-page"},Ie(a)&&Ie(r)&&o.a.createElement(TS,{name:n,mirror:r,config:t}))};DS.propTypes={config:Qa.isRequired,name:Y.a.string.isRequired};var AS=DS;function qS(){return(qS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var MS=function(e){return o.a.createElement(k.d,null,wt({name:"stream-item",render:function(t){return o.a.createElement(Ry,qS({},e,t,{name:decodeURIComponent(t.match.params.mediaName)}))}}),wt({name:"location-item",render:function(t){return o.a.createElement(eE,qS({},e,t,{name:decodeURIComponent(t.match.params.mediaName)}))}}),wt({name:"published-item",render:function(t){return o.a.createElement(vE,qS({},e,t,{name:decodeURIComponent(t.match.params.mediaName)}))}}),wt({name:"vod-item",render:function(t){return o.a.createElement(gw,qS({},e,t,{name:decodeURIComponent(t.match.params.mediaName)}))}}),wt({name:"file-item",render:function(t){return o.a.createElement(Dw,qS({},e,t,{name:decodeURIComponent(t.match.params.mediaName)}))}}),wt({name:"mirror-item",render:function(t){return o.a.createElement(vS,qS({},e,t,{name:decodeURIComponent(t.match.params.mediaName)}))}}),wt({name:"mirrored-item",render:function(t){return o.a.createElement(AS,qS({},e,t,{name:decodeURIComponent(t.match.params.mediaName)}))}}))};n(1371);function FS(e){return(FS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VS(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function BS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){zS(e,t,n[t])})}return e}function LS(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function WS(e){return(WS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function US(e,t){return(US=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var GS=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=WS(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==FS(r)&&"function"!=typeof r?HS(a):r,zS(HS(n),"streamListRef",null),zS(HS(n),"locationListRef",null),zS(HS(n),"mirroredListRef",null),zS(HS(n),"fileListRef",null),zS(HS(n),"setRef",function(e){return null===n[e]||n[e]?function(t){!n[e]&&t&&(n[e]=t)}:(console.error("Wrong ref name: ",e),null)}),zS(HS(n),"maybeMoveToSelectedElement",function(){if(n.streamListRef){var e=n.streamListRef.getSelectedItemIndex();if(e>-1)return void window.scrollTo(0,e*n.props.itemHeight+n.props.topOffset)}var t=n.locationListRef&&n.locationListRef.getSelectedNode()||n.mirroredListRef&&n.mirroredListRef.getSelectedNode()||n.fileListRef&&n.fileListRef.getSelectedNode();t&&(t.scrollIntoView(),window.innerHeight+window.scrollY<document.body.offsetHeight&&window.scrollTo(0,window.scrollY-n.props.topOffset))}),zS(HS(n),"isStreamNameMatchQueryAndFilters",function(e,t,a){return Zt.matchQuery(n.props.config.streams[a],t)&&Zt.matchFilters(n.props.config.streams[a],e)}),zS(HS(n),"getStandaloneNames",function(e,t){return Object.keys(n.props.config.streams).reduce(function(a,r){return n.isStreamNameMatchQueryAndFilters(e,t,r)?BS({},a,{visible:[].concat(VS(a.visible),[r])}):BS({},a,{hidden:[].concat(VS(a.hidden),[r])})},{visible:[],hidden:[]})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&US(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.config){var n=decodeURIComponent(e.params.mediaName),a=decodeURIComponent(this.props.params.mediaName),r=function(n){return t.props.config&&e.config&&t.props.config[n]&&e.config[n]&&Object.keys(t.props.config[n]).length!==Object.keys(e.config[n]).length};(a&&a!==n||!e.config&&this.props.config||r("streams")||r("lives")||r("vods")||r("sources"))&&requestAnimationFrame(this.maybeMoveToSelectedElement)}}},{key:"renderMediaContent",value:function(){var e=decodeURIComponent(this.props.params.mediaName||""),t=document.getElementById("media-content"),n="100%";return t&&(n="".concat(t.offsetWidth,"px")),e&&o.a.createElement("div",{id:"media-content"},o.a.createElement("div",{className:"media-content-inside",style:{top:this.props.topOffset,height:window.innerHeight-this.props.topOffset,width:n}},o.a.createElement(MS,{name:e,config:this.props.config,serverInfo:this.props.serverInfo})))}},{key:"render",value:function(){if(!this.props.config&&!this.props.visible)return o.a.createElement("div",null);if(!this.props.config)return o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",null,"Loading config...")),o.a.createElement("div",{className:"right-container"}));var e=this.props.params.mediaName?"base-container":"",t=this.props.query.filter,n=(this.props.query.query||"").trim().toLowerCase(),a=decodeURIComponent(this.props.params.mediaName||""),r=this.props.config&&o.a.createElement("span",null,o.a.createElement(zr,{selectedName:a,filters:t,query:n,config:this.props.config,ref:this.setRef("locationListRef")}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(Ao,{selectedName:a,filters:t,query:n,config:this.props.config,ref:this.setRef("mirroredListRef")}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(wi,{selectedName:a,filters:t,query:n,config:this.props.config,ref:this.setRef("fileListRef")}),o.a.createElement("div",{className:"row-height"})),i=Object.assign({marginTop:this.props.topOffset},!this.props.visible&&{display:"none"}),s=this.getStandaloneNames(t,n);return o.a.createElement("div",{style:i},o.a.createElement("div",{className:e},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-right-container"},o.a.createElement("div",{id:"media-list"},o.a.createElement(pi,{selectedName:a,visibleNames:s.visible,hiddenNames:s.hidden,config:this.props.config,ref:this.setRef("streamListRef"),topOffset:this.props.topOffset,itemHeight:this.props.itemHeight}),o.a.createElement("div",{className:"row-height"}),r),this.renderMediaContent())))}}])&&LS(n.prototype,a),r&&LS(n,r),t}();zS(GS,"propTypes",{visible:Y.a.bool.isRequired,params:Y.a.shape({mediaName:Y.a.string}).isRequired,query:Y.a.shape({filter:Y.a.arrayOf(Y.a.string),query:Y.a.string}).isRequired,config:Qa,itemHeight:Y.a.number,topOffset:Y.a.number.isRequired,serverInfo:Ja}),zS(GS,"defaultProps",{itemHeight:40,serverInfo:null,config:void 0});var QS=Dt()(GS),KS=n(1450);n(1372);function JS(){return(JS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function YS(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var $S=function(e){var t=e.noGutters,n=e.className,a=YS(e,["noGutters","className"]);return o.a.createElement(Jl.a,JS({className:an()(n,{noGutters:t})},a))};$S.propTypes={tag:Y.a.oneOfType([Y.a.func,Y.a.string]),fluid:Y.a.bool,className:Y.a.string,cssModule:Y.a.object,noGutters:Y.a.bool},$S.defaultProps={tag:"div",fluid:!1,className:"",noGutters:!1};var XS=$S,ZS=function(e){var t=e.config;return[t.stats.total_streams&&t.stats.online_streams&&o.a.createElement("li",{key:"streams"},"streams: ",t.stats.total_streams," (",o.a.createElement("span",{className:"success-text",style:{fontWeight:"normal"}},t.stats.online_streams),")"),t.stats.total_streams&&!t.stats.online_streams&&o.a.createElement("li",{key:"streams"},"streams: ",t.stats.total_streams),t.stats.opened_files&&o.a.createElement("li",{key:"files"},"files: ",t.stats.opened_files),t.stats.total_clients&&o.a.createElement("li",{key:"clients"},"clients: ",t.stats.total_clients)].filter(Boolean)};ZS.propTypes={config:Qa.isRequired};var eC=ZS,tC=function(e){var t,n,a,r,i,s=e.config,l=(t={inGbps:s.stats.input_kbit/1e6,inMbps:s.stats.input_kbit/1e3,outGbps:s.stats.output_kbit/1e6,outMbps:s.stats.output_kbit/1e3},n=t.inGbps,a=t.inMbps,r=t.outGbps,i=t.outMbps,n<1&&r<1?{inText:"".concat(a<10?a.toFixed(3):Math.floor(a)," Mbps"),outText:"".concat(i<10?i.toFixed(3):Math.floor(i)," Mbps")}:{inText:"".concat(n<10?n.toFixed(3):Math.floor(n)," Gbps"),outText:"".concat(r<10?r.toFixed(3):Math.floor(r)," Gbps")}),c=l.inText,u=l.outText;return o.a.createElement(o.a.Fragment,null,o.a.createElement("li",null,"in: ",c),o.a.createElement("li",null,"out: ",u))};tC.propTypes={config:Qa.isRequired};var nC=tC,aC=function(e){var t=e.connected,n=e.config;return o.a.createElement("div",{id:"header-info-line","data-testid":"header-top-nav-status-line-".concat(t?"online":"offline")},!t&&o.a.createElement("div",{className:"warning-text warning-border"},"Offline mode, connection with server has been lost."),n&&t&&o.a.createElement("ul",null,o.a.createElement("li",null,"".concat(n.stats.version).concat(n.stats.build>0?"-".concat(n.stats.build):"")),n.stats.retroview_enabled&&o.a.createElement("li",null,"Collecting statistics"),n.stats.retroview_configured?"":o.a.createElement("li",{className:"warning-text"},"Enable statistics collection"),o.a.createElement(eC,{config:n}),o.a.createElement(nC,{config:n}),o.a.createElement("li",null,"up: ",pr.seconds(n.stats.uptime))))};aC.propTypes={connected:Y.a.bool,config:Qa.isRequired},aC.defaultProps={connected:!1};var rC=aC,oC=n(1480),iC=n(1449),sC=n(669),lC=n(1448);function cC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var uC=Object(sC.a)(function(e){return Object(lC.a)({root:{backgroundColor:function(e){return e.isError?"#f4d7d7":"#e5ffd5"},position:"relative",height:function(t){return t.isOpened?"auto":e.spacing(6)},maxHeight:"80vh",width:"100%",padding:e.spacing(2),overflowY:"scroll"},text:{position:"relative",height:function(t){return t.isOpened?"auto":e.spacing(2)},lineHeight:function(e){return e.isOpened?"18px":"initial"},overflow:function(e){return e.isOpened?"visible":"hidden"},whiteSpace:function(e){return e.isOpened?"pre-wrap":"nowrap"}},textEllipsis:{position:"absolute",right:0,bottom:0,width:e.spacing(2),height:e.spacing(2),backgroundColor:function(e){return e.isError?"#f4d7d7":"#e5ffd5"}},iconButtonContainer:{position:"absolute",top:0,right:e.spacing(1),height:e.spacing(6),width:e.spacing(6),userSelect:"none"},iconButton:{width:e.spacing(6),height:e.spacing(6)},icon:{transform:function(e){return e.isOpened?"rotate(0)":"rotate(180deg)"},transition:"transform 0.3s"}})}),pC=function(e){var t=e.className,n=e.text,a=e.header,r=e.isError,i=e.isTextMultiline,s=e.children,l=(Object(oC.a)().width-32)/12*11/14,c=i?a&&a.length>l:n&&n.length>l,u=cC(Object(iC.a)(!1),2),p=u[0],d=u[1],m=uC({isError:r,isOpened:p});return o.a.createElement(Ps.a,{container:!0,justify:"space-between",className:an()(t,m.root)},o.a.createElement(Ps.a,{item:!0,xs:11,className:an()(m.text)},s||o.a.createElement("div",{dangerouslySetInnerHTML:{__html:n}}),n&&c&&!p&&o.a.createElement("div",{className:m.textEllipsis},"...")),o.a.createElement(Ps.a,{container:!0,item:!0,xs:1,justify:"flex-end",className:m.iconButtonContainer},(c||i)&&o.a.createElement(Is.a,{className:m.iconButton,"aria-label":"Toggle notification description",title:"Toggle notification description",onClick:d,"data-testid":"notificationToggle"},o.a.createElement(ig.a,{className:m.icon,fontSize:"small"}))))};pC.propTypes={className:Y.a.string,text:Y.a.string,header:Y.a.string,isError:Y.a.bool,isTextMultiline:Y.a.bool,children:Y.a.node},pC.defaultProps={className:null,text:null,header:null,isError:!1,isTextMultiline:!1,children:null};var dC=pC,mC=function(e){return e.replace(/,\\n/g,"").replace(/\\">>,<<\\"/,"<br />").replace(/\\">>}/g,"<br />}").replace(/\\">>]/g,"<br />]").replace(/\\\\n/g,"<br />").replace(/\n/g,"<br />").replace(/\\\\\\/g,"").replace(/\\n/g,"<br />").replace(/<<\\"/g,"<br />").replace(/\\">>/g,"<hr />").replace(/\s{4}/g,"")},fC=Q.a(ki.a,zt.a(/\\\\n/)),hC=function(e){var t=e.notifications;return o.a.createElement(Td.a,{px:"8.5%"},t.next_version&&o.a.createElement(dC,null,"New Flussonic version is out: ",o.a.createElement("span",{className:"success-text"},t.next_version)),t.errors.map(function(e){return o.a.createElement(dC,{isError:!0,key:e.slice(100),text:mC(e),isTextMultiline:(t=e,t.includes("\\n")||t.includes('<<\\"')),header:fC(e)});var t}))};hC.propTypes={notifications:Y.a.shape({next_version:Y.a.oneOfType([Y.a.string,Y.a.number]),errors:Y.a.arrayOf(Y.a.string)}).isRequired};var gC=hC,vC=(n(1373),function(e){var t=e.children,n=e.items,a=e.activeItemId;return o.a.createElement(XS,{fluid:!0,noGutters:!0},o.a.createElement(Yl.a,{noGutters:!0,style:{alignItems:"center"}},o.a.createElement($l.a,{sm:6},o.a.createElement("div",{className:"MenuLinesList","data-testid":"header-top-nav-links"},n.map(function(e){var t=e.id,n=e.item,r=e.to;return o.a.createElement(Et,{key:t,to:r,activeClassName:an()({active:t===a}),className:"action-button MenuLinesItem"},"function"==typeof n?o.a.createElement(n,null):n)}))),o.a.createElement($l.a,{sm:6},t)))});vC.propTypes={children:Y.a.node,activeItemId:Aa.isRequired,items:Y.a.arrayOf(Y.a.shape({id:Aa,Item:Y.a.node,to:Y.a.string})).isRequired},vC.defaultProps={children:null};var bC=vC;function yC(e){return(yC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EC(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function wC(e){return(wC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CC(e,t){return(CC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xC=[{id:0,item:"Media",to:"root"},{id:1,item:"Pulse",to:"pulse"},{id:2,item:"Config",to:"global-config",path:"config"},{id:3,item:"Cluster",to:"cluster"},{id:4,item:"IPTV",to:"iptv"},{id:5,item:"IP Cameras",to:"watcher"},{id:6,item:"Upload debug",to:"logupload"}],NC=[{id:0,item:"Media",to:"root"},{id:1,item:"Pulse",to:"pulse"},{id:2,item:"Config",to:"global-config",path:"config"},{id:3,item:"Chassis",to:"chassis"},{id:6,item:"Upload debug",to:"logupload"}],kC=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=wC(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==yC(r)&&"function"!=typeof r?SC(a):r,OC(SC(n),"state",{connected:ae.connected}),OC(SC(n),"onWebsocketClose",function(){n.setState({connected:!1})}),OC(SC(n),"onWebsocketOpen",function(){n.setState({connected:!0})}),OC(SC(n),"onLogoutClick",function(){n.props.logout()}),OC(SC(n),"menuItems",function(){return N.getServerInfo().chassis?NC:xC}),OC(SC(n),"getActiveItemId",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.hash.split("/");return Im.a(0,"id",n.menuItems().find(function(t){var n=t.to,a=t.path;return e.includes(n)||e.includes(a)}))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CC(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.listenTo(ne.websocketClose,this.onWebsocketClose),this.listenTo(ne.websocketOpen,this.onWebsocketOpen)}},{key:"render",value:function(){return o.a.createElement(XS,{fluid:!0},o.a.createElement(Yl.a,{className:"base-container",noGutters:!0},o.a.createElement($l.a,{sm:1}),o.a.createElement($l.a,{id:"header-top-nav","data-testid":"header-top-nav",className:"center-container",sm:10},o.a.createElement(bC,{items:this.menuItems(),activeItemId:this.getActiveItemId()},o.a.createElement(rC,{config:this.props.config,connected:this.state.connected}))),o.a.createElement($l.a,{className:"right-container",sm:1},o.a.createElement("div",{id:"header-top-logout",className:"flex-end"},o.a.createElement(KS.a,{color:"link",onClick:this.onLogoutClick,"data-testid":"header-top-nav-logout"},"logout")))),o.a.createElement(gC,{notifications:this.props.notifications}))}}])&&EC(n.prototype,a),r&&EC(n,r),t}();OC(kC,"propTypes",{config:Qa,notifications:J.shape({next_version:J.oneOfType([J.string,J.number]),errors:J.arrayOf(J.string)}).isRequired,logout:J.func}),OC(kC,"defaultProps",{logout:function(){},config:{stats:{}}});var _C=qw.a.decorate(te.a.ListenerMixin)(kC);n(1374);function PC(e){return(PC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jC(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function RC(e){return(RC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IC(e,t){return(IC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AC=[{id:0,name:"Overview",to:"overview"},{id:1,name:"Input",to:"input"},{id:2,name:"Transcoder",to:"transcoder"},{id:3,name:"DVR",to:"dvr"},{id:4,name:"Output",to:"output"},{id:5,name:"Auth",to:"auth"},{id:6,name:"Clients",to:"clients"}],qC=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=RC(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==PC(r)&&"function"!=typeof r?TC(a):r,DC(TC(n),"setActiveMenu",function(e){var t=n.props.mediaName,a=Q.a(Ut.a,zt.a("".concat(t)))(window.location.hash);return a?a==="/".concat(e.to):e.to===AC[0].to}),DC(TC(n),"onRemoveClick",function(){var e=n.props.mediaName,t=decodeURIComponent(e);if(window.confirm("Really delete ".concat(t," from config?"))){var a={streams:{}};a.streams[t]=null,ft.save(a).then(function(){return St(TC(n),"root",{},{})})}}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IC(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this,t={mediaName:this.props.mediaName};return o.a.createElement("div",{className:"header-stream-page__wrapper"},o.a.createElement("div",{className:an()(["flex-end","row-height","margin-left-10","padding-left-10","header-stream-page__container"])},AC.map(function(n){return o.a.createElement(Et,{key:n.id,to:"stream-item-".concat(n.to),"data-testid":"stream-item-".concat(n.to),params:t,className:"action-button margin-right-10 ".concat(e.setActiveMenu(n)?"active":"")},n.name)})),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"delete stream",onClick:this.onRemoveClick,className:"danger rect"})))}}])&&jC(n.prototype,a),r&&jC(n,r),t}();DC(qC,"propTypes",{mediaName:Y.a.string.isRequired});var MC=qC,FC=tn()({displayName:"HeaderPublishedPage",propTypes:{config:Y.a.object.isRequired},findLocation:function(e){for(var t in this.props.config.lives)if(this.props.config.lives[t].streams[e])return this.props.config.lives[t]},render:function(){var e={mediaName:this.props.mediaName},t=decodeURIComponent(this.props.mediaName),n=this.findLocation(t),a=void 0,r=void 0;n&&(a=n.streams[t],r=o.a.createElement(Et,{to:"location-item",params:{mediaName:n.prefix},className:"action-button margin-right-10"},"Location config"));var i=void 0;return a&&a.dvr_info&&(i=o.a.createElement(Et,{to:"published-item-dvr",params:e,className:"action-button margin-right-10"},"DVR")),o.a.createElement("div",{className:"flex-end row-height margin-left-10 padding-left-10"},o.a.createElement(Et,{to:"published-item-overview",params:e,className:"action-button margin-right-10"},"Overview"),o.a.createElement(Et,{to:"published-item-output",params:e,className:"action-button margin-right-10"},"Output"),o.a.createElement(Et,{to:"published-item-clients",params:e,className:"action-button margin-right-10"},"Clients"),i,r)}}),VC=tn()({displayName:"HeaderMirroredPage",propTypes:{config:Y.a.object},findOrigin:function(e){for(var t in this.props.config.sources)if(this.props.config.sources[t].streams[e])return this.props.config.sources[t]},render:function(){var e={mediaName:this.props.mediaName},t=decodeURIComponent(this.props.mediaName),n=this.findOrigin(t),a=void 0,r=void 0;n&&(r=n.streams[t],a=o.a.createElement(Et,{to:"mirror-item",params:{mediaName:n.position},className:"action-button margin-right-10"},"Mirror config"));var i=void 0;return r&&r.dvr_info&&(i=o.a.createElement(Et,{to:"mirrored-item-dvr",params:e,className:"action-button margin-right-10"},"DVR")),o.a.createElement("div",{className:"flex-end row-height margin-left-10 padding-left-10"},o.a.createElement(Et,{to:"mirrored-item-overview",params:e,className:"action-button margin-right-10"},"Overview"),o.a.createElement(Et,{to:"mirrored-item-output",params:e,className:"action-button margin-right-10"},"Output"),o.a.createElement(Et,{to:"mirrored-item-clients",params:e,className:"action-button margin-right-10"},"Clients"),i,a)}}),BC=tn()({displayName:"HeaderFilePage",propTypes:{config:Y.a.object.isRequired},findVod:function(e){for(var t in this.props.config.vods)if(this.props.config.vods[t].files[e])return this.props.config.vods[t]},render:function(){var e=this.findVod(decodeURIComponent(this.props.mediaName)),t=void 0,n={mediaName:this.props.mediaName};return e&&(t=o.a.createElement(Et,{to:"vod-item",params:{mediaName:e.prefix},className:"action-button margin-right-10"},"VOD config")),o.a.createElement("div",{className:"flex-end row-height margin-left-10 padding-left-10"},o.a.createElement(Et,{to:"file-item-overview",params:n,className:"action-button margin-right-10"},"Overview"),o.a.createElement(Et,{to:"file-item-output",params:n,className:"action-button margin-right-10"},"Output"),o.a.createElement(Et,{to:"file-item-clients",params:n,className:"action-button margin-right-10"},"Clients"),t)}}),LC=tn()({displayName:"HeaderLocationPage",propTypes:{config:Y.a.object.isRequired,mediaName:Y.a.string.isRequired},onRemoveClick:function(){var e=this.props.mediaName,t=this.props.config.lives[e],n="Really delete "+t.prefix+" from config?";if(t.dvr&&(n+=" DVR archive would remain."),window.confirm(n)){var a={lives:{}};a.lives[e]=null,ft.save(a).then(function(){St(this,"root")}.bind(this))}},render:function(){var e={mediaName:this.props.mediaName};return o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{className:"flex-end row-height margin-left-10 padding-left-10",style:{flexGrow:1}},o.a.createElement(Et,{to:"location-item-overview",params:e,className:"action-button margin-right-10"},"Overview"),o.a.createElement(Et,{to:"location-item-input",params:e,className:"action-button margin-right-10"},"Input"),o.a.createElement(Et,{to:"location-item-process",params:e,className:"action-button margin-right-10"},"Process"),o.a.createElement(Et,{to:"location-item-dvr",params:e,className:"action-button margin-right-10"},"DVR"),o.a.createElement(Et,{to:"location-item-output",params:e,className:"action-button margin-right-10"},"Output"),o.a.createElement(Et,{to:"location-item-auth",params:e,className:"action-button margin-right-10"},"Auth")),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"delete location",onClick:this.onRemoveClick,className:"danger rect"})))}}),WC=tn()({displayName:"HeaderMirrorPage",propTypes:{config:Y.a.object.isRequired},onRemoveClick:function(){var e=decodeURIComponent(this.props.mediaName),t=this.props.config.sources[e],n="Really delete "+t.urls.join(" ")+" from config?";if(t.dvr&&(n+=" DVR archive would remain."),window.confirm(n)){var a={sources:{}};a.sources[e]=null,ft.save(a).then(function(){St(this,"root",{},{})}.bind(this))}},render:function(){var e={mediaName:this.props.mediaName};return o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{className:"flex-end row-height margin-left-10 padding-left-10",style:{flexGrow:1}},o.a.createElement(Et,{to:"mirror-item-overview",params:e,className:"action-button margin-right-10"},"Overview"),o.a.createElement(Et,{to:"mirror-item-input",params:e,className:"action-button margin-right-10"},"Input"),o.a.createElement(Et,{to:"mirror-item-process",params:e,className:"action-button margin-right-10"},"Process"),o.a.createElement(Et,{to:"mirror-item-dvr",params:e,className:"action-button margin-right-10"},"DVR"),o.a.createElement(Et,{to:"mirror-item-output",params:e,className:"action-button margin-right-10"},"Output"),o.a.createElement(Et,{to:"mirror-item-auth",params:e,className:"action-button margin-right-10"},"Auth")),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"delete mirror",onClick:this.onRemoveClick,className:"danger rect"})))}}),HC=tn()({displayName:"HeaderVodPage",propTypes:{config:Y.a.object.isRequired},onRemoveClick:function(){var e=decodeURIComponent(this.props.mediaName);if(window.confirm("Really delete "+e+" from config?")){var t={vods:{}};t.vods[e]=null,ft.save(t).then(function(){St(this,"root",{},{})}.bind(this))}},render:function(){var e={mediaName:this.props.mediaName};return o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{className:"flex-end row-height margin-left-10 padding-left-10",style:{flexGrow:1}},o.a.createElement(Et,{to:"vod-item-overview",params:e,className:"action-button margin-right-10"},"Overview"),o.a.createElement(Et,{to:"vod-item-input",params:e,className:"action-button margin-right-10"},"Input"),o.a.createElement(Et,{to:"vod-item-output",params:e,className:"action-button margin-right-10"},"Output"),o.a.createElement(Et,{to:"vod-item-auth",params:e,className:"action-button margin-right-10"},"Auth")),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"delete VOD",onClick:this.onRemoveClick,className:"danger rect"})))}});function UC(e){return(UC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zC(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function GC(e){return(GC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KC(e,t){return(KC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function JC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var YC=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=GC(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==UC(r)&&"function"!=typeof r?QC(a):r,JC(QC(n),"toggle",function(e){var t=n.props.filter.slice(),a=t.indexOf(e);-1!==a?t.splice(a,1):t.push(e),n.props.onFilterChange(t)}),JC(QC(n),"toggleExclusive",function(e,t){var a=n.props.filter.slice();if(-1===a.indexOf(e)){for(var r=0;r<t.length;r+=1){var o=a.indexOf(t[r]);-1!==o&&a.splice(o,1)}a.push(e),n.props.onFilterChange(a)}else n.toggle(e)}),JC(QC(n),"renderPageNav",function(){if(!n.props.config)return null;switch(n.props.currentPage){case"stream-item":return o.a.createElement(MC,{config:n.props.config,mediaName:n.props.mediaName});case"published-item":return o.a.createElement(FC,{config:n.props.config,mediaName:n.props.mediaName});case"mirrored-item":return o.a.createElement(VC,{config:n.props.config,mediaName:n.props.mediaName});case"file-item":return o.a.createElement(BC,{config:n.props.config,mediaName:n.props.mediaName});case"location-item":return o.a.createElement(LC,{config:n.props.config,mediaName:n.props.mediaName});case"mirror-item":return o.a.createElement(WC,{config:n.props.config,mediaName:n.props.mediaName});case"vod-item":return o.a.createElement(HC,{config:n.props.config,mediaName:n.props.mediaName});default:return null}}),JC(QC(n),"mediaCount",function(e){return n.props.config?Object.keys(n.props.config.streams).filter(function(t){return Zt.matchFilters(n.props.config.streams[t],[e])}).length:0}),JC(QC(n),"queryMediaCount",function(e){return n.props.config?Object.keys(n.props.config.streams).filter(function(t){return Zt.matchQuery(n.props.config.streams[t],e)}).length:0}),JC(QC(n),"renderBackLink",function(){return n.props.mediaName&&n.props.config&&o.a.createElement(Et,{to:"root",query:{filter:n.props.filter,query:n.props.value},className:"action-button",activeClassName:""},"← back to list")}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KC(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){var e=this,t=function(e){return-1!==this.props.filter.indexOf(e)}.bind(this),n=["error","waiting","online"],a="error (".concat(this.mediaCount("error"),")"),r="waiting (".concat(this.mediaCount("waiting"),")"),i="online (".concat(this.mediaCount("online"),")"),s="with DVR (".concat(this.mediaCount("dvr"),")"),l="transcoded (".concat(this.mediaCount("transcoder"),")"),c="Text filter";this.props.value&&this.props.value.length>0&&(c="".concat(c," (").concat(this.queryMediaCount(this.props.value),")"));var u=o.a.createElement("div",null,o.a.createElement(ua,{label:i,onClick:function(){return e.toggleExclusive("online",n)},checked:t("online"),className:"margin-right-10"}),o.a.createElement(ua,{label:r,onClick:function(){return e.toggleExclusive("waiting",n)},checked:t("waiting"),className:"margin-right-10"}),o.a.createElement(ua,{label:a,onClick:function(){return e.toggleExclusive("error",n)},checked:t("error"),className:"margin-right-10"}),o.a.createElement(ua,{label:s,onClick:function(){return e.toggle("dvr")},checked:t("dvr"),className:"margin-left-10 margin-right-10"}),o.a.createElement(ua,{label:l,onClick:function(){return e.toggle("transcoder")},checked:t("transcoder"),className:"margin-left-10"})),p="base-container row-height",d="base-container",m="center-container";return this.props.isTopLevel?d="":(m+="",p+=" collapsed"),o.a.createElement("div",{className:d},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:m},o.a.createElement("div",{id:"header-additional-nav",className:p},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container",style:{alignItems:"flex-end"}},o.a.createElement("div",{className:"left-list-column"},o.a.createElement(ea,{label:c,className:"auto-height"},o.a.createElement(mn,{value:this.props.value||"",onChange:this.props.onTextFilterChange}))),o.a.createElement("div",{className:"center-right-list-column"},u)),o.a.createElement("div",{className:"right-container"})),o.a.createElement("div",{id:"header-page-nav",className:"page-nav-back-button-wrapper"},o.a.createElement("div",{className:"back-button"},this.renderBackLink()),o.a.createElement("div",{className:"page-nav"},this.renderPageNav()))),o.a.createElement("div",{className:"right-container"}))}}])&&zC(n.prototype,a),r&&zC(n,r),t}();JC(YC,"propTypes",{value:Y.a.string,filter:Y.a.arrayOf(Y.a.string).isRequired,config:Qa,mediaName:Y.a.string,currentPage:Y.a.string,isTopLevel:Y.a.bool,onTextFilterChange:Y.a.func.isRequired,onFilterChange:Y.a.func.isRequired}),JC(YC,"defaultProps",{config:void 0,currentPage:null,isTopLevel:!1,mediaName:void 0,value:void 0});var $C=Dt()(YC);function XC(e){return(XC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZC(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function eO(e){return(eO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nO(e,t){return(nO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rO=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=eO(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==XC(r)&&"function"!=typeof r?tO(a):r,aO(tO(n),"onQuerySelect",function(e,t){t.preventDefault(),n.props.onQuerySelect(e)}),aO(tO(n),"renderQueryLink",function(e){return o.a.createElement("a",{href:"",onClick:n.onQuerySelect.bind(tO(n),e)},e)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nO(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement("div",{id:"pulse-desc"},o.a.createElement("p",{className:"notice-text"},"You can draw graphs of different stats by construction PulseDB queries, for example: ",o.a.createElement("br",null),this.renderQueryLink("sum:1m-tavg8:total_input{from=-10h}")),o.a.createElement("p",{className:"notice-text"},"Syntax is:",o.a.createElement("br",null)," ",o.a.createElement("code",null,"group:period-aggregator:metric{tags}"),o.a.createElement("br",null),o.a.createElement("code",null,"group")," is max, min or sum. It is used across all metrics with same name and different tags.",o.a.createElement("br",null),o.a.createElement("code",null,"period")," is an aggregation period. From 1s to 1h.",o.a.createElement("br",null),o.a.createElement("code",null,"aggregator")," is a function that combines many measurements to one per period. tavg8 for traffic, savg for others",o.a.createElement("br",null),o.a.createElement("code",null,"metric")," list of metrics is below"),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"total_input"),"bit/s of input traffic. Available tags: interface=eth0. Example: ",this.renderQueryLink("sum:1m-tavg8:total_input")),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"total_output"),"bit/s of output traffic. Available tags: interface=eth0"),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"total_clients"),"Amount of online sessions"),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"media_input"),"bit/s of input traffic per stream. Available tags: media=ort, prefix=client_15."),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"media_output"),"bit/s of output traffic per stream or file. Available tags: media=ort, prefix=client_15. Example: ",this.renderQueryLink("sum:1m-tavg8:media_output{media=ort}")),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"media_clients"),"Amount of watchers per stream or file. Available tags: media=ort, prefix=client_15"),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"disk_io_usage"),"% of used disk throughput. Required tags: disk=sda. If you don't specify tag, than use max aggregator, because default sum is useless."),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"cpu_usage"),"% of used CPU time"),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"total_memavail"),"Amount of available RAM (MB)."),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"total_memused"),"Amount of used RAM (MB)"),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"total_memusage"),"% of used memory"),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"thumbnailer_memusage"),"% of used memory by thumbnailer"),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"thumbnailer_in"),"kbit/s of input to thumbnailer"),o.a.createElement("p",{className:"notice-text"},o.a.createElement("code",null,"thumbnailer_out"),"kbit/s of output to thumbnailer"))}}])&&ZC(n.prototype,a),r&&ZC(n,r),t}();aO(rO,"propTypes",{onQuerySelect:Y.a.func.isRequired});var oO=rO,iO=function(e){return/total_input/.test(e)||/total_output/.test(e)||/media_input/.test(e)||/media_output/.test(e)||/thumbnailer_in/.test(e)||/thumbnailer_out/.test(e)?{type:"net",min:0,tickDecimals:0,ratio:/thumbnailer/.test(e)?1e3:1}:/total_clients/.test(e)||/media_clients/.test(e)?{min:0}:/cpu_usage/.test(e)||/disk_io_usage/.test(e)||/total_memusage/.test(e)||/thumbnailer_memusage/.test(e)?{min:0,max:100}:/total_memavail/.test(e)||/total_memused/.test(e)?{min:0,type:"memory",ratio:1048576}:{}},sO=tn()({displayName:"Pulseboard",mixins:[te.a.ListenerMixin],propTypes:{config:Y.a.object},getInitialState:function(){return{customQuery:Ct(this).query||"",focused:!1}},componentWillReceiveProps:function(e){if(this.props.location.search!=e.location.search){var t=Ct({props:e});this.setState({customQuery:t.query})}},changeCustomQuery:function(e){this.setState({customQuery:e.target.value})},customQueryFocus:function(){this.setState({focused:!0})},customQueryBlur:function(){setTimeout(function(){this.setState({focused:!1}),this.state.customQuery||this.backToBoard()}.bind(this),300)},backToBoard:function(){St(this,"pulse",{},{query:void 0})},onBackButtonClick:function(){this.setState({customQuery:""}),this.backToBoard()},isQueryValid:function(){var e=function(e){return/^[^;{}\n\t\r,=:]+$/.test(e)},t=function(t){if(e(t))return!0;if("}"!=t[t.length-1])return!1;var n=t.slice(0,t.length-1).split("{");return 2==n.length&&e(n[0])&&function(t){var n=t.split(",");for(var a in n){var r=n[a].split("=");if(!e(r[0])||!e(r[0]))return!1}return!0}(n[1])},n=this.state.customQuery.split(":");return 1==n.length?t(n[0]):2==n.length?e(n[0])&&t(n[1]):3==n.length&&(e(n[0])&&e(n[1])&&t(n[2]))},applyQuery:function(e){var t=this.state.customQuery;"string"==typeof e&&(t=e),St(this,"pulse",{},{query:t})},onQuerySubmit:function(e){this.state.customQuery&&this.isQueryValid()&&this.applyQuery()},renderBackButton:function(){if(this.state.customQuery||Ct(this).query||this.state.focused)return o.a.createElement(ua,{label:"← back to board",onClick:this.onBackButtonClick})},renderHead:function(e){return o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"head-text"},e))),o.a.createElement("div",{className:"right-container"}))},renderMinuteHourSides:function(e,t,n,a){return o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-column margin-right-10"},o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},t," for last hours")),o.a.createElement("div",{style:{height:n}},o.a.createElement(pd,{topic:e,resolution:"hour",options:a}))),o.a.createElement("div",{className:"right-column margin-left-10"},o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},t," for last minute")),o.a.createElement("div",{style:{height:n}},o.a.createElement(pd,{topic:e,resolution:"minute",options:a})))),o.a.createElement("div",{className:"right-container"}))},renderDefaultBoard:function(){var e=(this.props.config?this.props.config.stats.disks:[]).map(function(e){return o.a.createElement("div",{key:e},this.renderMinuteHourSides("disk_io_usage{disk="+e+"}","I/O usage of "+e,"150px",{yaxis:{min:0,max:100}}),o.a.createElement("div",{className:"row-height"}))}.bind(this)),t=void 0;0!=e.length&&(t=this.renderHead("HDD I/O usage"));var n=(this.props.config?this.props.config.stats.partitions:[]).map(function(e){return o.a.createElement("div",{key:e.path,className:"row-height flex-end"},o.a.createElement(us,{text:e.path,progress:e.usage/100}))}.bind(this)),a=void 0;return 0!=n.length&&(a=this.renderHead("Disk space usage")),o.a.createElement("div",null,o.a.createElement("div",{className:"row-height"}),this.renderHead("Traffic"),this.renderMinuteHourSides("overview","System traffic","250px",{yaxes:[{type:"net",min:0,tickDecimals:0,position:"left"},{min:0,tickDecimals:0,position:"right"}]}),o.a.createElement("div",{className:"row-height"}),this.renderHead("Memory usage"),this.renderMinuteHourSides("total_memusage","","150px",{yaxis:{max:100,min:0}}),o.a.createElement("div",{className:"row-height"}),this.renderHead("CPU usage"),this.renderMinuteHourSides("cpu_usage","CPU usage","150px",{yaxis:{max:100,min:0}}),o.a.createElement("div",{className:"row-height"}),this.renderHead("Scheduler utilization"),this.renderMinuteHourSides("scheduler_loads","Scheduler utilization","150px",{yaxis:{max:100,min:0}}),o.a.createElement("div",{className:"row-height"}),this.renderHead("Erlang active tasks"),this.renderMinuteHourSides("active_tasks","Active tasks","150px",{yaxis:{min:0}}),o.a.createElement("div",{className:"row-height"}),t,e,a,o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-column margin-right-10"},n,o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-column margin-left-10"})),o.a.createElement("div",{className:"right-container"})))},render:function(){var e=void 0,t=void 0,n=void 0,a=Ct(this);this.state.customQuery||this.state.focused?(t=o.a.createElement(oO,{onQuerySelect:this.applyQuery}),a.query&&(n=o.a.createElement("div",{style:{height:"300px"}},o.a.createElement(pd,{topic:"custom/"+a.query,resolution:"custom",options:{yaxes:[{position:"left"},{position:"right"}],yaxis:iO(a.query)}})))):e=this.renderDefaultBoard();var r=void 0;return this.state.customQuery&&!this.isQueryValid()&&(r="invalid format"),o.a.createElement("div",{id:"pulseboard","data-testid":"pulse"},o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left3-column margin-right-10"},o.a.createElement("div",{className:"row-height flex-end"},this.renderBackButton()),o.a.createElement(ea,{label:"Custom pulse query",errorMessage:r,className:"margin-right-10"},o.a.createElement(mn,{value:this.state.customQuery,changed:(this.state.customQuery||"")!=(a.query||""),onChange:this.changeCustomQuery,onFocus:this.customQueryFocus,onBlur:this.customQueryBlur,onSubmit:this.onQuerySubmit}),o.a.createElement("div",{style:{right:0,top:"22px",position:"absolute"}},o.a.createElement(ua,{label:"show",disabled:!this.state.customQuery||!this.isQueryValid(),onClick:this.applyQuery}))),n),o.a.createElement("div",{className:"right-column margin-left-10"},t)),o.a.createElement("div",{className:"right-container"})),e)}}),lO=n(1451);function cO(e){return(cO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){hO(e,t,n[t])})}return e}function pO(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function dO(e){return(dO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fO(e,t){return(fO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gO=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=dO(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==cO(r)&&"function"!=typeof r?mO(a):r,hO(mO(n),"state",{cert:null,files:null,letsencryptRequesting:!1,letsencryptError:""}),hO(mO(n),"onLetsEncryptClick",function(){/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/.test(window.location.href)?alert("Can't issue a certificate for IP address. Switch to domain name and reload page"):n.requestLetsEncrypt()}),hO(mO(n),"onPortChange",function(e){return function(t){var a=t.map(function(e){return parseInt(e,10)}).filter(function(e){return!Number.isNaN(e)});n.props.change(e,"raw")(a)}}),hO(mO(n),"onHttpPortsChange",n.onPortChange("http")),hO(mO(n),"onHttpsPortsChange",n.onPortChange("https")),hO(mO(n),"requestLetsEncrypt",function(){var e=JSON.stringify({domains:[v]});n.setState({letsencryptRequesting:!0,letsencryptError:""}),x("/letsencrypt",{method:"post",body:e}).then(function(e){e.cert&&(n.setState({cert:e.cert,files:e.files}),setTimeout(function(){document.location.href=document.location.href},1500))}).catch(function(e){console.log("Letsencrypt request error: ",e),n.setState({letsencryptError:"Could not obtain certificate"})}).finally(function(){n.setState({letsencryptRequesting:!1})})}),hO(mO(n),"renderFile",function(e,t){return n.state.files[e]?o.a.createElement(ea,{expanded:!0,key:e,label:e,details:"file found"},o.a.createElement("div",{className:"notice-text"},n.state.files[e])):o.a.createElement(ea,{expanded:!0,key:e,label:e},o.a.createElement("div",{className:t},"missing"))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fO(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentWillMount",value:function(){var e=this;x("/letsencrypt",{method:"get"}).then(function(t){return e.setState({cert:t.cert&&uO({},t.cert,{valid_till_date:pr.local_date_at(t.cert.valid_till)}),files:t.files})})}},{key:"render",value:function(){var e,t,n,a,r=this.props.config.rtmps||this.props.config.rtsps||this.props.config.https&&this.props.config.https.length>0;return r&&this.state.files&&((e=[]).push(this.renderFile("flussonic.key","error-text")),e.push(this.renderFile("flussonic.crt","error-text")),e.push(this.renderFile("flussonic-ca.crt","warning-text"))),r&&(n=o.a.createElement("div",null,o.a.createElement(KS.a,{className:"rect",onClick:this.onLetsEncryptClick,size:"sm",color:"primary",outline:!0},this.state.letsencryptRequesting&&o.a.createElement(lO.a,{color:"primary",size:"sm"}),o.a.createElement("span",{style:{marginLeft:4}},"issue by LetsEncrypt")),this.state.letsencryptError&&o.a.createElement("p",{style:{color:"red",fontSize:12}},this.state.letsencryptError)),this.state.cert&&(a=o.a.createElement("div",null,o.a.createElement(ea,{expanded:!0,label:"Domains"},o.a.createElement("div",{className:"notice-text"},this.state.cert.domains.join(", "))),o.a.createElement(ea,{expanded:!0,label:"Issuer"},o.a.createElement("div",{className:"notice-text"},this.state.cert.issuer_name)),o.a.createElement(ea,{expanded:!0,label:"Valid until"},o.a.createElement("div",{className:"notice-text"},this.state.cert.valid_till_date)))),t=o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{className:"margin-right-10",style:{flex:"1 1 240px"}},o.a.createElement("div",{className:"row-height"}),e),o.a.createElement("div",{className:"margin-right-10",style:{flex:"1 1 240px"}},n,a))),o.a.createElement("div",null,o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"head-text"},"Protocols")),o.a.createElement(ea,{label:"HTTP ports",details:"If you remove all ports, you will loose access to web interface.",className:"auto-height"},o.a.createElement(Zn,{value:this.props.config.http,onChange:this.onHttpPortsChange,separators:[","," "]})),o.a.createElement(ea,{label:"RTMP port"},o.a.createElement(mn,{value:this.props.config.rtmp,onChange:this.props.change("rtmp","integer"),changed:this.props.config.rtmp_changed})),o.a.createElement(ea,{label:"RTSP port"},o.a.createElement(mn,{value:this.props.config.rtsp,onChange:this.props.change("rtsp","integer"),changed:this.props.config.rtsp_changed})),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"head-text"},"TLS-tunneled protocols")),o.a.createElement(ea,{label:"HTTPS ports",details:"Require SSL certificate for proper work",className:"auto-height"},o.a.createElement(Zn,{value:this.props.config.https,onChange:this.onHttpsPortsChange,separators:[","," "]})),o.a.createElement(ea,{label:"RTMPS port",details:"Require SSL certificate for proper work"},o.a.createElement(mn,{value:this.props.config.rtmps,onChange:this.props.change("rtmps","integer"),changed:this.props.config.rtmps_changed})),o.a.createElement(ea,{label:"RTSPS port",details:"Require SSL certificate for proper work"},o.a.createElement(mn,{value:this.props.config.rtsps,onChange:this.props.change("rtsps","integer"),changed:this.props.config.rtsps_changed})),t)}}])&&pO(n.prototype,a),r&&pO(n,r),t}();hO(gO,"propTypes",{change:Y.a.func.isRequired,config:Qa.isRequired});var vO=gO;function bO(e){return(bO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yO(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function EO(e){return(EO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SO(e,t){return(SO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function CO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var OO=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=EO(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==bO(r)&&"function"!=typeof r?wO(a):r,CO(wO(n),"getPorts",function(e){return e.map(function(e){return parseInt(e,10)}).filter(function(e){return!Number.isNaN(e)})}),CO(wO(n),"handleAdminHttpPortsChange",function(e){n.props.change("admin_http","raw")(n.getPorts(e))}),CO(wO(n),"handleAdminHttpsPortsChange",function(e){n.props.change("admin_https","raw")(n.getPorts(e))}),CO(wO(n),"handleLogLevelChange",function(e){return function(){return n.props.change("loglevel","raw")(e)}}),CO(wO(n),"handleNvidiaMonitorChange",function(e){return function(){return n.props.change("nvidia_monitor","raw")(e)}}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SO(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"head-text"},"Additional")),o.a.createElement(ea,{expanded:!0,label:"Log level"},o.a.createElement(ua,{checked:!this.props.config.loglevel,onClick:this.handleLogLevelChange(null),label:"default",className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{checked:"debug"===this.props.config.loglevel,onClick:this.handleLogLevelChange("debug"),label:"debug",className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{checked:"notice"===this.props.config.loglevel,onClick:this.handleLogLevelChange("notice"),label:"notice",className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{checked:"error"===this.props.config.loglevel,onClick:this.handleLogLevelChange("error"),label:"error",isRadio:!0})),o.a.createElement(ea,{expanded:!0,label:"Nvidia monitor"},o.a.createElement(ua,{checked:!this.props.config.nvidia_monitor,onClick:this.handleNvidiaMonitorChange(!1),label:"disabled",className:"margin-right-10",isRadio:!0}),o.a.createElement(ua,{checked:this.props.config.nvidia_monitor,onClick:this.handleNvidiaMonitorChange(!0),label:"enabled",isRadio:!0})),o.a.createElement(ea,{label:"PulseDB path",details:"Local DB for metrics"},o.a.createElement(mn,{value:this.props.config.pulsedb,onChange:this.props.change("pulsedb","string"),changed:this.props.config.pulsedb_changed})),o.a.createElement(ea,{label:"Session log path",details:"Where to save sessions on local disk"},o.a.createElement(mn,{value:this.props.config.session_log,onChange:this.props.change("session_log","string"),changed:this.props.config.session_log_changed})),o.a.createElement(ea,{label:"Admin HTTP ports",details:"Restrict API usage through these ports only.",className:"auto-height"},o.a.createElement(Zn,{value:this.props.config.admin_http,onChange:this.handleAdminHttpPortsChange,separators:[","," "]})),o.a.createElement(ea,{label:"Admin HTTPS ports",details:"Restrict API usage trough these ports only.",className:"auto-height"},o.a.createElement(Zn,{value:this.props.config.admin_https,onChange:this.handleAdminHttpsPortsChange,separators:[","," "]})),o.a.createElement(ea,{label:"MySQL API port",details:"Access Flussonic runtime info via MySQL API"},o.a.createElement(mn,{value:this.props.config.mysql,onChange:this.props.change("mysql","string"),changed:this.props.config.mysql_changed})),o.a.createElement(ea,{label:"SNMP port",details:"Access Flussonic statistics via SNMP"},o.a.createElement(mn,{value:this.props.config.snmp,onChange:this.props.change("snmp","string"),changed:this.props.config.snmp_changed})),o.a.createElement(ea,{label:"Total bandwidth",details:"Estimated maximum capacity of Flussonic server bandwidth (100M for example)"},o.a.createElement(qn,{value:this.props.config.total_bandwidth,changed:this.props.config.total_bandwidth_changed,onChange:this.props.change("total_bandwidth","raw"),defaultUnit:"Megabits per second"})),o.a.createElement(ea,{label:"Meta",details:"Arbitrary information related to server"},o.a.createElement(mn,{value:this.props.config.meta,onChange:this.props.change("meta","string"),changed:this.props.config.meta_changed})))}}])&&yO(n.prototype,a),r&&yO(n,r),t}();CO(OO,"propTypes",{change:Y.a.func.isRequired,config:Qa.isRequired});var xO=OO,NO=function(e){var t=e.config,n=e.change,a=t.edit_auth||{};return o.a.createElement("div",null,o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"head-text"},"Access")),o.a.createElement(ea,{label:"Admin UI username"},o.a.createElement(mn,{value:a.login,onChange:n(["edit_auth","login"],"string"),changed:a.login_changed})),o.a.createElement(ea,{label:"Admin UI password"},o.a.createElement(mn,{value:a.password,onChange:n(["edit_auth","password"],"string"),changed:a.password_changed})),o.a.createElement("div",{className:"row-height"}),o.a.createElement(Kl,{media:t,change:n}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(Et,{to:"auth",className:"action-button"},"Auth backends config →"),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"head-text"},"Ad Injector")),o.a.createElement(Et,{to:"ad_injector",className:"action-button"},"Ad Injector config →"))};NO.propTypes={config:Qa.isRequired,change:Y.a.func.isRequired};var kO=NO;function _O(e){return(_O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jO(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function RO(e,t,n){return t&&jO(e.prototype,t),n&&jO(e,n),e}function TO(e,t){return!t||"object"!==_O(t)&&"function"!=typeof t?DO(e):t}function IO(e){return(IO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AO(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qO(e,t)}function qO(e,t){return(qO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function MO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var FO=function(e){function t(){var e,n;PO(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return MO(DO(n=TO(this,(e=IO(t)).call.apply(e,[this].concat(r)))),"handleExtraChange",function(e){n.props.change(["web_scripts",n.props.index,"extra"],"raw")(e)}),MO(DO(n),"handleWebscriptFieldChange",function(e){return function(t){t.preventDefault(),n.props.change(["web_scripts",n.props.index,e],"raw")(t.target.value)}}),MO(DO(n),"handleBlur",function(){n.props.script.prefix||n.props.script.path||n.delete()}),MO(DO(n),"handleWebscriptDelete",function(){n.props.change(["web_scripts",n.props.index],"raw")(null)}),n}return AO(t,o.a.Component),RO(t,[{key:"render",value:function(){var e=this.props.script.prefix||this.props.script.path?o.a.createElement("div",{className:"row-height flex-end more-block margin-left-10"},o.a.createElement(ua,{label:"remove",className:"danger",onClick:this.handleWebscriptDelete})):null,t=this.props.script.is_new_script?"New prefix":"Prefix",n=this.props.script.is_new_script?"New path":"Path";return o.a.createElement("div",{className:"config-server-group"},o.a.createElement("div",{className:"config-server-hostname"},o.a.createElement(ea,{label:t,className:"margin-right-10"},o.a.createElement(mn,{onChange:this.handleWebscriptFieldChange("prefix"),onBlur:this.handleBlur,value:this.props.script.prefix})),o.a.createElement(ea,{label:n,className:"margin-left-10"},o.a.createElement(mn,{onChange:this.handleWebscriptFieldChange("path"),onBlur:this.handleBlur,value:this.props.script.path})),e),!this.props.script.is_new_script&&o.a.createElement("div",{className:"config-server-extra"},o.a.createElement("div",{className:"notice-text"},"Specify extra params to pass"),o.a.createElement(Tl,{extra:this.props.script.extra,onChange:this.handleExtraChange})))}}]),t}();MO(FO,"propTypes",{index:Y.a.string.isRequired,script:Y.a.shape({prefix:Y.a.string,path:Y.a.string,is_new_script:Y.a.bool,extra:Y.a.object}).isRequired,change:Y.a.func.isRequired});var VO=function(e){function t(){return PO(this,t),TO(this,IO(t).apply(this,arguments))}return AO(t,o.a.Component),RO(t,[{key:"render",value:function(){var e=this.props.config.web_scripts,t=[];for(var n in e)n.indexOf("_changed")>=0||t.push(o.a.createElement(FO,{key:n,index:n,script:e[n],change:this.props.change}));(!this.new_key||e&&e[this.new_key])&&(this.new_key="zzzz$zzz"+(new Date).getTime());var a={prefix:"",path:"",extra:{},is_new_script:!0,position:Object.keys(e).length+5};return t.push(o.a.createElement(FO,{key:this.new_key,index:this.new_key,script:a,change:this.props.change})),o.a.createElement("div",null,o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"head-text"},"Web scripts")),t)}}]),t}(),BO="SETTINGS",LO="EDITOR",WO=[{id:BO,item:"Settings",to:"global-config",path:vt["global-config"]},{id:LO,item:"Config editor",to:"config-editor",path:vt["config-editor"]}],HO=function(e){var t=e.children,n=e.activeItemId,a=e.menuButtons;return o.a.createElement("div",null,o.a.createElement("div",{className:"base-container global-config-tabs"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement(bC,{activeItemId:n,items:WO},a)),o.a.createElement("div",{className:"right-container"})),o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},t),o.a.createElement("div",{className:"right-container"})))};HO.propTypes={children:Y.a.node,activeItemId:Aa.isRequired,menuButtons:Y.a.node},HO.defaultProps={children:null,menuButtons:null};var UO=HO;n(1375);function zO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var GO=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(Hs.a,{variant:"outlined",onClick:N.exportConfig},"Download config"),o.a.createElement("input",{accept:"application/json",style:{display:"none"},id:"outlined-button-file",multiple:!0,type:"file",onChange:N.importConfig}),o.a.createElement("label",{htmlFor:"outlined-button-file"},o.a.createElement(Hs.a,{variant:"outlined",component:"span"},"Upload config")))},QO=function(e){var t=e.config,n=e.onConfigChange,a=e.isConfigSaving,r=e.onConfigSave;return t?o.a.createElement(UO,{activeItemId:BO},o.a.createElement("div",{id:"global-config","data-testid":"config"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-column margin-right-10"},o.a.createElement(vO,{config:t,change:n()}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(xO,{config:t,change:n()}),o.a.createElement("div",{className:"row-height"})),o.a.createElement("div",{className:"right-column margin-left-10"},o.a.createElement(kO,{config:t,change:n()}),o.a.createElement("div",{className:"row-height"}),o.a.createElement(VO,{config:t,change:n()}),o.a.createElement("div",{className:"row-height"}))),o.a.createElement("div",{className:"GlobalConfigActionsContainer"},o.a.createElement(Hs.a,{variant:"outlined",onClick:r,disabled:a||t.runningRequest||!t.changed},a?o.a.createElement(o.a.Fragment,null,"Saving ",o.a.createElement(Am.a,{size:16})):"Save"),o.a.createElement(GO,null)))):o.a.createElement("div",null,"Loading...")};QO.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){zO(e,t,n[t])})}return e}({},Yi);var KO=es()(QO);function JO(e){return(JO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YO(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function $O(e){return($O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZO(e,t){return(ZO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ex(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tx=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=$O(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==JO(r)&&"function"!=typeof r?XO(a):r,ex(XO(n),"state",{textConfig:n.props.textConfig,isTextConfigChanged:!1}),ex(XO(n),"onTextConfigChange",function(e){n.setState({textConfig:e.target.value,isTextConfigChanged:!0})}),ex(XO(n),"onSave",function(){var e=n.state.textConfig;ar.dispatch({type:"configWrite",textConfig:e}),n.setState({isTextConfigChanged:!1})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZO(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){ar.dispatch({type:"configRead"})}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.textConfig;e.textConfig!==n&&t.textConfig!==n&&this.setState({textConfig:this.props.textConfig})}},{key:"render",value:function(){var e=this.props,t=e.isTextConfigError,n=e.isConfigSaving,a=this.state,r=a.textConfig,i=a.isTextConfigChanged;return o.a.createElement(UO,{activeItemId:LO,menuButtons:o.a.createElement("div",{className:"global-config-editor-save"},o.a.createElement(Hs.a,{variant:"outlined",onClick:this.onSave,disabled:n||!i},n?o.a.createElement(o.a.Fragment,null,"Saving ",o.a.createElement(Am.a,{size:16})):"Save"))},o.a.createElement("div",{style:{width:"100%"}},o.a.createElement("div",{className:"row-height"}),o.a.createElement(Dm.a,{fullWidth:!0},o.a.createElement(ks.a,{label:"Config text",multiline:!0,rows:"30",margin:"normal",value:r,onChange:this.onTextConfigChange,error:t,helperText:t?"Config is wrong":"",variant:"outlined"})),o.a.createElement("div",{className:"row-height"})))}}])&&YO(n.prototype,a),r&&YO(n,r),t}();tx.propTypes={textConfig:Y.a.string.isRequired,isTextConfigError:Y.a.bool.isRequired,isConfigSaving:Y.a.bool.isRequired};var nx=Object($.connect)(function(e){return{textConfig:e.get("textConfig"),isTextConfigError:e.get("isTextConfigError"),isConfigSaving:e.get("isTextConfigSaving")}},function(){return{}})(tx),ax=tn()({displayName:"Watcher",mixins:[te.a.ListenerMixin],propTypes:{config:Y.a.object},componentWillMount:function(){this.listenTo(ft,this.onConfigChange),this.conf=new ie.Instance},componentDidMount:function(){this.changeDb=this.validatedChange(["plugins","vsaas","database"],"string")},onConfigChange:function(e){this.conf.setServerConfig(e),this.setState({config:this.conf.localConfig()})},onSaveClick:function(){this.setState({runningRequest:!0});var e=this.conf.delta;if(e.plugins&&e.plugins.vsaas){var t=e.plugins.vsaas;this.state.config.plugins&&this.state.config.plugins.vsaas&&this.state.config.plugins.database||(t.database&&(t.endpoint="enabled"),this.state.config.plugins&&this.state.config.plugins.rproxy||(e.plugins.rproxy={endpoint_auth:"vsaas",streampoint_key:Math.random().toString(36).replace(/[^a-z0-9]+/g,"").substr(0,14)})),null===t.database&&(e.plugins.vsaas=null)}ft.save(this.conf.delta).then(function(){this.conf.resetDelta(),this.setState({runningRequest:!1,config:this.conf.localConfig()})}.bind(this))},getInitialState:function(){return{config:void 0,runningRequest:!1}},validatedChange:function(e,t){return function(n){var a="raw"==t?n:n.target.value;"string"==t&&0==a.length&&(a=null),this.conf.changeDelta(e,a,t),this.setState({config:this.conf.localConfig()})}.bind(this)},renderConfiguration:function(){var e=this.state.config.plugins.vsaas||{};return o.a.createElement("div",{className:"left-column margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("h1",{className:"head-text"},e.database?o.a.createElement("a",{target:"_blank",href:"/vsaas"},"Flussonic Watcher configuration"):"Flussonic Watcher is not configured"),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",null,o.a.createElement(ea,{label:"Database path",details:"specify where Flussonic Watcher should store data",errorMessage:""},o.a.createElement(mn,{value:e.database,onChange:this.changeDb})),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"for example: postgresql://vsaas:vsaas@localhost/vsaas_production")),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:!e.changed,className:"rect filled",onClick:this.onSaveClick}))))},renderWatcherDisabled:function(){return o.a.createElement("div",{className:"left-column margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("h1",{className:"head-text"},"Flussonic Watcher is disabled on this license"),o.a.createElement("p",null,"Contact ",o.a.createElement("a",{href:"mailto:info@erlyvideo.org"},"info@erlyvideo.org")," to enable it."))},render:function(){return this.state.config?o.a.createElement("div",{id:"iptv"},o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},this.state.config.stats.vsaas?this.renderConfiguration():this.renderWatcherDisabled(),o.a.createElement("div",{className:"right-column margin-left-10"})),o.a.createElement("div",{className:"right-container"}))):o.a.createElement("div",null)}}),rx=n(1453),ox=n(1452);function ix(e){return(ix="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sx(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function lx(e){return(lx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ux(e,t){return(ux=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function px(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dx=3e4,mx={LOADING:"LOADING",ENABLED:"ENABLED",DISABLED:"DISABLED"},fx=function(e){return e?mx.ENABLED:mx.DISABLED},hx=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=lx(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==ix(r)&&"function"!=typeof r?cx(a):r,px(cx(n),"state",{comment:"",sshAgentStatus:mx.LOADING,progress:0,warningText:"",successText:"",logId:null,isSshModalVisible:!1,isCommentFieldTouched:!1,isSubmitButtonPressed:!1}),px(cx(n),"setSshModal",function(e){return function(){n.setState({isSshModalVisible:e})}}),px(cx(n),"setSubmitButtonPressed",function(e){return function(){n.setState({isSubmitButtonPressed:e})}}),px(cx(n),"uploadLogsWithComment",function(e){n.setState({logId:null,successText:"",warningText:"",progress:0}),n.startRequestProgress(dx),x("/flussonic/api/sendlogs",{method:"post",body:JSON.stringify({comment:e})}).then(function(e){n.finishRequestProgress(e.ticket)}).catch(function(){n.finishRequestProgress(!1)})}),px(cx(n),"uploadLogs",function(){n.uploadLogsWithComment(n.state.comment)}),px(cx(n),"changeComment",function(e){n.setState({comment:e.target.value,isCommentFieldTouched:!0})}),px(cx(n),"startRequestProgressCallback",function(e){var t=e-1e3;if(t>0){var a=1-t/dx;n.timeout=setTimeout(function(){n.startRequestProgressCallback(t)},1e3),n.setState({progress:a})}else n.setState({warningText:"Server not responding..."})}),px(cx(n),"startRequestProgress",function(e){n.timeout=setTimeout(function(){n.startRequestProgressCallback(e)},0)}),px(cx(n),"finishRequestProgress",function(e){n.timeout&&(clearTimeout(n.timeout),n.timeout=null),n.setState(e?{logId:e,successText:"Submited",progress:1}:{warningText:"Server error"})}),px(cx(n),"handleToggleSshAccess",function(){var e=n.state.sshAgentStatus===mx.ENABLED;n.setState({isSshModalVisible:!1,sshAgentStatus:mx.LOADING}),e?x("/flussonic/api/disable_ssh_agent",{method:"post"}).then(function(e){n.setState({sshAgentStatus:fx(!e)})}):x("/flussonic/api/enable_ssh_agent",{method:"post"}).then(function(e){e&&n.uploadLogsWithComment("The debug data was automatically uploaded"),n.setState({sshAgentStatus:fx(e)})})}),px(cx(n),"renderSshButtonWithLabel",function(){var e=(n.state.sshAgentStatus===mx.ENABLED?"Disable SSH access":n.state.sshAgentStatus===mx.DISABLED&&"Enable SSH access")||"Status updating",t=(n.state.sshAgentStatus===mx.ENABLED?"SSH Access Enabled":n.state.sshAgentStatus===mx.DISABLED&&"SSH Access Disabled")||"Updating SSH Access status",a=n.state.sshAgentStatus===mx.LOADING,r=n.state.sshAgentStatus===mx.ENABLED;return o.a.createElement(Ps.a,{container:!0,alignItems:"center",justify:"flex-start",spacing:1},o.a.createElement(Ps.a,{item:!0,xs:12,md:5,lg:4},o.a.createElement(Hs.a,{variant:"contained",disabled:a,onClick:r?n.handleToggleSshAccess:n.setSshModal(!0),className:n.state.sshAgentStatus===mx.ENABLED?n.props.classes.sshButtonEnabled:n.props.classes.sshButtonDisabled},a&&o.a.createElement(Am.a,{size:20}),e)),o.a.createElement(Ps.a,{item:!0,xs:12,md:!0},o.a.createElement(Td.a,{p:2},t)))}),px(cx(n),"renderSshModal",function(){return o.a.createElement(vv.a,{open:n.state.isSshModalVisible,onClose:n.setSshModal(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},o.a.createElement(yv.a,{id:"alert-dialog-title"},"Attention!!!"),o.a.createElement(bv.a,null,o.a.createElement(ox.a,{id:"alert-dialog-description",variant:"body2"},"By enabling SSH access, you are allowing Flussonic technical support team members to connect to your Flussonic server over SSH protocol with superuser privileges. Please note that Flussonic SSH can traverse NAT firewalls and proxies, and you aren’t required to have public IP address or port forwarding enabled to allow Flussonic technical support team to connect to your system."),o.a.createElement(ox.a,{id:"alert-dialog-description",variant:"body2"},"Consequently, this may entail identifying some of your information stored on your server and on your network resources to Flussonic technical support team. Therefore the Flussonic developers require your express consent for your Flussonic Media Server instance to access the Flussonic technical support servers on the Internet."),o.a.createElement(ox.a,{id:"alert-dialog-description",variant:"body2"},"Please acknowledge that you understand all consequences of enabling SSH access by pressing ‘OK’ button below."),o.a.createElement(ox.a,{id:"alert-dialog-description",variant:"body2"},"NOTICE that after pressing ‘OK’ button the debug data will be automatically uploaded.")),o.a.createElement(rx.a,null,o.a.createElement(Hs.a,{onClick:n.setSshModal(!1),color:"primary"},"Cancel"),o.a.createElement(Hs.a,{onClick:n.handleToggleSshAccess,color:"primary",autoFocus:!0},"OK")))}),px(cx(n),"renderForm",function(){var e=n.state,t=e.isCommentFieldTouched,a=e.isSubmitButtonPressed,r=n.state.comment&&n.state.comment.length>3,i=!r;return n.state.progress||n.state.logId?o.a.createElement("div",null,o.a.createElement(us,{progress:n.state.progress,text:"Submitting data, please wait...",warningText:n.state.warningText,successText:n.state.successText}),o.a.createElement("div",{className:"row-height"}),n.state.logId&&o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"Your data has been submitted, please provide this id to our support agents while referring to your problem:")),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"head-text"},n.state.logId))):o.a.createElement("div",null,o.a.createElement(ks.a,{variant:"outlined",value:n.state.comment,onChange:n.changeComment,error:!r&&(t||a),helperText:r?"":"Description required (more than 3 characters)",rowsMax:7,rows:3,fullWidth:!0,multiline:!0,required:!0}),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height"},o.a.createElement(Hs.a,{variant:"contained",color:"primary",disabled:i,onClick:r?n.uploadLogs:n.setSubmitButtonPressed(!0)},"Submit")))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ux(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;x("/flussonic/api/ssh_agent_enabled",{method:"get"}).then(function(t){e.setState({sshAgentStatus:fx(t)})})}},{key:"componentWillUnmount",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}},{key:"render",value:function(){return o.a.createElement("div",{id:"log-uploader","data-testid":"logupload"},o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-column margin-right-10"},this.renderSshButtonWithLabel(),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"head-text"},"Send server state to Flussonic support team")),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"Please describe your problem. If you already created ticket in our support system, please specify number of the ticket.")),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"Your config, logs and system stats will be uploaded.")),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"This is not a support request. You will have to open a support request after this upload.")),o.a.createElement("div",{className:"row-height"}),this.renderForm()),o.a.createElement("div",{className:"right-column margin-left-10"})),o.a.createElement("div",{className:"right-container"})),this.renderSshModal())}}])&&sx(n.prototype,a),r&&sx(n,r),t}();px(hx,"propTypes",{classes:Y.a.shape({sshButtonDisabled:Y.a.string,sshButtonEnabled:Y.a.string})}),px(hx,"defaultProps",{classes:{}});var gx=Ss()(function(e){return{sshButtonDisabled:{backgroundColor:e.palette.red.main,color:"white"},sshButtonEnabled:{backgroundColor:e.palette.primary.main,color:"white"}}})(hx),vx=function(e){var t=e.peers;return o.a.createElement("table",{className:"table",style:{minWidth:800}},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{style:{textAlign:"left"}},"Host"),o.a.createElement("th",{style:{textAlign:"left"}},"CPU"),o.a.createElement("th",{style:{textAlign:"left"}},"Mem"),o.a.createElement("th",{style:{textAlign:"left"}},"Clients"),o.a.createElement("th",{style:{textAlign:"left"}},"Streams"),o.a.createElement("th",{style:{textAlign:"left"}},"Input bitrate"),o.a.createElement("th",{style:{textAlign:"left"}},"Output bitrate"),o.a.createElement("th",{style:{textAlign:"left"}},"Load"),o.a.createElement("th",{style:{textAlign:"left"}},"Version"),o.a.createElement("th",{style:{textAlign:"left"}},"Uptime"),o.a.createElement("th",{style:{textAlign:"left"}},"Last update"))),o.a.createElement("tbody",null,t.map(function(e){return o.a.createElement("tr",{key:e.name},o.a.createElement("td",null,e.persistent?"* ":"- ",e.name,":",e.ports.http||e.ports.https||"",function(e){var t=[e.is_peer&&"peer",e.is_source&&"peer"].filter(Boolean).join(", ");return t?"(".concat(t,")"):""}(e)),o.a.createElement("td",null,e.cpu_usage),o.a.createElement("td",null,e.memory_usage),o.a.createElement("td",null,e.client_count),o.a.createElement("td",null,e.stream_count),o.a.createElement("td",null,e.input_bitrate),o.a.createElement("td",null,e.output_bitrate),o.a.createElement("td",null,e.bandwidth_usage?"".concat(e.bandwidth_usage,"%"):"-"),o.a.createElement("td",null,e.version),o.a.createElement("td",null,e.uptime&&pr.seconds(e.uptime)),o.a.createElement("td",null,"-"))})))};vx.propTypes={peers:Y.a.arrayOf(Y.a.shape({cpu_usage:Y.a.number,memory_usage:Y.a.number,is_peer:Y.a.bool,is_source:Y.a.bool,persistent:Y.a.bool,uptime:Y.a.number,version:Y.a.string,fetch_delay:Y.a.number,client_count:Y.a.number,stream_count:Y.a.number,input_bitrate:Y.a.number,output_bitrate:Y.a.number,bandwidth_usage:Y.a.number,ports:Y.a.shape({http:Y.a.number,https:Y.a.number,rtmp:Y.a.number})})).isRequired};var bx=vx,yx=(n(1376),"OVERVIEW"),Ex="SETTINGS",wx="INGEST",Sx="SOURCES",Cx=[{id:yx,item:"Overview",to:"cluster",path:vt.cluster},{id:Ex,item:"Settings",to:"cluster-settings",path:vt["cluster-settings"]},{id:wx,item:"Ingest",to:"cluster-ingest",path:vt["cluster-ingest"]},{id:Sx,item:"Sources",to:"cluster-sources",path:vt["cluster-sources"]}],Ox=function(e){var t=e.children,n=e.activeItemId,a=e.menuButtons;return o.a.createElement(Jl.a,{id:"cluster"},o.a.createElement(Yl.a,{className:"ClusterPageContainerMenuRow"},o.a.createElement(bC,{activeItemId:n,items:Cx},o.a.createElement("div",{className:"ClusterPageContainerMenuButtons"},a))),o.a.createElement(Yl.a,null,t))};Ox.propTypes={children:Y.a.node,menuButtons:Y.a.node,activeItemId:Aa.isRequired},Ox.defaultProps={children:null,menuButtons:null};var xx=Ox;function Nx(e){return(Nx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kx(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _x(e){return(_x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Px(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jx(e,t){return(jx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Tx(e,t,n[t])})}return e}function Tx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ix(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Dx=function(e){return Object.keys(e).reduce(function(t,n){return[].concat(Ix(t),[Rx({},e[n],{name:n})])},[])},Ax=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=_x(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Nx(r)&&"function"!=typeof r?Px(a):r,Tx(Px(n),"state",{peers:[]}),Tx(Px(n),"setPeersFromReply",function(e){n.setState({peers:Dx(e)})}),Tx(Px(n),"renderOldMenu",function(){return o.a.createElement("div",{className:"left-column"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"col-sm-1"},o.a.createElement("button",{type:"button",onClick:n.fetchAndSetPeers},"Reload")),o.a.createElement("div",{className:"col-sm-2"},o.a.createElement(Et,{to:"cluster-ingest"},"cluster ingest")),o.a.createElement("div",{className:"col-sm-2"},o.a.createElement(Et,{to:"cluster-sources"},"cluster sources")),o.a.createElement("div",{className:"col-sm-6"},o.a.createElement("h1",null,"Flussonic servers")))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jx(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.fetchAndSetPeers()}},{key:"fetchAndSetPeers",value:function(){x("/flussonic/api/cluster_servers",{method:"get"}).then(this.setPeersFromReply)}},{key:"render",value:function(){return o.a.createElement(xx,{activeItemId:yx},this.state.peers&&o.a.createElement(bx,{peers:this.state.peers}))}}])&&kx(n.prototype,a),r&&kx(n,r),t}(),qx=n(368),Mx=n(257),Fx=n(1454);n(1377);function Vx(e){return(Vx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bx(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Lx(e){return(Lx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hx(e,t){return(Hx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ux(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zx=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Lx(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Vx(r)&&"function"!=typeof r?Wx(a):r,Ux(Wx(n),"state",{streams:null,servers:null}),Ux(Wx(n),"fetchClusterIngest",function(){n.fetchTimer&&clearTimeout(n.fetchTimer),x("/flussonic/api/cluster_servers?ingest=true",{method:"get"}).then(function(e){var t=e.streams;n.setState({streams:t,servers:Q.a(Ne.a(qx.a("name")),Mx.a,Ne.a(Ee.a("running_at")))(t)}),n.isDeleting||(n.fetchTimer=setTimeout(n.fetchClusterIngest,3e3))})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hx(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.fetchTimer=setTimeout(this.fetchClusterIngest,1)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.fetchTimer),this.isDeleting=!0}},{key:"render",value:function(){var e=this.state,t=e.servers,n=e.streams;return o.a.createElement(xx,{activeItemId:wx,menuButtons:o.a.createElement("div",{className:"ClusterIngestMenuButtons"},o.a.createElement(KS.a,{outline:!0,size:"sm",onClick:this.fetchClusterIngest},"reload"))},o.a.createElement(Jl.a,null,o.a.createElement(Yl.a,null,t&&n&&o.a.createElement(Fx.a,null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Stream"),t.map(function(e){return o.a.createElement("th",{key:e.name},e.name)}))),o.a.createElement("tbody",null,n.map(function(e){return o.a.createElement("tr",{key:e.name},o.a.createElement("td",null,e.name),t.map(function(t){return o.a.createElement("td",{key:t.name},e.running_at.includes(t.name)?t.name:"-")}))}))))))}}])&&Bx(n.prototype,a),r&&Bx(n,r),t}();function Gx(e){return(Gx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qx(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Kx(e){return(Kx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yx(e,t){return(Yx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xx=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Kx(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==Gx(r)&&"function"!=typeof r?Jx(a):r,$x(Jx(n),"state",{streams:{},fetched:!1}),$x(Jx(n),"setServerLoaded",function(e){n.setState(e),n.setState({fetched:!0})}),$x(Jx(n),"renderServerInfo",function(){var e=n.state.streams;return o.a.createElement(o.a.Fragment,null,o.a.createElement("h5",null,"Streams:"),o.a.createElement(Fx.a,null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{style:{textAlign:"left"}},"name"),o.a.createElement("th",{style:{textAlign:"left"}},"lifetime"),o.a.createElement("th",{style:{textAlign:"left"}},"bitrate"),o.a.createElement("th",{style:{textAlign:"left"}},"clients"))),o.a.createElement("tbody",null,Object.keys(e).map(function(t){var n=(new Date).getTime(),a=e[t];return o.a.createElement("tr",{key:t},o.a.createElement("td",null,t),o.a.createElement("td",null,pr.seconds(a.stats.start_running_at>0?(n-a.stats.start_running_at)/1e3:void 0)),o.a.createElement("td",null,a.stats.bitrate),o.a.createElement("td",null,a.stats.client_count))}))))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yx(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.fetchPeerInfo()}},{key:"fetchPeerInfo",value:function(){var e=this;return x("/flussonic/api/cluster_servers?server=".concat(this.props.name),{method:"get"}).then(function(t){return e.setServerLoaded(t),t})}},{key:"render",value:function(){return o.a.createElement(xx,{activeItemId:yx},o.a.createElement(Jl.a,null,o.a.createElement(Yl.a,null,o.a.createElement(KS.a,{outline:!0,onClick:this.fetchPeerInfo},"reload")),o.a.createElement(Yl.a,null,o.a.createElement("h2",null,this.props.name)),o.a.createElement(Yl.a,null,this.state.fetched&&this.renderServerInfo())))}}])&&Qx(n.prototype,a),r&&Qx(n,r),t}();$x(Xx,"propTypes",{name:Y.a.string.isRequired});var Zx=Xx;n(1378);function eN(e){return(eN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tN(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function nN(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function aN(e){return(aN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oN(e,t){return(oN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sN=function(e){return e.isNewPeer?"":"".concat(e.name).concat(e.port?":".concat(e.port):"")},lN=function(e){return e.isNewPeer?"New peer hostname":"Peer hostname"},cN=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=aN(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==eN(r)&&"function"!=typeof r?rN(a):r,iN(rN(n),"state",{peer:n.props.peer,label:lN(n.props.peer),peerString:sN(n.props.peer),shouldUpdatePeer:!1}),iN(rN(n),"isMounted",!0),iN(rN(n),"changePeer",Vm(n.props.updatePeerDebounce,function(e){var t=n.props.peerName;n.props.changePeer(t,e,function(){setTimeout(function(){n.setStateSafe({shouldUpdatePeer:!0,peer:e})})})})),iN(rN(n),"setStateSafe",function(){var e;return n.isMounted&&(e=n).setState.apply(e,arguments)}),iN(rN(n),"deletePeer",function(){n.props.deletePeer(n.props.peerName)}),iN(rN(n),"handleChange",function(e){var t=tN(e.target.value.split(":"),2),a=t[0],r=t[1],o=parseInt(r,10)||void 0,i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){iN(e,t,n[t])})}return e}({},n.state.peer,{name:a,port:o});n.setState({peerString:e.target.value},function(){n.changePeer(i)})}),iN(rN(n),"handleBlur",function(){n.state.peer.name||n.deletePeer()}),iN(rN(n),"handleDelete",function(){n.deletePeer()}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oN(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentWillUnmount",value:function(){this.isMounted=!1}},{key:"render",value:function(){return o.a.createElement("div",{className:"ClusterPeerNameContainer"},o.a.createElement(ks.a,{fullWidth:!0,className:"ClusterPeerNameInput",type:"text",margin:"normal",value:this.state.peerString,label:this.state.label,onChange:this.handleChange,onBlur:this.handleBlur}),this.props.peer.name&&o.a.createElement(Hs.a,{className:"ClusterPeerNameButtonsRemove",onClick:this.handleDelete},"remove"))}}])&&nN(n.prototype,a),r&&nN(n,r),t}();function uN(e){return(uN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pN(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function dN(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function mN(e){return(mN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hN(e,t){return(hN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){vN(e,t,n[t])})}return e}function vN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}iN(cN,"propTypes",{peerName:Aa.isRequired,peer:Ma.isRequired,changePeer:Y.a.func.isRequired,deletePeer:Y.a.func.isRequired,updatePeerDebounce:Y.a.number}),iN(cN,"defaultProps",{updatePeerDebounce:1e3}),iN(cN,"getDerivedStateFromProps",function(e,t){var n=e.peer;return t.shouldUpdatePeer&&{shouldUpdatePeer:!1,peerString:sN(n),label:lN(n),peer:n}});var bN=Q.a(Ce.a,Ai.a("_changed"),Im.a("","key")),yN=Es.a({},["config","peers"]),EN=Q.a(Kf.a,pe.a(function(e,t){return gN({},e,{key:t})}),yN),wN=Q.a(Im.a(0,"length"),EN),SN=Q.a(be.a(bN),EN),CN=Q.a(ve.a(Qf.a,0),Ne.a(Im.a(0,"position")),EN),ON=function(){return(new Date).getTime()},xN={isNewPeer:!0},NN=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=mN(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==uN(r)&&"function"!=typeof r?fN(a):r,vN(fN(n),"state",{newKey:ON()}),vN(fN(n),"setNewKey",function(e){var t=SN(n.props);n.setState(function(a){return(!a.newKey||t&&t[n.newKey])&&{newKey:e}})}),vN(fN(n),"changePeer",function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:K.a(),r=ke.a(["config","peers",e],n.props),o=he.a(we.a)(t.name)||he.a(we.a)(r);t.name!==r&&o&&(e===n.state.newKey&&t.name?n.props.onConfigChange()(["peers",t.name],"raw",a)({position:CN(n.props)+1,name:t.name,port:t.port}):n.props.onConfigChange()(["peers",e],"raw",a)(t))}),vN(fN(n),"deletePeer",function(e){n.props.onConfigChange()(["peers",e],"raw")(null)}),vN(fN(n),"renderClusterPeersSettings",function(){return[].concat(pN(SN(n.props).map(function(e){return o.a.createElement(cN,{key:e.key,peerName:e.key,peer:e,changePeer:n.changePeer,deletePeer:n.deletePeer})})),[o.a.createElement(cN,{key:n.state.newKey,peerName:n.state.newKey,peer:xN,changePeer:n.changePeer,deletePeer:n.deletePeer})])}),vN(fN(n),"renderClusterMainSettings",function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(ks.a,{fullWidth:!0,label:"This peer hostname",helperText:"How this peer should be referred from other flussonic peers",margin:"normal",value:n.props.config.stats.hostname,onChange:K.a()}),o.a.createElement(ks.a,{fullWidth:!0,label:"Cluster key",helperText:"Must be same on all clustered peers",margin:"normal",value:n.props.config.cluster_key,onChange:n.props.onConfigChange()("cluster_key","string")}))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hN(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidUpdate",value:function(e){wN(this.props)!==wN(e)&&this.setNewKey(ON())}},{key:"render",value:function(){return o.a.createElement(xx,{activeItemId:Ex},this.props.config?o.a.createElement(Ps.a,{container:!0,spacing:32,wrap:"wrap"},o.a.createElement(Ps.a,{container:!0,item:!0,xs:8,direction:"column"},this.renderClusterMainSettings()),o.a.createElement(Ps.a,{container:!0,item:!0,xs:8,direction:"column"},this.renderClusterPeersSettings())):null,o.a.createElement(Hs.a,{size:"small",variant:"outlined",color:"primary",onClick:this.props.onConfigSave,disabled:this.props.isConfigSaving},this.props.isConfigSaving?o.a.createElement(Am.a,{size:20}):"save"))}}])&&dN(n.prototype,a),r&&dN(n,r),t}();vN(NN,"propTypes",gN({},Yi)),vN(NN,"defaultProps",{config:null});var kN=es()(NN);function _N(e){return(_N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PN(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jN(e){return(jN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TN(e,t){return(TN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var DN=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=jN(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==_N(r)&&"function"!=typeof r?RN(a):r,IN(RN(n),"state",{sources:[]}),IN(RN(n),"fetchClusterSources",function(){var e=RN(n);return x("/flussonic/api/cluster_servers?sources=true",{method:"get"}).then(function(t){return e.setSourcesLoaded(t.sources),t})}),IN(RN(n),"setSourcesLoaded",function(e){n.setState({sources:e})}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TN(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.fetchClusterSources()}},{key:"render",value:function(){return o.a.createElement(xx,{activeItemId:Sx,menuButtons:o.a.createElement(KS.a,{outline:!0,size:"sm",onClick:this.fetchClusterSources},"reload")},o.a.createElement(Jl.a,null,o.a.createElement(Yl.a,null,this.state.sources.map(function(e){return o.a.createElement("div",{key:e.name},o.a.createElement("div",null,"".concat(e.proto,"://"),e.name,e.port?":".concat(e.port):"",e.prefix?"/".concat(e.prefix):""),o.a.createElement("div",null,e.stream_count," streams",we.a(e.only)?"":0===e.only.length?", all ondemand":", take only: (".concat(e.only.join(","),") "),we.a(e.except)?"":", except: (".concat(e.except.join(","),") ")))}))))}}])&&PN(n.prototype,a),r&&PN(n,r),t}(),AN=tn()({displayName:"AttachableScrollbox",mixins:[te.a.ListenerMixin],propTypes:{attachedWidth:Y.a.number},componentDidMount:function(){this.listenTo(ne.pageScroll,this.onPageScroll),this.refreshHeight(),window.addEventListener("resize",this.refreshHeight)},onPageScroll:function(){var e=this.refs.outer;if(e){var t=e.parentNode.getBoundingClientRect();!this.state.attached&&t.top<0?this.setState({attached:!0,height:window.innerHeight}):this.state.attached&&t.top>=0?this.setState({attached:!1,height:this.calculateHeight()}):this.state.attached||this.setState({height:this.calculateHeight()})}},refreshHeight:function(){this.setState({height:this.calculateHeight()})},calculateHeight:function(){var e=this.refs.outer.parentNode.getBoundingClientRect();return window.innerHeight-e.top},getInitialState:function(){return{attached:!1,height:0}},render:function(){var e={height:this.state.height+"px",overflow:"hidden"};this.state.attached&&this.props.attachedWidth&&(e.width=this.props.attachedWidth+"px");var t={height:this.state.height+"px",overflowY:"scroll",overflowX:"hidden"};this.state.attached&&(e.position="fixed",e.top=0);var n=this.refs.scroller&&this.refs.scroller.scrollTop,a=this.props.children;return this.state.height&&this.props.children&&(a=o.a.Children.map(this.props.children,function(e){return e&&o.a.cloneElement(e,{scrollTop:n,scrollHeight:this.state.height})}.bind(this))),o.a.createElement("div",null,o.a.createElement("div",{ref:"outer",style:e},o.a.createElement("div",{ref:"scroller",style:t,className:"scrollbox-margin-autohide"},a)))}});function qN(e){return(qN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FN(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function VN(e,t,n){return t&&FN(e.prototype,t),n&&FN(e,n),e}function BN(e,t){return!t||"object"!==qN(t)&&"function"!=typeof t?WN(e):t}function LN(e){return(LN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HN(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UN(e,t)}function UN(e,t){return(UN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GN(e){var t=o.a.createElement("div",null);return null!=e&&(t=o.a.createElement(ua,{label:"IPTV plugin settings",className:"margin-left-0 margin-right-0",onClick:e})),o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",null,o.a.createElement("h1",{className:"head-text"},"Head over to ",o.a.createElement("a",{href:"https://flussonic.com/doc/catena"},"this link")," and find out more about our new product for IPTV solutions - Catena."),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"You can still use IPTV plugin, but it will be deprecated in the following releases.")),o.a.createElement("div",{className:"row-height"}),t)),o.a.createElement("div",{className:"right-container"}))}var QN=function(e){function t(){var e,n;MN(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return zN(WN(n=BN(this,(e=LN(t)).call.apply(e,[this].concat(r)))),"enableStream",function(){var e={streams:{}};e.streams[n.props.name]={meta:{iptv:"true"}},n.props.stream.auth&&n.props.stream.auth.url||(e.streams[n.props.name].auth={url:"iptv://localhost"}),ft.save(e)}),zN(WN(n),"disableStream",function(){var e={streams:{}};e.streams[n.props.name]={meta:{iptv:null}},n.props.stream.auth&&n.props.stream.auth.url&&0==n.props.stream.auth.url.indexOf("iptv://")&&(e.streams[n.props.name].auth=null),n.props.stream.auth&&n.props.stream.auth.url&&0!=n.props.stream.auth.url.indexOf("/tv/auth")&&(e.streams[n.props.name].auth=null),ft.save(e)}),n}return HN(t,o.a.Component),VN(t,[{key:"render",value:function(){var e=this.props.enabled?this.disableStream:this.enableStream;return o.a.createElement("div",{className:"row-height flex-end stream-item"},o.a.createElement(ua,{label:this.props.name,checked:this.props.enabled,onClick:e}))}}]),t}();zN(QN,"propTypes",{name:Y.a.string.isRequired,enabled:Y.a.bool});var KN=function(e){function t(){var e,n;MN(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return zN(WN(n=BN(this,(e=LN(t)).call.apply(e,[this].concat(r)))),"state",{name:"",email:"",max_sessions:""}),zN(WN(n),"changeField",function(e,t){var a={};a[e]=t.target.value,n.setState(a)}),zN(WN(n),"onSaveClick",function(){ar.dispatch({type:"iptv:createUser",user:er.a.fromJS({name:n.state.name,email:n.state.email,max_sessions:n.state.max_sessions})}),n.setState({name:"",email:"",max_sessions:""})}),n}return HN(t,o.a.Component),VN(t,[{key:"render",value:function(){return o.a.createElement("tr",{className:"row-height"},o.a.createElement("td",null,o.a.createElement(ea,{label:"New user name"},o.a.createElement(mn,{value:this.state.name,changed:!!this.state.name,onChange:this.changeField.bind(this,"name")})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("td",null,o.a.createElement(ea,{label:"New user email"},o.a.createElement(mn,{value:this.state.email,changed:!!this.state.email,onChange:this.changeField.bind(this,"email")})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("td",null,o.a.createElement(ea,{label:"Max sessions"},o.a.createElement(mn,{value:this.state.max_sessions,changed:!!this.state.max_sessions,onChange:this.changeField.bind(this,"max_sessions")})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("td",null,o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"save",disabled:!this.state.name||!this.state.email,onClick:this.onSaveClick,className:"margin-right-10"})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("td",{className:"links-block"}))}}]),t}(),JN=function(e){function t(){var e,n;MN(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return zN(WN(n=BN(this,(e=LN(t)).call.apply(e,[this].concat(r)))),"state",{name:n.props.user.get("name"),email:n.props.user.get("email"),key:n.props.user.get("key"),max_sessions:n.props.user.get("max_sessions"),saveTimeout:void 0}),zN(WN(n),"changeField",function(e,t){n.state.saveTimeout&&clearTimeout(n.state.saveTimeout);var a={saveTimeout:setTimeout(n.save,1e3)};a[e]=t.target.value,n.setState(a)}),zN(WN(n),"save",function(){var e=n.props.user.merge({name:n.state.name,email:n.state.email,key:n.state.key,max_sessions:n.state.max_sessions});ar.dispatch({type:"iptv:updateUser",user:e})}),zN(WN(n),"onRemoveClick",function(){ar.dispatch({type:"iptv:removeUser",user:n.props.user})}),n}return HN(t,o.a.Component),VN(t,[{key:"render",value:function(){var e=E+"/tv/playlists/"+this.props.user.get("id")+".m3u?key="+this.props.user.get("key"),t=e+"&type=mpegts";return o.a.createElement("tr",{className:"row-height"},o.a.createElement("td",null,o.a.createElement(mn,{value:this.state.name,changed:this.state.name!=this.props.user.get("name"),onChange:this.changeField.bind(this,"name")})),o.a.createElement("td",null,o.a.createElement(mn,{value:this.state.email,changed:this.state.email!=this.props.user.get("email"),onChange:this.changeField.bind(this,"email")})),o.a.createElement("td",null,o.a.createElement(mn,{value:this.state.key,changed:this.state.key!=this.props.user.get("key"),onChange:this.changeField.bind(this,"key")})),o.a.createElement("td",null,o.a.createElement(mn,{value:this.state.max_sessions,changed:this.state.max_sessions!=this.props.user.get("max_sessions"),onChange:this.changeField.bind(this,"max_sessions")})),o.a.createElement("td",{className:"links-block"},o.a.createElement(ua,{label:"✕",onClick:this.onRemoveClick,className:"danger margin-right-10"}),o.a.createElement("a",{href:t,className:"margin-right-10"},"MPEG-TS"),o.a.createElement("a",{href:e},"HLS")))}}]),t}();zN(JN,"propTypes",{user:Y.a.object.isRequired});var YN=tn()({displayName:"IptvEnabled",propTypes:{config:Y.a.object.isRequired,users:Y.a.object.isRequired,loadedAll:Y.a.bool},getInitialState:function(){return{streamsFilter:"",usersFilter:"",usersPage:0,usersTimeout:void 0,ignorePagination:!1,showPlugin:!1}},componentDidMount:function(){ar.dispatch({type:"iptv:refreshUsers",filter:this.state.usersFilter,page:this.state.usersPage}),window.addEventListener("scroll",this.handleScroll)},componentWillUnmount:function(){ar.dispatch({type:"iptv:clearUsers"}),window.removeEventListener("scroll",this.handleScroll)},handleScroll:function(){if(!this.state.ignorePagination&&!this.props.loadedAll){var e=window.pageYOffset||document.documentElement.scrollTop,t=document.documentElement.clientHeight;document.body.offsetHeight-(e+t)<300&&(ar.dispatch({type:"iptv:refreshUsers",filter:this.state.usersFilter,page:this.state.usersPage+1}),this.setState({ignorePagination:!0,usersPage:this.state.usersPage+1}),setTimeout(function(){this.setState({ignorePagination:!1})}.bind(this),1e3))}},streamsFilterChange:function(e){this.setState({streamsFilter:e.target.value})},usersFilterChange:function(e){this.state.usersTimeout&&clearTimeout(this.state.usersTimeout);var t=setTimeout(function(){ar.dispatch({type:"iptv:refreshUsers",filter:this.state.usersFilter,page:0}),this.setState({usersTimeout:void 0,usersPage:0})}.bind(this),1e3);this.setState({usersFilter:e.target.value,usersTimeout:t})},togglePluginShow:function(e){var t=!this.state.showPlugin;this.setState({showPlugin:t})},render:function(){var e=[],t=[];for(var n in this.props.config.streams)this.props.config.streams[n].meta.iptv?this.state.streamsFilter&&-1==n.indexOf(this.state.streamsFilter)||e.push(o.a.createElement(QN,{key:n,name:n,stream:this.props.config.streams[n],self:this,enabled:!0})):this.state.streamsFilter&&-1==n.indexOf(this.state.streamsFilter)||t.push(o.a.createElement(QN,{key:n,name:n,stream:this.props.config.streams[n],self:this}));0!=e.length&&(e=o.a.createElement("div",null,o.a.createElement("h1",{className:"head-text"},"Enabled"),e,o.a.createElement("div",{className:"row-height"}))),0!=t.length&&(t=o.a.createElement("div",null,o.a.createElement("h1",{className:"head-text"},"Disabled"),t,o.a.createElement("div",{className:"row-height"})));var a=[];this.props.users.forEach(function(e,t){a.push(o.a.createElement(JN,{key:e.get("id"),user:e}))});var r=o.a.createElement("div",null);return this.state.showPlugin&&(r=o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"iptv-stream-list margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("h1",{className:"head-text"},"Streams"),o.a.createElement("div",{className:"row-height"}),o.a.createElement(ea,{label:"Filter"},o.a.createElement(mn,{value:this.state.streamsFilter,onChange:this.streamsFilterChange})),o.a.createElement("div",{className:"row-height"}),o.a.createElement(AN,{attachedWidth:240},e,t)),o.a.createElement("div",{className:"right-column margin-left-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("h1",{className:"head-text"},"Users"),o.a.createElement("div",{className:"row-height"}),o.a.createElement("table",null,o.a.createElement("thead",{id:"clients"},o.a.createElement(KN,null),o.a.createElement("tr",null,o.a.createElement("th",{colSpan:"2"},o.a.createElement(ea,{label:"Filter"},o.a.createElement(mn,{value:this.state.usersFilter,onChange:this.usersFilterChange})),o.a.createElement("div",{className:"row-height"})),o.a.createElement("th",null),o.a.createElement("th",null)),o.a.createElement("tr",null,o.a.createElement("th",{className:"column-caption"},"name"),o.a.createElement("th",{className:"column-caption"},"email"),o.a.createElement("th",{className:"column-caption"},"token"),o.a.createElement("th",{className:"column-caption"},"max sessions"),o.a.createElement("th",{className:"column-caption"}))),o.a.createElement("tbody",null,a)))),o.a.createElement("div",{className:"right-container"}))),o.a.createElement("div",{id:"iptv"},GN(this.togglePluginShow),r)}}),$N=tn()({displayName:"IptvPage",mixins:[te.a.ListenerMixin],propTypes:{},getInitialState:function(){return{showPlugin:!1}},componentDidMount:function(){this.listenTo(ft,this.onConfigChange)},onConfigChange:function(e){this.setState({config:e,path:this.state.path||(e.plugins.iptv||{}).database||"sqlite:///opt/flussonic/priv/iptv.db"})},changePath:function(e){this.setState({path:e.target.value})},savePath:function(){var e={plugins:{iptv:{database:this.state.path}}};this.setState({saving:!0}),ft.save(e).then(function(){this.setState({saving:!1}),document.location=document.location.href}.bind(this))},togglePluginShow:function(e){var t=!this.state.showPlugin;this.setState({showPlugin:t})},render:function(){if(!this.state.config)return o.a.createElement("div",null);var e=(this.state.config.plugins.iptv||{}).database;if(!this.props.error&&e)return o.a.createElement(YN,{config:this.state.config,users:this.props.users,loadedAll:this.props.loadedAll});var t=this.props.error?"unable to access database on path":void 0,n=o.a.createElement("div",null);return this.state.showPlugin&&(n=o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{className:"center-container"},o.a.createElement("div",{className:"left-column margin-right-10"},o.a.createElement("div",{className:"row-height"}),o.a.createElement("h1",{className:"head-text"},"IPTV is not configured"),o.a.createElement(ea,{label:"Database path",details:"specify where Flussonic should store data",errorMessage:t},o.a.createElement(mn,{value:this.state.path,onChange:this.changePath})),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("div",{className:"notice-text"},"for example: sqlite:///opt/flussonic/priv/iptv.db")),o.a.createElement("div",{className:"row-height"}),o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement(ua,{label:"Enable IPTV",className:"rect filled",onClick:this.savePath})),this.state.saving&&o.a.createElement("div",{className:"row-height flex-end"},o.a.createElement("i",null,"saving..."))),o.a.createElement("div",{className:"right-column margin-left-10"})),o.a.createElement("div",{className:"right-container"}))),o.a.createElement("div",{id:"iptv","data-testid":"iptv"},GN(this.togglePluginShow),n)}}),XN=Object($.connect)(function(e){return{users:e.get("iptvUsers"),loadedAll:e.get("iptvLoadedAll"),error:e.get("iptvError")}},function(e){return{}})($N),ZN=n(590),ek=n(237),tk=n.n(ek),nk=n(672),ak=n.n(nk),rk=n(1482),ok=n(670),ik=n.n(ok),sk=n(671),lk=n.n(sk),ck=Y.a.Object;function uk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var dk=function(e){var t=e.authBackend,n=e.value,a=e.isAllowed,i=e.isBackend,s=e.variant,l=e.title,c=e.isSelected,u=e.onToggleEdit,p=e.onDelete,d=e.classes,m=pk(Object(r.useState)(null),2),f=(m[0],m[1]);return o.a.createElement("div",{"data-testid":"authBackendsOption"},o.a.createElement(rk.a,{className:an()(d.chipRoot,c&&d.chipRootSelected),classes:{root:a?d.chipRootAllowed:!i&&d.chipRootDenied,icon:a?d.chipIconAllowed:!i&&d.chipIconDenied},icon:a?o.a.createElement(ik.a,null):!i&&o.a.createElement(lk.a,null)||null,label:"".concat(l,": ").concat(n),onClick:u({name:t.name,isAllowed:a,isBackend:i,variant:s,value:n}),deleteIcon:o.a.createElement(As.a,{"data-testid":"authBackendsOptionDeleteButton"}),onDelete:p({name:t.name,isAllowed:a,isBackend:i,variant:s,value:n}),variant:"outlined",innerRef:f}),!1)},mk=Ss()(function(e){return{chipRoot:{marginRight:e.spacing(1),marginTop:e.spacing(1)},chipRootSelected:{borderWidth:3},chipRootAllowed:{color:e.palette.green.dark,borderColor:e.palette.green.dark},chipRootDenied:{color:e.palette.red.dark,borderColor:e.palette.red.dark},chipIconAllowed:{color:e.palette.green.light},chipIconDenied:{color:e.palette.red.light}}})(dk);mk.propTypes={authBackend:Y.a.shape({name:Y.a.string}).isRequired,value:Aa.isRequired,conflictValue:Aa,isAllowed:Y.a.bool.isRequired,isBackend:Y.a.bool.isRequired,variant:Y.a.string.isRequired,title:Y.a.string.isRequired,isSelected:Y.a.bool.isRequired,onToggleEdit:Y.a.func.isRequired,onResolveConflict:Y.a.func.isRequired,onDelete:Y.a.func.isRequired},mk.defaultProps={conflictValue:null},dk.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){uk(e,t,n[t])})}return e}({},mk.propTypes,{classes:Y.a.shape({chipRoot:ck,chipRootSelected:ck,chipRootAllowed:ck,chipRootDenied:ck,chipIconAllowed:ck,chipIconDenied:ck}).isRequired});var fk=n(582),hk=n(589),gk=n(591);function vk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bk=function(e,t){for(var n=1;t["".concat(e).concat(n)];)n+=1;return"".concat(e).concat(n)},yk=Q.a(xi.a([[we.a,K.a(1)],[Ni.a,fk.a]]),Ut.a,hk.a(gk.a),Kf.a,pe.a(Ee.a("position"))),Ek=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){vk(e,t,n[t])})}return e}({name:bk(e,t),position:yk(t)},n)};function wk(e){return(wk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sk(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ck(e){return(Ck=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ok(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xk(e,t){return(xk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kk(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var _k=function(e){var t=e.authBackend,n=e.isAllowed,a=e.type;return Q.a(Ne.a(function(e){return{value:e,isAllowed:n,isBackend:!1}}),Im.a([],"".concat(n?"allow":"deny","_").concat(a)))(t)},Pk=function(e,t){return[].concat(kk(_k({authBackend:e,type:t,isAllowed:!0})),kk(_k({authBackend:e,type:t,isAllowed:!1})))},jk=[{variant:"tokens",title:"Token"},{variant:"ips",title:"IP"},{variant:"countries",title:"Country"},{variant:"uas",title:"UA"},{variant:"backends",title:"Backend"}],Rk=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=Ck(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==wk(r)&&"function"!=typeof r?Ok(a):r,Nk(Ok(n),"state",{mode:"allow",variant:"ips",value:"",prevValue:"",prevValueAuthBackend:"",backend:"",authBackends:[],authBackendNameEditable:"",authBackendNameNew:""}),Nk(Ok(n),"setAuthBackendNameEditable",function(e){return n.setState({authBackendNameEditable:e,authBackendNameNew:e})}),Nk(Ok(n),"setPrevValueAndItsAuthBackendToDefault",function(){return n.setState({prevValue:"",prevValueAuthBackend:""})}),Nk(Ok(n),"handleChange",function(e){return function(t){var a=t.target.value;return n.setState(Nk({},e,a))}}),Nk(Ok(n),"handleValueChange",function(e){var t=e.target.value;return n.setState({value:t})}),Nk(Ok(n),"handleAuthBackendNameChange",function(e){var t=e.target.value;return n.setState({authBackendNameNew:t.trim()})}),Nk(Ok(n),"handleAuthBackendNameEditHide",function(){n.setAuthBackendNameEditable("")}),Nk(Ok(n),"handleAuthBackendNameKeyPress",function(e){"Enter"===e.key&&n.handleAuthBackendNameSet()}),Nk(Ok(n),"handleAuthBackendNameSet",function(){var e=n.state,t=e.authBackendNameEditable,a=e.authBackendNameNew;n.props.AuthBackends.onConfigValueNameChange([],t,a,function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Nk(e,t,n[t])})}return e}({},e,{name:a})}),n.handleAuthBackendNameEditHide()}),Nk(Ok(n),"handleAuthBackendDelete",function(e){return function(){n.props.AuthBackends.onConfigValueChange([e])(null)}}),Nk(Ok(n),"handleDelete",function(e){var t=e.name,a=e.isAllowed,r=e.isBackend,o=e.variant,i=e.value;return function(){var e=r?"backends":"".concat(a?"allow":"deny","_").concat(o),s=[t,e],l=he.a(me.a(i)),c=r?Q.a(l,Ee.a("url")):l,u=Q.a(be.a(c),ke.a(s))(n.props.AuthBackends.config);n.props.AuthBackends.onConfigValueChange(s)(u),n.setPrevValueAndItsAuthBackendToDefault()}}),Nk(Ok(n),"handleValueSet",function(e){"Enter"===e.key&&n.handleValueAdd()}),Nk(Ok(n),"handleValueAdd",function(){var e=n.state,t=e.backend,a=e.variant,r=e.mode,o=e.value;if(n.state.backend){var i="backend"===r,s=i?"backends":"".concat(r,"_").concat(a),l=i?{url:o}:o,c=i?{url:n.state.prevValue}:n.state.prevValue,u=i?Q.a(me.a(o),Ee.a("url")):me.a(o),p=qi.a(u,Es.a([],[t,s],n.props.AuthBackends.config));if(qi.a(me.a(c),Es.a([],[t,s],n.props.AuthBackends.config))){var d=ue.a(me.a(c),[].concat(kk(Es.a([],[t,s],n.props.AuthBackends.config)),[l]));n.props.AuthBackends.onConfigValueChange([t,s])(d)}else if(p)console.error("Value alerady exists");else{var m=[].concat(kk(Es.a([],[t,s],n.props.AuthBackends.config)),[l]);n.props.AuthBackends.onConfigValueChange([t,s])(m)}n.setPrevValueAndItsAuthBackendToDefault()}}),Nk(Ok(n),"handleToggleEdit",function(e){var t=e.name,a=e.isAllowed,r=e.isBackend,o=e.variant,i=e.value;return function(){n.state.prevValue===i&&n.state.prevValueAuthBackend===t?n.setPrevValueAndItsAuthBackendToDefault():n.setState({mode:r?"backend":a?"allow":"deny",backend:t,value:i,variant:o,prevValue:i,prevValueAuthBackend:t})}}),Nk(Ok(n),"handleToggleDefault",function(e){return function(){var t=[e,"allow_default"],a=!n.props.AuthBackends.config[e].allow_default;n.props.AuthBackends.onConfigValueChange(t)(a||null)}}),Nk(Ok(n),"handleAddAuthBackend",function(){var e=Ek("NewAuthBackend",n.props.AuthBackends.config);n.props.AuthBackends.onConfigValueChange([e.name])(e)}),Nk(Ok(n),"renderAuthBackendValueEditor",function(){return o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(Ps.a,{container:!0,spacing:2,alignItems:"flex-end"},o.a.createElement(Ps.a,{item:!0,xs:7},o.a.createElement(ks.a,{fullWidth:!0,label:"Auth backend option value",value:n.state.value,type:"text",onChange:n.handleValueChange,onKeyPress:n.handleValueSet,"data-testid":"authBackendsOptionEditor"})),o.a.createElement(Ps.a,{container:!0,item:!0,xs:4,alignItems:"flex-end"},o.a.createElement(Cs.a,{value:n.state.mode,onChange:n.handleChange("mode"),"data-testid":"authBackendsOptionSelectorMode"},o.a.createElement(Ns.a,{value:"allow"},"allow"),o.a.createElement(Ns.a,{value:"deny","data-testid":"authBackendsOptionSelectorModeDeny"},"deny"),o.a.createElement(Ns.a,{value:"backend"},"backend")),"backend"!==n.state.mode&&o.a.createElement(Cs.a,{value:n.state.variant,onChange:n.handleChange("variant"),"data-testid":"authBackendsOptionSelectorVariant"},o.a.createElement(Ns.a,{value:"ips"},"ip"),o.a.createElement(Ns.a,{value:"tokens","data-testid":"authBackendsOptionSelectorVariantToken"},"token"),o.a.createElement(Ns.a,{value:"countries"},"country"),o.a.createElement(Ns.a,{value:"uas"},"ua")),o.a.createElement(Cs.a,{value:n.state.backend,onChange:n.handleChange("backend"),"data-testid":"authBackendsOptionSelectorAuthBackend"},Object.keys(n.props.AuthBackends.config).map(function(e){return o.a.createElement(Ns.a,{key:e,value:e,"data-testid":"authBackendsOptionSelectorAuthBackend_".concat(e)},e)}))),o.a.createElement(Ps.a,{item:!0,xs:1},o.a.createElement(Hs.a,{onClick:n.handleValueAdd,"data-testid":"authBackendsOptionEditButton"},n.state.prevValue?"Edit":"Add"))))}),Nk(Ok(n),"renderAuthBackendsValues",function(){return n.state.authBackends.map(function(e,t){return o.a.createElement(o.a.Fragment,{key:e.name},t>0&&o.a.createElement(Td.a,{mt:2,mb:1},o.a.createElement(Jf.a,{light:!0})),o.a.createElement(Ps.a,{container:!0,spacing:2,"data-testid":"authBackendsList"},o.a.createElement(Ps.a,{container:!0,item:!0,xs:12,alignItems:"center",justify:"space-between"},o.a.createElement(Ps.a,{item:!0,xs:8},n.state.authBackendNameEditable===e.name?o.a.createElement(Zf.a,{onClickAway:n.handleAuthBackendNameEditHide},o.a.createElement(ks.a,{"data-testid":"authBackendsTitleEditor",fullWidth:!0,autoFocus:!0,value:n.state.authBackendNameNew,type:"text",onKeyPress:n.handleAuthBackendNameKeyPress,onChange:n.handleAuthBackendNameChange,InputProps:{endAdornment:o.a.createElement(Ts.a,{position:"end"},o.a.createElement(Is.a,{onClick:n.handleAuthBackendNameSet,"data-testid":"authBackendsTitleEditorButton"},o.a.createElement(ak.a,null)))}})):o.a.createElement("span",{"data-testid":"authBackendsTitle",style:{marginRight:32,height:48,fontSize:24},onClick:function(){return n.setAuthBackendNameEditable(e.name)}},e.name)),o.a.createElement(Ps.a,{container:!0,item:!0,xs:4,justify:"flex-end",alignItems:"center"},o.a.createElement(Ps.a,{item:!0},o.a.createElement(pg.a,{checked:n.props.AuthBackends.config[e.name].allow_default,onChange:n.handleToggleDefault(e.name),value:n.props.AuthBackends.config[e.name].allow_default,color:"primary"}),o.a.createElement("span",{style:{marginRight:32,height:48}},"Allow default")),o.a.createElement(Ps.a,{item:!0},o.a.createElement(Is.a,{"aria-label":"Delete auth backend",title:"Delete auth backend",onClick:n.handleAuthBackendDelete(e.name),"data-testid":"authBackendsItemDeleteButton"},o.a.createElement(tk.a,{fontSize:"small"}))))),jk.map(function(t){var a=t.variant,r=t.title;return o.a.createElement(Td.a,{my:1,key:a},o.a.createElement(Ps.a,{container:!0,item:!0,spacing:2},e[a].map(function(t){var i=t.value,s=t.isAllowed,l=t.isBackend;return o.a.createElement(Ps.a,{item:!0,key:i},o.a.createElement(mk,{authBackend:e,value:i,isAllowed:s,isBackend:l,variant:a,title:r,isSelected:i===n.state.prevValue&&e.name===n.state.prevValueAuthBackend,onToggleEdit:n.handleToggleEdit,onDelete:n.handleDelete}))})))})))})}),Nk(Ok(n),"renderActions",function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(Hs.a,{color:"primary",variant:"contained",onClick:n.props.AuthBackends.onConfigSave,disabled:!n.props.AuthBackends.isConfigChanged,"data-testid":"authBackendsSaveButton"},n.props.AuthBackends.isSaving&&o.a.createElement(Am.a,{size:20,color:"primary"}),"Save"),o.a.createElement(Td.a,{ml:1},o.a.createElement(Hs.a,{className:n.props.classes.buttonReset,variant:"contained",onClick:n.props.AuthBackends.onConfigReset,disabled:!n.props.AuthBackends.isConfigChanged,"data-testid":"authBackendsResetButton"},"Reset")),o.a.createElement(Td.a,{ml:1},o.a.createElement(Hs.a,{variant:"outlined",onClick:n.handleAddAuthBackend,"data-testid":"authBackendsAddAuthBackendButton"},"Add auth backend")))}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xk(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return o.a.createElement(Td.a,{px:"8.5%","data-testid":"auth"},o.a.createElement(Ps.a,{container:!0,spacing:2},this.renderAuthBackendValueEditor(),o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(Td.a,{my:4})),o.a.createElement(Ps.a,{item:!0,xs:12},this.renderAuthBackendsValues()),o.a.createElement(Td.a,{mt:2},o.a.createElement(Ps.a,{container:!0,item:!0,xs:12},this.renderActions()))))}}])&&Sk(n.prototype,a),r&&Sk(n,r),t}();Nk(Rk,"propTypes",{AuthBackends:Y.a.shape({config:Ba,isConfigChanged:Y.a.bool.isRequired,onConfigValueChange:Y.a.func,onConfigValueNameChange:Y.a.func,onConfigSave:Y.a.func,onConfigReset:Y.a.func,isSaving:Y.a.bool}),classes:Y.a.shape({buttonReset:ck}).isRequired}),Nk(Rk,"defaultProps",{AuthBackends:{config:null,onConfigValueChange:K.a(),onConfigValueNameChange:K.a(K.a()),onConfigSave:K.a(),onConfigReset:K.a()}}),Nk(Rk,"getDerivedStateFromProps",function(e){return e.AuthBackends.config?{authBackends:(t=e.AuthBackends.config,Q.a(Ne.a(function(e){return{position:t[e].position,backends:(n=e,Q.a(Ne.a(function(e){return{value:e.url,isBackend:!0,isAllowed:!1}}),Es.a([],[n,"backends"])))(t),name:t[e].name,allowDefault:t[e].allow_default,ips:Pk(t[e],"ips"),tokens:Pk(t[e],"tokens"),uas:Pk(t[e],"uas"),countries:Pk(t[e],"countries")};var n}),ZN.a(function(e){return t[e].position}),be.a(function(e){return!!t[e]}),ye.a)(t))}:{};var t});var Tk=Q.a(Ss()(function(e){return{buttonReset:{backgroundColor:e.palette.red.main}}}),pu(["auth_backends"],{},"AuthBackends"),function(e){return o.a.memo(e,me.a)})(Rk),Ik=fl(function(e){var t=e.value,n=e.streamRoots,a=0===t.indexOf("/")?t.slice(1):t;return!n.includes(t)&&!n.includes(a)},"DVR root should be unique, this root is already used as stream root path."),Dk=fl(function(e){var t=e.dvrs,n=e.value;return Q.a(Ce.a,Ai.a(n),Ne.a(Ee.a("root")),Kf.a)(t)},"DVR root should be unique, this root is already used as global."),Ak=fl(function(e){var t=e.value;return t&&t.length>0},"DVR root is required and should have 1 character at least."),qk=hl(Ik,Dk,Ak),Mk=fl(function(e){var t=e.value;return Ae(t)},"DVR name is required and should have 1 character at least."),Fk=fl(function(e){var t=e.dvrs,n=e.value,a=e.oldValue;return!a||n===a||!t[n]},"DVR name should be unique, this name is already used."),Vk=hl(Fk,Mk),Bk=function(e){var t=e.size;return o.a.createElement("svg",{x:0,y:0,width:t,height:t,viewBox:"0 0 512 512"},o.a.createElement("g",null,o.a.createElement("g",{transform:"matrix(1.7,0,0,1.6,-125.6,-126)"},o.a.createElement("g",null,o.a.createElement("path",{d:"M 305.7 117.9 C 304 113.8 299.1 110.5 294.7 110.5 H 150.7 c -4.4 0 -9.3 3.3 -11 7.4 l -26.1 65.1 C 112 187.2 110.7 194.1 110.7 198.5 v 32 c 0 4.4 3.6 8 8 8 h 208 c 4.4 0 8 -3.6 8 -8 v -32 c 0 -4.4 -1.3 -11.3 -3 -15.4 L 305.7 117.9 z M 142.7 214.5 c 0 4.4 -3.6 8 -8 8 l 0 0 c -4.4 0 -8 -3.6 -8 -8 l 0 0 c 0 -4.4 3.6 -8 8 -8 l 0 0 C 139.1 206.5 142.7 210.1 142.7 214.5 L 142.7 214.5 z M 174.7 214.5 c 0 4.4 -3.6 8 -8 8 l 0 0 c -4.4 0 -8 -3.6 -8 -8 l 0 0 c 0 -4.4 3.6 -8 8 -8 l 0 0 C 171.1 206.5 174.7 210.1 174.7 214.5 L 174.7 214.5 z M 206.7 214.5 c 0 4.4 -3.6 8 -8 8 l 0 0 c -4.4 0 -8 -3.6 -8 -8 l 0 0 c 0 -4.4 3.6 -8 8 -8 l 0 0 C 203.1 206.5 206.7 210.1 206.7 214.5 L 206.7 214.5 z M 318.7 214.5 c 0 4.4 -3.6 8 -8 8 l 0 0 c -4.4 0 -8 -3.6 -8 -8 l 0 0 c 0 -4.4 3.6 -8 8 -8 l 0 0 C 315.1 206.5 318.7 210.1 318.7 214.5 L 318.7 214.5 z"})),o.a.createElement("g",null,o.a.createElement("path",{d:"M 110.7 294.5 c 0 4.4 3.6 8 8 8 h 208 c 4.4 0 8 -3.6 8 -8 v -32 c 0 -4.4 -3.6 -8 -8 -8 H 118.7 c -4.4 0 -8 3.6 -8 8 V 294.5 z M 302.7 278.5 c 0 -4.4 3.6 -8 8 -8 l 0 0 c 4.4 0 8 3.6 8 8 l 0 0 c 0 4.4 -3.6 8 -8 8 l 0 0 C 306.3 286.5 302.7 282.9 302.7 278.5 L 302.7 278.5 z M 190.7 278.5 c 0 -4.4 3.6 -8 8 -8 l 0 0 c 4.4 0 8 3.6 8 8 l 0 0 c 0 4.4 -3.6 8 -8 8 l 0 0 C 194.3 286.5 190.7 282.9 190.7 278.5 L 190.7 278.5 z M 158.7 278.5 c 0 -4.4 3.6 -8 8 -8 l 0 0 c 4.4 0 8 3.6 8 8 l 0 0 c 0 4.4 -3.6 8 -8 8 l 0 0 C 162.3 286.5 158.7 282.9 158.7 278.5 L 158.7 278.5 z M 126.7 278.5 c 0 -4.4 3.6 -8 8 -8 l 0 0 c 4.4 0 8 3.6 8 8 l 0 0 c 0 4.4 -3.6 8 -8 8 l 0 0 C 130.3 286.5 126.7 282.9 126.7 278.5 L 126.7 278.5 z"})),o.a.createElement("g",null,o.a.createElement("path",{d:"M 110.7 358.5 c 0 4.4 3.6 8 8 8 h 208 c 4.4 0 8 -3.6 8 -8 v -32 c 0 -4.4 -3.6 -8 -8 -8 H 118.7 c -4.4 0 -8 3.6 -8 8 V 358.5 z M 302.7 342.5 c 0 -4.4 3.6 -8 8 -8 l 0 0 c 4.4 0 8 3.6 8 8 l 0 0 c 0 4.4 -3.6 8 -8 8 l 0 0 C 306.3 350.5 302.7 346.9 302.7 342.5 L 302.7 342.5 z M 190.7 342.5 c 0 -4.4 3.6 -8 8 -8 l 0 0 c 4.4 0 8 3.6 8 8 l 0 0 c 0 4.4 -3.6 8 -8 8 l 0 0 C 194.3 350.5 190.7 346.9 190.7 342.5 L 190.7 342.5 z M 158.7 342.5 c 0 -4.4 3.6 -8 8 -8 l 0 0 c 4.4 0 8 3.6 8 8 l 0 0 c 0 4.4 -3.6 8 -8 8 l 0 0 C 162.3 350.5 158.7 346.9 158.7 342.5 L 158.7 342.5 z M 126.7 342.5 c 0 -4.4 3.6 -8 8 -8 l 0 0 c 4.4 0 8 3.6 8 8 l 0 0 c 0 4.4 -3.6 8 -8 8 l 0 0 C 130.3 350.5 126.7 346.9 126.7 342.5 L 126.7 342.5 z"})))))};Bk.propTypes={size:Y.a.number.isRequired};var Lk=Bk,Wk=function(e){var t=e.dvr,n=e.onValueChange,a=e.onValueToggle,o=e.isSingleStream,i=void 0!==o&&o;return r.createElement(Ps.a,{container:!0,spacing:1},r.createElement(Ps.a,{item:!0,xs:12},r.createElement(Ws,{fullWidth:!0,label:"Cached metadata subdirectory",value:t.index,type:"text",onChange:n([t.name,"index"]),"data-testid":"dvrIndex"})),r.createElement(hf,{dvr:t,onValueToggle:a,onValueChange:n}),r.createElement(Ps.a,{item:!0,xs:12},r.createElement(ta.a,{control:r.createElement(mf.a,{checked:!t.no_index,onChange:a([t.name,"no_index"]),color:"primary","data-testid":"dvrNoIndex"}),label:"Indexing for stream".concat(i?"":"s")})))};Wk.propTypes={dvr:La.isRequired,onValueChange:Y.a.func.isRequired,onValueToggle:Y.a.func.isRequired,isSingleStream:Y.a.bool},Wk.defaultProps={isSingleStream:!1};var Hk=Wk,Uk=Ss()(function(e){return{text:{fontWeight:e.typography.fontWeightLight}}})(function(e){var t=e.title,n=e.classes,a=e.children;return r.createElement(Ps.a,{container:!0,justify:"space-between"},r.createElement(Ps.a,{item:!0},r.createElement(Id.a,{variant:"h4",className:n.text},t)),r.createElement(Ps.a,{item:!0},a))}),zk=n(673),Gk=n.n(zk);function Qk(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Kk=Ss()(function(e){return{dvrSectionAddButton:{color:e.palette.grey[800]}}})(function(e){var t=e.label,n=e.onClick,a=e.classes,o=Qk(e,["label","onClick","classes"]);return r.createElement(Hs.a,{className:a.dvrSectionAddButton,variant:"outlined",onClick:n,"data-testid":o["data-testid"]},t,r.createElement(Gk.a,{fontSize:"small"}))});function Jk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Yk=function(e){var t=e.toString().padStart(4,"0");return"".concat(t.slice(0,2),":").concat(t.slice(2))},$k=function(e){var t=e.dvr,n=e.onScheduleRangeValueChange,a=e.onScheduleRangeDelete,o=e.onScheduleRangeAdd;return r.createElement(r.Fragment,null,r.createElement(Uk,{title:"Schedule"},r.createElement(Kk,{label:"Add schedule range",onClick:o(t.name),"data-testid":"dvrScheduleRangeAdd"})),(t.schedule||[]).filter(Ae).map(function(e,o){var i=Jk(e,2),s=i[0],l=i[1];return r.createElement(Ps.a,{container:!0,spacing:1,key:"".concat(t.name,"-").concat(o)},r.createElement(Ps.a,{item:!0,xs:!0},r.createElement(ks.a,{fullWidth:!0,value:Yk(s),type:"time",onChange:n(t.name,o,0),inputProps:{style:{textAlign:"center"}},"data-testid":"dvrScheduleRangeFrom"})),r.createElement(Ps.a,{item:!0,xs:!0},r.createElement(ks.a,{fullWidth:!0,value:Yk(l),type:"time",onChange:n(t.name,o,1),inputProps:{style:{textAlign:"center"}},"data-testid":"dvrScheduleRangeTo"})),r.createElement(Ps.a,{container:!0,item:!0,xs:1,justify:"flex-end"},r.createElement(Is.a,{"aria-label":"Delete schedule range",title:"Delete schedule range",onClick:a(t.name,o),"data-testid":"dvrScheduleRangeDelete"},r.createElement(tk.a,{fontSize:"small"}))))}))};$k.propTypes={dvr:La.isRequired,onScheduleRangeValueChange:Y.a.func.isRequired,onScheduleRangeDelete:Y.a.func.isRequired,onScheduleRangeAdd:Y.a.func.isRequired};var Xk=$k;function Zk(e){return(Zk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e_(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function t_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){i_(e,t,n[t])})}return e}function n_(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a_(e){return(a_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o_(e,t){return(o_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s_=[null,"keep","readonly","abandon","migrate","rescue"],l_=function(e){return e||"default"},c_=Q.a(Ne.a(function(e){return 0===e.indexOf("/")?e.slice(1):e}),be.a(Boolean),Ne.a(ke.a(["dvr","root"])),Kf.a),u_=function(e){function t(){var e,n,a,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,o=(e=a_(t)).call.apply(e,[this].concat(s)),n=!o||"object"!==Zk(o)&&"function"!=typeof o?r_(a):o,i_(r_(n),"state",{newDvrName:null,oldDvrName:null,expandedDvrs:{}}),i_(r_(n),"handleDvrExpansion",function(e){return function(t,a){console.log(e,a),n.setState(function(t){return{expandedDvrs:t_({},t.expandedDvrs,i_({},e,a))}})}}),i_(r_(n),"handleDvrNameFocus",function(e){return function(){n.setState({oldDvrName:e,newDvrName:e})}}),i_(r_(n),"handleDvrNameEdit",function(e){var t=e.target.value;n.setState({newDvrName:t},n.handleDvrNameSet)}),i_(r_(n),"handleDvrNameSet",function(){var e=n.state,t=e.oldDvrName,a=e.newDvrName;t!==a&&(n.props.onConfigValueNameChange([],t,a,function(e){return t_({},e,{name:a})}),n.setState(function(e){var n;return{expandedDvrs:t_({},e.expandedDvrs,(n={},i_(n,t,!1),i_(n,a,!0),n)),oldDvrName:null,newDvrName:null}}))}),i_(r_(n),"handleDvrNameKeyPress",function(e){"Enter"===e.key&&n.handleDvrNameSet()}),i_(r_(n),"handleValueChange",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ti;return function(a){var r=t(a);n.props.onConfigValueChange(e,"raw")(r)}}),i_(r_(n),"handleValueToggle",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return!0!==e||null};return function(){n.props.onConfigValueChange(e,"raw")(t(ke.a(e,n.props.subconfig)))}}),i_(r_(n),"handleScheduleRangeValueChange",function(e,t,a){return function(r){var o=r.target.value.replace(/:/g,""),i=parseInt(o,10),s=[e,"schedule"],l=n.props.subconfig[e].schedule.map(function(e,n){return n!==t?e:0===a&&[i,e[1]]||[e[0],i]});n.props.onConfigValueChange(s,"raw")(l)}}),i_(r_(n),"handleScheduleRangeDelete",function(e,t){return function(){n.props.onConfigValueChange([e,"schedule"],"raw")(n.props.subconfig[e].schedule.filter(function(e,n){return t!==n}))}}),i_(r_(n),"handleScheduleRangeAdd",function(e){return function(){n.props.onConfigValueChange([e,"schedule"],"raw")([].concat(e_(n.props.subconfig[e].schedule||[]),[[0,2359]]))}}),i_(r_(n),"handleDiskRename",function(e,t){return function(a){var r=a.target.value;n.props.onConfigValueNameChange([e.name,"disks"],t,r)}}),i_(r_(n),"handleDiskModeChange",function(e,t){return function(a){var r=a.target.value;n.props.onConfigValueChange([e,"disks",t,"mode"],"raw")(r)}}),i_(r_(n),"handleDiskDelete",function(e,t){return function(){n.props.onConfigValueDelete([e,"disks",t])}}),i_(r_(n),"handleDiskAdd",function(e){return function(){var t=Ek("NewDisk",Vi(n.props.subconfig[e].disks));n.props.onConfigValueChange([e,"disks",t.name],"raw")(ts.a(["name"],t))}}),i_(r_(n),"handleDvrDelete",function(e){return function(t){t.stopPropagation(),n.props.onConfigValueDelete([e])}}),i_(r_(n),"handleDvrAdd",function(){var e=Ek("NewDvr",Vi(n.props.subconfig),{schedule:[],disks:{}});n.props.onConfigValueChange([e.name],"raw")(e),n.setState(function(t){return{expandedDvrs:t_({},t.expandedDvrs,i_({},e.name,!0))}})}),i_(r_(n),"handleDvrSave",function(){n.props.onConfigSave()}),i_(r_(n),"renderStorage",function(e){var t=e.dvrs,a=e.dvr;return r.createElement(Ps.a,{container:!0,spacing:1},r.createElement(Ps.a,{item:!0,xs:12},r.createElement(Ws,{autoFocus:!0,fullWidth:!0,required:!0,changeOnlyValidated:!0,debounce:300,label:"Name",defaultValue:n.state.oldDvrName===a.name?n.state.newDvrName:a.name,type:"text",onFocus:n.handleDvrNameFocus(a.name),onChange:n.handleDvrNameEdit,onKeyPress:n.handleDvrNameKeyPress,onBlur:n.handleDvrNameSet,validate:function(e){return Vk({dvrs:t,value:e,oldValue:n.state.oldDvrName})},onError:n.props.onError([a.name,"name"]),onErrorResolve:n.props.onErrorResolve([a.name,"name"]),error:n.props.errors[ul([a.name,"name"])],"data-testid":"dvrName"})),r.createElement(Ps.a,{item:!0,xs:12},r.createElement(Ws,{fullWidth:!0,required:!0,changeOnlyValidated:!0,label:"Root",defaultValue:a.root,onEditingFinished:n.handleValueChange([a.name,"root"]),validate:function(e){return qk({dvrs:t,value:e,streamRoots:c_(n.props.config.streams)})},onError:n.props.onError(a.name,"root"),onErrorResolve:n.props.onErrorResolve(a.name,"root"),error:n.props.errors[ul([a.name,"root"])],type:"text","data-testid":"dvrRoot"})),r.createElement(Ps.a,{container:!0,item:!0,xs:12},r.createElement(Ps.a,{item:!0,xs:3},r.createElement(ta.a,{control:r.createElement(mf.a,{checked:0===a.raid,onChange:n.handleValueToggle([a.name,"raid"],function(e){return 0===e?null:0}),color:"primary","data-testid":"dvrRaid",disabled:qe(a.root)}),label:"RAID 0"})),r.createElement(Ps.a,{item:!0,xs:3},r.createElement(Ws,{fullWidth:!0,label:"Disks to write",value:a.active,type:"number",inputProps:{min:1,max:Object.keys(Vi(Im.a({},"disks",a))).length},onChange:n.handleValueChange([a.name,"active"],Ii),"data-testid":"dvrActive",disabled:qe(a.root)||0!==a.raid}))),r.createElement(Ps.a,{item:!0,xs:12},r.createElement(Ws,{fullWidth:!0,label:"Copy chunks to this location",value:a.copy,type:"text",onChange:n.handleValueChange([a.name,"copy"]),"data-testid":"dvrCopy"})))}),i_(r_(n),"renderDisk",function(e){var t=e.dvr,a=e.classes,o=e.disk;return r.createElement(Ps.a,{container:!0,alignItems:"flex-end",spacing:1,key:"".concat(t.name,"-").concat(o.key)},r.createElement(Ps.a,{item:!0,xs:3},r.createElement(Ws,{fullWidth:!0,value:"".concat(t.root,"/"),type:"text",disabled:!0})),r.createElement(Ps.a,{item:!0,xs:5},r.createElement(Ws,{fullWidth:!0,label:"Disk name",defaultValue:o.key,type:"text",onEditingFinished:n.handleDiskRename(t,o.key),"data-testid":"dvrDiskName"})),r.createElement(Ps.a,{container:!0,item:!0,xs:3},r.createElement(Dm.a,{className:a.dvrDiskModeSelectControl,fullWidth:!0},r.createElement(xs.a,{htmlFor:"dvrDiskMode_".concat(t.name,"_").concat(o.key)},"Mode"),r.createElement(Cs.a,{autoWidth:!0,value:o.mode||"",onChange:n.handleDiskModeChange(t.name,o.key),inputProps:{id:"dvrDiskMode_".concat(t.name,"_").concat(o.key)},"data-testid":"dvrDiskMode"},s_.map(function(e){return r.createElement(Ns.a,{"data-testid":"dvrDiskMode".concat(l_(e)),key:l_(e),value:e},l_(e))})))),r.createElement(Ps.a,{container:!0,item:!0,xs:1,justify:"flex-end"},r.createElement(Is.a,{"aria-label":"Delete disk",title:"Delete disk",onClick:n.handleDiskDelete(t.name,o.key),"data-testid":"dvrDiskDelete"},r.createElement(tk.a,{fontSize:"small"}))))}),i_(r_(n),"renderDisks",function(e){var t=e.dvr,a=e.classes;return Q.a(Ne.a(function(e){return n.renderDisk({dvr:t,classes:a,disk:e})}),ZN.a(Ee.a("position")),ve.a(function(e,n){return t.disks[n]?[].concat(e_(e),[t_({},t.disks[n],{key:n})]):e},[]),ye.a,Vi)(t.disks)}),i_(r_(n),"renderDvrEditor",function(e){var t=e.dvrs,a=e.dvr,o=e.classes;return r.createElement(Ps.a,{container:!0,spacing:8},r.createElement(Ps.a,{container:!0,item:!0,xs:12,md:6,lg:4,alignContent:"flex-start"},r.createElement(Uk,{title:"Storage"}),n.renderStorage({dvrs:t,dvr:a})),r.createElement(Ps.a,{container:!0,item:!0,xs:12,md:6,lg:4,alignContent:"flex-start"},r.createElement(Uk,{title:"Additional"}),r.createElement(Hk,{dvr:a,onValueChange:n.handleValueChange,onValueToggle:n.handleValueToggle})),r.createElement(Ps.a,{container:!0,item:!0,xs:12,md:6,lg:4,alignContent:"flex-start"},r.createElement(Uk,{title:"Limits"}),r.createElement(df,{dvr:a,onValueChange:n.handleValueChange})),r.createElement(Ps.a,{container:!0,item:!0,xs:12,md:6,alignContent:"flex-start"},r.createElement(Xk,{dvr:a,onScheduleRangeValueChange:n.handleScheduleRangeValueChange,onScheduleRangeDelete:n.handleScheduleRangeDelete,onScheduleRangeAdd:n.handleScheduleRangeAdd})),r.createElement(Ps.a,{container:!0,item:!0,xs:12,lg:6,alignContent:"flex-start"},r.createElement(Uk,{title:"Disks"},r.createElement(Kk,{label:"Add disk",onClick:n.handleDiskAdd(a.name),"data-testid":"dvrDiskAdd"})),n.renderDisks({dvr:a,classes:o})),r.createElement(Ps.a,{container:!0,item:!0,xs:12},r.createElement(Td.a,{mt:2,mb:1},r.createElement(Jf.a,{light:!0}))))}),i_(r_(n),"renderDvrSummary",function(e){var t=e.dvr;return r.createElement(Ps.a,{container:!0,justify:"space-between"},r.createElement(Ps.a,{container:!0,item:!0,xs:11,alignItems:"center"},1===t.raid&&r.createElement(Td.a,{mr:1,display:"inline-block",title:"RAID 0 with ".concat(t.active||Object.keys(t.disks||{}).length," disks to write")},r.createElement(Lk,{size:20}),"(",t.active||Object.keys(t.disks||{}).length,")"),t.name," at ",t.root),r.createElement(Ps.a,{item:!0,xs:1},r.createElement(Ps.a,{container:!0,justify:"flex-end"},r.createElement(Is.a,{"aria-label":"Delete dvr config",title:"Delete dvr config",onClick:n.handleDvrDelete(t.name),"data-testid":"dvrDelete"},r.createElement(tk.a,{fontSize:"small"})))))}),i_(r_(n),"renderActions",function(){return r.createElement(Td.a,{mt:2},r.createElement(Ps.a,{container:!0,spacing:1},r.createElement(Ps.a,{item:!0},r.createElement(Hs.a,{color:"primary",variant:"contained",onClick:n.handleDvrSave,disabled:!n.props.isConfigChanged||n.props.areErrorsExists,"data-testid":"dvrSaveButton"},n.props.isConfigSaving&&r.createElement(Am.a,{size:20,color:"primary"}),"Save")),r.createElement(Ps.a,{item:!0},r.createElement(Hs.a,{variant:"contained",onClick:n.props.onConfigResetChanges,disabled:!n.props.isConfigChanged,"data-testid":"dvrResetButton"},"Reset")),r.createElement(Ps.a,{item:!0},r.createElement(Hs.a,{variant:"outlined",onClick:n.handleDvrAdd,"data-testid":"dvrAddButton"},"Add DVR"))))}),n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o_(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.subconfig,o=this.state.expandedDvrs;return r.createElement(Td.a,{px:"8.5%","data-testid":"dvrs",pt:1},r.createElement(Ps.a,{container:!0},Q.a(Ne.a(function(t){return r.createElement(Ps.a,{item:!0,xs:12,key:t.name},r.createElement(ng.a,{key:t.name,elevation:0,expanded:o[t.name]||1===Object.keys(a).length,onChange:e.handleDvrExpansion(t.name),TransitionProps:{unmountOnExit:!0}},r.createElement(ag.a,{expandIcon:r.createElement(ig.a,null),"data-testid":"dvrPanelSummary"},e.renderDvrSummary({dvr:t})),r.createElement(rg.a,{"data-testid":"dvrPanelSummary"},e.renderDvrEditor({dvr:t,classes:n,dvrs:a}))))}),be.a(he.a(we.a)),ZN.a(Ee.a("position")),Kf.a,Vi)(a)),this.renderActions())}}])&&n_(n.prototype,a),o&&n_(n,o),t}();i_(u_,"propTypes",{config:Qa.isRequired,isConfigChanged:Y.a.bool.isRequired,subconfig:Wa.isRequired,onConfigValueChange:Y.a.func.isRequired,onConfigValueDelete:Y.a.func.isRequired,onConfigValueNameChange:Y.a.func.isRequired,onConfigSave:Y.a.func.isRequired,onConfigResetChanges:Y.a.func.isRequired,isConfigSaving:Y.a.bool.isRequired,classes:Y.a.shape({dvrDiskModeSelectControl:Y.a.string,dvrSectionAddButton:Y.a.string}),onError:Y.a.func.isRequired,onErrorResolve:Y.a.func.isRequired,errors:ha()(Y.a.string).isRequired,areErrorsExists:Y.a.bool.isRequired}),i_(u_,"defaultProps",{classes:{}});var p_=Q.a(es(u_.propTypes,["dvrs"]),du(),pl)(u_),d_=n(1455),m_=n(1456),f_=n(1457),h_=n(1458),g_=n(1386),v_=n(1459),b_=n(1387),y_=n(1460);function E_(e){return(E_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w_(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function S_(e){return(S_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O_(e,t){return(O_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N_=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=S_(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==E_(r)&&"function"!=typeof r?C_(a):r,x_(C_(n),"restartCoder",function(e){var t=e.coder;x("/flussonic/api/chassis/coder_restart",{method:"post",body:JSON.stringify({coder:t})})}),x_(C_(n),"renderCoder",function(e){return o.a.createElement(Ps.a,{item:!0,sm:6,md:4,lg:2,key:e.coder},o.a.createElement(d_.a,null,o.a.createElement(m_.a,{title:"Coder ".concat(e.coder)}),o.a.createElement(f_.a,null,o.a.createElement("p",null,e.status," ",e.uptime?"".concat(Math.round(e.uptime/1e3),"s"):""),o.a.createElement(Hs.a,{variant:"contained",color:"secondary",onClick:function(){n.restartCoder(e)}},"restart"),"working"===e.status?n.renderCoderRuntime(e):n.renderCoderBoot(e))))}),x_(C_(n),"renderCoderBoot",function(e){var t=["offline","booting"].includes(e.status)||"default",n={offline:0,booting:10+90*e.stage/9,default:100};return o.a.createElement(Td.a,{mt:1},o.a.createElement(h_.a,{variant:"determinate",value:n[t]}))}),x_(C_(n),"renderCoderRuntime",function(e){return o.a.createElement(g_.a,{subheader:o.a.createElement(v_.a,null,"streams")},e&&e.streams?e.streams.map(function(e){return o.a.createElement(b_.a,{key:e.name},o.a.createElement(y_.a,{primary:e.name}))}):"")}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O_(e,t)}(t,o.a.Component),n=t,(a=[{key:"render",value:function(){return this.props.config?o.a.createElement(Td.a,{px:"8.5%","data-testid":"chassis"},o.a.createElement("h1",null,"Chassis"),o.a.createElement(Ps.a,{container:!0,spacing:2},Q.a(Ne.a(this.renderCoder),Es.a([],["config","stats","chassis","coders"]))(this.props))):o.a.createElement(Td.a,null,"loading...")}}])&&w_(n.prototype,a),r&&w_(n,r),t}();x_(N_,"propTypes",{config:Qa.isRequired});var k_=es()(N_),__=n(1467),P_=n(580),j_=n(578),R_=n(577),T_=n(371),I_=n(581),D_=n(584),A_=n(583),q_=Q.a(me.a("Object"),ge.a),M_=Q.a(Mg.a(q_),Kf.a),F_=P_.a("left"),V_=P_.a("right"),B_=j_.a(F_,V_),L_=j_.a(B_,Q.a(Fm.a(me.a),Kf.a)),W_=Q.a(R_.a(void 0),Kf.a),H_=Q.a(T_.a(void 0),Kf.a),U_=j_.a(F_,he.a(V_)),z_=j_.a(he.a(F_),V_),G_=Se.a(function(e,t){return Q.a(Ne.a(xi.a([[U_,W_],[z_,H_],[B_,I_.a(M_,Q.a(Fm.a(G_),Kf.a),Kf.a)]])),ue.a(L_),yp.a(D_.a(A_.a),[Ne.a(qx.a("left")),Ne.a(qx.a("right"))]))(e,t)});var Q_={name:"",files:[],slots:[]},K_={from:"00:00:00",duration:15},J_=function(e){return function(t){return t.name==="".concat(e.prefix,"/").concat(e.name)}},Y_=n(674),$_=n.n(Y_),X_=n(576),Z_=fl(function(e){var t=e.schedules,n=e.value,a=e.scheduleIndex;return Q.a(Ce.a,Ai.a(n),Ne.a(Ee.a("name")),X_.a(be.a)(function(e,t){return t!==a}))(t)},"Ad schedule name should be unique."),eP=fl(function(e){var t=e.value;return t&&t.length>0},"Ad schedule name is required and should have 1 character at least."),tP=hl(Z_,eP),nP=fl(function(e){var t=e.value,n=e.slots,a=e.slotIndex;return!n.some(function(e,n){return n!==a&&(e.from===t||"".concat(e.from,":00")===t||e.from==="".concat(t,":00"))})},"Time slot start time should be unique"),aP=fl(function(e){var t=e.value;return/\d\d:\d\d:\d\d/.test(t)},"Slot format is HH:mm:ss"),rP=hl(nP,aP),oP=hl(fl(function(e){var t=e.value;return Pi(0,t)>0},"Should be greater, than 0"));function iP(){return(iP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function sP(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var lP=/\d/,cP=function(e){var t=e.inputRef,n=sP(e,["inputRef"]);return o.a.createElement($_.a,iP({},n,{ref:function(e){t(e?e.inputElement:null)},mask:[lP,lP,":",lP,lP,":",lP,lP],placeholderChar:"_",showMask:!0}))};cP.propTypes={inputRef:Y.a.func.isRequired};var uP=function(e){var t=e.schedules,n=e.schedule,a=e.index,r=e.onChange,i=e.onIndexDelete,s=e.onSlotAdd,l=e.onError,c=e.onErrorResolve,u=e.errors;return o.a.createElement(Ps.a,{container:!0,spacing:2},o.a.createElement(Ps.a,{container:!0,item:!0,xs:12},o.a.createElement(Ps.a,{item:!0,xs:12,sm:6,md:4,lg:3},o.a.createElement(Ws,{required:!0,fullWidth:!0,autoFocus:!0,label:"Schedule name",value:n.name,onChange:r([a,"name"]),validate:function(e){return tP({schedules:t,value:e,scheduleIndex:a})},onError:l("schedules",a,"name"),onErrorResolve:c("schedules",a,"name"),error:u[ul(["schedules",a,"name"])],"data-testid":"adInjectorStreams_".concat(n.name,"_name_input")}))),o.a.createElement(Ps.a,{item:!0,xs:12,lg:6},o.a.createElement(Ps.a,{container:!0,item:!0,xs:12},o.a.createElement(Td.a,{fontSize:20,my:2},"Time slots"),n.slots.map(function(e,t){return o.a.createElement(Ps.a,{container:!0,item:!0,xs:12},o.a.createElement(Ps.a,{container:!0,item:!0,xs:8,spacing:1},o.a.createElement(Ps.a,{item:!0,xs:8},o.a.createElement(Ws,{fullWidth:!0,label:"From",value:e.from,inputProps:{step:1},onChange:r([a,"slots",t,"from"]),validate:function(e){return rP({slots:n.slots,value:e,slotIndex:t})},onError:l("schedules",a,"slots",t,"from"),onErrorResolve:c("schedules",a,"slots",t,"from"),error:u[ul(["schedules",a,"slots",t,"from"])],InputProps:{inputComponent:cP},"data-testid":"adInjectorStreams_".concat(n.name,"_slot_").concat(t,"_from_").concat(e.from,"_textfield")})),o.a.createElement(Ps.a,{item:!0,xs:4},o.a.createElement(Ws,{fullWidth:!0,label:"Duration",value:e.duration,type:"number",onChange:r([a,"slots",t,"duration"]),validate:function(e){return oP({value:e})},onError:l("schedules",a,"slots",t,"duration"),onErrorResolve:c("schedules",a,"slots",t,"duration"),error:u[ul(["schedules",a,"slots",t,"duration"])],"data-testid":"adInjectorStreams_".concat(n.name,"_slot_").concat(t,"_duration_").concat(e.duration,"_textfield")}))),o.a.createElement(Ps.a,{container:!0,item:!0,xs:4,justify:"flex-end"},o.a.createElement(Zs,{variant:"text",color:"red.light",size:"small",onClick:i([a,"slots"],t),"data-testid":"adInjectorStreams_".concat(n.name,"_slot_").concat(t,"_remove_button")},"Remove")))}),o.a.createElement(Ps.a,{container:!0,item:!0,xs:12},o.a.createElement(Td.a,{mt:2},o.a.createElement(Zs,{variant:"text",color:"primary",size:"small",onClick:s,"data-testid":"adInjectorStreams_".concat(n.name,"_slot_add_button")},"Add slot"))))),o.a.createElement(Ps.a,{item:!0,xs:12,lg:6},o.a.createElement(Ps.a,{container:!0,item:!0,xs:12},o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(Td.a,{fontSize:20,my:2},"Schedule files"),n.files.map(function(e,t){return o.a.createElement(Ps.a,{container:!0,item:!0,xs:12,"data-testid":"adInjectorStreams_".concat(n.name,"_file_").concat(e.name)},o.a.createElement(Ps.a,{container:!0,item:!0,xs:8,spacing:1},o.a.createElement(Ps.a,{item:!0,xs:8},o.a.createElement(Ws,{disabled:!0,fullWidth:!0,label:"Filename",value:e.name,onChange:void 0})),o.a.createElement(Ps.a,{item:!0,xs:4},o.a.createElement(Ws,{fullWidth:!0,label:"Weight",value:e.weight,type:"number",onChange:r([a,"files",t,"weight"]),validate:function(e){return oP({value:e})},onError:l("schedules",a,"files",t,"weight"),onErrorResolve:c("schedules",a,"files",t,"weight"),error:u[ul(["schedules",a,"files",t,"weight"])],"data-testid":"adInjectorStreams_".concat(n.name,"_file_").concat(e.name,"_weight_textfield")}))),o.a.createElement(Ps.a,{container:!0,item:!0,xs:4,justify:"flex-end"},o.a.createElement(Zs,{variant:"text",color:"red.light",size:"small",onClick:i([a,"files"],t),"data-testid":"adInjectorStreams_".concat(n.name,"_file_").concat(e.name,"_remove_button")},"Remove")))})))))};uP.propTypes={schedules:Y.a.arrayOf(Y.a.shape({name:Y.a.string,slots:Y.a.arrayOf(Y.a.shape({from:Y.a.string,duration:Y.a.number})),files:Y.a.arrayOf(Y.a.shape({name:Y.a.string,weight:Y.a.number}))})).isRequired,schedule:Y.a.shape({name:Y.a.string,slots:Y.a.arrayOf(Y.a.shape({from:Y.a.string,duration:Y.a.number})),files:Y.a.arrayOf(Y.a.shape({name:Y.a.string,weight:Y.a.number}))}).isRequired,index:Y.a.number.isRequired,onChange:Y.a.func.isRequired,onIndexDelete:Y.a.func.isRequired,onSlotAdd:Y.a.func.isRequired,onError:Y.a.func.isRequired,onErrorResolve:Y.a.func.isRequired,errors:ha()(Y.a.string).isRequired};var pP=uP,dP=n(1461),mP=n(1462),fP=n(1463),hP=n(1464),gP=n(1465),vP=function(e){var t=e.name,n=e.stream;return o.a.createElement(Ps.a,{container:!0,"data-testid":"adInjectorAdvertedStreams_".concat(t)},o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(Td.a,{fontSize:16},t)),o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(dP.a,{"data-testid":"adInjectorAdvertedStreams_".concat(t,"_table")},o.a.createElement(mP.a,null,o.a.createElement(fP.a,null,o.a.createElement(hP.a,null,"File"),o.a.createElement(hP.a,null,"Shows"),o.a.createElement(hP.a,null,"Views"))),o.a.createElement(gP.a,null,n.map(function(e){return o.a.createElement(fP.a,{"data-testid":"adInjectorAdvertedStreams_".concat(t,"_table_").concat(e)},o.a.createElement(hP.a,{"data-testid":"adInjectorAdvertedStreams_".concat(t,"_table_").concat(e,"_name")},e.name),o.a.createElement(hP.a,{"data-testid":"adInjectorAdvertedStreams_".concat(t,"_table_").concat(e,"_show_count")},e.show_count),o.a.createElement(hP.a,{"data-testid":"adInjectorAdvertedStreams_".concat(t,"_table_").concat(e,"_view_count")},e.view_count))})))))};vP.propTypes={name:Y.a.string.isRequired,stream:Y.a.arrayOf(Y.a.shape({name:Y.a.string,show_count:Y.a.number,view_count:Y.a.number})).isRequired};var bP=vP,yP=n(1466);function EP(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function wP(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Y.a.shape({name:Y.a.string,prefix:Y.a.string}).isRequired,Y.a.bool.isRequired,Y.a.func.isRequired;var SP=function e(t){var n=t.vodName,a=t.path,r=t.subPath,i=t.onNavigateToParentDirectory,s=t.onFileSelect,l=t.selectedFiles,c=void 0===l?[]:l,u=qe(r),p=wP(o.a.useState(null),2),d=p[0],m=p[1],f=wP(o.a.useState([]),2),h=f[0],g=f[1],v=wP(o.a.useState([]),2),b=v[0],y=v[1],E=o.a.useCallback(function(e){return function(t){t.preventDefault(),m(e)}},[m]);return o.a.useEffect(function(){N.vodList(a,n,r).then(function(e){g(e.files.filter(function(e){var t=e.type,n=e.name;return"file"===t&&[".mp4",".f4v",".mov",".m4v",".mp4a",".3gp",".3g2"].some(function(e){return n.endsWith(e)})})),y(e.files.filter(function(e){return"directory"===e.type}))})},[]),o.a.createElement(Ps.a,{container:!0,item:!0,xs:12},d?o.a.createElement(e,{vodName:n,path:a,subPath:[].concat(EP(r),[d]),onNavigateToParentDirectory:E(null),onFileSelect:s,selectedFiles:c}):o.a.createElement(o.a.Fragment,null,!u&&o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(yP.a,{href:"#",onClick:i,"data-testid":"adInjectorFiles_".concat(n,"_parentDir_link")},".. parent directory")),b.map(function(e){var t=e.name;return o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(yP.a,{href:"#",onClick:E(t),"data-testid":"adInjectorFiles_".concat(n,"_dir_").concat(t,"_link")},t))}),h.map(function(e){return o.a.createElement(Ps.a,{item:!0,xs:12},o.a.createElement(Og,{label:"".concat(e.prefix,"/").concat(e.name),onChange:s(e),checked:c.some(J_(e)),"data-testid":"adInjectorFiles_".concat(n,"_file_").concat(e.name,"_checkbox")}))})))};SP.propTypes={vodName:Y.a.string.isRequired,path:Y.a.string.isRequired,subPath:Y.a.arrayOf(Y.a.string).isRequired,onNavigateToParentDirectory:Y.a.func,onFileSelect:Y.a.func.isRequired,selectedFiles:Y.a.arrayOf(Y.a.shape({name:Y.a.string,prefix:Y.a.string})).isRequired},SP.defaultProps={onNavigateToParentDirectory:void 0};var CP=SP;function OP(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function xP(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var NP=Q.a(Ne.a(function(e){return Pi(0,e)}),zt.a(":"),Ee.a("from")),kP=Q.a(el.a(":"),Ne.a(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0).toString().padStart(2,"0")})),_P=Object(Us.a)(function(){return Object(zs.a)({files:{position:"fixed",top:68,left:"60vw",paddingTop:"0 !important",height:"calc(100vh - 100px)",overflowY:"scroll"},stickyHeader:{position:"sticky",top:0,width:"100%",background:"white",zIndex:1}})}),PP=function(e){var t=e.subconfig,n=e.onError,a=e.onErrorResolve,r=e.areErrorsExists,i=e.errors,s=_P(),l=Object(__.a)(),c=xP(o.a.useState(!1),2),u=c[0],p=c[1],d=xP(o.a.useState(null),2),m=d[0],f=d[1],h=xP(o.a.useState([]),2),g=h[0],v=h[1],b=xP(o.a.useState([]),2),y=b[0],E=b[1],w=xP(o.a.useState({}),2),S=w[0],C=w[1],O=xP(o.a.useState(!1),2),N=O[0],k=O[1],_=o.a.useCallback(function(e){return function(t,n){f(n?e:null)}},[f]),P=o.a.useCallback(function(e){return function(t){return function(){if(null!==e){var n=Oi.a([e,"files"]),a=Oe.a(n,y),r=a.some(J_(t)),o={name:"".concat(t.prefix,"/").concat(t.name),weight:1},i=r?a.filter(function(e){return function(t){return!J_(e)(t)}}(t)):[].concat(OP(a),[o]),s=_s.a(n,i,y);E(s)}}}},[y,E]),j=o.a.useCallback(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ti;return function(n){var a=Oi.a(e),r=t(n);E(_s.a(a,r,y))}},[y]),R=o.a.useCallback(function(e,t){return function(){var n=Oi.a(e),a=Oe.a(n,y).filter(function(e,n){return n!==t}),r=_s.a(n,a,y);E(r)}},[y,E]),T=o.a.useCallback(function(e){return function(){var t=y[e].slots,n=t.length-1,a=null;if(0===t.length)a=K_;else{var r=t[n],o=xP(NP(r),3),i=o[0],s=o[1],l=o[2],c=i>22?0:i+1,u=kP([c,s,l]);a={from:t.some(function(e){return e.from===u})?kP([c,s>54?s-5:s+5,l]):u,duration:r.duration}}var p=Oi.a([e,"slots",n+1]),d=_s.a(p,a,y);E(d)}},[y,E]),I=o.a.useCallback(function(){if(!y.some(function(e){return e.name===Q_.name})){var e=y.length,t=Oi.a([e]);E(_s.a(t,Q_,y)),f(e)}},[y,f]),D=o.a.useCallback(function(){x("/flussonic/api/save_ad_schedules",{method:"post",body:JSON.stringify({schedules:y})}).then(function(){l&&(v(y),p(!1))}).catch(function(){l&&p(!1)}),p(!0)},[y]);return o.a.useEffect(function(){x("/flussonic/api/fetch_ad_schedules",{method:"get"}).then(function(e){l&&(E(e.schedules),v(e.schedules))}),x("/flussonic/api/ad_streams",{method:"get"}).then(function(e){l&&C(e)})},[]),o.a.useEffect(function(){var e=G_(y,g),t=!Ae(e);k(!t)},[y,g]),o.a.createElement(Td.a,{px:"8.5%","data-testid":"adInjector"},o.a.createElement(Ps.a,{container:!0,spacing:8},o.a.createElement(Ps.a,{container:!0,item:!0,xs:7,spacing:2},o.a.createElement(Ps.a,{item:!0,xs:12,key:"adInjectorAdvertedStreams"},o.a.createElement(cg,{isPadded:!0,header:"Adverted streams",isExpanded:-1===m,onChange:_(-1),"data-testid":"adInjectorAdvertedStreamsToggle"},Ae(S)&&Object.entries(S).map(function(e){var t=xP(e,2),n=t[0],a=t[1];return o.a.createElement(bP,{stream:a,name:n,key:n})}))),o.a.createElement(Td.a,{fontSize:20,my:4,className:s.stickyHeader},"Ad schedules"),y.map(function(e,t){return o.a.createElement(Ps.a,{item:!0,xs:12,key:t},o.a.createElement(cg,{"data-testid":"adInjectorStreams_".concat(e.name,"_toggle"),header:o.a.createElement(Td.a,{width:"100%"},o.a.createElement(Ps.a,{container:!0,alignItems:"center"},o.a.createElement(Ps.a,{container:!0,item:!0,xs:!0},"Schedule: ",e.name),o.a.createElement(Ps.a,{container:!0,item:!0,xs:!0,justify:"flex-end"},o.a.createElement(Zs,{onClick:R([],t),color:"red.light","data-testid":"adInjectorStreams_".concat(e.name,"_remove_button")},"Remove")))),isPadded:!0,isExpanded:m===t,onChange:_(t)},o.a.createElement(pP,{schedules:y,schedule:e,index:t,onChange:j,onIndexDelete:R,onSlotAdd:T(t),onError:n,onErrorResolve:a,errors:i})))}),o.a.createElement(Ps.a,{container:!0,item:!0,xs:12,spacing:2},o.a.createElement(Ps.a,{item:!0},o.a.createElement(Zs,{disabled:r||u||!Ae(t)||!N,variant:"contained",color:"primary",width:18,onClick:D,"data-testid":"adInjectorStreamsSaveButton"},"Save",u&&o.a.createElement(Am.a,{size:20,color:"primary"}))),o.a.createElement(Ps.a,{item:!0},o.a.createElement(Zs,{variant:"contained",width:18,onClick:I,"data-testid":"adInjectorStreamsAddButton"},"Add schedule")))),o.a.createElement(Ps.a,{item:!0,xs:5,className:s.files},o.a.createElement(Td.a,{fontSize:20,my:4},"Files"),Ae(t)&&Object.keys(t).map(function(e){return o.a.createElement(cg,{header:e,"data-testid":"adInjectorFiles_".concat(e,"_toggle")},o.a.createElement(CP,{subPath:[],vodName:e,path:t[e].urls[0].url,onFileSelect:P(m),selectedFiles:Ae(y[m])?y[m].files:[]}))}))))};PP.propTypes={subconfig:Ua.isRequired,onError:Y.a.func.isRequired,onErrorResolve:Y.a.func.isRequired,errors:ha()(Y.a.string).isRequired,areErrorsExists:Y.a.bool.isRequired};var jP=Q.a(pl,es(PP.props,["vods"]),du())(PP);function RP(){return(RP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var TP=Object(k.f)(function(e){return o.a.createElement(k.d,null,wt({name:"pulse",component:sO,extraProps:e}),wt({name:"global-config",exact:!0,component:KO}),wt({name:"config-editor",render:function(t){return o.a.createElement(nx,RP({},t,e))}}),wt({name:"iptv",render:function(t){return o.a.createElement(XN,RP({},t,e))}}),wt({name:"chassis",component:k_,extraProps:e}),wt({name:"watcher",component:ax}),wt({name:"logupload",component:gx}),wt({name:"auth",component:Tk}),wt({name:"ad_injector",component:jP}),wt({name:"dvrs",component:p_}),wt({name:"cluster",exact:!0,component:Ax}),wt({name:"cluster-ingest",component:zx}),wt({name:"cluster-settings",component:kN}),wt({name:"cluster-sources",component:DN}),wt({name:"cluster-peer",render:function(e){return o.a.createElement(Zx,RP({},e,{name:e.match.params.name}))}}))});function IP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){LP(e,t,n[t])})}return e}function DP(e){return(DP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AP(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qP(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function MP(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function FP(e){return(FP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BP(e,t){return(BP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var WP=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=FP(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==DP(r)&&"function"!=typeof r?VP(a):r,LP(VP(n),"state",{query:"",filter:[],config:void 0}),LP(VP(n),"onConfigChange",function(e){n.setState({config:e})}),LP(VP(n),"onTextFilterChange",function(e){n.setState({query:e.target.value}),n.refreshRoute(e.target.value,n.state.filter)}),LP(VP(n),"onFilterChange",function(e){n.setState({filter:e}),n.refreshRoute(n.state.query,e)}),LP(VP(n),"clearModal",function(){ar.dispatch({type:"modal:clear"})}),LP(VP(n),"refreshHeight",function(){var e=window.innerHeight-100;n.setState({height:e})}),LP(VP(n),"doNotPropagate",function(e){e.stopPropagation()}),LP(VP(n),"getNotifications",function(){return n.state.config?{next_version:n.state.config.stats.next_version,errors:Object.keys(n.state.config.stats.status).reduce(function(e,t){return t.includes("error_")?[].concat(qP(e),[n.state.config.stats.status[t]]):e},[])}:{next_version:void 0,errors:[]}}),LP(VP(n),"getNameMediaStats",function(){var e=n.props.modal?n.props.modal.get("path").toJS():[],t=AP(e,1)[0];if("streams"===t){var a=e[1],r=n.state.config.streams[a];return{name:a,media:r,stats:r.stats}}if("lives"===t){var o=AP(e,3),i=o[1],s=o[2],l=n.state.config.lives[i];return{name:s,media:l,stats:l.streams[s]}}if("sources"===t){var c=AP(e,3),u=c[1],p=c[2],d=n.state.config.sources[u];return{name:p,media:d,stats:d.streams[p]}}return console.error("Wrong path for modal play window: ",e),null}),LP(VP(n),"renderAdditionalNav",function(){return n.isMediaShowing()?o.a.createElement($C,{isTopLevel:n.isTopLevel(),config:n.state.config,currentPage:n.currentHeaderMediaType(),mediaName:n.currentMediaName(),value:n.state.query,onTextFilterChange:n.onTextFilterChange,filter:n.state.filter,onFilterChange:n.onFilterChange}):o.a.createElement("div",{className:"base-container"},o.a.createElement("div",{className:"left-container"}),o.a.createElement("div",{id:"header-additional-nav",className:"center-container"}),o.a.createElement("div",{className:"right-container"}))}),LP(VP(n),"renderModal",function(){if(!(n.props.modal&&"playMedia"===n.props.modal.get("type")&&n.state.config))return null;var e=n.getNameMediaStats(),t=e.name,a=e.media,r=e.stats;return o.a.createElement("div",{id:"modal-content",onClick:n.doNotPropagate},o.a.createElement("div",{className:"close",onClick:n.clearModal},"⨯"),o.a.createElement(wd,{name:t,media:a,stats:r,config:n.state.config,height:320}))}),LP(VP(n),"refreshRoute",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1?arguments[1]:void 0,a=0!==t.length?t.filter(function(e){return e&&e.length>0}).join("-"):null,r=Ot(VP(n)),o=xt(VP(n)),i=Z()(Ct(VP(n)),{$merge:{query:e,filter:a}});St(VP(n),r.length>2?r[1].name:r[r.length-1].name,o,i)}),LP(VP(n),"isTopLevel",function(){return 1===Ot(VP(n)).length}),LP(VP(n),"currentMediaName",function(){return xt(VP(n)).mediaName?decodeURIComponent(xt(VP(n)).mediaName):void 0}),LP(VP(n),"isMediaShowing",function(){var e=Ot(VP(n));return 1===e.length&&"root"===e[0].name||!!n.currentMediaName()}),LP(VP(n),"isHeaderTopNavActive",function(){return n.isTopLevel()||!!n.currentMediaName()}),LP(VP(n),"currentHeaderMediaType",function(){var e=Ot(VP(n));if(e.length>=2){if(["stream-item","published-item","mirrored-item","file-item","location-item","mirror-item","vod-item"].includes(e[1].name))return e[1].name}return null}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BP(e,t)}(t,o.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){var e=Ct(this),t=e.filter?e.filter.split("-"):[];this.setState({query:e.query,filter:t}),this.props.listenTo(ft,this.onConfigChange),this.refreshHeight(),window.addEventListener("resize",this.refreshHeight)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.refreshHeight)}},{key:"render",value:function(){var e=this.getNotifications(),t=e.errors,n=e.next_version,a=100+50*(t.length+(n?1:0)),r="".concat(a,"px"),i=this.isMediaShowing();return o.a.createElement("div",{"data-testid":"main"},o.a.createElement("div",{id:"modal-overlay",onClick:this.clearModal,style:{visibility:this.props.modal?"visible":"hidden"}},this.renderModal()),o.a.createElement(QS,{serverInfo:this.props.serverInfo,config:this.state.config,topOffset:a,height:"".concat(this.state.height,"px"),visible:i,params:{mediaName:this.currentMediaName()},query:{filter:this.state.filter,query:this.state.query}}),o.a.createElement("div",{style:{position:"fixed",height:r,top:0,width:"100%",backgroundColor:"white"}},o.a.createElement(_C,{config:this.state.config,notifications:e,logout:this.props.logout}),this.renderAdditionalNav()),!i&&o.a.createElement("div",{style:{position:"fixed",top:r,width:"100%",height:window.innerHeight-a,backgroundColor:"white",overflow:"scroll"}},o.a.createElement(TP,{serverInfo:this.props.serverInfo,config:this.state.config,store:this.props.store})))}}])&&MP(n.prototype,a),r&&MP(n,r),t}();LP(WP,"propTypes",IP({},At,{modal:Y.a.string,logout:Y.a.func.isRequired,store:Y.a.object.isRequired,serverInfo:Ja})),LP(WP,"defaultProps",IP({},{listenTo:function(){}},{modal:null,serverInfo:null}));var HP=Q.a(Object($.connect)(function(e){return{modal:e.get("modal")}},K.a({})),Dt(WP.propTypes,WP.defaultProps));WP.displayName="AdminPanel";var UP=HP(WP);function zP(e){return(zP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GP(){return(GP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function QP(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function KP(e){return(KP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function JP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YP(e,t){return(YP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var XP=P()(),ZP=Object(D.a)(),ej=Object(j.create)(Object(A.a)());ej.use({onProcessRule:function(e){if("keyframes"===e.type){var t=e;t.at&&(t.at=U.a(t.at))}},onProcessStyle:function(e,t){return"style"!==t.type?e:(Object.keys(e).forEach(function(t){var n=e[t],a=U.b(t),r=a&&a!==t,o=U.c(a,Object(j.toCssValue)(n));if((r||o&&o!==n)&&(r&&delete e[t],e[a||t]=o||n),/msie (8|9|10)/i.test(window.navigator.userAgent)){var i=z[t],s=G[n];i&&s?(delete e[t],e[i]=s):i&&!s?(delete e[t],e[i]=n):!i&&s&&(e[t]=s)}}),e)},onChangeValue:function(e,t){return U.c(t,Object(j.toCssValue)(e))||e}});var tj=Object(I.a)({palette:{primary:{light:M.a[300],main:M.a[500],dark:M.a[700]},secondary:{light:F.a[300],main:F.a[500],dark:F.a[700]},background:{default:"#ffffff"},green:{light:V.a[300],default:V.a[500],main:V.a[500],dark:V.a[700]},red:{light:B.a[400],default:B.a[500],main:B.a[500],dark:B.a[700]},orange:{light:L.a[400],default:L.a[500],main:L.a[500],dark:L.a[700]},grey:{light:W.a[300],default:W.a[500],main:W.a[500],dark:W.a[700]}},typography:{body1:{fontSize:12},useNextVariants:!0}}),nj=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=this,r=(e=KP(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==zP(r)&&"function"!=typeof r?JP(a):r,$P(JP(n),"state",{login:null,password:null,logged:null,error:!1,logging:!1,initialized:!1,serverInfoLoaded:!1,serverInfo:null}),$P(JP(n),"handleLogin",function(e){e.preventDefault();var t=n.state,a=t.login,r=t.password;n.setState({logging:!0}),N.login({login:a,password:r}).then(function(){N.setLogin({login:a,password:r}),localStorage.setItem("FlussonicAuth",JSON.stringify({login:a,password:r})),n.getServerInfo(),window.location.reload()}).catch(function(e){403===parseInt(e.status,10)?n.setState({logging:!1,error:!1,invalidLogin:!0}):(console.log("setError",e),n.setState({logging:!1,error:!0}))})}),$P(JP(n),"handleLogout",function(){N.setLogin(null),localStorage.removeItem("FlussonicAuth"),document.cookie="fluadmin=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT",n.setState({logged:!1,logging:!1,error:!1}),ae.stop(),ft.stop(),window.location.reload()}),$P(JP(n),"handleStateChange",function(e){return function(t){var a=t.target.value;return n.setState($P({},e,a))}}),$P(JP(n),"initializeStores",function(){n.state.initialized||(ae.start(),ft.start(),ar.dispatch({type:"init"}),n.setState({initialized:!0}))}),$P(JP(n),"getServerInfo",function(){N.requestServerInfo().then(function(e){N.setServerInfo(e),n.setState({logged:!0,error:!1,logging:!1,serverInfoLoaded:!0,serverInfo:e}),n.initializeStores()}).catch(function(e){401===parseInt(e.status,10)||403===parseInt(e.status,10)?n.setState({logged:!1,error:!1,logging:!1}):(console.log("setError",e),n.setState({logged:!1,error:!0,logging:!1}))})}),$P(JP(n),"renderLoading",function(){return o.a.createElement("div",null,"Loading app...")}),n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YP(e,t)}(t,r["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=localStorage.getItem("FlussonicAuth");if(e)try{N.setLogin(JSON.parse(e))}catch(e){console.error("Corrupted data in `FlussonicAuth` key in LocalStorage",e)}this.getServerInfo()}},{key:"renderError",value:function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"Server error"),o.a.createElement("div",null,o.a.createElement("button",{type:"button",onClick:this.getServerInfo},"Retry")))}},{key:"renderLogin",value:function(){return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"pb-2 mt-4 mb-2 border-bottom"},o.a.createElement("h1",null,"Flussonic Login")),o.a.createElement("form",null,o.a.createElement("div",{className:"form-group row"},o.a.createElement("label",{className:"col-sm-3 col-form-label"},"Login"),o.a.createElement("div",{className:"col-sm-4"},o.a.createElement("input",{type:"text",className:"form-control",placeholder:"Login","data-testid":"login",onChange:this.handleStateChange("login")}))),o.a.createElement("div",{className:"form-group row"},o.a.createElement("label",{className:"col-sm-3 col-form-label"},"Password"),o.a.createElement("div",{className:"col-sm-4"},o.a.createElement("input",{type:"password",className:"form-control",placeholder:"Password","data-testid":"password",onChange:this.handleStateChange("password")}))),o.a.createElement("div",{className:"form-group row"},o.a.createElement("div",{className:"col-sm-3"},o.a.createElement("button",{type:"submit",className:"btn btn-primary",onClick:this.handleLogin,"data-testid":"submit"},"Sign")),this.state.logging&&o.a.createElement("div",{className:"col-sm-4"},"Logging in..."),this.state.invalidLogin&&o.a.createElement("div",{className:"col-sm-4"},"Invalid login/password"),this.state.error&&o.a.createElement("div",{className:"col-sm-5"},"Server error"))))}},{key:"renderRouter",value:function(){var e=this;return o.a.createElement(k.c,{history:XP},o.a.createElement(k.d,null,o.a.createElement(k.b,{path:"/",exact:!0,render:function(){return o.a.createElement(k.a,{to:"/admin"})}}),o.a.createElement(k.b,{path:"/admin",render:function(t){return o.a.createElement(UP,GP({},t,{serverInfo:e.state.serverInfo,logout:e.handleLogout,store:ar}))}})))}},{key:"render",value:function(){return o.a.createElement(T.a,{jss:ej,generateClassName:ZP},o.a.createElement(q.a,{theme:tj},o.a.createElement(H.a,null),!this.state.logged&&this.renderLogin()||this.state.initialized&&this.state.serverInfoLoaded&&this.renderRouter()||this.renderLoading()))}}])&&QP(n.prototype,a),i&&QP(n,i),t}();n(1379),n(1380),n(1381);function aj(e){return(aj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){oj(e,t,n[t])})}return e}function oj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ij(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function sj(e,t){return!t||"object"!==aj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lj(e){return(lj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cj(e,t){return(cj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var uj=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),sj(this,lj(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cj(e,t)}(t,i["a"].BaseTransport),n=t,(a=[{key:"sendEvent",value:function(e){return x("/flussonic/api/error/store",{method:"post",body:JSON.stringify(rj({},e))}).then(function(){return{status:"success"}})}}])&&ij(n.prototype,a),r&&ij(n,r),t}();nj.load=function(e,t){var n=t.token;n&&!n.includes("{{")&&N.setAdminToken(n);var a,r,i=(a=t.query,r=null,a&&Object(u.parse)(a).host||r);N.setHost(t.host||i),s.a({dsn:"http://dsn@flussonic/flussonic/api",environment:"production",transport:uj}),Object(l.render)(o.a.createElement(nj,null),e)};t.default=nj},991:function(e,t,n){},992:function(e,t,n){},993:function(e,t,n){}},[[1383,1,2]]])});